function QT(s,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in s)){const o=Object.getOwnPropertyDescriptor(n,a);o&&Object.defineProperty(s,a,o.get?o:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function wv(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function XT(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var e=s.default;if(typeof e=="function"){var t=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var a=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return s[n]}})}),t}var Sg={exports:{}},kl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tb;function KT(){if(tb)return kl;tb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,o){var c=null;if(o!==void 0&&(c=""+o),a.key!==void 0&&(c=""+a.key),"key"in a){o={};for(var d in a)d!=="key"&&(o[d]=a[d])}else o=a;return a=o.ref,{$$typeof:s,type:n,key:c,ref:a!==void 0?a:null,props:o}}return kl.Fragment=e,kl.jsx=t,kl.jsxs=t,kl}var nb;function JT(){return nb||(nb=1,Sg.exports=KT()),Sg.exports}var w=JT(),Eg={exports:{}},we={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ib;function ZT(){if(ib)return we;ib=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function y(D){return D===null||typeof D!="object"?null:(D=m&&D[m]||D["@@iterator"],typeof D=="function"?D:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function T(D,z,F){this.props=D,this.context=z,this.refs=S,this.updater=F||_}T.prototype.isReactComponent={},T.prototype.setState=function(D,z){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,z,"setState")},T.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function O(){}O.prototype=T.prototype;function $(D,z,F){this.props=D,this.context=z,this.refs=S,this.updater=F||_}var L=$.prototype=new O;L.constructor=$,E(L,T.prototype),L.isPureReactComponent=!0;var U=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},Y=Object.prototype.hasOwnProperty;function Z(D,z,F,P,W,ge){return F=ge.ref,{$$typeof:s,type:D,key:z,ref:F!==void 0?F:null,props:ge}}function J(D,z){return Z(D.type,z,void 0,void 0,void 0,D.props)}function fe(D){return typeof D=="object"&&D!==null&&D.$$typeof===s}function ee(D){var z={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(F){return z[F]})}var ce=/\/+/g;function de(D,z){return typeof D=="object"&&D!==null&&D.key!=null?ee(""+D.key):z.toString(36)}function Se(){}function Ue(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(Se,Se):(D.status="pending",D.then(function(z){D.status==="pending"&&(D.status="fulfilled",D.value=z)},function(z){D.status==="pending"&&(D.status="rejected",D.reason=z)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function xe(D,z,F,P,W){var ge=typeof D;(ge==="undefined"||ge==="boolean")&&(D=null);var ne=!1;if(D===null)ne=!0;else switch(ge){case"bigint":case"string":case"number":ne=!0;break;case"object":switch(D.$$typeof){case s:case e:ne=!0;break;case p:return ne=D._init,xe(ne(D._payload),z,F,P,W)}}if(ne)return W=W(D),ne=P===""?"."+de(D,0):P,U(W)?(F="",ne!=null&&(F=ne.replace(ce,"$&/")+"/"),xe(W,z,F,"",function(ct){return ct})):W!=null&&(fe(W)&&(W=J(W,F+(W.key==null||D&&D.key===W.key?"":(""+W.key).replace(ce,"$&/")+"/")+ne)),z.push(W)),1;ne=0;var lt=P===""?".":P+":";if(U(D))for(var Ce=0;Ce<D.length;Ce++)P=D[Ce],ge=lt+de(P,Ce),ne+=xe(P,z,F,ge,W);else if(Ce=y(D),typeof Ce=="function")for(D=Ce.call(D),Ce=0;!(P=D.next()).done;)P=P.value,ge=lt+de(P,Ce++),ne+=xe(P,z,F,ge,W);else if(ge==="object"){if(typeof D.then=="function")return xe(Ue(D),z,F,P,W);throw z=String(D),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return ne}function H(D,z,F){if(D==null)return D;var P=[],W=0;return xe(D,P,"","",function(ge){return z.call(F,ge,W++)}),P}function K(D){if(D._status===-1){var z=D._result;z=z(),z.then(function(F){(D._status===0||D._status===-1)&&(D._status=1,D._result=F)},function(F){(D._status===0||D._status===-1)&&(D._status=2,D._result=F)}),D._status===-1&&(D._status=0,D._result=z)}if(D._status===1)return D._result.default;throw D._result}var re=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)};function V(){}return we.Children={map:H,forEach:function(D,z,F){H(D,function(){z.apply(this,arguments)},F)},count:function(D){var z=0;return H(D,function(){z++}),z},toArray:function(D){return H(D,function(z){return z})||[]},only:function(D){if(!fe(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},we.Component=T,we.Fragment=t,we.Profiler=a,we.PureComponent=$,we.StrictMode=n,we.Suspense=h,we.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,we.__COMPILER_RUNTIME={__proto__:null,c:function(D){return A.H.useMemoCache(D)}},we.cache=function(D){return function(){return D.apply(null,arguments)}},we.cloneElement=function(D,z,F){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var P=E({},D.props),W=D.key,ge=void 0;if(z!=null)for(ne in z.ref!==void 0&&(ge=void 0),z.key!==void 0&&(W=""+z.key),z)!Y.call(z,ne)||ne==="key"||ne==="__self"||ne==="__source"||ne==="ref"&&z.ref===void 0||(P[ne]=z[ne]);var ne=arguments.length-2;if(ne===1)P.children=F;else if(1<ne){for(var lt=Array(ne),Ce=0;Ce<ne;Ce++)lt[Ce]=arguments[Ce+2];P.children=lt}return Z(D.type,W,void 0,void 0,ge,P)},we.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:o,_context:D},D},we.createElement=function(D,z,F){var P,W={},ge=null;if(z!=null)for(P in z.key!==void 0&&(ge=""+z.key),z)Y.call(z,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(W[P]=z[P]);var ne=arguments.length-2;if(ne===1)W.children=F;else if(1<ne){for(var lt=Array(ne),Ce=0;Ce<ne;Ce++)lt[Ce]=arguments[Ce+2];W.children=lt}if(D&&D.defaultProps)for(P in ne=D.defaultProps,ne)W[P]===void 0&&(W[P]=ne[P]);return Z(D,ge,void 0,void 0,null,W)},we.createRef=function(){return{current:null}},we.forwardRef=function(D){return{$$typeof:d,render:D}},we.isValidElement=fe,we.lazy=function(D){return{$$typeof:p,_payload:{_status:-1,_result:D},_init:K}},we.memo=function(D,z){return{$$typeof:g,type:D,compare:z===void 0?null:z}},we.startTransition=function(D){var z=A.T,F={};A.T=F;try{var P=D(),W=A.S;W!==null&&W(F,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(V,re)}catch(ge){re(ge)}finally{A.T=z}},we.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},we.use=function(D){return A.H.use(D)},we.useActionState=function(D,z,F){return A.H.useActionState(D,z,F)},we.useCallback=function(D,z){return A.H.useCallback(D,z)},we.useContext=function(D){return A.H.useContext(D)},we.useDebugValue=function(){},we.useDeferredValue=function(D,z){return A.H.useDeferredValue(D,z)},we.useEffect=function(D,z,F){var P=A.H;if(typeof F=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return P.useEffect(D,z)},we.useId=function(){return A.H.useId()},we.useImperativeHandle=function(D,z,F){return A.H.useImperativeHandle(D,z,F)},we.useInsertionEffect=function(D,z){return A.H.useInsertionEffect(D,z)},we.useLayoutEffect=function(D,z){return A.H.useLayoutEffect(D,z)},we.useMemo=function(D,z){return A.H.useMemo(D,z)},we.useOptimistic=function(D,z){return A.H.useOptimistic(D,z)},we.useReducer=function(D,z,F){return A.H.useReducer(D,z,F)},we.useRef=function(D){return A.H.useRef(D)},we.useState=function(D){return A.H.useState(D)},we.useSyncExternalStore=function(D,z,F){return A.H.useSyncExternalStore(D,z,F)},we.useTransition=function(){return A.H.useTransition()},we.version="19.1.1",we}var sb;function Sv(){return sb||(sb=1,Eg.exports=ZT()),Eg.exports}var C=Sv();const ft=wv(C),WT=QT({__proto__:null,default:ft},[C]);var xg={exports:{}},Al={},Cg={exports:{}},Tg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rb;function eD(){return rb||(rb=1,(function(s){function e(H,K){var re=H.length;H.push(K);e:for(;0<re;){var V=re-1>>>1,D=H[V];if(0<a(D,K))H[V]=K,H[re]=D,re=V;else break e}}function t(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var K=H[0],re=H.pop();if(re!==K){H[0]=re;e:for(var V=0,D=H.length,z=D>>>1;V<z;){var F=2*(V+1)-1,P=H[F],W=F+1,ge=H[W];if(0>a(P,re))W<D&&0>a(ge,P)?(H[V]=ge,H[W]=re,V=W):(H[V]=P,H[F]=re,V=F);else if(W<D&&0>a(ge,re))H[V]=ge,H[W]=re,V=W;else break e}}return K}function a(H,K){var re=H.sortIndex-K.sortIndex;return re!==0?re:H.id-K.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var c=Date,d=c.now();s.unstable_now=function(){return c.now()-d}}var h=[],g=[],p=1,m=null,y=3,_=!1,E=!1,S=!1,T=!1,O=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function U(H){for(var K=t(g);K!==null;){if(K.callback===null)n(g);else if(K.startTime<=H)n(g),K.sortIndex=K.expirationTime,e(h,K);else break;K=t(g)}}function A(H){if(S=!1,U(H),!E)if(t(h)!==null)E=!0,Y||(Y=!0,de());else{var K=t(g);K!==null&&xe(A,K.startTime-H)}}var Y=!1,Z=-1,J=5,fe=-1;function ee(){return T?!0:!(s.unstable_now()-fe<J)}function ce(){if(T=!1,Y){var H=s.unstable_now();fe=H;var K=!0;try{e:{E=!1,S&&(S=!1,$(Z),Z=-1),_=!0;var re=y;try{t:{for(U(H),m=t(h);m!==null&&!(m.expirationTime>H&&ee());){var V=m.callback;if(typeof V=="function"){m.callback=null,y=m.priorityLevel;var D=V(m.expirationTime<=H);if(H=s.unstable_now(),typeof D=="function"){m.callback=D,U(H),K=!0;break t}m===t(h)&&n(h),U(H)}else n(h);m=t(h)}if(m!==null)K=!0;else{var z=t(g);z!==null&&xe(A,z.startTime-H),K=!1}}break e}finally{m=null,y=re,_=!1}K=void 0}}finally{K?de():Y=!1}}}var de;if(typeof L=="function")de=function(){L(ce)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,Ue=Se.port2;Se.port1.onmessage=ce,de=function(){Ue.postMessage(null)}}else de=function(){O(ce,0)};function xe(H,K){Z=O(function(){H(s.unstable_now())},K)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(H){H.callback=null},s.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<H?Math.floor(1e3/H):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_next=function(H){switch(y){case 1:case 2:case 3:var K=3;break;default:K=y}var re=y;y=K;try{return H()}finally{y=re}},s.unstable_requestPaint=function(){T=!0},s.unstable_runWithPriority=function(H,K){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var re=y;y=H;try{return K()}finally{y=re}},s.unstable_scheduleCallback=function(H,K,re){var V=s.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?V+re:V):re=V,H){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=re+D,H={id:p++,callback:K,priorityLevel:H,startTime:re,expirationTime:D,sortIndex:-1},re>V?(H.sortIndex=re,e(g,H),t(h)===null&&H===t(g)&&(S?($(Z),Z=-1):S=!0,xe(A,re-V))):(H.sortIndex=D,e(h,H),E||_||(E=!0,Y||(Y=!0,de()))),H},s.unstable_shouldYield=ee,s.unstable_wrapCallback=function(H){var K=y;return function(){var re=y;y=K;try{return H.apply(this,arguments)}finally{y=re}}}})(Tg)),Tg}var ab;function tD(){return ab||(ab=1,Cg.exports=eD()),Cg.exports}var Dg={exports:{}},an={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ob;function nD(){if(ob)return an;ob=1;var s=Sv();function e(h){var g="https://react.dev/errors/"+h;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)g+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,g,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:m==null?null:""+m,children:h,containerInfo:g,implementation:p}}var c=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(h,g){if(h==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return an.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,an.createPortal=function(h,g){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return o(h,g,null,p)},an.flushSync=function(h){var g=c.T,p=n.p;try{if(c.T=null,n.p=2,h)return h()}finally{c.T=g,n.p=p,n.d.f()}},an.preconnect=function(h,g){typeof h=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,n.d.C(h,g))},an.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},an.preinit=function(h,g){if(typeof h=="string"&&g&&typeof g.as=="string"){var p=g.as,m=d(p,g.crossOrigin),y=typeof g.integrity=="string"?g.integrity:void 0,_=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;p==="style"?n.d.S(h,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:m,integrity:y,fetchPriority:_}):p==="script"&&n.d.X(h,{crossOrigin:m,integrity:y,fetchPriority:_,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},an.preinitModule=function(h,g){if(typeof h=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var p=d(g.as,g.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&n.d.M(h)},an.preload=function(h,g){if(typeof h=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var p=g.as,m=d(p,g.crossOrigin);n.d.L(h,p,{crossOrigin:m,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},an.preloadModule=function(h,g){if(typeof h=="string")if(g){var p=d(g.as,g.crossOrigin);n.d.m(h,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:p,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else n.d.m(h)},an.requestFormReset=function(h){n.d.r(h)},an.unstable_batchedUpdates=function(h,g){return h(g)},an.useFormState=function(h,g,p){return c.H.useFormState(h,g,p)},an.useFormStatus=function(){return c.H.useHostTransitionStatus()},an.version="19.1.1",an}var lb;function LS(){if(lb)return Dg.exports;lb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Dg.exports=nD(),Dg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cb;function iD(){if(cb)return Al;cb=1;var s=tD(),e=Sv(),t=LS();function n(i){var r="https://react.dev/errors/"+i;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var r=i,l=i;if(i.alternate)for(;r.return;)r=r.return;else{i=r;do r=i,(r.flags&4098)!==0&&(l=r.return),i=r.return;while(i)}return r.tag===3?l:null}function c(i){if(i.tag===13){var r=i.memoizedState;if(r===null&&(i=i.alternate,i!==null&&(r=i.memoizedState)),r!==null)return r.dehydrated}return null}function d(i){if(o(i)!==i)throw Error(n(188))}function h(i){var r=i.alternate;if(!r){if(r=o(i),r===null)throw Error(n(188));return r!==i?null:i}for(var l=i,u=r;;){var f=l.return;if(f===null)break;var v=f.alternate;if(v===null){if(u=f.return,u!==null){l=u;continue}break}if(f.child===v.child){for(v=f.child;v;){if(v===l)return d(f),i;if(v===u)return d(f),r;v=v.sibling}throw Error(n(188))}if(l.return!==u.return)l=f,u=v;else{for(var b=!1,x=f.child;x;){if(x===l){b=!0,l=f,u=v;break}if(x===u){b=!0,u=f,l=v;break}x=x.sibling}if(!b){for(x=v.child;x;){if(x===l){b=!0,l=v,u=f;break}if(x===u){b=!0,u=v,l=f;break}x=x.sibling}if(!b)throw Error(n(189))}}if(l.alternate!==u)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?i:r}function g(i){var r=i.tag;if(r===5||r===26||r===27||r===6)return i;for(i=i.child;i!==null;){if(r=g(i),r!==null)return r;i=i.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),$=Symbol.for("react.consumer"),L=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),fe=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),ce=Symbol.iterator;function de(i){return i===null||typeof i!="object"?null:(i=ce&&i[ce]||i["@@iterator"],typeof i=="function"?i:null)}var Se=Symbol.for("react.client.reference");function Ue(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Se?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case E:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case A:return"Suspense";case Y:return"SuspenseList";case fe:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case _:return"Portal";case L:return(i.displayName||"Context")+".Provider";case $:return(i._context.displayName||"Context")+".Consumer";case U:var r=i.render;return i=i.displayName,i||(i=r.displayName||r.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Z:return r=i.displayName||null,r!==null?r:Ue(i.type)||"Memo";case J:r=i._payload,i=i._init;try{return Ue(i(r))}catch{}}return null}var xe=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},V=[],D=-1;function z(i){return{current:i}}function F(i){0>D||(i.current=V[D],V[D]=null,D--)}function P(i,r){D++,V[D]=i.current,i.current=r}var W=z(null),ge=z(null),ne=z(null),lt=z(null);function Ce(i,r){switch(P(ne,r),P(ge,i),P(W,null),r.nodeType){case 9:case 11:i=(i=r.documentElement)&&(i=i.namespaceURI)?A0(i):0;break;default:if(i=r.tagName,r=r.namespaceURI)r=A0(r),i=R0(r,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}F(W),P(W,i)}function ct(){F(W),F(ge),F(ne)}function _e(i){i.memoizedState!==null&&P(lt,i);var r=W.current,l=R0(r,i.type);r!==l&&(P(ge,i),P(W,l))}function fn(i){ge.current===i&&(F(W),F(ge)),lt.current===i&&(F(lt),El._currentValue=re)}var xt=Object.prototype.hasOwnProperty,nn=s.unstable_scheduleCallback,Mt=s.unstable_cancelCallback,xn=s.unstable_shouldYield,Cn=s.unstable_requestPaint,Ct=s.unstable_now,Qr=s.unstable_getCurrentPriorityLevel,ds=s.unstable_ImmediatePriority,Tn=s.unstable_UserBlockingPriority,ii=s.unstable_NormalPriority,Oi=s.unstable_LowPriority,hs=s.unstable_IdlePriority,Xr=s.log,No=s.unstable_setDisableYieldValue,gn=null,Qe=null;function Tt(i){if(typeof Xr=="function"&&No(i),Qe&&typeof Qe.setStrictMode=="function")try{Qe.setStrictMode(gn,i)}catch{}}var ut=Math.clz32?Math.clz32:Jr,Kr=Math.log,zn=Math.LN2;function Jr(i){return i>>>=0,i===0?32:31-(Kr(i)/zn|0)|0}var fs=256,gs=4194304;function Dn(i){var r=i&42;if(r!==0)return r;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Li(i,r,l){var u=i.pendingLanes;if(u===0)return 0;var f=0,v=i.suspendedLanes,b=i.pingedLanes;i=i.warmLanes;var x=u&134217727;return x!==0?(u=x&~v,u!==0?f=Dn(u):(b&=x,b!==0?f=Dn(b):l||(l=x&~i,l!==0&&(f=Dn(l))))):(x=u&~v,x!==0?f=Dn(x):b!==0?f=Dn(b):l||(l=u&~i,l!==0&&(f=Dn(l)))),f===0?0:r!==0&&r!==f&&(r&v)===0&&(v=f&-f,l=r&-r,v>=l||v===32&&(l&4194048)!==0)?r:f}function ji(i,r){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&r)===0}function Zr(i,r){switch(i){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wr(){var i=fs;return fs<<=1,(fs&4194048)===0&&(fs=256),i}function ea(){var i=gs;return gs<<=1,(gs&62914560)===0&&(gs=4194304),i}function ar(i){for(var r=[],l=0;31>l;l++)r.push(i);return r}function st(i,r){i.pendingLanes|=r,r!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Qt(i,r,l,u,f,v){var b=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var x=i.entanglements,k=i.expirationTimes,M=i.hiddenUpdates;for(l=b&~l;0<l;){var G=31-ut(l),X=1<<G;x[G]=0,k[G]=-1;var I=M[G];if(I!==null)for(M[G]=null,G=0;G<I.length;G++){var B=I[G];B!==null&&(B.lane&=-536870913)}l&=~X}u!==0&&Ut(i,u,0),v!==0&&f===0&&i.tag!==0&&(i.suspendedLanes|=v&~(b&~r))}function Ut(i,r,l){i.pendingLanes|=r,i.suspendedLanes&=~r;var u=31-ut(r);i.entangledLanes|=r,i.entanglements[u]=i.entanglements[u]|1073741824|l&4194090}function kn(i,r){var l=i.entangledLanes|=r;for(i=i.entanglements;l;){var u=31-ut(l),f=1<<u;f&r|i[u]&r&&(i[u]|=r),l&=~f}}function $t(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function se(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function _t(){var i=K.p;return i!==0?i:(i=window.event,i===void 0?32:X0(i.type))}function It(i,r){var l=K.p;try{return K.p=i,r()}finally{K.p=l}}var ze=Math.random().toString(36).slice(2),Ie="__reactFiber$"+ze,et="__reactProps$"+ze,sn="__reactContainer$"+ze,Ni="__reactEvents$"+ze,or="__reactListeners$"+ze,fi="__reactHandles$"+ze,ps="__reactResources$"+ze,Mi="__reactMarker$"+ze;function gh(i){delete i[Ie],delete i[et],delete i[Ni],delete i[or],delete i[fi]}function ta(i){var r=i[Ie];if(r)return r;for(var l=i.parentNode;l;){if(r=l[sn]||l[Ie]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(i=N0(i);i!==null;){if(l=i[Ie])return l;i=N0(i)}return r}i=l,l=i.parentNode}return null}function na(i){if(i=i[Ie]||i[sn]){var r=i.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return i}return null}function Mo(i){var r=i.tag;if(r===5||r===26||r===27||r===6)return i.stateNode;throw Error(n(33))}function ia(i){var r=i[ps];return r||(r=i[ps]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Bt(i){i[Mi]=!0}var ym=new Set,_m={};function lr(i,r){sa(i,r),sa(i+"Capture",r)}function sa(i,r){for(_m[i]=r,i=0;i<r.length;i++)ym.add(r[i])}var z1=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bm={},wm={};function P1(i){return xt.call(wm,i)?!0:xt.call(bm,i)?!1:z1.test(i)?wm[i]=!0:(bm[i]=!0,!1)}function Mc(i,r,l){if(P1(r))if(l===null)i.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){i.removeAttribute(r);return}}i.setAttribute(r,""+l)}}function Uc(i,r,l){if(l===null)i.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(r);return}i.setAttribute(r,""+l)}}function Ui(i,r,l,u){if(u===null)i.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(r,l,""+u)}}var ph,Sm;function ra(i){if(ph===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);ph=r&&r[1]||"",Sm=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ph+i+Sm}var vh=!1;function mh(i,r){if(!i||vh)return"";vh=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var X=function(){throw Error()};if(Object.defineProperty(X.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(X,[])}catch(B){var I=B}Reflect.construct(i,[],X)}else{try{X.call()}catch(B){I=B}i.call(X.prototype)}}else{try{throw Error()}catch(B){I=B}(X=i())&&typeof X.catch=="function"&&X.catch(function(){})}}catch(B){if(B&&I&&typeof B.stack=="string")return[B.stack,I.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=u.DetermineComponentFrameRoot(),b=v[0],x=v[1];if(b&&x){var k=b.split(`
`),M=x.split(`
`);for(f=u=0;u<k.length&&!k[u].includes("DetermineComponentFrameRoot");)u++;for(;f<M.length&&!M[f].includes("DetermineComponentFrameRoot");)f++;if(u===k.length||f===M.length)for(u=k.length-1,f=M.length-1;1<=u&&0<=f&&k[u]!==M[f];)f--;for(;1<=u&&0<=f;u--,f--)if(k[u]!==M[f]){if(u!==1||f!==1)do if(u--,f--,0>f||k[u]!==M[f]){var G=`
`+k[u].replace(" at new "," at ");return i.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",i.displayName)),G}while(1<=u&&0<=f);break}}}finally{vh=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?ra(l):""}function q1(i){switch(i.tag){case 26:case 27:case 5:return ra(i.type);case 16:return ra("Lazy");case 13:return ra("Suspense");case 19:return ra("SuspenseList");case 0:case 15:return mh(i.type,!1);case 11:return mh(i.type.render,!1);case 1:return mh(i.type,!0);case 31:return ra("Activity");default:return""}}function Em(i){try{var r="";do r+=q1(i),i=i.return;while(i);return r}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Pn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function xm(i){var r=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function H1(i){var r=xm(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,r),u=""+i[r];if(!i.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var f=l.get,v=l.set;return Object.defineProperty(i,r,{configurable:!0,get:function(){return f.call(this)},set:function(b){u=""+b,v.call(this,b)}}),Object.defineProperty(i,r,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(b){u=""+b},stopTracking:function(){i._valueTracker=null,delete i[r]}}}}function $c(i){i._valueTracker||(i._valueTracker=H1(i))}function Cm(i){if(!i)return!1;var r=i._valueTracker;if(!r)return!0;var l=r.getValue(),u="";return i&&(u=xm(i)?i.checked?"true":"false":i.value),i=u,i!==l?(r.setValue(i),!0):!1}function Ic(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var F1=/[\n"\\]/g;function qn(i){return i.replace(F1,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function yh(i,r,l,u,f,v,b,x){i.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?i.type=b:i.removeAttribute("type"),r!=null?b==="number"?(r===0&&i.value===""||i.value!=r)&&(i.value=""+Pn(r)):i.value!==""+Pn(r)&&(i.value=""+Pn(r)):b!=="submit"&&b!=="reset"||i.removeAttribute("value"),r!=null?_h(i,b,Pn(r)):l!=null?_h(i,b,Pn(l)):u!=null&&i.removeAttribute("value"),f==null&&v!=null&&(i.defaultChecked=!!v),f!=null&&(i.checked=f&&typeof f!="function"&&typeof f!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?i.name=""+Pn(x):i.removeAttribute("name")}function Tm(i,r,l,u,f,v,b,x){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(i.type=v),r!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||r!=null))return;l=l!=null?""+Pn(l):"",r=r!=null?""+Pn(r):l,x||r===i.value||(i.value=r),i.defaultValue=r}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,i.checked=x?i.checked:!!u,i.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.name=b)}function _h(i,r,l){r==="number"&&Ic(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function aa(i,r,l,u){if(i=i.options,r){r={};for(var f=0;f<l.length;f++)r["$"+l[f]]=!0;for(l=0;l<i.length;l++)f=r.hasOwnProperty("$"+i[l].value),i[l].selected!==f&&(i[l].selected=f),f&&u&&(i[l].defaultSelected=!0)}else{for(l=""+Pn(l),r=null,f=0;f<i.length;f++){if(i[f].value===l){i[f].selected=!0,u&&(i[f].defaultSelected=!0);return}r!==null||i[f].disabled||(r=i[f])}r!==null&&(r.selected=!0)}}function Dm(i,r,l){if(r!=null&&(r=""+Pn(r),r!==i.value&&(i.value=r),l==null)){i.defaultValue!==r&&(i.defaultValue=r);return}i.defaultValue=l!=null?""+Pn(l):""}function km(i,r,l,u){if(r==null){if(u!=null){if(l!=null)throw Error(n(92));if(xe(u)){if(1<u.length)throw Error(n(93));u=u[0]}l=u}l==null&&(l=""),r=l}l=Pn(r),i.defaultValue=l,u=i.textContent,u===l&&u!==""&&u!==null&&(i.value=u)}function oa(i,r){if(r){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=r;return}}i.textContent=r}var Y1=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Am(i,r,l){var u=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?i.setProperty(r,""):r==="float"?i.cssFloat="":i[r]="":u?i.setProperty(r,l):typeof l!="number"||l===0||Y1.has(r)?r==="float"?i.cssFloat=l:i[r]=(""+l).trim():i[r]=l+"px"}function Rm(i,r,l){if(r!=null&&typeof r!="object")throw Error(n(62));if(i=i.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="");for(var f in r)u=r[f],r.hasOwnProperty(f)&&l[f]!==u&&Am(i,f,u)}else for(var v in r)r.hasOwnProperty(v)&&Am(i,v,r[v])}function bh(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var V1=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),G1=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Bc(i){return G1.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var wh=null;function Sh(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var la=null,ca=null;function Om(i){var r=na(i);if(r&&(i=r.stateNode)){var l=i[et]||null;e:switch(i=r.stateNode,r.type){case"input":if(yh(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+qn(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var u=l[r];if(u!==i&&u.form===i.form){var f=u[et]||null;if(!f)throw Error(n(90));yh(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<l.length;r++)u=l[r],u.form===i.form&&Cm(u)}break e;case"textarea":Dm(i,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&aa(i,!!l.multiple,r,!1)}}}var Eh=!1;function Lm(i,r,l){if(Eh)return i(r,l);Eh=!0;try{var u=i(r);return u}finally{if(Eh=!1,(la!==null||ca!==null)&&(xu(),la&&(r=la,i=ca,ca=la=null,Om(r),i)))for(r=0;r<i.length;r++)Om(i[r])}}function Uo(i,r){var l=i.stateNode;if(l===null)return null;var u=l[et]||null;if(u===null)return null;l=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(i=i.type,u=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!u;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(n(231,r,typeof l));return l}var $i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xh=!1;if($i)try{var $o={};Object.defineProperty($o,"passive",{get:function(){xh=!0}}),window.addEventListener("test",$o,$o),window.removeEventListener("test",$o,$o)}catch{xh=!1}var vs=null,Ch=null,zc=null;function jm(){if(zc)return zc;var i,r=Ch,l=r.length,u,f="value"in vs?vs.value:vs.textContent,v=f.length;for(i=0;i<l&&r[i]===f[i];i++);var b=l-i;for(u=1;u<=b&&r[l-u]===f[v-u];u++);return zc=f.slice(i,1<u?1-u:void 0)}function Pc(i){var r=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&r===13&&(i=13)):i=r,i===10&&(i=13),32<=i||i===13?i:0}function qc(){return!0}function Nm(){return!1}function pn(i){function r(l,u,f,v,b){this._reactName=l,this._targetInst=f,this.type=u,this.nativeEvent=v,this.target=b,this.currentTarget=null;for(var x in i)i.hasOwnProperty(x)&&(l=i[x],this[x]=l?l(v):v[x]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?qc:Nm,this.isPropagationStopped=Nm,this}return p(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=qc)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=qc)},persist:function(){},isPersistent:qc}),r}var cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hc=pn(cr),Io=p({},cr,{view:0,detail:0}),Q1=pn(Io),Th,Dh,Bo,Fc=p({},Io,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ah,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Bo&&(Bo&&i.type==="mousemove"?(Th=i.screenX-Bo.screenX,Dh=i.screenY-Bo.screenY):Dh=Th=0,Bo=i),Th)},movementY:function(i){return"movementY"in i?i.movementY:Dh}}),Mm=pn(Fc),X1=p({},Fc,{dataTransfer:0}),K1=pn(X1),J1=p({},Io,{relatedTarget:0}),kh=pn(J1),Z1=p({},cr,{animationName:0,elapsedTime:0,pseudoElement:0}),W1=pn(Z1),eC=p({},cr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),tC=pn(eC),nC=p({},cr,{data:0}),Um=pn(nC),iC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aC(i){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(i):(i=rC[i])?!!r[i]:!1}function Ah(){return aC}var oC=p({},Io,{key:function(i){if(i.key){var r=iC[i.key]||i.key;if(r!=="Unidentified")return r}return i.type==="keypress"?(i=Pc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?sC[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ah,charCode:function(i){return i.type==="keypress"?Pc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Pc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),lC=pn(oC),cC=p({},Fc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$m=pn(cC),uC=p({},Io,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ah}),dC=pn(uC),hC=p({},cr,{propertyName:0,elapsedTime:0,pseudoElement:0}),fC=pn(hC),gC=p({},Fc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),pC=pn(gC),vC=p({},cr,{newState:0,oldState:0}),mC=pn(vC),yC=[9,13,27,32],Rh=$i&&"CompositionEvent"in window,zo=null;$i&&"documentMode"in document&&(zo=document.documentMode);var _C=$i&&"TextEvent"in window&&!zo,Im=$i&&(!Rh||zo&&8<zo&&11>=zo),Bm=" ",zm=!1;function Pm(i,r){switch(i){case"keyup":return yC.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qm(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ua=!1;function bC(i,r){switch(i){case"compositionend":return qm(r);case"keypress":return r.which!==32?null:(zm=!0,Bm);case"textInput":return i=r.data,i===Bm&&zm?null:i;default:return null}}function wC(i,r){if(ua)return i==="compositionend"||!Rh&&Pm(i,r)?(i=jm(),zc=Ch=vs=null,ua=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Im&&r.locale!=="ko"?null:r.data;default:return null}}var SC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hm(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r==="input"?!!SC[i.type]:r==="textarea"}function Fm(i,r,l,u){la?ca?ca.push(u):ca=[u]:la=u,r=Ru(r,"onChange"),0<r.length&&(l=new Hc("onChange","change",null,l,u),i.push({event:l,listeners:r}))}var Po=null,qo=null;function EC(i){x0(i,0)}function Yc(i){var r=Mo(i);if(Cm(r))return i}function Ym(i,r){if(i==="change")return r}var Vm=!1;if($i){var Oh;if($i){var Lh="oninput"in document;if(!Lh){var Gm=document.createElement("div");Gm.setAttribute("oninput","return;"),Lh=typeof Gm.oninput=="function"}Oh=Lh}else Oh=!1;Vm=Oh&&(!document.documentMode||9<document.documentMode)}function Qm(){Po&&(Po.detachEvent("onpropertychange",Xm),qo=Po=null)}function Xm(i){if(i.propertyName==="value"&&Yc(qo)){var r=[];Fm(r,qo,i,Sh(i)),Lm(EC,r)}}function xC(i,r,l){i==="focusin"?(Qm(),Po=r,qo=l,Po.attachEvent("onpropertychange",Xm)):i==="focusout"&&Qm()}function CC(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Yc(qo)}function TC(i,r){if(i==="click")return Yc(r)}function DC(i,r){if(i==="input"||i==="change")return Yc(r)}function kC(i,r){return i===r&&(i!==0||1/i===1/r)||i!==i&&r!==r}var An=typeof Object.is=="function"?Object.is:kC;function Ho(i,r){if(An(i,r))return!0;if(typeof i!="object"||i===null||typeof r!="object"||r===null)return!1;var l=Object.keys(i),u=Object.keys(r);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var f=l[u];if(!xt.call(r,f)||!An(i[f],r[f]))return!1}return!0}function Km(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Jm(i,r){var l=Km(i);i=0;for(var u;l;){if(l.nodeType===3){if(u=i+l.textContent.length,i<=r&&u>=r)return{node:l,offset:r-i};i=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Km(l)}}function Zm(i,r){return i&&r?i===r?!0:i&&i.nodeType===3?!1:r&&r.nodeType===3?Zm(i,r.parentNode):"contains"in i?i.contains(r):i.compareDocumentPosition?!!(i.compareDocumentPosition(r)&16):!1:!1}function Wm(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var r=Ic(i.document);r instanceof i.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)i=r.contentWindow;else break;r=Ic(i.document)}return r}function jh(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r&&(r==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||r==="textarea"||i.contentEditable==="true")}var AC=$i&&"documentMode"in document&&11>=document.documentMode,da=null,Nh=null,Fo=null,Mh=!1;function ey(i,r,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Mh||da==null||da!==Ic(u)||(u=da,"selectionStart"in u&&jh(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Fo&&Ho(Fo,u)||(Fo=u,u=Ru(Nh,"onSelect"),0<u.length&&(r=new Hc("onSelect","select",null,r,l),i.push({event:r,listeners:u}),r.target=da)))}function ur(i,r){var l={};return l[i.toLowerCase()]=r.toLowerCase(),l["Webkit"+i]="webkit"+r,l["Moz"+i]="moz"+r,l}var ha={animationend:ur("Animation","AnimationEnd"),animationiteration:ur("Animation","AnimationIteration"),animationstart:ur("Animation","AnimationStart"),transitionrun:ur("Transition","TransitionRun"),transitionstart:ur("Transition","TransitionStart"),transitioncancel:ur("Transition","TransitionCancel"),transitionend:ur("Transition","TransitionEnd")},Uh={},ty={};$i&&(ty=document.createElement("div").style,"AnimationEvent"in window||(delete ha.animationend.animation,delete ha.animationiteration.animation,delete ha.animationstart.animation),"TransitionEvent"in window||delete ha.transitionend.transition);function dr(i){if(Uh[i])return Uh[i];if(!ha[i])return i;var r=ha[i],l;for(l in r)if(r.hasOwnProperty(l)&&l in ty)return Uh[i]=r[l];return i}var ny=dr("animationend"),iy=dr("animationiteration"),sy=dr("animationstart"),RC=dr("transitionrun"),OC=dr("transitionstart"),LC=dr("transitioncancel"),ry=dr("transitionend"),ay=new Map,$h="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");$h.push("scrollEnd");function si(i,r){ay.set(i,r),lr(r,[i])}var oy=new WeakMap;function Hn(i,r){if(typeof i=="object"&&i!==null){var l=oy.get(i);return l!==void 0?l:(r={value:i,source:r,stack:Em(r)},oy.set(i,r),r)}return{value:i,source:r,stack:Em(r)}}var Fn=[],fa=0,Ih=0;function Vc(){for(var i=fa,r=Ih=fa=0;r<i;){var l=Fn[r];Fn[r++]=null;var u=Fn[r];Fn[r++]=null;var f=Fn[r];Fn[r++]=null;var v=Fn[r];if(Fn[r++]=null,u!==null&&f!==null){var b=u.pending;b===null?f.next=f:(f.next=b.next,b.next=f),u.pending=f}v!==0&&ly(l,f,v)}}function Gc(i,r,l,u){Fn[fa++]=i,Fn[fa++]=r,Fn[fa++]=l,Fn[fa++]=u,Ih|=u,i.lanes|=u,i=i.alternate,i!==null&&(i.lanes|=u)}function Bh(i,r,l,u){return Gc(i,r,l,u),Qc(i)}function ga(i,r){return Gc(i,null,null,r),Qc(i)}function ly(i,r,l){i.lanes|=l;var u=i.alternate;u!==null&&(u.lanes|=l);for(var f=!1,v=i.return;v!==null;)v.childLanes|=l,u=v.alternate,u!==null&&(u.childLanes|=l),v.tag===22&&(i=v.stateNode,i===null||i._visibility&1||(f=!0)),i=v,v=v.return;return i.tag===3?(v=i.stateNode,f&&r!==null&&(f=31-ut(l),i=v.hiddenUpdates,u=i[f],u===null?i[f]=[r]:u.push(r),r.lane=l|536870912),v):null}function Qc(i){if(50<pl)throw pl=0,Vf=null,Error(n(185));for(var r=i.return;r!==null;)i=r,r=i.return;return i.tag===3?i.stateNode:null}var pa={};function jC(i,r,l,u){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(i,r,l,u){return new jC(i,r,l,u)}function zh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ii(i,r){var l=i.alternate;return l===null?(l=Rn(i.tag,r,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=r,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,r=i.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function cy(i,r){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=r,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,r=l.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),i}function Xc(i,r,l,u,f,v){var b=0;if(u=i,typeof i=="function")zh(i)&&(b=1);else if(typeof i=="string")b=MT(i,l,W.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case fe:return i=Rn(31,l,r,f),i.elementType=fe,i.lanes=v,i;case E:return hr(l.children,f,v,r);case S:b=8,f|=24;break;case T:return i=Rn(12,l,r,f|2),i.elementType=T,i.lanes=v,i;case A:return i=Rn(13,l,r,f),i.elementType=A,i.lanes=v,i;case Y:return i=Rn(19,l,r,f),i.elementType=Y,i.lanes=v,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case O:case L:b=10;break e;case $:b=9;break e;case U:b=11;break e;case Z:b=14;break e;case J:b=16,u=null;break e}b=29,l=Error(n(130,i===null?"null":typeof i,"")),u=null}return r=Rn(b,l,r,f),r.elementType=i,r.type=u,r.lanes=v,r}function hr(i,r,l,u){return i=Rn(7,i,u,r),i.lanes=l,i}function Ph(i,r,l){return i=Rn(6,i,null,r),i.lanes=l,i}function qh(i,r,l){return r=Rn(4,i.children!==null?i.children:[],i.key,r),r.lanes=l,r.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},r}var va=[],ma=0,Kc=null,Jc=0,Yn=[],Vn=0,fr=null,Bi=1,zi="";function gr(i,r){va[ma++]=Jc,va[ma++]=Kc,Kc=i,Jc=r}function uy(i,r,l){Yn[Vn++]=Bi,Yn[Vn++]=zi,Yn[Vn++]=fr,fr=i;var u=Bi;i=zi;var f=32-ut(u)-1;u&=~(1<<f),l+=1;var v=32-ut(r)+f;if(30<v){var b=f-f%5;v=(u&(1<<b)-1).toString(32),u>>=b,f-=b,Bi=1<<32-ut(r)+f|l<<f|u,zi=v+i}else Bi=1<<v|l<<f|u,zi=i}function Hh(i){i.return!==null&&(gr(i,1),uy(i,1,0))}function Fh(i){for(;i===Kc;)Kc=va[--ma],va[ma]=null,Jc=va[--ma],va[ma]=null;for(;i===fr;)fr=Yn[--Vn],Yn[Vn]=null,zi=Yn[--Vn],Yn[Vn]=null,Bi=Yn[--Vn],Yn[Vn]=null}var un=null,dt=null,Pe=!1,pr=null,gi=!1,Yh=Error(n(519));function vr(i){var r=Error(n(418,""));throw Go(Hn(r,i)),Yh}function dy(i){var r=i.stateNode,l=i.type,u=i.memoizedProps;switch(r[Ie]=i,r[et]=u,l){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(l=0;l<ml.length;l++)Ae(ml[l],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":Ae("invalid",r),Tm(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),$c(r);break;case"select":Ae("invalid",r);break;case"textarea":Ae("invalid",r),km(r,u.value,u.defaultValue,u.children),$c(r)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||u.suppressHydrationWarning===!0||k0(r.textContent,l)?(u.popover!=null&&(Ae("beforetoggle",r),Ae("toggle",r)),u.onScroll!=null&&Ae("scroll",r),u.onScrollEnd!=null&&Ae("scrollend",r),u.onClick!=null&&(r.onclick=Ou),r=!0):r=!1,r||vr(i)}function hy(i){for(un=i.return;un;)switch(un.tag){case 5:case 13:gi=!1;return;case 27:case 3:gi=!0;return;default:un=un.return}}function Yo(i){if(i!==un)return!1;if(!Pe)return hy(i),Pe=!0,!1;var r=i.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||lg(i.type,i.memoizedProps)),l=!l),l&&dt&&vr(i),hy(i),r===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,r=0;i;){if(i.nodeType===8)if(l=i.data,l==="/$"){if(r===0){dt=ai(i.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++;i=i.nextSibling}dt=null}}else r===27?(r=dt,Ls(i.type)?(i=hg,hg=null,dt=i):dt=r):dt=un?ai(i.stateNode.nextSibling):null;return!0}function Vo(){dt=un=null,Pe=!1}function fy(){var i=pr;return i!==null&&(yn===null?yn=i:yn.push.apply(yn,i),pr=null),i}function Go(i){pr===null?pr=[i]:pr.push(i)}var Vh=z(null),mr=null,Pi=null;function ms(i,r,l){P(Vh,r._currentValue),r._currentValue=l}function qi(i){i._currentValue=Vh.current,F(Vh)}function Gh(i,r,l){for(;i!==null;){var u=i.alternate;if((i.childLanes&r)!==r?(i.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),i===l)break;i=i.return}}function Qh(i,r,l,u){var f=i.child;for(f!==null&&(f.return=i);f!==null;){var v=f.dependencies;if(v!==null){var b=f.child;v=v.firstContext;e:for(;v!==null;){var x=v;v=f;for(var k=0;k<r.length;k++)if(x.context===r[k]){v.lanes|=l,x=v.alternate,x!==null&&(x.lanes|=l),Gh(v.return,l,i),u||(b=null);break e}v=x.next}}else if(f.tag===18){if(b=f.return,b===null)throw Error(n(341));b.lanes|=l,v=b.alternate,v!==null&&(v.lanes|=l),Gh(b,l,i),b=null}else b=f.child;if(b!==null)b.return=f;else for(b=f;b!==null;){if(b===i){b=null;break}if(f=b.sibling,f!==null){f.return=b.return,b=f;break}b=b.return}f=b}}function Qo(i,r,l,u){i=null;for(var f=r,v=!1;f!==null;){if(!v){if((f.flags&524288)!==0)v=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var b=f.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var x=f.type;An(f.pendingProps.value,b.value)||(i!==null?i.push(x):i=[x])}}else if(f===lt.current){if(b=f.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(i!==null?i.push(El):i=[El])}f=f.return}i!==null&&Qh(r,i,l,u),r.flags|=262144}function Zc(i){for(i=i.firstContext;i!==null;){if(!An(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function yr(i){mr=i,Pi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function rn(i){return gy(mr,i)}function Wc(i,r){return mr===null&&yr(i),gy(i,r)}function gy(i,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},Pi===null){if(i===null)throw Error(n(308));Pi=r,i.dependencies={lanes:0,firstContext:r},i.flags|=524288}else Pi=Pi.next=r;return l}var NC=typeof AbortController<"u"?AbortController:function(){var i=[],r=this.signal={aborted:!1,addEventListener:function(l,u){i.push(u)}};this.abort=function(){r.aborted=!0,i.forEach(function(l){return l()})}},MC=s.unstable_scheduleCallback,UC=s.unstable_NormalPriority,Dt={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xh(){return{controller:new NC,data:new Map,refCount:0}}function Xo(i){i.refCount--,i.refCount===0&&MC(UC,function(){i.controller.abort()})}var Ko=null,Kh=0,ya=0,_a=null;function $C(i,r){if(Ko===null){var l=Ko=[];Kh=0,ya=Wf(),_a={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Kh++,r.then(py,py),r}function py(){if(--Kh===0&&Ko!==null){_a!==null&&(_a.status="fulfilled");var i=Ko;Ko=null,ya=0,_a=null;for(var r=0;r<i.length;r++)(0,i[r])()}}function IC(i,r){var l=[],u={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return i.then(function(){u.status="fulfilled",u.value=r;for(var f=0;f<l.length;f++)(0,l[f])(r)},function(f){for(u.status="rejected",u.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),u}var vy=H.S;H.S=function(i,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&$C(i,r),vy!==null&&vy(i,r)};var _r=z(null);function Jh(){var i=_r.current;return i!==null?i:Ke.pooledCache}function eu(i,r){r===null?P(_r,_r.current):P(_r,r.pool)}function my(){var i=Jh();return i===null?null:{parent:Dt._currentValue,pool:i}}var Jo=Error(n(460)),yy=Error(n(474)),tu=Error(n(542)),Zh={then:function(){}};function _y(i){return i=i.status,i==="fulfilled"||i==="rejected"}function nu(){}function by(i,r,l){switch(l=i[l],l===void 0?i.push(r):l!==r&&(r.then(nu,nu),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw i=r.reason,Sy(i),i;default:if(typeof r.status=="string")r.then(nu,nu);else{if(i=Ke,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=r,i.status="pending",i.then(function(u){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=u}},function(u){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw i=r.reason,Sy(i),i}throw Zo=r,Jo}}var Zo=null;function wy(){if(Zo===null)throw Error(n(459));var i=Zo;return Zo=null,i}function Sy(i){if(i===Jo||i===tu)throw Error(n(483))}var ys=!1;function Wh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ef(i,r){i=i.updateQueue,r.updateQueue===i&&(r.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function _s(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function bs(i,r,l){var u=i.updateQueue;if(u===null)return null;if(u=u.shared,(qe&2)!==0){var f=u.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),u.pending=r,r=Qc(i),ly(i,null,l),r}return Gc(i,u,r,l),Qc(i)}function Wo(i,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var u=r.lanes;u&=i.pendingLanes,l|=u,r.lanes=l,kn(i,l)}}function tf(i,r){var l=i.updateQueue,u=i.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var f=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var b={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?f=v=b:v=v.next=b,l=l.next}while(l!==null);v===null?f=v=r:v=v.next=r}else f=v=r;l={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:v,shared:u.shared,callbacks:u.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=r:i.next=r,l.lastBaseUpdate=r}var nf=!1;function el(){if(nf){var i=_a;if(i!==null)throw i}}function tl(i,r,l,u){nf=!1;var f=i.updateQueue;ys=!1;var v=f.firstBaseUpdate,b=f.lastBaseUpdate,x=f.shared.pending;if(x!==null){f.shared.pending=null;var k=x,M=k.next;k.next=null,b===null?v=M:b.next=M,b=k;var G=i.alternate;G!==null&&(G=G.updateQueue,x=G.lastBaseUpdate,x!==b&&(x===null?G.firstBaseUpdate=M:x.next=M,G.lastBaseUpdate=k))}if(v!==null){var X=f.baseState;b=0,G=M=k=null,x=v;do{var I=x.lane&-536870913,B=I!==x.lane;if(B?(Me&I)===I:(u&I)===I){I!==0&&I===ya&&(nf=!0),G!==null&&(G=G.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var ve=i,he=x;I=r;var Ve=l;switch(he.tag){case 1:if(ve=he.payload,typeof ve=="function"){X=ve.call(Ve,X,I);break e}X=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=he.payload,I=typeof ve=="function"?ve.call(Ve,X,I):ve,I==null)break e;X=p({},X,I);break e;case 2:ys=!0}}I=x.callback,I!==null&&(i.flags|=64,B&&(i.flags|=8192),B=f.callbacks,B===null?f.callbacks=[I]:B.push(I))}else B={lane:I,tag:x.tag,payload:x.payload,callback:x.callback,next:null},G===null?(M=G=B,k=X):G=G.next=B,b|=I;if(x=x.next,x===null){if(x=f.shared.pending,x===null)break;B=x,x=B.next,B.next=null,f.lastBaseUpdate=B,f.shared.pending=null}}while(!0);G===null&&(k=X),f.baseState=k,f.firstBaseUpdate=M,f.lastBaseUpdate=G,v===null&&(f.shared.lanes=0),ks|=b,i.lanes=b,i.memoizedState=X}}function Ey(i,r){if(typeof i!="function")throw Error(n(191,i));i.call(r)}function xy(i,r){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)Ey(l[i],r)}var ba=z(null),iu=z(0);function Cy(i,r){i=Xi,P(iu,i),P(ba,r),Xi=i|r.baseLanes}function sf(){P(iu,Xi),P(ba,ba.current)}function rf(){Xi=iu.current,F(ba),F(iu)}var ws=0,Ee=null,Fe=null,bt=null,su=!1,wa=!1,br=!1,ru=0,nl=0,Sa=null,BC=0;function pt(){throw Error(n(321))}function af(i,r){if(r===null)return!1;for(var l=0;l<r.length&&l<i.length;l++)if(!An(i[l],r[l]))return!1;return!0}function of(i,r,l,u,f,v){return ws=v,Ee=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,H.H=i===null||i.memoizedState===null?l_:c_,br=!1,v=l(u,f),br=!1,wa&&(v=Dy(r,l,u,f)),Ty(i),v}function Ty(i){H.H=du;var r=Fe!==null&&Fe.next!==null;if(ws=0,bt=Fe=Ee=null,su=!1,nl=0,Sa=null,r)throw Error(n(300));i===null||zt||(i=i.dependencies,i!==null&&Zc(i)&&(zt=!0))}function Dy(i,r,l,u){Ee=i;var f=0;do{if(wa&&(Sa=null),nl=0,wa=!1,25<=f)throw Error(n(301));if(f+=1,bt=Fe=null,i.updateQueue!=null){var v=i.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}H.H=VC,v=r(l,u)}while(wa);return v}function zC(){var i=H.H,r=i.useState()[0];return r=typeof r.then=="function"?il(r):r,i=i.useState()[0],(Fe!==null?Fe.memoizedState:null)!==i&&(Ee.flags|=1024),r}function lf(){var i=ru!==0;return ru=0,i}function cf(i,r,l){r.updateQueue=i.updateQueue,r.flags&=-2053,i.lanes&=~l}function uf(i){if(su){for(i=i.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}su=!1}ws=0,bt=Fe=Ee=null,wa=!1,nl=ru=0,Sa=null}function vn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?Ee.memoizedState=bt=i:bt=bt.next=i,bt}function wt(){if(Fe===null){var i=Ee.alternate;i=i!==null?i.memoizedState:null}else i=Fe.next;var r=bt===null?Ee.memoizedState:bt.next;if(r!==null)bt=r,Fe=i;else{if(i===null)throw Ee.alternate===null?Error(n(467)):Error(n(310));Fe=i,i={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},bt===null?Ee.memoizedState=bt=i:bt=bt.next=i}return bt}function df(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function il(i){var r=nl;return nl+=1,Sa===null&&(Sa=[]),i=by(Sa,i,r),r=Ee,(bt===null?r.memoizedState:bt.next)===null&&(r=r.alternate,H.H=r===null||r.memoizedState===null?l_:c_),i}function au(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return il(i);if(i.$$typeof===L)return rn(i)}throw Error(n(438,String(i)))}function hf(i){var r=null,l=Ee.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var u=Ee.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=df(),Ee.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(i),u=0;u<i;u++)l[u]=ee;return r.index++,l}function Hi(i,r){return typeof r=="function"?r(i):r}function ou(i){var r=wt();return ff(r,Fe,i)}function ff(i,r,l){var u=i.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=l;var f=i.baseQueue,v=u.pending;if(v!==null){if(f!==null){var b=f.next;f.next=v.next,v.next=b}r.baseQueue=f=v,u.pending=null}if(v=i.baseState,f===null)i.memoizedState=v;else{r=f.next;var x=b=null,k=null,M=r,G=!1;do{var X=M.lane&-536870913;if(X!==M.lane?(Me&X)===X:(ws&X)===X){var I=M.revertLane;if(I===0)k!==null&&(k=k.next={lane:0,revertLane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),X===ya&&(G=!0);else if((ws&I)===I){M=M.next,I===ya&&(G=!0);continue}else X={lane:0,revertLane:M.revertLane,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null},k===null?(x=k=X,b=v):k=k.next=X,Ee.lanes|=I,ks|=I;X=M.action,br&&l(v,X),v=M.hasEagerState?M.eagerState:l(v,X)}else I={lane:X,revertLane:M.revertLane,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null},k===null?(x=k=I,b=v):k=k.next=I,Ee.lanes|=X,ks|=X;M=M.next}while(M!==null&&M!==r);if(k===null?b=v:k.next=x,!An(v,i.memoizedState)&&(zt=!0,G&&(l=_a,l!==null)))throw l;i.memoizedState=v,i.baseState=b,i.baseQueue=k,u.lastRenderedState=v}return f===null&&(u.lanes=0),[i.memoizedState,u.dispatch]}function gf(i){var r=wt(),l=r.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=i;var u=l.dispatch,f=l.pending,v=r.memoizedState;if(f!==null){l.pending=null;var b=f=f.next;do v=i(v,b.action),b=b.next;while(b!==f);An(v,r.memoizedState)||(zt=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),l.lastRenderedState=v}return[v,u]}function ky(i,r,l){var u=Ee,f=wt(),v=Pe;if(v){if(l===void 0)throw Error(n(407));l=l()}else l=r();var b=!An((Fe||f).memoizedState,l);b&&(f.memoizedState=l,zt=!0),f=f.queue;var x=Oy.bind(null,u,f,i);if(sl(2048,8,x,[i]),f.getSnapshot!==r||b||bt!==null&&bt.memoizedState.tag&1){if(u.flags|=2048,Ea(9,lu(),Ry.bind(null,u,f,l,r),null),Ke===null)throw Error(n(349));v||(ws&124)!==0||Ay(u,r,l)}return l}function Ay(i,r,l){i.flags|=16384,i={getSnapshot:r,value:l},r=Ee.updateQueue,r===null?(r=df(),Ee.updateQueue=r,r.stores=[i]):(l=r.stores,l===null?r.stores=[i]:l.push(i))}function Ry(i,r,l,u){r.value=l,r.getSnapshot=u,Ly(r)&&jy(i)}function Oy(i,r,l){return l(function(){Ly(r)&&jy(i)})}function Ly(i){var r=i.getSnapshot;i=i.value;try{var l=r();return!An(i,l)}catch{return!0}}function jy(i){var r=ga(i,2);r!==null&&Mn(r,i,2)}function pf(i){var r=vn();if(typeof i=="function"){var l=i;if(i=l(),br){Tt(!0);try{l()}finally{Tt(!1)}}}return r.memoizedState=r.baseState=i,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:i},r}function Ny(i,r,l,u){return i.baseState=l,ff(i,Fe,typeof u=="function"?u:Hi)}function PC(i,r,l,u,f){if(uu(i))throw Error(n(485));if(i=r.action,i!==null){var v={payload:f,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){v.listeners.push(b)}};H.T!==null?l(!0):v.isTransition=!1,u(v),l=r.pending,l===null?(v.next=r.pending=v,My(r,v)):(v.next=l.next,r.pending=l.next=v)}}function My(i,r){var l=r.action,u=r.payload,f=i.state;if(r.isTransition){var v=H.T,b={};H.T=b;try{var x=l(f,u),k=H.S;k!==null&&k(b,x),Uy(i,r,x)}catch(M){vf(i,r,M)}finally{H.T=v}}else try{v=l(f,u),Uy(i,r,v)}catch(M){vf(i,r,M)}}function Uy(i,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){$y(i,r,u)},function(u){return vf(i,r,u)}):$y(i,r,l)}function $y(i,r,l){r.status="fulfilled",r.value=l,Iy(r),i.state=l,r=i.pending,r!==null&&(l=r.next,l===r?i.pending=null:(l=l.next,r.next=l,My(i,l)))}function vf(i,r,l){var u=i.pending;if(i.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=l,Iy(r),r=r.next;while(r!==u)}i.action=null}function Iy(i){i=i.listeners;for(var r=0;r<i.length;r++)(0,i[r])()}function By(i,r){return r}function zy(i,r){if(Pe){var l=Ke.formState;if(l!==null){e:{var u=Ee;if(Pe){if(dt){t:{for(var f=dt,v=gi;f.nodeType!==8;){if(!v){f=null;break t}if(f=ai(f.nextSibling),f===null){f=null;break t}}v=f.data,f=v==="F!"||v==="F"?f:null}if(f){dt=ai(f.nextSibling),u=f.data==="F!";break e}}vr(u)}u=!1}u&&(r=l[0])}}return l=vn(),l.memoizedState=l.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:By,lastRenderedState:r},l.queue=u,l=r_.bind(null,Ee,u),u.dispatch=l,u=pf(!1),v=wf.bind(null,Ee,!1,u.queue),u=vn(),f={state:r,dispatch:null,action:i,pending:null},u.queue=f,l=PC.bind(null,Ee,f,v,l),f.dispatch=l,u.memoizedState=i,[r,l,!1]}function Py(i){var r=wt();return qy(r,Fe,i)}function qy(i,r,l){if(r=ff(i,r,By)[0],i=ou(Hi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=il(r)}catch(b){throw b===Jo?tu:b}else u=r;r=wt();var f=r.queue,v=f.dispatch;return l!==r.memoizedState&&(Ee.flags|=2048,Ea(9,lu(),qC.bind(null,f,l),null)),[u,v,i]}function qC(i,r){i.action=r}function Hy(i){var r=wt(),l=Fe;if(l!==null)return qy(r,l,i);wt(),r=r.memoizedState,l=wt();var u=l.queue.dispatch;return l.memoizedState=i,[r,u,!1]}function Ea(i,r,l,u){return i={tag:i,create:l,deps:u,inst:r,next:null},r=Ee.updateQueue,r===null&&(r=df(),Ee.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=i.next=i:(u=l.next,l.next=i,i.next=u,r.lastEffect=i),i}function lu(){return{destroy:void 0,resource:void 0}}function Fy(){return wt().memoizedState}function cu(i,r,l,u){var f=vn();u=u===void 0?null:u,Ee.flags|=i,f.memoizedState=Ea(1|r,lu(),l,u)}function sl(i,r,l,u){var f=wt();u=u===void 0?null:u;var v=f.memoizedState.inst;Fe!==null&&u!==null&&af(u,Fe.memoizedState.deps)?f.memoizedState=Ea(r,v,l,u):(Ee.flags|=i,f.memoizedState=Ea(1|r,v,l,u))}function Yy(i,r){cu(8390656,8,i,r)}function Vy(i,r){sl(2048,8,i,r)}function Gy(i,r){return sl(4,2,i,r)}function Qy(i,r){return sl(4,4,i,r)}function Xy(i,r){if(typeof r=="function"){i=i();var l=r(i);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return i=i(),r.current=i,function(){r.current=null}}function Ky(i,r,l){l=l!=null?l.concat([i]):null,sl(4,4,Xy.bind(null,r,i),l)}function mf(){}function Jy(i,r){var l=wt();r=r===void 0?null:r;var u=l.memoizedState;return r!==null&&af(r,u[1])?u[0]:(l.memoizedState=[i,r],i)}function Zy(i,r){var l=wt();r=r===void 0?null:r;var u=l.memoizedState;if(r!==null&&af(r,u[1]))return u[0];if(u=i(),br){Tt(!0);try{i()}finally{Tt(!1)}}return l.memoizedState=[u,r],u}function yf(i,r,l){return l===void 0||(ws&1073741824)!==0?i.memoizedState=r:(i.memoizedState=l,i=t0(),Ee.lanes|=i,ks|=i,l)}function Wy(i,r,l,u){return An(l,r)?l:ba.current!==null?(i=yf(i,l,u),An(i,r)||(zt=!0),i):(ws&42)===0?(zt=!0,i.memoizedState=l):(i=t0(),Ee.lanes|=i,ks|=i,r)}function e_(i,r,l,u,f){var v=K.p;K.p=v!==0&&8>v?v:8;var b=H.T,x={};H.T=x,wf(i,!1,r,l);try{var k=f(),M=H.S;if(M!==null&&M(x,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var G=IC(k,u);rl(i,r,G,Nn(i))}else rl(i,r,u,Nn(i))}catch(X){rl(i,r,{then:function(){},status:"rejected",reason:X},Nn())}finally{K.p=v,H.T=b}}function HC(){}function _f(i,r,l,u){if(i.tag!==5)throw Error(n(476));var f=t_(i).queue;e_(i,f,r,re,l===null?HC:function(){return n_(i),l(u)})}function t_(i){var r=i.memoizedState;if(r!==null)return r;r={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:re},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:l},next:null},i.memoizedState=r,i=i.alternate,i!==null&&(i.memoizedState=r),r}function n_(i){var r=t_(i).next.queue;rl(i,r,{},Nn())}function bf(){return rn(El)}function i_(){return wt().memoizedState}function s_(){return wt().memoizedState}function FC(i){for(var r=i.return;r!==null;){switch(r.tag){case 24:case 3:var l=Nn();i=_s(l);var u=bs(r,i,l);u!==null&&(Mn(u,r,l),Wo(u,r,l)),r={cache:Xh()},i.payload=r;return}r=r.return}}function YC(i,r,l){var u=Nn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},uu(i)?a_(r,l):(l=Bh(i,r,l,u),l!==null&&(Mn(l,i,u),o_(l,r,u)))}function r_(i,r,l){var u=Nn();rl(i,r,l,u)}function rl(i,r,l,u){var f={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(uu(i))a_(r,f);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var b=r.lastRenderedState,x=v(b,l);if(f.hasEagerState=!0,f.eagerState=x,An(x,b))return Gc(i,r,f,0),Ke===null&&Vc(),!1}catch{}finally{}if(l=Bh(i,r,f,u),l!==null)return Mn(l,i,u),o_(l,r,u),!0}return!1}function wf(i,r,l,u){if(u={lane:2,revertLane:Wf(),action:u,hasEagerState:!1,eagerState:null,next:null},uu(i)){if(r)throw Error(n(479))}else r=Bh(i,l,u,2),r!==null&&Mn(r,i,2)}function uu(i){var r=i.alternate;return i===Ee||r!==null&&r===Ee}function a_(i,r){wa=su=!0;var l=i.pending;l===null?r.next=r:(r.next=l.next,l.next=r),i.pending=r}function o_(i,r,l){if((l&4194048)!==0){var u=r.lanes;u&=i.pendingLanes,l|=u,r.lanes=l,kn(i,l)}}var du={readContext:rn,use:au,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useLayoutEffect:pt,useInsertionEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useSyncExternalStore:pt,useId:pt,useHostTransitionStatus:pt,useFormState:pt,useActionState:pt,useOptimistic:pt,useMemoCache:pt,useCacheRefresh:pt},l_={readContext:rn,use:au,useCallback:function(i,r){return vn().memoizedState=[i,r===void 0?null:r],i},useContext:rn,useEffect:Yy,useImperativeHandle:function(i,r,l){l=l!=null?l.concat([i]):null,cu(4194308,4,Xy.bind(null,r,i),l)},useLayoutEffect:function(i,r){return cu(4194308,4,i,r)},useInsertionEffect:function(i,r){cu(4,2,i,r)},useMemo:function(i,r){var l=vn();r=r===void 0?null:r;var u=i();if(br){Tt(!0);try{i()}finally{Tt(!1)}}return l.memoizedState=[u,r],u},useReducer:function(i,r,l){var u=vn();if(l!==void 0){var f=l(r);if(br){Tt(!0);try{l(r)}finally{Tt(!1)}}}else f=r;return u.memoizedState=u.baseState=f,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:f},u.queue=i,i=i.dispatch=YC.bind(null,Ee,i),[u.memoizedState,i]},useRef:function(i){var r=vn();return i={current:i},r.memoizedState=i},useState:function(i){i=pf(i);var r=i.queue,l=r_.bind(null,Ee,r);return r.dispatch=l,[i.memoizedState,l]},useDebugValue:mf,useDeferredValue:function(i,r){var l=vn();return yf(l,i,r)},useTransition:function(){var i=pf(!1);return i=e_.bind(null,Ee,i.queue,!0,!1),vn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,r,l){var u=Ee,f=vn();if(Pe){if(l===void 0)throw Error(n(407));l=l()}else{if(l=r(),Ke===null)throw Error(n(349));(Me&124)!==0||Ay(u,r,l)}f.memoizedState=l;var v={value:l,getSnapshot:r};return f.queue=v,Yy(Oy.bind(null,u,v,i),[i]),u.flags|=2048,Ea(9,lu(),Ry.bind(null,u,v,l,r),null),l},useId:function(){var i=vn(),r=Ke.identifierPrefix;if(Pe){var l=zi,u=Bi;l=(u&~(1<<32-ut(u)-1)).toString(32)+l,r=""+r+"R"+l,l=ru++,0<l&&(r+="H"+l.toString(32)),r+=""}else l=BC++,r=""+r+"r"+l.toString(32)+"";return i.memoizedState=r},useHostTransitionStatus:bf,useFormState:zy,useActionState:zy,useOptimistic:function(i){var r=vn();r.memoizedState=r.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=wf.bind(null,Ee,!0,l),l.dispatch=r,[i,r]},useMemoCache:hf,useCacheRefresh:function(){return vn().memoizedState=FC.bind(null,Ee)}},c_={readContext:rn,use:au,useCallback:Jy,useContext:rn,useEffect:Vy,useImperativeHandle:Ky,useInsertionEffect:Gy,useLayoutEffect:Qy,useMemo:Zy,useReducer:ou,useRef:Fy,useState:function(){return ou(Hi)},useDebugValue:mf,useDeferredValue:function(i,r){var l=wt();return Wy(l,Fe.memoizedState,i,r)},useTransition:function(){var i=ou(Hi)[0],r=wt().memoizedState;return[typeof i=="boolean"?i:il(i),r]},useSyncExternalStore:ky,useId:i_,useHostTransitionStatus:bf,useFormState:Py,useActionState:Py,useOptimistic:function(i,r){var l=wt();return Ny(l,Fe,i,r)},useMemoCache:hf,useCacheRefresh:s_},VC={readContext:rn,use:au,useCallback:Jy,useContext:rn,useEffect:Vy,useImperativeHandle:Ky,useInsertionEffect:Gy,useLayoutEffect:Qy,useMemo:Zy,useReducer:gf,useRef:Fy,useState:function(){return gf(Hi)},useDebugValue:mf,useDeferredValue:function(i,r){var l=wt();return Fe===null?yf(l,i,r):Wy(l,Fe.memoizedState,i,r)},useTransition:function(){var i=gf(Hi)[0],r=wt().memoizedState;return[typeof i=="boolean"?i:il(i),r]},useSyncExternalStore:ky,useId:i_,useHostTransitionStatus:bf,useFormState:Hy,useActionState:Hy,useOptimistic:function(i,r){var l=wt();return Fe!==null?Ny(l,Fe,i,r):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:hf,useCacheRefresh:s_},xa=null,al=0;function hu(i){var r=al;return al+=1,xa===null&&(xa=[]),by(xa,i,r)}function ol(i,r){r=r.props.ref,i.ref=r!==void 0?r:null}function fu(i,r){throw r.$$typeof===m?Error(n(525)):(i=Object.prototype.toString.call(r),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":i)))}function u_(i){var r=i._init;return r(i._payload)}function d_(i){function r(j,R){if(i){var N=j.deletions;N===null?(j.deletions=[R],j.flags|=16):N.push(R)}}function l(j,R){if(!i)return null;for(;R!==null;)r(j,R),R=R.sibling;return null}function u(j){for(var R=new Map;j!==null;)j.key!==null?R.set(j.key,j):R.set(j.index,j),j=j.sibling;return R}function f(j,R){return j=Ii(j,R),j.index=0,j.sibling=null,j}function v(j,R,N){return j.index=N,i?(N=j.alternate,N!==null?(N=N.index,N<R?(j.flags|=67108866,R):N):(j.flags|=67108866,R)):(j.flags|=1048576,R)}function b(j){return i&&j.alternate===null&&(j.flags|=67108866),j}function x(j,R,N,Q){return R===null||R.tag!==6?(R=Ph(N,j.mode,Q),R.return=j,R):(R=f(R,N),R.return=j,R)}function k(j,R,N,Q){var le=N.type;return le===E?G(j,R,N.props.children,Q,N.key):R!==null&&(R.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===J&&u_(le)===R.type)?(R=f(R,N.props),ol(R,N),R.return=j,R):(R=Xc(N.type,N.key,N.props,null,j.mode,Q),ol(R,N),R.return=j,R)}function M(j,R,N,Q){return R===null||R.tag!==4||R.stateNode.containerInfo!==N.containerInfo||R.stateNode.implementation!==N.implementation?(R=qh(N,j.mode,Q),R.return=j,R):(R=f(R,N.children||[]),R.return=j,R)}function G(j,R,N,Q,le){return R===null||R.tag!==7?(R=hr(N,j.mode,Q,le),R.return=j,R):(R=f(R,N),R.return=j,R)}function X(j,R,N){if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return R=Ph(""+R,j.mode,N),R.return=j,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case y:return N=Xc(R.type,R.key,R.props,null,j.mode,N),ol(N,R),N.return=j,N;case _:return R=qh(R,j.mode,N),R.return=j,R;case J:var Q=R._init;return R=Q(R._payload),X(j,R,N)}if(xe(R)||de(R))return R=hr(R,j.mode,N,null),R.return=j,R;if(typeof R.then=="function")return X(j,hu(R),N);if(R.$$typeof===L)return X(j,Wc(j,R),N);fu(j,R)}return null}function I(j,R,N,Q){var le=R!==null?R.key:null;if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return le!==null?null:x(j,R,""+N,Q);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case y:return N.key===le?k(j,R,N,Q):null;case _:return N.key===le?M(j,R,N,Q):null;case J:return le=N._init,N=le(N._payload),I(j,R,N,Q)}if(xe(N)||de(N))return le!==null?null:G(j,R,N,Q,null);if(typeof N.then=="function")return I(j,R,hu(N),Q);if(N.$$typeof===L)return I(j,R,Wc(j,N),Q);fu(j,N)}return null}function B(j,R,N,Q,le){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return j=j.get(N)||null,x(R,j,""+Q,le);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case y:return j=j.get(Q.key===null?N:Q.key)||null,k(R,j,Q,le);case _:return j=j.get(Q.key===null?N:Q.key)||null,M(R,j,Q,le);case J:var Te=Q._init;return Q=Te(Q._payload),B(j,R,N,Q,le)}if(xe(Q)||de(Q))return j=j.get(N)||null,G(R,j,Q,le,null);if(typeof Q.then=="function")return B(j,R,N,hu(Q),le);if(Q.$$typeof===L)return B(j,R,N,Wc(R,Q),le);fu(R,Q)}return null}function ve(j,R,N,Q){for(var le=null,Te=null,ue=R,pe=R=0,qt=null;ue!==null&&pe<N.length;pe++){ue.index>pe?(qt=ue,ue=null):qt=ue.sibling;var Be=I(j,ue,N[pe],Q);if(Be===null){ue===null&&(ue=qt);break}i&&ue&&Be.alternate===null&&r(j,ue),R=v(Be,R,pe),Te===null?le=Be:Te.sibling=Be,Te=Be,ue=qt}if(pe===N.length)return l(j,ue),Pe&&gr(j,pe),le;if(ue===null){for(;pe<N.length;pe++)ue=X(j,N[pe],Q),ue!==null&&(R=v(ue,R,pe),Te===null?le=ue:Te.sibling=ue,Te=ue);return Pe&&gr(j,pe),le}for(ue=u(ue);pe<N.length;pe++)qt=B(ue,j,pe,N[pe],Q),qt!==null&&(i&&qt.alternate!==null&&ue.delete(qt.key===null?pe:qt.key),R=v(qt,R,pe),Te===null?le=qt:Te.sibling=qt,Te=qt);return i&&ue.forEach(function($s){return r(j,$s)}),Pe&&gr(j,pe),le}function he(j,R,N,Q){if(N==null)throw Error(n(151));for(var le=null,Te=null,ue=R,pe=R=0,qt=null,Be=N.next();ue!==null&&!Be.done;pe++,Be=N.next()){ue.index>pe?(qt=ue,ue=null):qt=ue.sibling;var $s=I(j,ue,Be.value,Q);if($s===null){ue===null&&(ue=qt);break}i&&ue&&$s.alternate===null&&r(j,ue),R=v($s,R,pe),Te===null?le=$s:Te.sibling=$s,Te=$s,ue=qt}if(Be.done)return l(j,ue),Pe&&gr(j,pe),le;if(ue===null){for(;!Be.done;pe++,Be=N.next())Be=X(j,Be.value,Q),Be!==null&&(R=v(Be,R,pe),Te===null?le=Be:Te.sibling=Be,Te=Be);return Pe&&gr(j,pe),le}for(ue=u(ue);!Be.done;pe++,Be=N.next())Be=B(ue,j,pe,Be.value,Q),Be!==null&&(i&&Be.alternate!==null&&ue.delete(Be.key===null?pe:Be.key),R=v(Be,R,pe),Te===null?le=Be:Te.sibling=Be,Te=Be);return i&&ue.forEach(function(GT){return r(j,GT)}),Pe&&gr(j,pe),le}function Ve(j,R,N,Q){if(typeof N=="object"&&N!==null&&N.type===E&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case y:e:{for(var le=N.key;R!==null;){if(R.key===le){if(le=N.type,le===E){if(R.tag===7){l(j,R.sibling),Q=f(R,N.props.children),Q.return=j,j=Q;break e}}else if(R.elementType===le||typeof le=="object"&&le!==null&&le.$$typeof===J&&u_(le)===R.type){l(j,R.sibling),Q=f(R,N.props),ol(Q,N),Q.return=j,j=Q;break e}l(j,R);break}else r(j,R);R=R.sibling}N.type===E?(Q=hr(N.props.children,j.mode,Q,N.key),Q.return=j,j=Q):(Q=Xc(N.type,N.key,N.props,null,j.mode,Q),ol(Q,N),Q.return=j,j=Q)}return b(j);case _:e:{for(le=N.key;R!==null;){if(R.key===le)if(R.tag===4&&R.stateNode.containerInfo===N.containerInfo&&R.stateNode.implementation===N.implementation){l(j,R.sibling),Q=f(R,N.children||[]),Q.return=j,j=Q;break e}else{l(j,R);break}else r(j,R);R=R.sibling}Q=qh(N,j.mode,Q),Q.return=j,j=Q}return b(j);case J:return le=N._init,N=le(N._payload),Ve(j,R,N,Q)}if(xe(N))return ve(j,R,N,Q);if(de(N)){if(le=de(N),typeof le!="function")throw Error(n(150));return N=le.call(N),he(j,R,N,Q)}if(typeof N.then=="function")return Ve(j,R,hu(N),Q);if(N.$$typeof===L)return Ve(j,R,Wc(j,N),Q);fu(j,N)}return typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint"?(N=""+N,R!==null&&R.tag===6?(l(j,R.sibling),Q=f(R,N),Q.return=j,j=Q):(l(j,R),Q=Ph(N,j.mode,Q),Q.return=j,j=Q),b(j)):l(j,R)}return function(j,R,N,Q){try{al=0;var le=Ve(j,R,N,Q);return xa=null,le}catch(ue){if(ue===Jo||ue===tu)throw ue;var Te=Rn(29,ue,null,j.mode);return Te.lanes=Q,Te.return=j,Te}finally{}}}var Ca=d_(!0),h_=d_(!1),Gn=z(null),pi=null;function Ss(i){var r=i.alternate;P(kt,kt.current&1),P(Gn,i),pi===null&&(r===null||ba.current!==null||r.memoizedState!==null)&&(pi=i)}function f_(i){if(i.tag===22){if(P(kt,kt.current),P(Gn,i),pi===null){var r=i.alternate;r!==null&&r.memoizedState!==null&&(pi=i)}}else Es()}function Es(){P(kt,kt.current),P(Gn,Gn.current)}function Fi(i){F(Gn),pi===i&&(pi=null),F(kt)}var kt=z(0);function gu(i){for(var r=i;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||dg(l)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function Sf(i,r,l,u){r=i.memoizedState,l=l(u,r),l=l==null?r:p({},r,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Ef={enqueueSetState:function(i,r,l){i=i._reactInternals;var u=Nn(),f=_s(u);f.payload=r,l!=null&&(f.callback=l),r=bs(i,f,u),r!==null&&(Mn(r,i,u),Wo(r,i,u))},enqueueReplaceState:function(i,r,l){i=i._reactInternals;var u=Nn(),f=_s(u);f.tag=1,f.payload=r,l!=null&&(f.callback=l),r=bs(i,f,u),r!==null&&(Mn(r,i,u),Wo(r,i,u))},enqueueForceUpdate:function(i,r){i=i._reactInternals;var l=Nn(),u=_s(l);u.tag=2,r!=null&&(u.callback=r),r=bs(i,u,l),r!==null&&(Mn(r,i,l),Wo(r,i,l))}};function g_(i,r,l,u,f,v,b){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(u,v,b):r.prototype&&r.prototype.isPureReactComponent?!Ho(l,u)||!Ho(f,v):!0}function p_(i,r,l,u){i=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,u),r.state!==i&&Ef.enqueueReplaceState(r,r.state,null)}function wr(i,r){var l=r;if("ref"in r){l={};for(var u in r)u!=="ref"&&(l[u]=r[u])}if(i=i.defaultProps){l===r&&(l=p({},l));for(var f in i)l[f]===void 0&&(l[f]=i[f])}return l}var pu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function v_(i){pu(i)}function m_(i){console.error(i)}function y_(i){pu(i)}function vu(i,r){try{var l=i.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function __(i,r,l){try{var u=i.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function xf(i,r,l){return l=_s(l),l.tag=3,l.payload={element:null},l.callback=function(){vu(i,r)},l}function b_(i){return i=_s(i),i.tag=3,i}function w_(i,r,l,u){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var v=u.value;i.payload=function(){return f(v)},i.callback=function(){__(r,l,u)}}var b=l.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(i.callback=function(){__(r,l,u),typeof f!="function"&&(As===null?As=new Set([this]):As.add(this));var x=u.stack;this.componentDidCatch(u.value,{componentStack:x!==null?x:""})})}function GC(i,r,l,u,f){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=l.alternate,r!==null&&Qo(r,l,f,!0),l=Gn.current,l!==null){switch(l.tag){case 13:return pi===null?Qf():l.alternate===null&&ht===0&&(ht=3),l.flags&=-257,l.flags|=65536,l.lanes=f,u===Zh?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([u]):r.add(u),Kf(i,u,f)),!1;case 22:return l.flags|=65536,u===Zh?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([u]):l.add(u)),Kf(i,u,f)),!1}throw Error(n(435,l.tag))}return Kf(i,u,f),Qf(),!1}if(Pe)return r=Gn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,u!==Yh&&(i=Error(n(422),{cause:u}),Go(Hn(i,l)))):(u!==Yh&&(r=Error(n(423),{cause:u}),Go(Hn(r,l))),i=i.current.alternate,i.flags|=65536,f&=-f,i.lanes|=f,u=Hn(u,l),f=xf(i.stateNode,u,f),tf(i,f),ht!==4&&(ht=2)),!1;var v=Error(n(520),{cause:u});if(v=Hn(v,l),gl===null?gl=[v]:gl.push(v),ht!==4&&(ht=2),r===null)return!0;u=Hn(u,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,i=f&-f,l.lanes|=i,i=xf(l.stateNode,u,i),tf(l,i),!1;case 1:if(r=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(As===null||!As.has(v))))return l.flags|=65536,f&=-f,l.lanes|=f,f=b_(f),w_(f,i,l,u),tf(l,f),!1}l=l.return}while(l!==null);return!1}var S_=Error(n(461)),zt=!1;function Xt(i,r,l,u){r.child=i===null?h_(r,null,l,u):Ca(r,i.child,l,u)}function E_(i,r,l,u,f){l=l.render;var v=r.ref;if("ref"in u){var b={};for(var x in u)x!=="ref"&&(b[x]=u[x])}else b=u;return yr(r),u=of(i,r,l,b,v,f),x=lf(),i!==null&&!zt?(cf(i,r,f),Yi(i,r,f)):(Pe&&x&&Hh(r),r.flags|=1,Xt(i,r,u,f),r.child)}function x_(i,r,l,u,f){if(i===null){var v=l.type;return typeof v=="function"&&!zh(v)&&v.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=v,C_(i,r,v,u,f)):(i=Xc(l.type,null,u,r,r.mode,f),i.ref=r.ref,i.return=r,r.child=i)}if(v=i.child,!Lf(i,f)){var b=v.memoizedProps;if(l=l.compare,l=l!==null?l:Ho,l(b,u)&&i.ref===r.ref)return Yi(i,r,f)}return r.flags|=1,i=Ii(v,u),i.ref=r.ref,i.return=r,r.child=i}function C_(i,r,l,u,f){if(i!==null){var v=i.memoizedProps;if(Ho(v,u)&&i.ref===r.ref)if(zt=!1,r.pendingProps=u=v,Lf(i,f))(i.flags&131072)!==0&&(zt=!0);else return r.lanes=i.lanes,Yi(i,r,f)}return Cf(i,r,l,u,f)}function T_(i,r,l){var u=r.pendingProps,f=u.children,v=i!==null?i.memoizedState:null;if(u.mode==="hidden"){if((r.flags&128)!==0){if(u=v!==null?v.baseLanes|l:l,i!==null){for(f=r.child=i.child,v=0;f!==null;)v=v|f.lanes|f.childLanes,f=f.sibling;r.childLanes=v&~u}else r.childLanes=0,r.child=null;return D_(i,r,u,l)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},i!==null&&eu(r,v!==null?v.cachePool:null),v!==null?Cy(r,v):sf(),f_(r);else return r.lanes=r.childLanes=536870912,D_(i,r,v!==null?v.baseLanes|l:l,l)}else v!==null?(eu(r,v.cachePool),Cy(r,v),Es(),r.memoizedState=null):(i!==null&&eu(r,null),sf(),Es());return Xt(i,r,f,l),r.child}function D_(i,r,l,u){var f=Jh();return f=f===null?null:{parent:Dt._currentValue,pool:f},r.memoizedState={baseLanes:l,cachePool:f},i!==null&&eu(r,null),sf(),f_(r),i!==null&&Qo(i,r,u,!0),null}function mu(i,r){var l=r.ref;if(l===null)i!==null&&i.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(i===null||i.ref!==l)&&(r.flags|=4194816)}}function Cf(i,r,l,u,f){return yr(r),l=of(i,r,l,u,void 0,f),u=lf(),i!==null&&!zt?(cf(i,r,f),Yi(i,r,f)):(Pe&&u&&Hh(r),r.flags|=1,Xt(i,r,l,f),r.child)}function k_(i,r,l,u,f,v){return yr(r),r.updateQueue=null,l=Dy(r,u,l,f),Ty(i),u=lf(),i!==null&&!zt?(cf(i,r,v),Yi(i,r,v)):(Pe&&u&&Hh(r),r.flags|=1,Xt(i,r,l,v),r.child)}function A_(i,r,l,u,f){if(yr(r),r.stateNode===null){var v=pa,b=l.contextType;typeof b=="object"&&b!==null&&(v=rn(b)),v=new l(u,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Ef,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=u,v.state=r.memoizedState,v.refs={},Wh(r),b=l.contextType,v.context=typeof b=="object"&&b!==null?rn(b):pa,v.state=r.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(Sf(r,l,b,u),v.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(b=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),b!==v.state&&Ef.enqueueReplaceState(v,v.state,null),tl(r,u,v,f),el(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(i===null){v=r.stateNode;var x=r.memoizedProps,k=wr(l,x);v.props=k;var M=v.context,G=l.contextType;b=pa,typeof G=="object"&&G!==null&&(b=rn(G));var X=l.getDerivedStateFromProps;G=typeof X=="function"||typeof v.getSnapshotBeforeUpdate=="function",x=r.pendingProps!==x,G||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(x||M!==b)&&p_(r,v,u,b),ys=!1;var I=r.memoizedState;v.state=I,tl(r,u,v,f),el(),M=r.memoizedState,x||I!==M||ys?(typeof X=="function"&&(Sf(r,l,X,u),M=r.memoizedState),(k=ys||g_(r,l,k,u,I,M,b))?(G||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=M),v.props=u,v.state=M,v.context=b,u=k):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{v=r.stateNode,ef(i,r),b=r.memoizedProps,G=wr(l,b),v.props=G,X=r.pendingProps,I=v.context,M=l.contextType,k=pa,typeof M=="object"&&M!==null&&(k=rn(M)),x=l.getDerivedStateFromProps,(M=typeof x=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(b!==X||I!==k)&&p_(r,v,u,k),ys=!1,I=r.memoizedState,v.state=I,tl(r,u,v,f),el();var B=r.memoizedState;b!==X||I!==B||ys||i!==null&&i.dependencies!==null&&Zc(i.dependencies)?(typeof x=="function"&&(Sf(r,l,x,u),B=r.memoizedState),(G=ys||g_(r,l,G,u,I,B,k)||i!==null&&i.dependencies!==null&&Zc(i.dependencies))?(M||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,B,k),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,B,k)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||b===i.memoizedProps&&I===i.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&I===i.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=B),v.props=u,v.state=B,v.context=k,u=G):(typeof v.componentDidUpdate!="function"||b===i.memoizedProps&&I===i.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&I===i.memoizedState||(r.flags|=1024),u=!1)}return v=u,mu(i,r),u=(r.flags&128)!==0,v||u?(v=r.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,i!==null&&u?(r.child=Ca(r,i.child,null,f),r.child=Ca(r,null,l,f)):Xt(i,r,l,f),r.memoizedState=v.state,i=r.child):i=Yi(i,r,f),i}function R_(i,r,l,u){return Vo(),r.flags|=256,Xt(i,r,l,u),r.child}var Tf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Df(i){return{baseLanes:i,cachePool:my()}}function kf(i,r,l){return i=i!==null?i.childLanes&~l:0,r&&(i|=Qn),i}function O_(i,r,l){var u=r.pendingProps,f=!1,v=(r.flags&128)!==0,b;if((b=v)||(b=i!==null&&i.memoizedState===null?!1:(kt.current&2)!==0),b&&(f=!0,r.flags&=-129),b=(r.flags&32)!==0,r.flags&=-33,i===null){if(Pe){if(f?Ss(r):Es(),Pe){var x=dt,k;if(k=x){e:{for(k=x,x=gi;k.nodeType!==8;){if(!x){x=null;break e}if(k=ai(k.nextSibling),k===null){x=null;break e}}x=k}x!==null?(r.memoizedState={dehydrated:x,treeContext:fr!==null?{id:Bi,overflow:zi}:null,retryLane:536870912,hydrationErrors:null},k=Rn(18,null,null,0),k.stateNode=x,k.return=r,r.child=k,un=r,dt=null,k=!0):k=!1}k||vr(r)}if(x=r.memoizedState,x!==null&&(x=x.dehydrated,x!==null))return dg(x)?r.lanes=32:r.lanes=536870912,null;Fi(r)}return x=u.children,u=u.fallback,f?(Es(),f=r.mode,x=yu({mode:"hidden",children:x},f),u=hr(u,f,l,null),x.return=r,u.return=r,x.sibling=u,r.child=x,f=r.child,f.memoizedState=Df(l),f.childLanes=kf(i,b,l),r.memoizedState=Tf,u):(Ss(r),Af(r,x))}if(k=i.memoizedState,k!==null&&(x=k.dehydrated,x!==null)){if(v)r.flags&256?(Ss(r),r.flags&=-257,r=Rf(i,r,l)):r.memoizedState!==null?(Es(),r.child=i.child,r.flags|=128,r=null):(Es(),f=u.fallback,x=r.mode,u=yu({mode:"visible",children:u.children},x),f=hr(f,x,l,null),f.flags|=2,u.return=r,f.return=r,u.sibling=f,r.child=u,Ca(r,i.child,null,l),u=r.child,u.memoizedState=Df(l),u.childLanes=kf(i,b,l),r.memoizedState=Tf,r=f);else if(Ss(r),dg(x)){if(b=x.nextSibling&&x.nextSibling.dataset,b)var M=b.dgst;b=M,u=Error(n(419)),u.stack="",u.digest=b,Go({value:u,source:null,stack:null}),r=Rf(i,r,l)}else if(zt||Qo(i,r,l,!1),b=(l&i.childLanes)!==0,zt||b){if(b=Ke,b!==null&&(u=l&-l,u=(u&42)!==0?1:$t(u),u=(u&(b.suspendedLanes|l))!==0?0:u,u!==0&&u!==k.retryLane))throw k.retryLane=u,ga(i,u),Mn(b,i,u),S_;x.data==="$?"||Qf(),r=Rf(i,r,l)}else x.data==="$?"?(r.flags|=192,r.child=i.child,r=null):(i=k.treeContext,dt=ai(x.nextSibling),un=r,Pe=!0,pr=null,gi=!1,i!==null&&(Yn[Vn++]=Bi,Yn[Vn++]=zi,Yn[Vn++]=fr,Bi=i.id,zi=i.overflow,fr=r),r=Af(r,u.children),r.flags|=4096);return r}return f?(Es(),f=u.fallback,x=r.mode,k=i.child,M=k.sibling,u=Ii(k,{mode:"hidden",children:u.children}),u.subtreeFlags=k.subtreeFlags&65011712,M!==null?f=Ii(M,f):(f=hr(f,x,l,null),f.flags|=2),f.return=r,u.return=r,u.sibling=f,r.child=u,u=f,f=r.child,x=i.child.memoizedState,x===null?x=Df(l):(k=x.cachePool,k!==null?(M=Dt._currentValue,k=k.parent!==M?{parent:M,pool:M}:k):k=my(),x={baseLanes:x.baseLanes|l,cachePool:k}),f.memoizedState=x,f.childLanes=kf(i,b,l),r.memoizedState=Tf,u):(Ss(r),l=i.child,i=l.sibling,l=Ii(l,{mode:"visible",children:u.children}),l.return=r,l.sibling=null,i!==null&&(b=r.deletions,b===null?(r.deletions=[i],r.flags|=16):b.push(i)),r.child=l,r.memoizedState=null,l)}function Af(i,r){return r=yu({mode:"visible",children:r},i.mode),r.return=i,i.child=r}function yu(i,r){return i=Rn(22,i,null,r),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function Rf(i,r,l){return Ca(r,i.child,null,l),i=Af(r,r.pendingProps.children),i.flags|=2,r.memoizedState=null,i}function L_(i,r,l){i.lanes|=r;var u=i.alternate;u!==null&&(u.lanes|=r),Gh(i.return,r,l)}function Of(i,r,l,u,f){var v=i.memoizedState;v===null?i.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:f}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=l,v.tailMode=f)}function j_(i,r,l){var u=r.pendingProps,f=u.revealOrder,v=u.tail;if(Xt(i,r,u.children,l),u=kt.current,(u&2)!==0)u=u&1|2,r.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=r.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&L_(i,l,r);else if(i.tag===19)L_(i,l,r);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}u&=1}switch(P(kt,u),f){case"forwards":for(l=r.child,f=null;l!==null;)i=l.alternate,i!==null&&gu(i)===null&&(f=l),l=l.sibling;l=f,l===null?(f=r.child,r.child=null):(f=l.sibling,l.sibling=null),Of(r,!1,f,l,v);break;case"backwards":for(l=null,f=r.child,r.child=null;f!==null;){if(i=f.alternate,i!==null&&gu(i)===null){r.child=f;break}i=f.sibling,f.sibling=l,l=f,f=i}Of(r,!0,l,null,v);break;case"together":Of(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Yi(i,r,l){if(i!==null&&(r.dependencies=i.dependencies),ks|=r.lanes,(l&r.childLanes)===0)if(i!==null){if(Qo(i,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(i!==null&&r.child!==i.child)throw Error(n(153));if(r.child!==null){for(i=r.child,l=Ii(i,i.pendingProps),r.child=l,l.return=r;i.sibling!==null;)i=i.sibling,l=l.sibling=Ii(i,i.pendingProps),l.return=r;l.sibling=null}return r.child}function Lf(i,r){return(i.lanes&r)!==0?!0:(i=i.dependencies,!!(i!==null&&Zc(i)))}function QC(i,r,l){switch(r.tag){case 3:Ce(r,r.stateNode.containerInfo),ms(r,Dt,i.memoizedState.cache),Vo();break;case 27:case 5:_e(r);break;case 4:Ce(r,r.stateNode.containerInfo);break;case 10:ms(r,r.type,r.memoizedProps.value);break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(Ss(r),r.flags|=128,null):(l&r.child.childLanes)!==0?O_(i,r,l):(Ss(r),i=Yi(i,r,l),i!==null?i.sibling:null);Ss(r);break;case 19:var f=(i.flags&128)!==0;if(u=(l&r.childLanes)!==0,u||(Qo(i,r,l,!1),u=(l&r.childLanes)!==0),f){if(u)return j_(i,r,l);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),P(kt,kt.current),u)break;return null;case 22:case 23:return r.lanes=0,T_(i,r,l);case 24:ms(r,Dt,i.memoizedState.cache)}return Yi(i,r,l)}function N_(i,r,l){if(i!==null)if(i.memoizedProps!==r.pendingProps)zt=!0;else{if(!Lf(i,l)&&(r.flags&128)===0)return zt=!1,QC(i,r,l);zt=(i.flags&131072)!==0}else zt=!1,Pe&&(r.flags&1048576)!==0&&uy(r,Jc,r.index);switch(r.lanes=0,r.tag){case 16:e:{i=r.pendingProps;var u=r.elementType,f=u._init;if(u=f(u._payload),r.type=u,typeof u=="function")zh(u)?(i=wr(u,i),r.tag=1,r=A_(null,r,u,i,l)):(r.tag=0,r=Cf(null,r,u,i,l));else{if(u!=null){if(f=u.$$typeof,f===U){r.tag=11,r=E_(null,r,u,i,l);break e}else if(f===Z){r.tag=14,r=x_(null,r,u,i,l);break e}}throw r=Ue(u)||u,Error(n(306,r,""))}}return r;case 0:return Cf(i,r,r.type,r.pendingProps,l);case 1:return u=r.type,f=wr(u,r.pendingProps),A_(i,r,u,f,l);case 3:e:{if(Ce(r,r.stateNode.containerInfo),i===null)throw Error(n(387));u=r.pendingProps;var v=r.memoizedState;f=v.element,ef(i,r),tl(r,u,null,l);var b=r.memoizedState;if(u=b.cache,ms(r,Dt,u),u!==v.cache&&Qh(r,[Dt],l,!0),el(),u=b.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:b.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=R_(i,r,u,l);break e}else if(u!==f){f=Hn(Error(n(424)),r),Go(f),r=R_(i,r,u,l);break e}else{switch(i=r.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(dt=ai(i.firstChild),un=r,Pe=!0,pr=null,gi=!0,l=h_(r,null,u,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Vo(),u===f){r=Yi(i,r,l);break e}Xt(i,r,u,l)}r=r.child}return r;case 26:return mu(i,r),i===null?(l=I0(r.type,null,r.pendingProps,null))?r.memoizedState=l:Pe||(l=r.type,i=r.pendingProps,u=Lu(ne.current).createElement(l),u[Ie]=r,u[et]=i,Jt(u,l,i),Bt(u),r.stateNode=u):r.memoizedState=I0(r.type,i.memoizedProps,r.pendingProps,i.memoizedState),null;case 27:return _e(r),i===null&&Pe&&(u=r.stateNode=M0(r.type,r.pendingProps,ne.current),un=r,gi=!0,f=dt,Ls(r.type)?(hg=f,dt=ai(u.firstChild)):dt=f),Xt(i,r,r.pendingProps.children,l),mu(i,r),i===null&&(r.flags|=4194304),r.child;case 5:return i===null&&Pe&&((f=u=dt)&&(u=ST(u,r.type,r.pendingProps,gi),u!==null?(r.stateNode=u,un=r,dt=ai(u.firstChild),gi=!1,f=!0):f=!1),f||vr(r)),_e(r),f=r.type,v=r.pendingProps,b=i!==null?i.memoizedProps:null,u=v.children,lg(f,v)?u=null:b!==null&&lg(f,b)&&(r.flags|=32),r.memoizedState!==null&&(f=of(i,r,zC,null,null,l),El._currentValue=f),mu(i,r),Xt(i,r,u,l),r.child;case 6:return i===null&&Pe&&((i=l=dt)&&(l=ET(l,r.pendingProps,gi),l!==null?(r.stateNode=l,un=r,dt=null,i=!0):i=!1),i||vr(r)),null;case 13:return O_(i,r,l);case 4:return Ce(r,r.stateNode.containerInfo),u=r.pendingProps,i===null?r.child=Ca(r,null,u,l):Xt(i,r,u,l),r.child;case 11:return E_(i,r,r.type,r.pendingProps,l);case 7:return Xt(i,r,r.pendingProps,l),r.child;case 8:return Xt(i,r,r.pendingProps.children,l),r.child;case 12:return Xt(i,r,r.pendingProps.children,l),r.child;case 10:return u=r.pendingProps,ms(r,r.type,u.value),Xt(i,r,u.children,l),r.child;case 9:return f=r.type._context,u=r.pendingProps.children,yr(r),f=rn(f),u=u(f),r.flags|=1,Xt(i,r,u,l),r.child;case 14:return x_(i,r,r.type,r.pendingProps,l);case 15:return C_(i,r,r.type,r.pendingProps,l);case 19:return j_(i,r,l);case 31:return u=r.pendingProps,l=r.mode,u={mode:u.mode,children:u.children},i===null?(l=yu(u,l),l.ref=r.ref,r.child=l,l.return=r,r=l):(l=Ii(i.child,u),l.ref=r.ref,r.child=l,l.return=r,r=l),r;case 22:return T_(i,r,l);case 24:return yr(r),u=rn(Dt),i===null?(f=Jh(),f===null&&(f=Ke,v=Xh(),f.pooledCache=v,v.refCount++,v!==null&&(f.pooledCacheLanes|=l),f=v),r.memoizedState={parent:u,cache:f},Wh(r),ms(r,Dt,f)):((i.lanes&l)!==0&&(ef(i,r),tl(r,null,null,l),el()),f=i.memoizedState,v=r.memoizedState,f.parent!==u?(f={parent:u,cache:u},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),ms(r,Dt,u)):(u=v.cache,ms(r,Dt,u),u!==f.cache&&Qh(r,[Dt],l,!0))),Xt(i,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(n(156,r.tag))}function Vi(i){i.flags|=4}function M_(i,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!H0(r)){if(r=Gn.current,r!==null&&((Me&4194048)===Me?pi!==null:(Me&62914560)!==Me&&(Me&536870912)===0||r!==pi))throw Zo=Zh,yy;i.flags|=8192}}function _u(i,r){r!==null&&(i.flags|=4),i.flags&16384&&(r=i.tag!==22?ea():536870912,i.lanes|=r,Aa|=r)}function ll(i,r){if(!Pe)switch(i.tailMode){case"hidden":r=i.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?r||i.tail===null?i.tail=null:i.tail.sibling=null:u.sibling=null}}function at(i){var r=i.alternate!==null&&i.alternate.child===i.child,l=0,u=0;if(r)for(var f=i.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=i,f=f.sibling;else for(f=i.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=i,f=f.sibling;return i.subtreeFlags|=u,i.childLanes=l,r}function XC(i,r,l){var u=r.pendingProps;switch(Fh(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return at(r),null;case 1:return at(r),null;case 3:return l=r.stateNode,u=null,i!==null&&(u=i.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),qi(Dt),ct(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(Yo(r)?Vi(r):i===null||i.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,fy())),at(r),null;case 26:return l=r.memoizedState,i===null?(Vi(r),l!==null?(at(r),M_(r,l)):(at(r),r.flags&=-16777217)):l?l!==i.memoizedState?(Vi(r),at(r),M_(r,l)):(at(r),r.flags&=-16777217):(i.memoizedProps!==u&&Vi(r),at(r),r.flags&=-16777217),null;case 27:fn(r),l=ne.current;var f=r.type;if(i!==null&&r.stateNode!=null)i.memoizedProps!==u&&Vi(r);else{if(!u){if(r.stateNode===null)throw Error(n(166));return at(r),null}i=W.current,Yo(r)?dy(r):(i=M0(f,u,l),r.stateNode=i,Vi(r))}return at(r),null;case 5:if(fn(r),l=r.type,i!==null&&r.stateNode!=null)i.memoizedProps!==u&&Vi(r);else{if(!u){if(r.stateNode===null)throw Error(n(166));return at(r),null}if(i=W.current,Yo(r))dy(r);else{switch(f=Lu(ne.current),i){case 1:i=f.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:i=f.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":i=f.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":i=f.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":i=f.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof u.is=="string"?f.createElement("select",{is:u.is}):f.createElement("select"),u.multiple?i.multiple=!0:u.size&&(i.size=u.size);break;default:i=typeof u.is=="string"?f.createElement(l,{is:u.is}):f.createElement(l)}}i[Ie]=r,i[et]=u;e:for(f=r.child;f!==null;){if(f.tag===5||f.tag===6)i.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===r)break e;for(;f.sibling===null;){if(f.return===null||f.return===r)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}r.stateNode=i;e:switch(Jt(i,l,u),l){case"button":case"input":case"select":case"textarea":i=!!u.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Vi(r)}}return at(r),r.flags&=-16777217,null;case 6:if(i&&r.stateNode!=null)i.memoizedProps!==u&&Vi(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(n(166));if(i=ne.current,Yo(r)){if(i=r.stateNode,l=r.memoizedProps,u=null,f=un,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}i[Ie]=r,i=!!(i.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||k0(i.nodeValue,l)),i||vr(r)}else i=Lu(i).createTextNode(u),i[Ie]=r,r.stateNode=i}return at(r),null;case 13:if(u=r.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(f=Yo(r),u!==null&&u.dehydrated!==null){if(i===null){if(!f)throw Error(n(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(n(317));f[Ie]=r}else Vo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;at(r),f=!1}else f=fy(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Fi(r),r):(Fi(r),null)}if(Fi(r),(r.flags&128)!==0)return r.lanes=l,r;if(l=u!==null,i=i!==null&&i.memoizedState!==null,l){u=r.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool);var v=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==f&&(u.flags|=2048)}return l!==i&&l&&(r.child.flags|=8192),_u(r,r.updateQueue),at(r),null;case 4:return ct(),i===null&&ig(r.stateNode.containerInfo),at(r),null;case 10:return qi(r.type),at(r),null;case 19:if(F(kt),f=r.memoizedState,f===null)return at(r),null;if(u=(r.flags&128)!==0,v=f.rendering,v===null)if(u)ll(f,!1);else{if(ht!==0||i!==null&&(i.flags&128)!==0)for(i=r.child;i!==null;){if(v=gu(i),v!==null){for(r.flags|=128,ll(f,!1),i=v.updateQueue,r.updateQueue=i,_u(r,i),r.subtreeFlags=0,i=l,l=r.child;l!==null;)cy(l,i),l=l.sibling;return P(kt,kt.current&1|2),r.child}i=i.sibling}f.tail!==null&&Ct()>Su&&(r.flags|=128,u=!0,ll(f,!1),r.lanes=4194304)}else{if(!u)if(i=gu(v),i!==null){if(r.flags|=128,u=!0,i=i.updateQueue,r.updateQueue=i,_u(r,i),ll(f,!0),f.tail===null&&f.tailMode==="hidden"&&!v.alternate&&!Pe)return at(r),null}else 2*Ct()-f.renderingStartTime>Su&&l!==536870912&&(r.flags|=128,u=!0,ll(f,!1),r.lanes=4194304);f.isBackwards?(v.sibling=r.child,r.child=v):(i=f.last,i!==null?i.sibling=v:r.child=v,f.last=v)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=Ct(),r.sibling=null,i=kt.current,P(kt,u?i&1|2:i&1),r):(at(r),null);case 22:case 23:return Fi(r),rf(),u=r.memoizedState!==null,i!==null?i.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(l&536870912)!==0&&(r.flags&128)===0&&(at(r),r.subtreeFlags&6&&(r.flags|=8192)):at(r),l=r.updateQueue,l!==null&&_u(r,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==l&&(r.flags|=2048),i!==null&&F(_r),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),qi(Dt),at(r),null;case 25:return null;case 30:return null}throw Error(n(156,r.tag))}function KC(i,r){switch(Fh(r),r.tag){case 1:return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 3:return qi(Dt),ct(),i=r.flags,(i&65536)!==0&&(i&128)===0?(r.flags=i&-65537|128,r):null;case 26:case 27:case 5:return fn(r),null;case 13:if(Fi(r),i=r.memoizedState,i!==null&&i.dehydrated!==null){if(r.alternate===null)throw Error(n(340));Vo()}return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 19:return F(kt),null;case 4:return ct(),null;case 10:return qi(r.type),null;case 22:case 23:return Fi(r),rf(),i!==null&&F(_r),i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 24:return qi(Dt),null;case 25:return null;default:return null}}function U_(i,r){switch(Fh(r),r.tag){case 3:qi(Dt),ct();break;case 26:case 27:case 5:fn(r);break;case 4:ct();break;case 13:Fi(r);break;case 19:F(kt);break;case 10:qi(r.type);break;case 22:case 23:Fi(r),rf(),i!==null&&F(_r);break;case 24:qi(Dt)}}function cl(i,r){try{var l=r.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&i)===i){u=void 0;var v=l.create,b=l.inst;u=v(),b.destroy=u}l=l.next}while(l!==f)}}catch(x){Xe(r,r.return,x)}}function xs(i,r,l){try{var u=r.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var v=f.next;u=v;do{if((u.tag&i)===i){var b=u.inst,x=b.destroy;if(x!==void 0){b.destroy=void 0,f=r;var k=l,M=x;try{M()}catch(G){Xe(f,k,G)}}}u=u.next}while(u!==v)}}catch(G){Xe(r,r.return,G)}}function $_(i){var r=i.updateQueue;if(r!==null){var l=i.stateNode;try{xy(r,l)}catch(u){Xe(i,i.return,u)}}}function I_(i,r,l){l.props=wr(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(u){Xe(i,r,u)}}function ul(i,r){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var u=i.stateNode;break;case 30:u=i.stateNode;break;default:u=i.stateNode}typeof l=="function"?i.refCleanup=l(u):l.current=u}}catch(f){Xe(i,r,f)}}function vi(i,r){var l=i.ref,u=i.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(f){Xe(i,r,f)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){Xe(i,r,f)}else l.current=null}function B_(i){var r=i.type,l=i.memoizedProps,u=i.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(f){Xe(i,i.return,f)}}function jf(i,r,l){try{var u=i.stateNode;mT(u,i.type,l,r),u[et]=r}catch(f){Xe(i,i.return,f)}}function z_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ls(i.type)||i.tag===4}function Nf(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||z_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ls(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Mf(i,r,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(i),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Ou));else if(u!==4&&(u===27&&Ls(i.type)&&(l=i.stateNode,r=null),i=i.child,i!==null))for(Mf(i,r,l),i=i.sibling;i!==null;)Mf(i,r,l),i=i.sibling}function bu(i,r,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,r?l.insertBefore(i,r):l.appendChild(i);else if(u!==4&&(u===27&&Ls(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(bu(i,r,l),i=i.sibling;i!==null;)bu(i,r,l),i=i.sibling}function P_(i){var r=i.stateNode,l=i.memoizedProps;try{for(var u=i.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Jt(r,u,l),r[Ie]=i,r[et]=l}catch(v){Xe(i,i.return,v)}}var Gi=!1,vt=!1,Uf=!1,q_=typeof WeakSet=="function"?WeakSet:Set,Pt=null;function JC(i,r){if(i=i.containerInfo,ag=Iu,i=Wm(i),jh(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var f=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var b=0,x=-1,k=-1,M=0,G=0,X=i,I=null;t:for(;;){for(var B;X!==l||f!==0&&X.nodeType!==3||(x=b+f),X!==v||u!==0&&X.nodeType!==3||(k=b+u),X.nodeType===3&&(b+=X.nodeValue.length),(B=X.firstChild)!==null;)I=X,X=B;for(;;){if(X===i)break t;if(I===l&&++M===f&&(x=b),I===v&&++G===u&&(k=b),(B=X.nextSibling)!==null)break;X=I,I=X.parentNode}X=B}l=x===-1||k===-1?null:{start:x,end:k}}else l=null}l=l||{start:0,end:0}}else l=null;for(og={focusedElem:i,selectionRange:l},Iu=!1,Pt=r;Pt!==null;)if(r=Pt,i=r.child,(r.subtreeFlags&1024)!==0&&i!==null)i.return=r,Pt=i;else for(;Pt!==null;){switch(r=Pt,v=r.alternate,i=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&v!==null){i=void 0,l=r,f=v.memoizedProps,v=v.memoizedState,u=l.stateNode;try{var ve=wr(l.type,f,l.elementType===l.type);i=u.getSnapshotBeforeUpdate(ve,v),u.__reactInternalSnapshotBeforeUpdate=i}catch(he){Xe(l,l.return,he)}}break;case 3:if((i&1024)!==0){if(i=r.stateNode.containerInfo,l=i.nodeType,l===9)ug(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":ug(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=r.sibling,i!==null){i.return=r.return,Pt=i;break}Pt=r.return}}function H_(i,r,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Cs(i,l),u&4&&cl(5,l);break;case 1:if(Cs(i,l),u&4)if(i=l.stateNode,r===null)try{i.componentDidMount()}catch(b){Xe(l,l.return,b)}else{var f=wr(l.type,r.memoizedProps);r=r.memoizedState;try{i.componentDidUpdate(f,r,i.__reactInternalSnapshotBeforeUpdate)}catch(b){Xe(l,l.return,b)}}u&64&&$_(l),u&512&&ul(l,l.return);break;case 3:if(Cs(i,l),u&64&&(i=l.updateQueue,i!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{xy(i,r)}catch(b){Xe(l,l.return,b)}}break;case 27:r===null&&u&4&&P_(l);case 26:case 5:Cs(i,l),r===null&&u&4&&B_(l),u&512&&ul(l,l.return);break;case 12:Cs(i,l);break;case 13:Cs(i,l),u&4&&V_(i,l),u&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=aT.bind(null,l),xT(i,l))));break;case 22:if(u=l.memoizedState!==null||Gi,!u){r=r!==null&&r.memoizedState!==null||vt,f=Gi;var v=vt;Gi=u,(vt=r)&&!v?Ts(i,l,(l.subtreeFlags&8772)!==0):Cs(i,l),Gi=f,vt=v}break;case 30:break;default:Cs(i,l)}}function F_(i){var r=i.alternate;r!==null&&(i.alternate=null,F_(r)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(r=i.stateNode,r!==null&&gh(r)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var rt=null,mn=!1;function Qi(i,r,l){for(l=l.child;l!==null;)Y_(i,r,l),l=l.sibling}function Y_(i,r,l){if(Qe&&typeof Qe.onCommitFiberUnmount=="function")try{Qe.onCommitFiberUnmount(gn,l)}catch{}switch(l.tag){case 26:vt||vi(l,r),Qi(i,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:vt||vi(l,r);var u=rt,f=mn;Ls(l.type)&&(rt=l.stateNode,mn=!1),Qi(i,r,l),_l(l.stateNode),rt=u,mn=f;break;case 5:vt||vi(l,r);case 6:if(u=rt,f=mn,rt=null,Qi(i,r,l),rt=u,mn=f,rt!==null)if(mn)try{(rt.nodeType===9?rt.body:rt.nodeName==="HTML"?rt.ownerDocument.body:rt).removeChild(l.stateNode)}catch(v){Xe(l,r,v)}else try{rt.removeChild(l.stateNode)}catch(v){Xe(l,r,v)}break;case 18:rt!==null&&(mn?(i=rt,j0(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),Dl(i)):j0(rt,l.stateNode));break;case 4:u=rt,f=mn,rt=l.stateNode.containerInfo,mn=!0,Qi(i,r,l),rt=u,mn=f;break;case 0:case 11:case 14:case 15:vt||xs(2,l,r),vt||xs(4,l,r),Qi(i,r,l);break;case 1:vt||(vi(l,r),u=l.stateNode,typeof u.componentWillUnmount=="function"&&I_(l,r,u)),Qi(i,r,l);break;case 21:Qi(i,r,l);break;case 22:vt=(u=vt)||l.memoizedState!==null,Qi(i,r,l),vt=u;break;default:Qi(i,r,l)}}function V_(i,r){if(r.memoizedState===null&&(i=r.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Dl(i)}catch(l){Xe(r,r.return,l)}}function ZC(i){switch(i.tag){case 13:case 19:var r=i.stateNode;return r===null&&(r=i.stateNode=new q_),r;case 22:return i=i.stateNode,r=i._retryCache,r===null&&(r=i._retryCache=new q_),r;default:throw Error(n(435,i.tag))}}function $f(i,r){var l=ZC(i);r.forEach(function(u){var f=oT.bind(null,i,u);l.has(u)||(l.add(u),u.then(f,f))})}function On(i,r){var l=r.deletions;if(l!==null)for(var u=0;u<l.length;u++){var f=l[u],v=i,b=r,x=b;e:for(;x!==null;){switch(x.tag){case 27:if(Ls(x.type)){rt=x.stateNode,mn=!1;break e}break;case 5:rt=x.stateNode,mn=!1;break e;case 3:case 4:rt=x.stateNode.containerInfo,mn=!0;break e}x=x.return}if(rt===null)throw Error(n(160));Y_(v,b,f),rt=null,mn=!1,v=f.alternate,v!==null&&(v.return=null),f.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)G_(r,i),r=r.sibling}var ri=null;function G_(i,r){var l=i.alternate,u=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:On(r,i),Ln(i),u&4&&(xs(3,i,i.return),cl(3,i),xs(5,i,i.return));break;case 1:On(r,i),Ln(i),u&512&&(vt||l===null||vi(l,l.return)),u&64&&Gi&&(i=i.updateQueue,i!==null&&(u=i.callbacks,u!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var f=ri;if(On(r,i),Ln(i),u&512&&(vt||l===null||vi(l,l.return)),u&4){var v=l!==null?l.memoizedState:null;if(u=i.memoizedState,l===null)if(u===null)if(i.stateNode===null){e:{u=i.type,l=i.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":v=f.getElementsByTagName("title")[0],(!v||v[Mi]||v[Ie]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=f.createElement(u),f.head.insertBefore(v,f.querySelector("head > title"))),Jt(v,u,l),v[Ie]=i,Bt(v),u=v;break e;case"link":var b=P0("link","href",f).get(u+(l.href||""));if(b){for(var x=0;x<b.length;x++)if(v=b[x],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){b.splice(x,1);break t}}v=f.createElement(u),Jt(v,u,l),f.head.appendChild(v);break;case"meta":if(b=P0("meta","content",f).get(u+(l.content||""))){for(x=0;x<b.length;x++)if(v=b[x],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){b.splice(x,1);break t}}v=f.createElement(u),Jt(v,u,l),f.head.appendChild(v);break;default:throw Error(n(468,u))}v[Ie]=i,Bt(v),u=v}i.stateNode=u}else q0(f,i.type,i.stateNode);else i.stateNode=z0(f,u,i.memoizedProps);else v!==u?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,u===null?q0(f,i.type,i.stateNode):z0(f,u,i.memoizedProps)):u===null&&i.stateNode!==null&&jf(i,i.memoizedProps,l.memoizedProps)}break;case 27:On(r,i),Ln(i),u&512&&(vt||l===null||vi(l,l.return)),l!==null&&u&4&&jf(i,i.memoizedProps,l.memoizedProps);break;case 5:if(On(r,i),Ln(i),u&512&&(vt||l===null||vi(l,l.return)),i.flags&32){f=i.stateNode;try{oa(f,"")}catch(B){Xe(i,i.return,B)}}u&4&&i.stateNode!=null&&(f=i.memoizedProps,jf(i,f,l!==null?l.memoizedProps:f)),u&1024&&(Uf=!0);break;case 6:if(On(r,i),Ln(i),u&4){if(i.stateNode===null)throw Error(n(162));u=i.memoizedProps,l=i.stateNode;try{l.nodeValue=u}catch(B){Xe(i,i.return,B)}}break;case 3:if(Mu=null,f=ri,ri=ju(r.containerInfo),On(r,i),ri=f,Ln(i),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Dl(r.containerInfo)}catch(B){Xe(i,i.return,B)}Uf&&(Uf=!1,Q_(i));break;case 4:u=ri,ri=ju(i.stateNode.containerInfo),On(r,i),Ln(i),ri=u;break;case 12:On(r,i),Ln(i);break;case 13:On(r,i),Ln(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Hf=Ct()),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,$f(i,u)));break;case 22:f=i.memoizedState!==null;var k=l!==null&&l.memoizedState!==null,M=Gi,G=vt;if(Gi=M||f,vt=G||k,On(r,i),vt=G,Gi=M,Ln(i),u&8192)e:for(r=i.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(l===null||k||Gi||vt||Sr(i)),l=null,r=i;;){if(r.tag===5||r.tag===26){if(l===null){k=l=r;try{if(v=k.stateNode,f)b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{x=k.stateNode;var X=k.memoizedProps.style,I=X!=null&&X.hasOwnProperty("display")?X.display:null;x.style.display=I==null||typeof I=="boolean"?"":(""+I).trim()}}catch(B){Xe(k,k.return,B)}}}else if(r.tag===6){if(l===null){k=r;try{k.stateNode.nodeValue=f?"":k.memoizedProps}catch(B){Xe(k,k.return,B)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===i)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=i.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,$f(i,l))));break;case 19:On(r,i),Ln(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,$f(i,u)));break;case 30:break;case 21:break;default:On(r,i),Ln(i)}}function Ln(i){var r=i.flags;if(r&2){try{for(var l,u=i.return;u!==null;){if(z_(u)){l=u;break}u=u.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var f=l.stateNode,v=Nf(i);bu(i,v,f);break;case 5:var b=l.stateNode;l.flags&32&&(oa(b,""),l.flags&=-33);var x=Nf(i);bu(i,x,b);break;case 3:case 4:var k=l.stateNode.containerInfo,M=Nf(i);Mf(i,M,k);break;default:throw Error(n(161))}}catch(G){Xe(i,i.return,G)}i.flags&=-3}r&4096&&(i.flags&=-4097)}function Q_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var r=i;Q_(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),i=i.sibling}}function Cs(i,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)H_(i,r.alternate,r),r=r.sibling}function Sr(i){for(i=i.child;i!==null;){var r=i;switch(r.tag){case 0:case 11:case 14:case 15:xs(4,r,r.return),Sr(r);break;case 1:vi(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&I_(r,r.return,l),Sr(r);break;case 27:_l(r.stateNode);case 26:case 5:vi(r,r.return),Sr(r);break;case 22:r.memoizedState===null&&Sr(r);break;case 30:Sr(r);break;default:Sr(r)}i=i.sibling}}function Ts(i,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,f=i,v=r,b=v.flags;switch(v.tag){case 0:case 11:case 15:Ts(f,v,l),cl(4,v);break;case 1:if(Ts(f,v,l),u=v,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(M){Xe(u,u.return,M)}if(u=v,f=u.updateQueue,f!==null){var x=u.stateNode;try{var k=f.shared.hiddenCallbacks;if(k!==null)for(f.shared.hiddenCallbacks=null,f=0;f<k.length;f++)Ey(k[f],x)}catch(M){Xe(u,u.return,M)}}l&&b&64&&$_(v),ul(v,v.return);break;case 27:P_(v);case 26:case 5:Ts(f,v,l),l&&u===null&&b&4&&B_(v),ul(v,v.return);break;case 12:Ts(f,v,l);break;case 13:Ts(f,v,l),l&&b&4&&V_(f,v);break;case 22:v.memoizedState===null&&Ts(f,v,l),ul(v,v.return);break;case 30:break;default:Ts(f,v,l)}r=r.sibling}}function If(i,r){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(i=r.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&Xo(l))}function Bf(i,r){i=null,r.alternate!==null&&(i=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==i&&(r.refCount++,i!=null&&Xo(i))}function mi(i,r,l,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)X_(i,r,l,u),r=r.sibling}function X_(i,r,l,u){var f=r.flags;switch(r.tag){case 0:case 11:case 15:mi(i,r,l,u),f&2048&&cl(9,r);break;case 1:mi(i,r,l,u);break;case 3:mi(i,r,l,u),f&2048&&(i=null,r.alternate!==null&&(i=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==i&&(r.refCount++,i!=null&&Xo(i)));break;case 12:if(f&2048){mi(i,r,l,u),i=r.stateNode;try{var v=r.memoizedProps,b=v.id,x=v.onPostCommit;typeof x=="function"&&x(b,r.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(k){Xe(r,r.return,k)}}else mi(i,r,l,u);break;case 13:mi(i,r,l,u);break;case 23:break;case 22:v=r.stateNode,b=r.alternate,r.memoizedState!==null?v._visibility&2?mi(i,r,l,u):dl(i,r):v._visibility&2?mi(i,r,l,u):(v._visibility|=2,Ta(i,r,l,u,(r.subtreeFlags&10256)!==0)),f&2048&&If(b,r);break;case 24:mi(i,r,l,u),f&2048&&Bf(r.alternate,r);break;default:mi(i,r,l,u)}}function Ta(i,r,l,u,f){for(f=f&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var v=i,b=r,x=l,k=u,M=b.flags;switch(b.tag){case 0:case 11:case 15:Ta(v,b,x,k,f),cl(8,b);break;case 23:break;case 22:var G=b.stateNode;b.memoizedState!==null?G._visibility&2?Ta(v,b,x,k,f):dl(v,b):(G._visibility|=2,Ta(v,b,x,k,f)),f&&M&2048&&If(b.alternate,b);break;case 24:Ta(v,b,x,k,f),f&&M&2048&&Bf(b.alternate,b);break;default:Ta(v,b,x,k,f)}r=r.sibling}}function dl(i,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=i,u=r,f=u.flags;switch(u.tag){case 22:dl(l,u),f&2048&&If(u.alternate,u);break;case 24:dl(l,u),f&2048&&Bf(u.alternate,u);break;default:dl(l,u)}r=r.sibling}}var hl=8192;function Da(i){if(i.subtreeFlags&hl)for(i=i.child;i!==null;)K_(i),i=i.sibling}function K_(i){switch(i.tag){case 26:Da(i),i.flags&hl&&i.memoizedState!==null&&$T(ri,i.memoizedState,i.memoizedProps);break;case 5:Da(i);break;case 3:case 4:var r=ri;ri=ju(i.stateNode.containerInfo),Da(i),ri=r;break;case 22:i.memoizedState===null&&(r=i.alternate,r!==null&&r.memoizedState!==null?(r=hl,hl=16777216,Da(i),hl=r):Da(i));break;default:Da(i)}}function J_(i){var r=i.alternate;if(r!==null&&(i=r.child,i!==null)){r.child=null;do r=i.sibling,i.sibling=null,i=r;while(i!==null)}}function fl(i){var r=i.deletions;if((i.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Pt=u,W_(u,i)}J_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Z_(i),i=i.sibling}function Z_(i){switch(i.tag){case 0:case 11:case 15:fl(i),i.flags&2048&&xs(9,i,i.return);break;case 3:fl(i);break;case 12:fl(i);break;case 22:var r=i.stateNode;i.memoizedState!==null&&r._visibility&2&&(i.return===null||i.return.tag!==13)?(r._visibility&=-3,wu(i)):fl(i);break;default:fl(i)}}function wu(i){var r=i.deletions;if((i.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var u=r[l];Pt=u,W_(u,i)}J_(i)}for(i=i.child;i!==null;){switch(r=i,r.tag){case 0:case 11:case 15:xs(8,r,r.return),wu(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,wu(r));break;default:wu(r)}i=i.sibling}}function W_(i,r){for(;Pt!==null;){var l=Pt;switch(l.tag){case 0:case 11:case 15:xs(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Xo(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Pt=u;else e:for(l=i;Pt!==null;){u=Pt;var f=u.sibling,v=u.return;if(F_(u),u===l){Pt=null;break e}if(f!==null){f.return=v,Pt=f;break e}Pt=v}}}var WC={getCacheForType:function(i){var r=rn(Dt),l=r.data.get(i);return l===void 0&&(l=i(),r.data.set(i,l)),l}},eT=typeof WeakMap=="function"?WeakMap:Map,qe=0,Ke=null,ke=null,Me=0,He=0,jn=null,Ds=!1,ka=!1,zf=!1,Xi=0,ht=0,ks=0,Er=0,Pf=0,Qn=0,Aa=0,gl=null,yn=null,qf=!1,Hf=0,Su=1/0,Eu=null,As=null,Kt=0,Rs=null,Ra=null,Oa=0,Ff=0,Yf=null,e0=null,pl=0,Vf=null;function Nn(){if((qe&2)!==0&&Me!==0)return Me&-Me;if(H.T!==null){var i=ya;return i!==0?i:Wf()}return _t()}function t0(){Qn===0&&(Qn=(Me&536870912)===0||Pe?Wr():536870912);var i=Gn.current;return i!==null&&(i.flags|=32),Qn}function Mn(i,r,l){(i===Ke&&(He===2||He===9)||i.cancelPendingCommit!==null)&&(La(i,0),Os(i,Me,Qn,!1)),st(i,l),((qe&2)===0||i!==Ke)&&(i===Ke&&((qe&2)===0&&(Er|=l),ht===4&&Os(i,Me,Qn,!1)),yi(i))}function n0(i,r,l){if((qe&6)!==0)throw Error(n(327));var u=!l&&(r&124)===0&&(r&i.expiredLanes)===0||ji(i,r),f=u?iT(i,r):Xf(i,r,!0),v=u;do{if(f===0){ka&&!u&&Os(i,r,0,!1);break}else{if(l=i.current.alternate,v&&!tT(l)){f=Xf(i,r,!1),v=!1;continue}if(f===2){if(v=r,i.errorRecoveryDisabledLanes&v)var b=0;else b=i.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){r=b;e:{var x=i;f=gl;var k=x.current.memoizedState.isDehydrated;if(k&&(La(x,b).flags|=256),b=Xf(x,b,!1),b!==2){if(zf&&!k){x.errorRecoveryDisabledLanes|=v,Er|=v,f=4;break e}v=yn,yn=f,v!==null&&(yn===null?yn=v:yn.push.apply(yn,v))}f=b}if(v=!1,f!==2)continue}}if(f===1){La(i,0),Os(i,r,0,!0);break}e:{switch(u=i,v=f,v){case 0:case 1:throw Error(n(345));case 4:if((r&4194048)!==r)break;case 6:Os(u,r,Qn,!Ds);break e;case 2:yn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((r&62914560)===r&&(f=Hf+300-Ct(),10<f)){if(Os(u,r,Qn,!Ds),Li(u,0,!0)!==0)break e;u.timeoutHandle=O0(i0.bind(null,u,l,yn,Eu,qf,r,Qn,Er,Aa,Ds,v,2,-0,0),f);break e}i0(u,l,yn,Eu,qf,r,Qn,Er,Aa,Ds,v,0,-0,0)}}break}while(!0);yi(i)}function i0(i,r,l,u,f,v,b,x,k,M,G,X,I,B){if(i.timeoutHandle=-1,X=r.subtreeFlags,(X&8192||(X&16785408)===16785408)&&(Sl={stylesheets:null,count:0,unsuspend:UT},K_(r),X=IT(),X!==null)){i.cancelPendingCommit=X(u0.bind(null,i,r,v,l,u,f,b,x,k,G,1,I,B)),Os(i,v,b,!M);return}u0(i,r,v,l,u,f,b,x,k)}function tT(i){for(var r=i;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var f=l[u],v=f.getSnapshot;f=f.value;try{if(!An(v(),f))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Os(i,r,l,u){r&=~Pf,r&=~Er,i.suspendedLanes|=r,i.pingedLanes&=~r,u&&(i.warmLanes|=r),u=i.expirationTimes;for(var f=r;0<f;){var v=31-ut(f),b=1<<v;u[v]=-1,f&=~b}l!==0&&Ut(i,l,r)}function xu(){return(qe&6)===0?(vl(0),!1):!0}function Gf(){if(ke!==null){if(He===0)var i=ke.return;else i=ke,Pi=mr=null,uf(i),xa=null,al=0,i=ke;for(;i!==null;)U_(i.alternate,i),i=i.return;ke=null}}function La(i,r){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,_T(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),Gf(),Ke=i,ke=l=Ii(i.current,null),Me=r,He=0,jn=null,Ds=!1,ka=ji(i,r),zf=!1,Aa=Qn=Pf=Er=ks=ht=0,yn=gl=null,qf=!1,(r&8)!==0&&(r|=r&32);var u=i.entangledLanes;if(u!==0)for(i=i.entanglements,u&=r;0<u;){var f=31-ut(u),v=1<<f;r|=i[f],u&=~v}return Xi=r,Vc(),l}function s0(i,r){Ee=null,H.H=du,r===Jo||r===tu?(r=wy(),He=3):r===yy?(r=wy(),He=4):He=r===S_?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,jn=r,ke===null&&(ht=1,vu(i,Hn(r,i.current)))}function r0(){var i=H.H;return H.H=du,i===null?du:i}function a0(){var i=H.A;return H.A=WC,i}function Qf(){ht=4,Ds||(Me&4194048)!==Me&&Gn.current!==null||(ka=!0),(ks&134217727)===0&&(Er&134217727)===0||Ke===null||Os(Ke,Me,Qn,!1)}function Xf(i,r,l){var u=qe;qe|=2;var f=r0(),v=a0();(Ke!==i||Me!==r)&&(Eu=null,La(i,r)),r=!1;var b=ht;e:do try{if(He!==0&&ke!==null){var x=ke,k=jn;switch(He){case 8:Gf(),b=6;break e;case 3:case 2:case 9:case 6:Gn.current===null&&(r=!0);var M=He;if(He=0,jn=null,ja(i,x,k,M),l&&ka){b=0;break e}break;default:M=He,He=0,jn=null,ja(i,x,k,M)}}nT(),b=ht;break}catch(G){s0(i,G)}while(!0);return r&&i.shellSuspendCounter++,Pi=mr=null,qe=u,H.H=f,H.A=v,ke===null&&(Ke=null,Me=0,Vc()),b}function nT(){for(;ke!==null;)o0(ke)}function iT(i,r){var l=qe;qe|=2;var u=r0(),f=a0();Ke!==i||Me!==r?(Eu=null,Su=Ct()+500,La(i,r)):ka=ji(i,r);e:do try{if(He!==0&&ke!==null){r=ke;var v=jn;t:switch(He){case 1:He=0,jn=null,ja(i,r,v,1);break;case 2:case 9:if(_y(v)){He=0,jn=null,l0(r);break}r=function(){He!==2&&He!==9||Ke!==i||(He=7),yi(i)},v.then(r,r);break e;case 3:He=7;break e;case 4:He=5;break e;case 7:_y(v)?(He=0,jn=null,l0(r)):(He=0,jn=null,ja(i,r,v,7));break;case 5:var b=null;switch(ke.tag){case 26:b=ke.memoizedState;case 5:case 27:var x=ke;if(!b||H0(b)){He=0,jn=null;var k=x.sibling;if(k!==null)ke=k;else{var M=x.return;M!==null?(ke=M,Cu(M)):ke=null}break t}}He=0,jn=null,ja(i,r,v,5);break;case 6:He=0,jn=null,ja(i,r,v,6);break;case 8:Gf(),ht=6;break e;default:throw Error(n(462))}}sT();break}catch(G){s0(i,G)}while(!0);return Pi=mr=null,H.H=u,H.A=f,qe=l,ke!==null?0:(Ke=null,Me=0,Vc(),ht)}function sT(){for(;ke!==null&&!xn();)o0(ke)}function o0(i){var r=N_(i.alternate,i,Xi);i.memoizedProps=i.pendingProps,r===null?Cu(i):ke=r}function l0(i){var r=i,l=r.alternate;switch(r.tag){case 15:case 0:r=k_(l,r,r.pendingProps,r.type,void 0,Me);break;case 11:r=k_(l,r,r.pendingProps,r.type.render,r.ref,Me);break;case 5:uf(r);default:U_(l,r),r=ke=cy(r,Xi),r=N_(l,r,Xi)}i.memoizedProps=i.pendingProps,r===null?Cu(i):ke=r}function ja(i,r,l,u){Pi=mr=null,uf(r),xa=null,al=0;var f=r.return;try{if(GC(i,f,r,l,Me)){ht=1,vu(i,Hn(l,i.current)),ke=null;return}}catch(v){if(f!==null)throw ke=f,v;ht=1,vu(i,Hn(l,i.current)),ke=null;return}r.flags&32768?(Pe||u===1?i=!0:ka||(Me&536870912)!==0?i=!1:(Ds=i=!0,(u===2||u===9||u===3||u===6)&&(u=Gn.current,u!==null&&u.tag===13&&(u.flags|=16384))),c0(r,i)):Cu(r)}function Cu(i){var r=i;do{if((r.flags&32768)!==0){c0(r,Ds);return}i=r.return;var l=XC(r.alternate,r,Xi);if(l!==null){ke=l;return}if(r=r.sibling,r!==null){ke=r;return}ke=r=i}while(r!==null);ht===0&&(ht=5)}function c0(i,r){do{var l=KC(i.alternate,i);if(l!==null){l.flags&=32767,ke=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(i=i.sibling,i!==null)){ke=i;return}ke=i=l}while(i!==null);ht=6,ke=null}function u0(i,r,l,u,f,v,b,x,k){i.cancelPendingCommit=null;do Tu();while(Kt!==0);if((qe&6)!==0)throw Error(n(327));if(r!==null){if(r===i.current)throw Error(n(177));if(v=r.lanes|r.childLanes,v|=Ih,Qt(i,l,v,b,x,k),i===Ke&&(ke=Ke=null,Me=0),Ra=r,Rs=i,Oa=l,Ff=v,Yf=f,e0=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,lT(ii,function(){return p0(),null})):(i.callbackNode=null,i.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=H.T,H.T=null,f=K.p,K.p=2,b=qe,qe|=4;try{JC(i,r,l)}finally{qe=b,K.p=f,H.T=u}}Kt=1,d0(),h0(),f0()}}function d0(){if(Kt===1){Kt=0;var i=Rs,r=Ra,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=H.T,H.T=null;var u=K.p;K.p=2;var f=qe;qe|=4;try{G_(r,i);var v=og,b=Wm(i.containerInfo),x=v.focusedElem,k=v.selectionRange;if(b!==x&&x&&x.ownerDocument&&Zm(x.ownerDocument.documentElement,x)){if(k!==null&&jh(x)){var M=k.start,G=k.end;if(G===void 0&&(G=M),"selectionStart"in x)x.selectionStart=M,x.selectionEnd=Math.min(G,x.value.length);else{var X=x.ownerDocument||document,I=X&&X.defaultView||window;if(I.getSelection){var B=I.getSelection(),ve=x.textContent.length,he=Math.min(k.start,ve),Ve=k.end===void 0?he:Math.min(k.end,ve);!B.extend&&he>Ve&&(b=Ve,Ve=he,he=b);var j=Jm(x,he),R=Jm(x,Ve);if(j&&R&&(B.rangeCount!==1||B.anchorNode!==j.node||B.anchorOffset!==j.offset||B.focusNode!==R.node||B.focusOffset!==R.offset)){var N=X.createRange();N.setStart(j.node,j.offset),B.removeAllRanges(),he>Ve?(B.addRange(N),B.extend(R.node,R.offset)):(N.setEnd(R.node,R.offset),B.addRange(N))}}}}for(X=[],B=x;B=B.parentNode;)B.nodeType===1&&X.push({element:B,left:B.scrollLeft,top:B.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<X.length;x++){var Q=X[x];Q.element.scrollLeft=Q.left,Q.element.scrollTop=Q.top}}Iu=!!ag,og=ag=null}finally{qe=f,K.p=u,H.T=l}}i.current=r,Kt=2}}function h0(){if(Kt===2){Kt=0;var i=Rs,r=Ra,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=H.T,H.T=null;var u=K.p;K.p=2;var f=qe;qe|=4;try{H_(i,r.alternate,r)}finally{qe=f,K.p=u,H.T=l}}Kt=3}}function f0(){if(Kt===4||Kt===3){Kt=0,Cn();var i=Rs,r=Ra,l=Oa,u=e0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Kt=5:(Kt=0,Ra=Rs=null,g0(i,i.pendingLanes));var f=i.pendingLanes;if(f===0&&(As=null),se(l),r=r.stateNode,Qe&&typeof Qe.onCommitFiberRoot=="function")try{Qe.onCommitFiberRoot(gn,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=H.T,f=K.p,K.p=2,H.T=null;try{for(var v=i.onRecoverableError,b=0;b<u.length;b++){var x=u[b];v(x.value,{componentStack:x.stack})}}finally{H.T=r,K.p=f}}(Oa&3)!==0&&Tu(),yi(i),f=i.pendingLanes,(l&4194090)!==0&&(f&42)!==0?i===Vf?pl++:(pl=0,Vf=i):pl=0,vl(0)}}function g0(i,r){(i.pooledCacheLanes&=r)===0&&(r=i.pooledCache,r!=null&&(i.pooledCache=null,Xo(r)))}function Tu(i){return d0(),h0(),f0(),p0()}function p0(){if(Kt!==5)return!1;var i=Rs,r=Ff;Ff=0;var l=se(Oa),u=H.T,f=K.p;try{K.p=32>l?32:l,H.T=null,l=Yf,Yf=null;var v=Rs,b=Oa;if(Kt=0,Ra=Rs=null,Oa=0,(qe&6)!==0)throw Error(n(331));var x=qe;if(qe|=4,Z_(v.current),X_(v,v.current,b,l),qe=x,vl(0,!1),Qe&&typeof Qe.onPostCommitFiberRoot=="function")try{Qe.onPostCommitFiberRoot(gn,v)}catch{}return!0}finally{K.p=f,H.T=u,g0(i,r)}}function v0(i,r,l){r=Hn(l,r),r=xf(i.stateNode,r,2),i=bs(i,r,2),i!==null&&(st(i,2),yi(i))}function Xe(i,r,l){if(i.tag===3)v0(i,i,l);else for(;r!==null;){if(r.tag===3){v0(r,i,l);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(As===null||!As.has(u))){i=Hn(l,i),l=b_(2),u=bs(r,l,2),u!==null&&(w_(l,u,r,i),st(u,2),yi(u));break}}r=r.return}}function Kf(i,r,l){var u=i.pingCache;if(u===null){u=i.pingCache=new eT;var f=new Set;u.set(r,f)}else f=u.get(r),f===void 0&&(f=new Set,u.set(r,f));f.has(l)||(zf=!0,f.add(l),i=rT.bind(null,i,r,l),r.then(i,i))}function rT(i,r,l){var u=i.pingCache;u!==null&&u.delete(r),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,Ke===i&&(Me&l)===l&&(ht===4||ht===3&&(Me&62914560)===Me&&300>Ct()-Hf?(qe&2)===0&&La(i,0):Pf|=l,Aa===Me&&(Aa=0)),yi(i)}function m0(i,r){r===0&&(r=ea()),i=ga(i,r),i!==null&&(st(i,r),yi(i))}function aT(i){var r=i.memoizedState,l=0;r!==null&&(l=r.retryLane),m0(i,l)}function oT(i,r){var l=0;switch(i.tag){case 13:var u=i.stateNode,f=i.memoizedState;f!==null&&(l=f.retryLane);break;case 19:u=i.stateNode;break;case 22:u=i.stateNode._retryCache;break;default:throw Error(n(314))}u!==null&&u.delete(r),m0(i,l)}function lT(i,r){return nn(i,r)}var Du=null,Na=null,Jf=!1,ku=!1,Zf=!1,xr=0;function yi(i){i!==Na&&i.next===null&&(Na===null?Du=Na=i:Na=Na.next=i),ku=!0,Jf||(Jf=!0,uT())}function vl(i,r){if(!Zf&&ku){Zf=!0;do for(var l=!1,u=Du;u!==null;){if(i!==0){var f=u.pendingLanes;if(f===0)var v=0;else{var b=u.suspendedLanes,x=u.pingedLanes;v=(1<<31-ut(42|i)+1)-1,v&=f&~(b&~x),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,w0(u,v))}else v=Me,v=Li(u,u===Ke?v:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(v&3)===0||ji(u,v)||(l=!0,w0(u,v));u=u.next}while(l);Zf=!1}}function cT(){y0()}function y0(){ku=Jf=!1;var i=0;xr!==0&&(yT()&&(i=xr),xr=0);for(var r=Ct(),l=null,u=Du;u!==null;){var f=u.next,v=_0(u,r);v===0?(u.next=null,l===null?Du=f:l.next=f,f===null&&(Na=l)):(l=u,(i!==0||(v&3)!==0)&&(ku=!0)),u=f}vl(i)}function _0(i,r){for(var l=i.suspendedLanes,u=i.pingedLanes,f=i.expirationTimes,v=i.pendingLanes&-62914561;0<v;){var b=31-ut(v),x=1<<b,k=f[b];k===-1?((x&l)===0||(x&u)!==0)&&(f[b]=Zr(x,r)):k<=r&&(i.expiredLanes|=x),v&=~x}if(r=Ke,l=Me,l=Li(i,i===r?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u=i.callbackNode,l===0||i===r&&(He===2||He===9)||i.cancelPendingCommit!==null)return u!==null&&u!==null&&Mt(u),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||ji(i,l)){if(r=l&-l,r===i.callbackPriority)return r;switch(u!==null&&Mt(u),se(l)){case 2:case 8:l=Tn;break;case 32:l=ii;break;case 268435456:l=hs;break;default:l=ii}return u=b0.bind(null,i),l=nn(l,u),i.callbackPriority=r,i.callbackNode=l,r}return u!==null&&u!==null&&Mt(u),i.callbackPriority=2,i.callbackNode=null,2}function b0(i,r){if(Kt!==0&&Kt!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(Tu()&&i.callbackNode!==l)return null;var u=Me;return u=Li(i,i===Ke?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u===0?null:(n0(i,u,r),_0(i,Ct()),i.callbackNode!=null&&i.callbackNode===l?b0.bind(null,i):null)}function w0(i,r){if(Tu())return null;n0(i,r,!0)}function uT(){bT(function(){(qe&6)!==0?nn(ds,cT):y0()})}function Wf(){return xr===0&&(xr=Wr()),xr}function S0(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Bc(""+i)}function E0(i,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,i.id&&l.setAttribute("form",i.id),r.parentNode.insertBefore(l,r),i=new FormData(i),l.parentNode.removeChild(l),i}function dT(i,r,l,u,f){if(r==="submit"&&l&&l.stateNode===f){var v=S0((f[et]||null).action),b=u.submitter;b&&(r=(r=b[et]||null)?S0(r.formAction):b.getAttribute("formAction"),r!==null&&(v=r,b=null));var x=new Hc("action","action",null,u,f);i.push({event:x,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(xr!==0){var k=b?E0(f,b):new FormData(f);_f(l,{pending:!0,data:k,method:f.method,action:v},null,k)}}else typeof v=="function"&&(x.preventDefault(),k=b?E0(f,b):new FormData(f),_f(l,{pending:!0,data:k,method:f.method,action:v},v,k))},currentTarget:f}]})}}for(var eg=0;eg<$h.length;eg++){var tg=$h[eg],hT=tg.toLowerCase(),fT=tg[0].toUpperCase()+tg.slice(1);si(hT,"on"+fT)}si(ny,"onAnimationEnd"),si(iy,"onAnimationIteration"),si(sy,"onAnimationStart"),si("dblclick","onDoubleClick"),si("focusin","onFocus"),si("focusout","onBlur"),si(RC,"onTransitionRun"),si(OC,"onTransitionStart"),si(LC,"onTransitionCancel"),si(ry,"onTransitionEnd"),sa("onMouseEnter",["mouseout","mouseover"]),sa("onMouseLeave",["mouseout","mouseover"]),sa("onPointerEnter",["pointerout","pointerover"]),sa("onPointerLeave",["pointerout","pointerover"]),lr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),lr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),lr("onBeforeInput",["compositionend","keypress","textInput","paste"]),lr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),lr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),lr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ml));function x0(i,r){r=(r&4)!==0;for(var l=0;l<i.length;l++){var u=i[l],f=u.event;u=u.listeners;e:{var v=void 0;if(r)for(var b=u.length-1;0<=b;b--){var x=u[b],k=x.instance,M=x.currentTarget;if(x=x.listener,k!==v&&f.isPropagationStopped())break e;v=x,f.currentTarget=M;try{v(f)}catch(G){pu(G)}f.currentTarget=null,v=k}else for(b=0;b<u.length;b++){if(x=u[b],k=x.instance,M=x.currentTarget,x=x.listener,k!==v&&f.isPropagationStopped())break e;v=x,f.currentTarget=M;try{v(f)}catch(G){pu(G)}f.currentTarget=null,v=k}}}}function Ae(i,r){var l=r[Ni];l===void 0&&(l=r[Ni]=new Set);var u=i+"__bubble";l.has(u)||(C0(r,i,2,!1),l.add(u))}function ng(i,r,l){var u=0;r&&(u|=4),C0(l,i,u,r)}var Au="_reactListening"+Math.random().toString(36).slice(2);function ig(i){if(!i[Au]){i[Au]=!0,ym.forEach(function(l){l!=="selectionchange"&&(gT.has(l)||ng(l,!1,i),ng(l,!0,i))});var r=i.nodeType===9?i:i.ownerDocument;r===null||r[Au]||(r[Au]=!0,ng("selectionchange",!1,r))}}function C0(i,r,l,u){switch(X0(r)){case 2:var f=PT;break;case 8:f=qT;break;default:f=mg}l=f.bind(null,r,l,i),f=void 0,!xh||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),u?f!==void 0?i.addEventListener(r,l,{capture:!0,passive:f}):i.addEventListener(r,l,!0):f!==void 0?i.addEventListener(r,l,{passive:f}):i.addEventListener(r,l,!1)}function sg(i,r,l,u,f){var v=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var x=u.stateNode.containerInfo;if(x===f)break;if(b===4)for(b=u.return;b!==null;){var k=b.tag;if((k===3||k===4)&&b.stateNode.containerInfo===f)return;b=b.return}for(;x!==null;){if(b=ta(x),b===null)return;if(k=b.tag,k===5||k===6||k===26||k===27){u=v=b;continue e}x=x.parentNode}}u=u.return}Lm(function(){var M=v,G=Sh(l),X=[];e:{var I=ay.get(i);if(I!==void 0){var B=Hc,ve=i;switch(i){case"keypress":if(Pc(l)===0)break e;case"keydown":case"keyup":B=lC;break;case"focusin":ve="focus",B=kh;break;case"focusout":ve="blur",B=kh;break;case"beforeblur":case"afterblur":B=kh;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":B=Mm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":B=K1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":B=dC;break;case ny:case iy:case sy:B=W1;break;case ry:B=fC;break;case"scroll":case"scrollend":B=Q1;break;case"wheel":B=pC;break;case"copy":case"cut":case"paste":B=tC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":B=$m;break;case"toggle":case"beforetoggle":B=mC}var he=(r&4)!==0,Ve=!he&&(i==="scroll"||i==="scrollend"),j=he?I!==null?I+"Capture":null:I;he=[];for(var R=M,N;R!==null;){var Q=R;if(N=Q.stateNode,Q=Q.tag,Q!==5&&Q!==26&&Q!==27||N===null||j===null||(Q=Uo(R,j),Q!=null&&he.push(yl(R,Q,N))),Ve)break;R=R.return}0<he.length&&(I=new B(I,ve,null,l,G),X.push({event:I,listeners:he}))}}if((r&7)===0){e:{if(I=i==="mouseover"||i==="pointerover",B=i==="mouseout"||i==="pointerout",I&&l!==wh&&(ve=l.relatedTarget||l.fromElement)&&(ta(ve)||ve[sn]))break e;if((B||I)&&(I=G.window===G?G:(I=G.ownerDocument)?I.defaultView||I.parentWindow:window,B?(ve=l.relatedTarget||l.toElement,B=M,ve=ve?ta(ve):null,ve!==null&&(Ve=o(ve),he=ve.tag,ve!==Ve||he!==5&&he!==27&&he!==6)&&(ve=null)):(B=null,ve=M),B!==ve)){if(he=Mm,Q="onMouseLeave",j="onMouseEnter",R="mouse",(i==="pointerout"||i==="pointerover")&&(he=$m,Q="onPointerLeave",j="onPointerEnter",R="pointer"),Ve=B==null?I:Mo(B),N=ve==null?I:Mo(ve),I=new he(Q,R+"leave",B,l,G),I.target=Ve,I.relatedTarget=N,Q=null,ta(G)===M&&(he=new he(j,R+"enter",ve,l,G),he.target=N,he.relatedTarget=Ve,Q=he),Ve=Q,B&&ve)t:{for(he=B,j=ve,R=0,N=he;N;N=Ma(N))R++;for(N=0,Q=j;Q;Q=Ma(Q))N++;for(;0<R-N;)he=Ma(he),R--;for(;0<N-R;)j=Ma(j),N--;for(;R--;){if(he===j||j!==null&&he===j.alternate)break t;he=Ma(he),j=Ma(j)}he=null}else he=null;B!==null&&T0(X,I,B,he,!1),ve!==null&&Ve!==null&&T0(X,Ve,ve,he,!0)}}e:{if(I=M?Mo(M):window,B=I.nodeName&&I.nodeName.toLowerCase(),B==="select"||B==="input"&&I.type==="file")var le=Ym;else if(Hm(I))if(Vm)le=DC;else{le=CC;var Te=xC}else B=I.nodeName,!B||B.toLowerCase()!=="input"||I.type!=="checkbox"&&I.type!=="radio"?M&&bh(M.elementType)&&(le=Ym):le=TC;if(le&&(le=le(i,M))){Fm(X,le,l,G);break e}Te&&Te(i,I,M),i==="focusout"&&M&&I.type==="number"&&M.memoizedProps.value!=null&&_h(I,"number",I.value)}switch(Te=M?Mo(M):window,i){case"focusin":(Hm(Te)||Te.contentEditable==="true")&&(da=Te,Nh=M,Fo=null);break;case"focusout":Fo=Nh=da=null;break;case"mousedown":Mh=!0;break;case"contextmenu":case"mouseup":case"dragend":Mh=!1,ey(X,l,G);break;case"selectionchange":if(AC)break;case"keydown":case"keyup":ey(X,l,G)}var ue;if(Rh)e:{switch(i){case"compositionstart":var pe="onCompositionStart";break e;case"compositionend":pe="onCompositionEnd";break e;case"compositionupdate":pe="onCompositionUpdate";break e}pe=void 0}else ua?Pm(i,l)&&(pe="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(pe="onCompositionStart");pe&&(Im&&l.locale!=="ko"&&(ua||pe!=="onCompositionStart"?pe==="onCompositionEnd"&&ua&&(ue=jm()):(vs=G,Ch="value"in vs?vs.value:vs.textContent,ua=!0)),Te=Ru(M,pe),0<Te.length&&(pe=new Um(pe,i,null,l,G),X.push({event:pe,listeners:Te}),ue?pe.data=ue:(ue=qm(l),ue!==null&&(pe.data=ue)))),(ue=_C?bC(i,l):wC(i,l))&&(pe=Ru(M,"onBeforeInput"),0<pe.length&&(Te=new Um("onBeforeInput","beforeinput",null,l,G),X.push({event:Te,listeners:pe}),Te.data=ue)),dT(X,i,M,l,G)}x0(X,r)})}function yl(i,r,l){return{instance:i,listener:r,currentTarget:l}}function Ru(i,r){for(var l=r+"Capture",u=[];i!==null;){var f=i,v=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||v===null||(f=Uo(i,l),f!=null&&u.unshift(yl(i,f,v)),f=Uo(i,r),f!=null&&u.push(yl(i,f,v))),i.tag===3)return u;i=i.return}return[]}function Ma(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function T0(i,r,l,u,f){for(var v=r._reactName,b=[];l!==null&&l!==u;){var x=l,k=x.alternate,M=x.stateNode;if(x=x.tag,k!==null&&k===u)break;x!==5&&x!==26&&x!==27||M===null||(k=M,f?(M=Uo(l,v),M!=null&&b.unshift(yl(l,M,k))):f||(M=Uo(l,v),M!=null&&b.push(yl(l,M,k)))),l=l.return}b.length!==0&&i.push({event:r,listeners:b})}var pT=/\r\n?/g,vT=/\u0000|\uFFFD/g;function D0(i){return(typeof i=="string"?i:""+i).replace(pT,`
`).replace(vT,"")}function k0(i,r){return r=D0(r),D0(i)===r}function Ou(){}function Ye(i,r,l,u,f,v){switch(l){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||oa(i,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&oa(i,""+u);break;case"className":Uc(i,"class",u);break;case"tabIndex":Uc(i,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Uc(i,l,u);break;case"style":Rm(i,u,v);break;case"data":if(r!=="object"){Uc(i,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||l!=="href")){i.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=Bc(""+u),i.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(r!=="input"&&Ye(i,r,"name",f.name,f,null),Ye(i,r,"formEncType",f.formEncType,f,null),Ye(i,r,"formMethod",f.formMethod,f,null),Ye(i,r,"formTarget",f.formTarget,f,null)):(Ye(i,r,"encType",f.encType,f,null),Ye(i,r,"method",f.method,f,null),Ye(i,r,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=Bc(""+u),i.setAttribute(l,u);break;case"onClick":u!=null&&(i.onclick=Ou);break;case"onScroll":u!=null&&Ae("scroll",i);break;case"onScrollEnd":u!=null&&Ae("scrollend",i);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(n(60));i.innerHTML=l}}break;case"multiple":i.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":i.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){i.removeAttribute("xlink:href");break}l=Bc(""+u),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""+u):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":u===!0?i.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,u):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?i.setAttribute(l,u):i.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?i.removeAttribute(l):i.setAttribute(l,u);break;case"popover":Ae("beforetoggle",i),Ae("toggle",i),Mc(i,"popover",u);break;case"xlinkActuate":Ui(i,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ui(i,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ui(i,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ui(i,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ui(i,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ui(i,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ui(i,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ui(i,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ui(i,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Mc(i,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=V1.get(l)||l,Mc(i,l,u))}}function rg(i,r,l,u,f,v){switch(l){case"style":Rm(i,u,v);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(n(60));i.innerHTML=l}}break;case"children":typeof u=="string"?oa(i,u):(typeof u=="number"||typeof u=="bigint")&&oa(i,""+u);break;case"onScroll":u!=null&&Ae("scroll",i);break;case"onScrollEnd":u!=null&&Ae("scrollend",i);break;case"onClick":u!=null&&(i.onclick=Ou);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_m.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),r=l.slice(2,f?l.length-7:void 0),v=i[et]||null,v=v!=null?v[l]:null,typeof v=="function"&&i.removeEventListener(r,v,f),typeof u=="function")){typeof v!="function"&&v!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(r,u,f);break e}l in i?i[l]=u:u===!0?i.setAttribute(l,""):Mc(i,l,u)}}}function Jt(i,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ae("error",i),Ae("load",i);var u=!1,f=!1,v;for(v in l)if(l.hasOwnProperty(v)){var b=l[v];if(b!=null)switch(v){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,r));default:Ye(i,r,v,b,l,null)}}f&&Ye(i,r,"srcSet",l.srcSet,l,null),u&&Ye(i,r,"src",l.src,l,null);return;case"input":Ae("invalid",i);var x=v=b=f=null,k=null,M=null;for(u in l)if(l.hasOwnProperty(u)){var G=l[u];if(G!=null)switch(u){case"name":f=G;break;case"type":b=G;break;case"checked":k=G;break;case"defaultChecked":M=G;break;case"value":v=G;break;case"defaultValue":x=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(n(137,r));break;default:Ye(i,r,u,G,l,null)}}Tm(i,v,x,k,M,b,f,!1),$c(i);return;case"select":Ae("invalid",i),u=b=v=null;for(f in l)if(l.hasOwnProperty(f)&&(x=l[f],x!=null))switch(f){case"value":v=x;break;case"defaultValue":b=x;break;case"multiple":u=x;default:Ye(i,r,f,x,l,null)}r=v,l=b,i.multiple=!!u,r!=null?aa(i,!!u,r,!1):l!=null&&aa(i,!!u,l,!0);return;case"textarea":Ae("invalid",i),v=f=u=null;for(b in l)if(l.hasOwnProperty(b)&&(x=l[b],x!=null))switch(b){case"value":u=x;break;case"defaultValue":f=x;break;case"children":v=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(n(91));break;default:Ye(i,r,b,x,l,null)}km(i,u,f,v),$c(i);return;case"option":for(k in l)if(l.hasOwnProperty(k)&&(u=l[k],u!=null))switch(k){case"selected":i.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Ye(i,r,k,u,l,null)}return;case"dialog":Ae("beforetoggle",i),Ae("toggle",i),Ae("cancel",i),Ae("close",i);break;case"iframe":case"object":Ae("load",i);break;case"video":case"audio":for(u=0;u<ml.length;u++)Ae(ml[u],i);break;case"image":Ae("error",i),Ae("load",i);break;case"details":Ae("toggle",i);break;case"embed":case"source":case"link":Ae("error",i),Ae("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(M in l)if(l.hasOwnProperty(M)&&(u=l[M],u!=null))switch(M){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,r));default:Ye(i,r,M,u,l,null)}return;default:if(bh(r)){for(G in l)l.hasOwnProperty(G)&&(u=l[G],u!==void 0&&rg(i,r,G,u,l,void 0));return}}for(x in l)l.hasOwnProperty(x)&&(u=l[x],u!=null&&Ye(i,r,x,u,l,null))}function mT(i,r,l,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,v=null,b=null,x=null,k=null,M=null,G=null;for(B in l){var X=l[B];if(l.hasOwnProperty(B)&&X!=null)switch(B){case"checked":break;case"value":break;case"defaultValue":k=X;default:u.hasOwnProperty(B)||Ye(i,r,B,null,u,X)}}for(var I in u){var B=u[I];if(X=l[I],u.hasOwnProperty(I)&&(B!=null||X!=null))switch(I){case"type":v=B;break;case"name":f=B;break;case"checked":M=B;break;case"defaultChecked":G=B;break;case"value":b=B;break;case"defaultValue":x=B;break;case"children":case"dangerouslySetInnerHTML":if(B!=null)throw Error(n(137,r));break;default:B!==X&&Ye(i,r,I,B,u,X)}}yh(i,b,x,k,M,G,v,f);return;case"select":B=b=x=I=null;for(v in l)if(k=l[v],l.hasOwnProperty(v)&&k!=null)switch(v){case"value":break;case"multiple":B=k;default:u.hasOwnProperty(v)||Ye(i,r,v,null,u,k)}for(f in u)if(v=u[f],k=l[f],u.hasOwnProperty(f)&&(v!=null||k!=null))switch(f){case"value":I=v;break;case"defaultValue":x=v;break;case"multiple":b=v;default:v!==k&&Ye(i,r,f,v,u,k)}r=x,l=b,u=B,I!=null?aa(i,!!l,I,!1):!!u!=!!l&&(r!=null?aa(i,!!l,r,!0):aa(i,!!l,l?[]:"",!1));return;case"textarea":B=I=null;for(x in l)if(f=l[x],l.hasOwnProperty(x)&&f!=null&&!u.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:Ye(i,r,x,null,u,f)}for(b in u)if(f=u[b],v=l[b],u.hasOwnProperty(b)&&(f!=null||v!=null))switch(b){case"value":I=f;break;case"defaultValue":B=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(n(91));break;default:f!==v&&Ye(i,r,b,f,u,v)}Dm(i,I,B);return;case"option":for(var ve in l)if(I=l[ve],l.hasOwnProperty(ve)&&I!=null&&!u.hasOwnProperty(ve))switch(ve){case"selected":i.selected=!1;break;default:Ye(i,r,ve,null,u,I)}for(k in u)if(I=u[k],B=l[k],u.hasOwnProperty(k)&&I!==B&&(I!=null||B!=null))switch(k){case"selected":i.selected=I&&typeof I!="function"&&typeof I!="symbol";break;default:Ye(i,r,k,I,u,B)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var he in l)I=l[he],l.hasOwnProperty(he)&&I!=null&&!u.hasOwnProperty(he)&&Ye(i,r,he,null,u,I);for(M in u)if(I=u[M],B=l[M],u.hasOwnProperty(M)&&I!==B&&(I!=null||B!=null))switch(M){case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(137,r));break;default:Ye(i,r,M,I,u,B)}return;default:if(bh(r)){for(var Ve in l)I=l[Ve],l.hasOwnProperty(Ve)&&I!==void 0&&!u.hasOwnProperty(Ve)&&rg(i,r,Ve,void 0,u,I);for(G in u)I=u[G],B=l[G],!u.hasOwnProperty(G)||I===B||I===void 0&&B===void 0||rg(i,r,G,I,u,B);return}}for(var j in l)I=l[j],l.hasOwnProperty(j)&&I!=null&&!u.hasOwnProperty(j)&&Ye(i,r,j,null,u,I);for(X in u)I=u[X],B=l[X],!u.hasOwnProperty(X)||I===B||I==null&&B==null||Ye(i,r,X,I,u,B)}var ag=null,og=null;function Lu(i){return i.nodeType===9?i:i.ownerDocument}function A0(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function R0(i,r){if(i===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&r==="foreignObject"?0:i}function lg(i,r){return i==="textarea"||i==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var cg=null;function yT(){var i=window.event;return i&&i.type==="popstate"?i===cg?!1:(cg=i,!0):(cg=null,!1)}var O0=typeof setTimeout=="function"?setTimeout:void 0,_T=typeof clearTimeout=="function"?clearTimeout:void 0,L0=typeof Promise=="function"?Promise:void 0,bT=typeof queueMicrotask=="function"?queueMicrotask:typeof L0<"u"?function(i){return L0.resolve(null).then(i).catch(wT)}:O0;function wT(i){setTimeout(function(){throw i})}function Ls(i){return i==="head"}function j0(i,r){var l=r,u=0,f=0;do{var v=l.nextSibling;if(i.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<u&&8>u){l=u;var b=i.ownerDocument;if(l&1&&_l(b.documentElement),l&2&&_l(b.body),l&4)for(l=b.head,_l(l),b=l.firstChild;b;){var x=b.nextSibling,k=b.nodeName;b[Mi]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&b.rel.toLowerCase()==="stylesheet"||l.removeChild(b),b=x}}if(f===0){i.removeChild(v),Dl(r);return}f--}else l==="$"||l==="$?"||l==="$!"?f++:u=l.charCodeAt(0)-48;else u=0;l=v}while(l);Dl(r)}function ug(i){var r=i.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":ug(l),gh(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function ST(i,r,l,u){for(;i.nodeType===1;){var f=l;if(i.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(u){if(!i[Mi])switch(r){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(v=i.getAttribute("rel"),v==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(v!==f.rel||i.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||i.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||i.getAttribute("title")!==(f.title==null?null:f.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(v=i.getAttribute("src"),(v!==(f.src==null?null:f.src)||i.getAttribute("type")!==(f.type==null?null:f.type)||i.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&v&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(r==="input"&&i.type==="hidden"){var v=f.name==null?null:""+f.name;if(f.type==="hidden"&&i.getAttribute("name")===v)return i}else return i;if(i=ai(i.nextSibling),i===null)break}return null}function ET(i,r,l){if(r==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=ai(i.nextSibling),i===null))return null;return i}function dg(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function xT(i,r){var l=i.ownerDocument;if(i.data!=="$?"||l.readyState==="complete")r();else{var u=function(){r(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),i._reactRetry=u}}function ai(i){for(;i!=null;i=i.nextSibling){var r=i.nodeType;if(r===1||r===3)break;if(r===8){if(r=i.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return i}var hg=null;function N0(i){i=i.previousSibling;for(var r=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return i;r--}else l==="/$"&&r++}i=i.previousSibling}return null}function M0(i,r,l){switch(r=Lu(l),i){case"html":if(i=r.documentElement,!i)throw Error(n(452));return i;case"head":if(i=r.head,!i)throw Error(n(453));return i;case"body":if(i=r.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function _l(i){for(var r=i.attributes;r.length;)i.removeAttributeNode(r[0]);gh(i)}var Xn=new Map,U0=new Set;function ju(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ki=K.d;K.d={f:CT,r:TT,D:DT,C:kT,L:AT,m:RT,X:LT,S:OT,M:jT};function CT(){var i=Ki.f(),r=xu();return i||r}function TT(i){var r=na(i);r!==null&&r.tag===5&&r.type==="form"?n_(r):Ki.r(i)}var Ua=typeof document>"u"?null:document;function $0(i,r,l){var u=Ua;if(u&&typeof r=="string"&&r){var f=qn(r);f='link[rel="'+i+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),U0.has(f)||(U0.add(f),i={rel:i,crossOrigin:l,href:r},u.querySelector(f)===null&&(r=u.createElement("link"),Jt(r,"link",i),Bt(r),u.head.appendChild(r)))}}function DT(i){Ki.D(i),$0("dns-prefetch",i,null)}function kT(i,r){Ki.C(i,r),$0("preconnect",i,r)}function AT(i,r,l){Ki.L(i,r,l);var u=Ua;if(u&&i&&r){var f='link[rel="preload"][as="'+qn(r)+'"]';r==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+qn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+qn(l.imageSizes)+'"]')):f+='[href="'+qn(i)+'"]';var v=f;switch(r){case"style":v=$a(i);break;case"script":v=Ia(i)}Xn.has(v)||(i=p({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:i,as:r},l),Xn.set(v,i),u.querySelector(f)!==null||r==="style"&&u.querySelector(bl(v))||r==="script"&&u.querySelector(wl(v))||(r=u.createElement("link"),Jt(r,"link",i),Bt(r),u.head.appendChild(r)))}}function RT(i,r){Ki.m(i,r);var l=Ua;if(l&&i){var u=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+qn(u)+'"][href="'+qn(i)+'"]',v=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Ia(i)}if(!Xn.has(v)&&(i=p({rel:"modulepreload",href:i},r),Xn.set(v,i),l.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(wl(v)))return}u=l.createElement("link"),Jt(u,"link",i),Bt(u),l.head.appendChild(u)}}}function OT(i,r,l){Ki.S(i,r,l);var u=Ua;if(u&&i){var f=ia(u).hoistableStyles,v=$a(i);r=r||"default";var b=f.get(v);if(!b){var x={loading:0,preload:null};if(b=u.querySelector(bl(v)))x.loading=5;else{i=p({rel:"stylesheet",href:i,"data-precedence":r},l),(l=Xn.get(v))&&fg(i,l);var k=b=u.createElement("link");Bt(k),Jt(k,"link",i),k._p=new Promise(function(M,G){k.onload=M,k.onerror=G}),k.addEventListener("load",function(){x.loading|=1}),k.addEventListener("error",function(){x.loading|=2}),x.loading|=4,Nu(b,r,u)}b={type:"stylesheet",instance:b,count:1,state:x},f.set(v,b)}}}function LT(i,r){Ki.X(i,r);var l=Ua;if(l&&i){var u=ia(l).hoistableScripts,f=Ia(i),v=u.get(f);v||(v=l.querySelector(wl(f)),v||(i=p({src:i,async:!0},r),(r=Xn.get(f))&&gg(i,r),v=l.createElement("script"),Bt(v),Jt(v,"link",i),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(f,v))}}function jT(i,r){Ki.M(i,r);var l=Ua;if(l&&i){var u=ia(l).hoistableScripts,f=Ia(i),v=u.get(f);v||(v=l.querySelector(wl(f)),v||(i=p({src:i,async:!0,type:"module"},r),(r=Xn.get(f))&&gg(i,r),v=l.createElement("script"),Bt(v),Jt(v,"link",i),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(f,v))}}function I0(i,r,l,u){var f=(f=ne.current)?ju(f):null;if(!f)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=$a(l.href),l=ia(f).hoistableStyles,u=l.get(r),u||(u={type:"style",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=$a(l.href);var v=ia(f).hoistableStyles,b=v.get(i);if(b||(f=f.ownerDocument||f,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(i,b),(v=f.querySelector(bl(i)))&&!v._p&&(b.instance=v,b.state.loading=5),Xn.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Xn.set(i,l),v||NT(f,i,l,b.state))),r&&u===null)throw Error(n(528,""));return b}if(r&&u!==null)throw Error(n(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Ia(l),l=ia(f).hoistableScripts,u=l.get(r),u||(u={type:"script",instance:null,count:0,state:null},l.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function $a(i){return'href="'+qn(i)+'"'}function bl(i){return'link[rel="stylesheet"]['+i+"]"}function B0(i){return p({},i,{"data-precedence":i.precedence,precedence:null})}function NT(i,r,l,u){i.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=i.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),Jt(r,"link",l),Bt(r),i.head.appendChild(r))}function Ia(i){return'[src="'+qn(i)+'"]'}function wl(i){return"script[async]"+i}function z0(i,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var u=i.querySelector('style[data-href~="'+qn(l.href)+'"]');if(u)return r.instance=u,Bt(u),u;var f=p({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(i.ownerDocument||i).createElement("style"),Bt(u),Jt(u,"style",f),Nu(u,l.precedence,i),r.instance=u;case"stylesheet":f=$a(l.href);var v=i.querySelector(bl(f));if(v)return r.state.loading|=4,r.instance=v,Bt(v),v;u=B0(l),(f=Xn.get(f))&&fg(u,f),v=(i.ownerDocument||i).createElement("link"),Bt(v);var b=v;return b._p=new Promise(function(x,k){b.onload=x,b.onerror=k}),Jt(v,"link",u),r.state.loading|=4,Nu(v,l.precedence,i),r.instance=v;case"script":return v=Ia(l.src),(f=i.querySelector(wl(v)))?(r.instance=f,Bt(f),f):(u=l,(f=Xn.get(v))&&(u=p({},l),gg(u,f)),i=i.ownerDocument||i,f=i.createElement("script"),Bt(f),Jt(f,"link",u),i.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(n(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Nu(u,l.precedence,i));return r.instance}function Nu(i,r,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,v=f,b=0;b<u.length;b++){var x=u[b];if(x.dataset.precedence===r)v=x;else if(v!==f)break}v?v.parentNode.insertBefore(i,v.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(i,r.firstChild))}function fg(i,r){i.crossOrigin==null&&(i.crossOrigin=r.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=r.referrerPolicy),i.title==null&&(i.title=r.title)}function gg(i,r){i.crossOrigin==null&&(i.crossOrigin=r.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=r.referrerPolicy),i.integrity==null&&(i.integrity=r.integrity)}var Mu=null;function P0(i,r,l){if(Mu===null){var u=new Map,f=Mu=new Map;f.set(l,u)}else f=Mu,u=f.get(l),u||(u=new Map,f.set(l,u));if(u.has(i))return u;for(u.set(i,null),l=l.getElementsByTagName(i),f=0;f<l.length;f++){var v=l[f];if(!(v[Mi]||v[Ie]||i==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var b=v.getAttribute(r)||"";b=i+b;var x=u.get(b);x?x.push(v):u.set(b,[v])}}return u}function q0(i,r,l){i=i.ownerDocument||i,i.head.insertBefore(l,r==="title"?i.querySelector("head > title"):null)}function MT(i,r,l){if(l===1||r.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return i=r.disabled,typeof r.precedence=="string"&&i==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function H0(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Sl=null;function UT(){}function $T(i,r,l){if(Sl===null)throw Error(n(475));var u=Sl;if(r.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=$a(l.href),v=i.querySelector(bl(f));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(u.count++,u=Uu.bind(u),i.then(u,u)),r.state.loading|=4,r.instance=v,Bt(v);return}v=i.ownerDocument||i,l=B0(l),(f=Xn.get(f))&&fg(l,f),v=v.createElement("link"),Bt(v);var b=v;b._p=new Promise(function(x,k){b.onload=x,b.onerror=k}),Jt(v,"link",l),r.instance=v}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(r,i),(i=r.state.preload)&&(r.state.loading&3)===0&&(u.count++,r=Uu.bind(u),i.addEventListener("load",r),i.addEventListener("error",r))}}function IT(){if(Sl===null)throw Error(n(475));var i=Sl;return i.stylesheets&&i.count===0&&pg(i,i.stylesheets),0<i.count?function(r){var l=setTimeout(function(){if(i.stylesheets&&pg(i,i.stylesheets),i.unsuspend){var u=i.unsuspend;i.unsuspend=null,u()}},6e4);return i.unsuspend=r,function(){i.unsuspend=null,clearTimeout(l)}}:null}function Uu(){if(this.count--,this.count===0){if(this.stylesheets)pg(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var $u=null;function pg(i,r){i.stylesheets=null,i.unsuspend!==null&&(i.count++,$u=new Map,r.forEach(BT,i),$u=null,Uu.call(i))}function BT(i,r){if(!(r.state.loading&4)){var l=$u.get(i);if(l)var u=l.get(null);else{l=new Map,$u.set(i,l);for(var f=i.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<f.length;v++){var b=f[v];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(l.set(b.dataset.precedence,b),u=b)}u&&l.set(null,u)}f=r.instance,b=f.getAttribute("data-precedence"),v=l.get(b)||u,v===u&&l.set(null,f),l.set(b,f),this.count++,u=Uu.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),v?v.parentNode.insertBefore(f,v.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(f,i.firstChild)),r.state.loading|=4}}var El={$$typeof:L,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function zT(i,r,l,u,f,v,b,x){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ar(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ar(0),this.hiddenUpdates=ar(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=v,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=x,this.incompleteTransitions=new Map}function F0(i,r,l,u,f,v,b,x,k,M,G,X){return i=new zT(i,r,l,b,x,k,M,X),r=1,v===!0&&(r|=24),v=Rn(3,null,null,r),i.current=v,v.stateNode=i,r=Xh(),r.refCount++,i.pooledCache=r,r.refCount++,v.memoizedState={element:u,isDehydrated:l,cache:r},Wh(v),i}function Y0(i){return i?(i=pa,i):pa}function V0(i,r,l,u,f,v){f=Y0(f),u.context===null?u.context=f:u.pendingContext=f,u=_s(r),u.payload={element:l},v=v===void 0?null:v,v!==null&&(u.callback=v),l=bs(i,u,r),l!==null&&(Mn(l,i,r),Wo(l,i,r))}function G0(i,r){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<r?l:r}}function vg(i,r){G0(i,r),(i=i.alternate)&&G0(i,r)}function Q0(i){if(i.tag===13){var r=ga(i,67108864);r!==null&&Mn(r,i,67108864),vg(i,67108864)}}var Iu=!0;function PT(i,r,l,u){var f=H.T;H.T=null;var v=K.p;try{K.p=2,mg(i,r,l,u)}finally{K.p=v,H.T=f}}function qT(i,r,l,u){var f=H.T;H.T=null;var v=K.p;try{K.p=8,mg(i,r,l,u)}finally{K.p=v,H.T=f}}function mg(i,r,l,u){if(Iu){var f=yg(u);if(f===null)sg(i,r,u,Bu,l),K0(i,u);else if(FT(f,i,r,l,u))u.stopPropagation();else if(K0(i,u),r&4&&-1<HT.indexOf(i)){for(;f!==null;){var v=na(f);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var b=Dn(v.pendingLanes);if(b!==0){var x=v;for(x.pendingLanes|=2,x.entangledLanes|=2;b;){var k=1<<31-ut(b);x.entanglements[1]|=k,b&=~k}yi(v),(qe&6)===0&&(Su=Ct()+500,vl(0))}}break;case 13:x=ga(v,2),x!==null&&Mn(x,v,2),xu(),vg(v,2)}if(v=yg(u),v===null&&sg(i,r,u,Bu,l),v===f)break;f=v}f!==null&&u.stopPropagation()}else sg(i,r,u,null,l)}}function yg(i){return i=Sh(i),_g(i)}var Bu=null;function _g(i){if(Bu=null,i=ta(i),i!==null){var r=o(i);if(r===null)i=null;else{var l=r.tag;if(l===13){if(i=c(r),i!==null)return i;i=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;i=null}else r!==i&&(i=null)}}return Bu=i,null}function X0(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qr()){case ds:return 2;case Tn:return 8;case ii:case Oi:return 32;case hs:return 268435456;default:return 32}default:return 32}}var bg=!1,js=null,Ns=null,Ms=null,xl=new Map,Cl=new Map,Us=[],HT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function K0(i,r){switch(i){case"focusin":case"focusout":js=null;break;case"dragenter":case"dragleave":Ns=null;break;case"mouseover":case"mouseout":Ms=null;break;case"pointerover":case"pointerout":xl.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cl.delete(r.pointerId)}}function Tl(i,r,l,u,f,v){return i===null||i.nativeEvent!==v?(i={blockedOn:r,domEventName:l,eventSystemFlags:u,nativeEvent:v,targetContainers:[f]},r!==null&&(r=na(r),r!==null&&Q0(r)),i):(i.eventSystemFlags|=u,r=i.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),i)}function FT(i,r,l,u,f){switch(r){case"focusin":return js=Tl(js,i,r,l,u,f),!0;case"dragenter":return Ns=Tl(Ns,i,r,l,u,f),!0;case"mouseover":return Ms=Tl(Ms,i,r,l,u,f),!0;case"pointerover":var v=f.pointerId;return xl.set(v,Tl(xl.get(v)||null,i,r,l,u,f)),!0;case"gotpointercapture":return v=f.pointerId,Cl.set(v,Tl(Cl.get(v)||null,i,r,l,u,f)),!0}return!1}function J0(i){var r=ta(i.target);if(r!==null){var l=o(r);if(l!==null){if(r=l.tag,r===13){if(r=c(l),r!==null){i.blockedOn=r,It(i.priority,function(){if(l.tag===13){var u=Nn();u=$t(u);var f=ga(l,u);f!==null&&Mn(f,l,u),vg(l,u)}});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function zu(i){if(i.blockedOn!==null)return!1;for(var r=i.targetContainers;0<r.length;){var l=yg(i.nativeEvent);if(l===null){l=i.nativeEvent;var u=new l.constructor(l.type,l);wh=u,l.target.dispatchEvent(u),wh=null}else return r=na(l),r!==null&&Q0(r),i.blockedOn=l,!1;r.shift()}return!0}function Z0(i,r,l){zu(i)&&l.delete(r)}function YT(){bg=!1,js!==null&&zu(js)&&(js=null),Ns!==null&&zu(Ns)&&(Ns=null),Ms!==null&&zu(Ms)&&(Ms=null),xl.forEach(Z0),Cl.forEach(Z0)}function Pu(i,r){i.blockedOn===r&&(i.blockedOn=null,bg||(bg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,YT)))}var qu=null;function W0(i){qu!==i&&(qu=i,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){qu===i&&(qu=null);for(var r=0;r<i.length;r+=3){var l=i[r],u=i[r+1],f=i[r+2];if(typeof u!="function"){if(_g(u||l)===null)continue;break}var v=na(l);v!==null&&(i.splice(r,3),r-=3,_f(v,{pending:!0,data:f,method:l.method,action:u},u,f))}}))}function Dl(i){function r(k){return Pu(k,i)}js!==null&&Pu(js,i),Ns!==null&&Pu(Ns,i),Ms!==null&&Pu(Ms,i),xl.forEach(r),Cl.forEach(r);for(var l=0;l<Us.length;l++){var u=Us[l];u.blockedOn===i&&(u.blockedOn=null)}for(;0<Us.length&&(l=Us[0],l.blockedOn===null);)J0(l),l.blockedOn===null&&Us.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var f=l[u],v=l[u+1],b=f[et]||null;if(typeof v=="function")b||W0(l);else if(b){var x=null;if(v&&v.hasAttribute("formAction")){if(f=v,b=v[et]||null)x=b.formAction;else if(_g(f)!==null)continue}else x=b.action;typeof x=="function"?l[u+1]=x:(l.splice(u,3),u-=3),W0(l)}}}function wg(i){this._internalRoot=i}Hu.prototype.render=wg.prototype.render=function(i){var r=this._internalRoot;if(r===null)throw Error(n(409));var l=r.current,u=Nn();V0(l,u,i,r,null,null)},Hu.prototype.unmount=wg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var r=i.containerInfo;V0(i.current,2,null,i,null,null),xu(),r[sn]=null}};function Hu(i){this._internalRoot=i}Hu.prototype.unstable_scheduleHydration=function(i){if(i){var r=_t();i={blockedOn:null,target:i,priority:r};for(var l=0;l<Us.length&&r!==0&&r<Us[l].priority;l++);Us.splice(l,0,i),l===0&&J0(i)}};var eb=e.version;if(eb!=="19.1.1")throw Error(n(527,eb,"19.1.1"));K.findDOMNode=function(i){var r=i._reactInternals;if(r===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=h(r),i=i!==null?g(i):null,i=i===null?null:i.stateNode,i};var VT={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fu.isDisabled&&Fu.supportsFiber)try{gn=Fu.inject(VT),Qe=Fu}catch{}}return Al.createRoot=function(i,r){if(!a(i))throw Error(n(299));var l=!1,u="",f=v_,v=m_,b=y_,x=null;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(b=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(x=r.unstable_transitionCallbacks)),r=F0(i,1,!1,null,null,l,u,f,v,b,x,null),i[sn]=r.current,ig(i),new wg(r)},Al.hydrateRoot=function(i,r,l){if(!a(i))throw Error(n(299));var u=!1,f="",v=v_,b=m_,x=y_,k=null,M=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(x=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(k=l.unstable_transitionCallbacks),l.formState!==void 0&&(M=l.formState)),r=F0(i,1,!0,r,l??null,u,f,v,b,x,k,M),r.context=Y0(null),l=r.current,u=Nn(),u=$t(u),f=_s(u),f.callback=null,bs(l,f,u),l=u,r.current.lanes=l,st(r,l),yi(r),i[sn]=r.current,ig(i),new Hu(r)},Al.version="19.1.1",Al}var ub;function sD(){if(ub)return xg.exports;ub=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),xg.exports=iD(),xg.exports}var rD=sD();const aD=wv(rD);var Il=LS();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ic(){return ic=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},ic.apply(this,arguments)}var Vs;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Vs||(Vs={}));const db="popstate";function oD(s){s===void 0&&(s={});function e(a,o){let{pathname:c="/",search:d="",hash:h=""}=Fr(a.location.hash.substr(1));return!c.startsWith("/")&&!c.startsWith(".")&&(c="/"+c),vp("",{pathname:c,search:d,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(a,o){let c=a.document.querySelector("base"),d="";if(c&&c.getAttribute("href")){let h=a.location.href,g=h.indexOf("#");d=g===-1?h:h.slice(0,g)}return d+"#"+(typeof o=="string"?o:vd(o))}function n(a,o){Ev(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return cD(e,t,n,s)}function yt(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Ev(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function lD(){return Math.random().toString(36).substr(2,8)}function hb(s,e){return{usr:s.state,key:s.key,idx:e}}function vp(s,e,t,n){return t===void 0&&(t=null),ic({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof e=="string"?Fr(e):e,{state:t,key:e&&e.key||n||lD()})}function vd(s){let{pathname:e="/",search:t="",hash:n=""}=s;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Fr(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substr(t),s=s.substr(0,t));let n=s.indexOf("?");n>=0&&(e.search=s.substr(n),s=s.substr(0,n)),s&&(e.pathname=s)}return e}function cD(s,e,t,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:o=!1}=n,c=a.history,d=Vs.Pop,h=null,g=p();g==null&&(g=0,c.replaceState(ic({},c.state,{idx:g}),""));function p(){return(c.state||{idx:null}).idx}function m(){d=Vs.Pop;let T=p(),O=T==null?null:T-g;g=T,h&&h({action:d,location:S.location,delta:O})}function y(T,O){d=Vs.Push;let $=vp(S.location,T,O);t&&t($,T),g=p()+1;let L=hb($,g),U=S.createHref($);try{c.pushState(L,"",U)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;a.location.assign(U)}o&&h&&h({action:d,location:S.location,delta:1})}function _(T,O){d=Vs.Replace;let $=vp(S.location,T,O);t&&t($,T),g=p();let L=hb($,g),U=S.createHref($);c.replaceState(L,"",U),o&&h&&h({action:d,location:S.location,delta:0})}function E(T){let O=a.location.origin!=="null"?a.location.origin:a.location.href,$=typeof T=="string"?T:vd(T);return $=$.replace(/ $/,"%20"),yt(O,"No window.location.(origin|href) available to create URL for href: "+$),new URL($,O)}let S={get action(){return d},get location(){return s(a,c)},listen(T){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(db,m),h=T,()=>{a.removeEventListener(db,m),h=null}},createHref(T){return e(a,T)},createURL:E,encodeLocation(T){let O=E(T);return{pathname:O.pathname,search:O.search,hash:O.hash}},push:y,replace:_,go(T){return c.go(T)}};return S}var fb;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(fb||(fb={}));function uD(s,e,t){return t===void 0&&(t="/"),dD(s,e,t)}function dD(s,e,t,n){let a=typeof e=="string"?Fr(e):e,o=xv(a.pathname||"/",t);if(o==null)return null;let c=jS(s);hD(c);let d=null;for(let h=0;d==null&&h<c.length;++h){let g=xD(o);d=wD(c[h],g)}return d}function jS(s,e,t,n){e===void 0&&(e=[]),t===void 0&&(t=[]),n===void 0&&(n="");let a=(o,c,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};h.relativePath.startsWith("/")&&(yt(h.relativePath.startsWith(n),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(n.length));let g=Xs([n,h.relativePath]),p=t.concat(h);o.children&&o.children.length>0&&(yt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+g+'".')),jS(o.children,e,p,g)),!(o.path==null&&!o.index)&&e.push({path:g,score:_D(g,o.index),routesMeta:p})};return s.forEach((o,c)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))a(o,c);else for(let h of NS(o.path))a(o,c,h)}),e}function NS(s){let e=s.split("/");if(e.length===0)return[];let[t,...n]=e,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let c=NS(n.join("/")),d=[];return d.push(...c.map(h=>h===""?o:[o,h].join("/"))),a&&d.push(...c),d.map(h=>s.startsWith("/")&&h===""?"/":h)}function hD(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:bD(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}const fD=/^:[\w-]+$/,gD=3,pD=2,vD=1,mD=10,yD=-2,gb=s=>s==="*";function _D(s,e){let t=s.split("/"),n=t.length;return t.some(gb)&&(n+=yD),e&&(n+=pD),t.filter(a=>!gb(a)).reduce((a,o)=>a+(fD.test(o)?gD:o===""?vD:mD),n)}function bD(s,e){return s.length===e.length&&s.slice(0,-1).every((n,a)=>n===e[a])?s[s.length-1]-e[e.length-1]:0}function wD(s,e,t){let{routesMeta:n}=s,a={},o="/",c=[];for(let d=0;d<n.length;++d){let h=n[d],g=d===n.length-1,p=o==="/"?e:e.slice(o.length)||"/",m=SD({path:h.relativePath,caseSensitive:h.caseSensitive,end:g},p),y=h.route;if(!m)return null;Object.assign(a,m.params),c.push({params:a,pathname:Xs([o,m.pathname]),pathnameBase:kD(Xs([o,m.pathnameBase])),route:y}),m.pathnameBase!=="/"&&(o=Xs([o,m.pathnameBase]))}return c}function SD(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,n]=ED(s.path,s.caseSensitive,s.end),a=e.match(t);if(!a)return null;let o=a[0],c=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:n.reduce((g,p,m)=>{let{paramName:y,isOptional:_}=p;if(y==="*"){let S=d[m]||"";c=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const E=d[m];return _&&!E?g[y]=void 0:g[y]=(E||"").replace(/%2F/g,"/"),g},{}),pathname:o,pathnameBase:c,pattern:s}}function ED(s,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Ev(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let n=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,h)=>(n.push({paramName:d,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(n.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function xD(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ev(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),s}}function xv(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=s.charAt(t);return n&&n!=="/"?null:s.slice(t)||"/"}function CD(s,e){e===void 0&&(e="/");let{pathname:t,search:n="",hash:a=""}=typeof s=="string"?Fr(s):s;return{pathname:t?t.startsWith("/")?t:TD(t,e):e,search:AD(n),hash:RD(a)}}function TD(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function kg(s,e,t,n){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function DD(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Cv(s,e){let t=DD(s);return e?t.map((n,a)=>a===t.length-1?n.pathname:n.pathnameBase):t.map(n=>n.pathnameBase)}function Tv(s,e,t,n){n===void 0&&(n=!1);let a;typeof s=="string"?a=Fr(s):(a=ic({},s),yt(!a.pathname||!a.pathname.includes("?"),kg("?","pathname","search",a)),yt(!a.pathname||!a.pathname.includes("#"),kg("#","pathname","hash",a)),yt(!a.search||!a.search.includes("#"),kg("#","search","hash",a)));let o=s===""||a.pathname==="",c=o?"/":a.pathname,d;if(c==null)d=t;else{let m=e.length-1;if(!n&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),m-=1;a.pathname=y.join("/")}d=m>=0?e[m]:"/"}let h=CD(a,d),g=c&&c!=="/"&&c.endsWith("/"),p=(o||c===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(g||p)&&(h.pathname+="/"),h}const Xs=s=>s.join("/").replace(/\/\/+/g,"/"),kD=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),AD=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,RD=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function OD(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const MS=["post","put","patch","delete"];new Set(MS);const LD=["get",...MS];new Set(LD);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sc(){return sc=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},sc.apply(this,arguments)}const Dv=C.createContext(null),jD=C.createContext(null),ir=C.createContext(null),Qd=C.createContext(null),os=C.createContext({outlet:null,matches:[],isDataRoute:!1}),US=C.createContext(null);function ND(s,e){let{relative:t}=e===void 0?{}:e;Eo()||yt(!1);let{basename:n,navigator:a}=C.useContext(ir),{hash:o,pathname:c,search:d}=BS(s,{relative:t}),h=c;return n!=="/"&&(h=c==="/"?n:Xs([n,c])),a.createHref({pathname:h,search:d,hash:o})}function Eo(){return C.useContext(Qd)!=null}function Ec(){return Eo()||yt(!1),C.useContext(Qd).location}function $S(s){C.useContext(ir).static||C.useLayoutEffect(s)}function ni(){let{isDataRoute:s}=C.useContext(os);return s?GD():MD()}function MD(){Eo()||yt(!1);let s=C.useContext(Dv),{basename:e,future:t,navigator:n}=C.useContext(ir),{matches:a}=C.useContext(os),{pathname:o}=Ec(),c=JSON.stringify(Cv(a,t.v7_relativeSplatPath)),d=C.useRef(!1);return $S(()=>{d.current=!0}),C.useCallback(function(g,p){if(p===void 0&&(p={}),!d.current)return;if(typeof g=="number"){n.go(g);return}let m=Tv(g,JSON.parse(c),o,p.relative==="path");s==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Xs([e,m.pathname])),(p.replace?n.replace:n.push)(m,p.state,p)},[e,n,c,o,s])}function IS(){let{matches:s}=C.useContext(os),e=s[s.length-1];return e?e.params:{}}function BS(s,e){let{relative:t}=e===void 0?{}:e,{future:n}=C.useContext(ir),{matches:a}=C.useContext(os),{pathname:o}=Ec(),c=JSON.stringify(Cv(a,n.v7_relativeSplatPath));return C.useMemo(()=>Tv(s,JSON.parse(c),o,t==="path"),[s,c,o,t])}function UD(s,e){return $D(s,e)}function $D(s,e,t,n){Eo()||yt(!1);let{navigator:a}=C.useContext(ir),{matches:o}=C.useContext(os),c=o[o.length-1],d=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let g=Ec(),p;if(e){var m;let T=typeof e=="string"?Fr(e):e;h==="/"||(m=T.pathname)!=null&&m.startsWith(h)||yt(!1),p=T}else p=g;let y=p.pathname||"/",_=y;if(h!=="/"){let T=h.replace(/^\//,"").split("/");_="/"+y.replace(/^\//,"").split("/").slice(T.length).join("/")}let E=uD(s,{pathname:_}),S=qD(E&&E.map(T=>Object.assign({},T,{params:Object.assign({},d,T.params),pathname:Xs([h,a.encodeLocation?a.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:Xs([h,a.encodeLocation?a.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),o,t,n);return e&&S?C.createElement(Qd.Provider,{value:{location:sc({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:Vs.Pop}},S):S}function ID(){let s=VD(),e=OD(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),t?C.createElement("pre",{style:a},t):null,null)}const BD=C.createElement(ID,null);class zD extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(os.Provider,{value:this.props.routeContext},C.createElement(US.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function PD(s){let{routeContext:e,match:t,children:n}=s,a=C.useContext(Dv);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(os.Provider,{value:e},n)}function qD(s,e,t,n){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),n===void 0&&(n=null),s==null){var o;if(!t)return null;if(t.errors)s=t.matches;else if((o=n)!=null&&o.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let c=s,d=(a=t)==null?void 0:a.errors;if(d!=null){let p=c.findIndex(m=>m.route.id&&d?.[m.route.id]!==void 0);p>=0||yt(!1),c=c.slice(0,Math.min(c.length,p+1))}let h=!1,g=-1;if(t&&n&&n.v7_partialHydration)for(let p=0;p<c.length;p++){let m=c[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(g=p),m.route.id){let{loaderData:y,errors:_}=t,E=m.route.loader&&y[m.route.id]===void 0&&(!_||_[m.route.id]===void 0);if(m.route.lazy||E){h=!0,g>=0?c=c.slice(0,g+1):c=[c[0]];break}}}return c.reduceRight((p,m,y)=>{let _,E=!1,S=null,T=null;t&&(_=d&&m.route.id?d[m.route.id]:void 0,S=m.route.errorElement||BD,h&&(g<0&&y===0?(QD("route-fallback"),E=!0,T=null):g===y&&(E=!0,T=m.route.hydrateFallbackElement||null)));let O=e.concat(c.slice(0,y+1)),$=()=>{let L;return _?L=S:E?L=T:m.route.Component?L=C.createElement(m.route.Component,null):m.route.element?L=m.route.element:L=p,C.createElement(PD,{match:m,routeContext:{outlet:p,matches:O,isDataRoute:t!=null},children:L})};return t&&(m.route.ErrorBoundary||m.route.errorElement||y===0)?C.createElement(zD,{location:t.location,revalidation:t.revalidation,component:S,error:_,children:$(),routeContext:{outlet:null,matches:O,isDataRoute:!0}}):$()},null)}var zS=(function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s})(zS||{}),PS=(function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s})(PS||{});function HD(s){let e=C.useContext(Dv);return e||yt(!1),e}function FD(s){let e=C.useContext(jD);return e||yt(!1),e}function YD(s){let e=C.useContext(os);return e||yt(!1),e}function qS(s){let e=YD(),t=e.matches[e.matches.length-1];return t.route.id||yt(!1),t.route.id}function VD(){var s;let e=C.useContext(US),t=FD(),n=qS();return e!==void 0?e:(s=t.errors)==null?void 0:s[n]}function GD(){let{router:s}=HD(zS.UseNavigateStable),e=qS(PS.UseNavigateStable),t=C.useRef(!1);return $S(()=>{t.current=!0}),C.useCallback(function(a,o){o===void 0&&(o={}),t.current&&(typeof a=="number"?s.navigate(a):s.navigate(a,sc({fromRouteId:e},o)))},[s,e])}const pb={};function QD(s,e,t){pb[s]||(pb[s]=!0)}function XD(s,e){s?.v7_startTransition,s?.v7_relativeSplatPath}function KD(s){let{to:e,replace:t,state:n,relative:a}=s;Eo()||yt(!1);let{future:o,static:c}=C.useContext(ir),{matches:d}=C.useContext(os),{pathname:h}=Ec(),g=ni(),p=Tv(e,Cv(d,o.v7_relativeSplatPath),h,a==="path"),m=JSON.stringify(p);return C.useEffect(()=>g(JSON.parse(m),{replace:t,state:n,relative:a}),[g,m,a,t,n]),null}function Wi(s){yt(!1)}function JD(s){let{basename:e="/",children:t=null,location:n,navigationType:a=Vs.Pop,navigator:o,static:c=!1,future:d}=s;Eo()&&yt(!1);let h=e.replace(/^\/*/,"/"),g=C.useMemo(()=>({basename:h,navigator:o,static:c,future:sc({v7_relativeSplatPath:!1},d)}),[h,d,o,c]);typeof n=="string"&&(n=Fr(n));let{pathname:p="/",search:m="",hash:y="",state:_=null,key:E="default"}=n,S=C.useMemo(()=>{let T=xv(p,h);return T==null?null:{location:{pathname:T,search:m,hash:y,state:_,key:E},navigationType:a}},[h,p,m,y,_,E,a]);return S==null?null:C.createElement(ir.Provider,{value:g},C.createElement(Qd.Provider,{children:t,value:S}))}function ZD(s){let{children:e,location:t}=s;return UD(mp(e),t)}new Promise(()=>{});function mp(s,e){e===void 0&&(e=[]);let t=[];return C.Children.forEach(s,(n,a)=>{if(!C.isValidElement(n))return;let o=[...e,a];if(n.type===C.Fragment){t.push.apply(t,mp(n.props.children,o));return}n.type!==Wi&&yt(!1),!n.props.index||!n.props.children||yt(!1);let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=mp(n.props.children,o)),t.push(c)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yp(){return yp=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},yp.apply(this,arguments)}function WD(s,e){if(s==null)return{};var t={},n=Object.keys(s),a,o;for(o=0;o<n.length;o++)a=n[o],!(e.indexOf(a)>=0)&&(t[a]=s[a]);return t}function ek(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function tk(s,e){return s.button===0&&(!e||e==="_self")&&!ek(s)}const nk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ik="6";try{window.__reactRouterVersion=ik}catch{}const sk="startTransition",vb=WT[sk];function rk(s){let{basename:e,children:t,future:n,window:a}=s,o=C.useRef();o.current==null&&(o.current=oD({window:a,v5Compat:!0}));let c=o.current,[d,h]=C.useState({action:c.action,location:c.location}),{v7_startTransition:g}=n||{},p=C.useCallback(m=>{g&&vb?vb(()=>h(m)):h(m)},[h,g]);return C.useLayoutEffect(()=>c.listen(p),[c,p]),C.useEffect(()=>XD(n),[n]),C.createElement(JD,{basename:e,children:t,location:d.location,navigationType:d.action,navigator:c,future:n})}const ak=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ok=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mb=C.forwardRef(function(e,t){let{onClick:n,relative:a,reloadDocument:o,replace:c,state:d,target:h,to:g,preventScrollReset:p,viewTransition:m}=e,y=WD(e,nk),{basename:_}=C.useContext(ir),E,S=!1;if(typeof g=="string"&&ok.test(g)&&(E=g,ak))try{let L=new URL(window.location.href),U=g.startsWith("//")?new URL(L.protocol+g):new URL(g),A=xv(U.pathname,_);U.origin===L.origin&&A!=null?g=A+U.search+U.hash:S=!0}catch{}let T=ND(g,{relative:a}),O=lk(g,{replace:c,state:d,target:h,preventScrollReset:p,relative:a,viewTransition:m});function $(L){n&&n(L),L.defaultPrevented||O(L)}return C.createElement("a",yp({},y,{href:E||T,onClick:S||o?n:$,ref:t,target:h}))});var yb;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(yb||(yb={}));var _b;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(_b||(_b={}));function lk(s,e){let{target:t,replace:n,state:a,preventScrollReset:o,relative:c,viewTransition:d}=e===void 0?{}:e,h=ni(),g=Ec(),p=BS(s,{relative:c});return C.useCallback(m=>{if(tk(m,t)){m.preventDefault();let y=n!==void 0?n:vd(g)===vd(p);h(s,{replace:y,state:a,preventScrollReset:o,relative:c,viewTransition:d})}},[g,h,p,n,a,t,s,o,c,d])}const ui=()=>new Map,_p=s=>{const e=ui();return s.forEach((t,n)=>{e.set(n,t)}),e},sr=(s,e,t)=>{let n=s.get(e);return n===void 0&&s.set(e,n=t()),n},ck=(s,e)=>{const t=[];for(const[n,a]of s)t.push(e(a,n));return t},uk=(s,e)=>{for(const[t,n]of s)if(e(n,t))return!0;return!1},ho=()=>new Set,Ag=s=>s[s.length-1],dk=(s,e)=>{for(let t=0;t<e.length;t++)s.push(e[t])},$r=Array.from,hk=Array.isArray;class fk{constructor(){this._observers=ui()}on(e,t){return sr(this._observers,e,ho).add(t),t}once(e,t){const n=(...a)=>{this.off(e,n),t(...a)};this.on(e,n)}off(e,t){const n=this._observers.get(e);n!==void 0&&(n.delete(t),n.size===0&&this._observers.delete(e))}emit(e,t){return $r((this._observers.get(e)||ui()).values()).forEach(n=>n(...t))}destroy(){this._observers=ui()}}const er=Math.floor,ld=Math.abs,HS=(s,e)=>s<e?s:e,Yr=(s,e)=>s>e?s:e,FS=s=>s!==0?s<0:1/s<0,bb=1,wb=2,Rg=4,Og=8,rc=32,as=64,Bn=128,Xd=31,bp=63,Mr=127,gk=2147483647,YS=Number.MAX_SAFE_INTEGER,pk=Number.isInteger||(s=>typeof s=="number"&&isFinite(s)&&er(s)===s),vk=s=>s.toLowerCase(),mk=/^\s*/g,yk=s=>s.replace(mk,""),_k=/([A-Z])/g,Sb=(s,e)=>yk(s.replace(_k,t=>`${e}${vk(t)}`)),bk=s=>{const e=unescape(encodeURIComponent(s)),t=e.length,n=new Uint8Array(t);for(let a=0;a<t;a++)n[a]=e.codePointAt(a);return n},ac=typeof TextEncoder<"u"?new TextEncoder:null,wk=s=>ac.encode(s),Sk=ac?wk:bk;let Ql=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Ql&&Ql.decode(new Uint8Array).length===1&&(Ql=null);class xc{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Kd=()=>new xc,Ek=s=>{let e=s.cpos;for(let t=0;t<s.bufs.length;t++)e+=s.bufs[t].length;return e},wi=s=>{const e=new Uint8Array(Ek(s));let t=0;for(let n=0;n<s.bufs.length;n++){const a=s.bufs[n];e.set(a,t),t+=a.length}return e.set(new Uint8Array(s.cbuf.buffer,0,s.cpos),t),e},xk=(s,e)=>{const t=s.cbuf.length;t-s.cpos<e&&(s.bufs.push(new Uint8Array(s.cbuf.buffer,0,s.cpos)),s.cbuf=new Uint8Array(Yr(t,e)*2),s.cpos=0)},Ft=(s,e)=>{const t=s.cbuf.length;s.cpos===t&&(s.bufs.push(s.cbuf),s.cbuf=new Uint8Array(t*2),s.cpos=0),s.cbuf[s.cpos++]=e},wp=Ft,$e=(s,e)=>{for(;e>Mr;)Ft(s,Bn|Mr&e),e=er(e/128);Ft(s,Mr&e)},kv=(s,e)=>{const t=FS(e);for(t&&(e=-e),Ft(s,(e>bp?Bn:0)|(t?as:0)|bp&e),e=er(e/64);e>0;)Ft(s,(e>Mr?Bn:0)|Mr&e),e=er(e/128)},Sp=new Uint8Array(3e4),Ck=Sp.length/3,Tk=(s,e)=>{if(e.length<Ck){const t=ac.encodeInto(e,Sp).written||0;$e(s,t);for(let n=0;n<t;n++)Ft(s,Sp[n])}else Un(s,Sk(e))},Dk=(s,e)=>{const t=unescape(encodeURIComponent(e)),n=t.length;$e(s,n);for(let a=0;a<n;a++)Ft(s,t.codePointAt(a))},so=ac&&ac.encodeInto?Tk:Dk,Jd=(s,e)=>{const t=s.cbuf.length,n=s.cpos,a=HS(t-n,e.length),o=e.length-a;s.cbuf.set(e.subarray(0,a),n),s.cpos+=a,o>0&&(s.bufs.push(s.cbuf),s.cbuf=new Uint8Array(Yr(t*2,o)),s.cbuf.set(e.subarray(a)),s.cpos=o)},Un=(s,e)=>{$e(s,e.byteLength),Jd(s,e)},Av=(s,e)=>{xk(s,e);const t=new DataView(s.cbuf.buffer,s.cpos,e);return s.cpos+=e,t},kk=(s,e)=>Av(s,4).setFloat32(0,e,!1),Ak=(s,e)=>Av(s,8).setFloat64(0,e,!1),Rk=(s,e)=>Av(s,8).setBigInt64(0,e,!1),Eb=new DataView(new ArrayBuffer(4)),Ok=s=>(Eb.setFloat32(0,s),Eb.getFloat32(0)===s),oc=(s,e)=>{switch(typeof e){case"string":Ft(s,119),so(s,e);break;case"number":pk(e)&&ld(e)<=gk?(Ft(s,125),kv(s,e)):Ok(e)?(Ft(s,124),kk(s,e)):(Ft(s,123),Ak(s,e));break;case"bigint":Ft(s,122),Rk(s,e);break;case"object":if(e===null)Ft(s,126);else if(hk(e)){Ft(s,117),$e(s,e.length);for(let t=0;t<e.length;t++)oc(s,e[t])}else if(e instanceof Uint8Array)Ft(s,116),Un(s,e);else{Ft(s,118);const t=Object.keys(e);$e(s,t.length);for(let n=0;n<t.length;n++){const a=t[n];so(s,a),oc(s,e[a])}}break;case"boolean":Ft(s,e?120:121);break;default:Ft(s,127)}};class xb extends xc{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&$e(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const Cb=s=>{s.count>0&&(kv(s.encoder,s.count===1?s.s:-s.s),s.count>1&&$e(s.encoder,s.count-2))};class cd{constructor(){this.encoder=new xc,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Cb(this),this.count=1,this.s=e)}toUint8Array(){return Cb(this),wi(this.encoder)}}const Tb=s=>{if(s.count>0){const e=s.diff*2+(s.count===1?0:1);kv(s.encoder,e),s.count>1&&$e(s.encoder,s.count-2)}};class Lg{constructor(){this.encoder=new xc,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Tb(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Tb(this),wi(this.encoder)}}class Lk{constructor(){this.sarr=[],this.s="",this.lensE=new cd}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new xc;return this.sarr.push(this.s),this.s="",so(e,this.sarr.join("")),Jd(e,this.lensE.toUint8Array()),wi(e)}}const tr=s=>new Error(s),xi=()=>{throw tr("Method unimplemented")},Ti=()=>{throw tr("Unexpected case")},VS=tr("Unexpected end of array"),GS=tr("Integer out of Range");class Zd{constructor(e){this.arr=e,this.pos=0}}const xo=s=>new Zd(s),jk=s=>s.pos!==s.arr.length,Nk=(s,e)=>{const t=new Uint8Array(s.arr.buffer,s.pos+s.arr.byteOffset,e);return s.pos+=e,t},$n=s=>Nk(s,De(s)),fo=s=>s.arr[s.pos++],De=s=>{let e=0,t=1;const n=s.arr.length;for(;s.pos<n;){const a=s.arr[s.pos++];if(e=e+(a&Mr)*t,t*=128,a<Bn)return e;if(e>YS)throw GS}throw VS},Rv=s=>{let e=s.arr[s.pos++],t=e&bp,n=64;const a=(e&as)>0?-1:1;if((e&Bn)===0)return a*t;const o=s.arr.length;for(;s.pos<o;){if(e=s.arr[s.pos++],t=t+(e&Mr)*n,n*=128,e<Bn)return a*t;if(t>YS)throw GS}throw VS},Mk=s=>{let e=De(s);if(e===0)return"";{let t=String.fromCodePoint(fo(s));if(--e<100)for(;e--;)t+=String.fromCodePoint(fo(s));else for(;e>0;){const n=e<1e4?e:1e4,a=s.arr.subarray(s.pos,s.pos+n);s.pos+=n,t+=String.fromCodePoint.apply(null,a),e-=n}return decodeURIComponent(escape(t))}},Uk=s=>Ql.decode($n(s)),ro=Ql?Uk:Mk,Ov=(s,e)=>{const t=new DataView(s.arr.buffer,s.arr.byteOffset+s.pos,e);return s.pos+=e,t},$k=s=>Ov(s,4).getFloat32(0,!1),Ik=s=>Ov(s,8).getFloat64(0,!1),Bk=s=>Ov(s,8).getBigInt64(0,!1),zk=[s=>{},s=>null,Rv,$k,Ik,Bk,s=>!1,s=>!0,ro,s=>{const e=De(s),t={};for(let n=0;n<e;n++){const a=ro(s);t[a]=lc(s)}return t},s=>{const e=De(s),t=[];for(let n=0;n<e;n++)t.push(lc(s));return t},$n],lc=s=>zk[127-fo(s)](s);class Db extends Zd{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),jk(this)?this.count=De(this)+1:this.count=-1),this.count--,this.s}}class ud extends Zd{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Rv(this);const e=FS(this.s);this.count=1,e&&(this.s=-this.s,this.count=De(this)+2)}return this.count--,this.s}}class jg extends Zd{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=Rv(this),t=e&1;this.diff=er(e/2),this.count=1,t&&(this.count=De(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Pk{constructor(e){this.decoder=new ud(e),this.str=ro(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const qk=crypto.getRandomValues.bind(crypto),QS=()=>qk(new Uint32Array(1))[0],Hk="10000000-1000-4000-8000"+-1e11,Fk=()=>Hk.replace(/[018]/g,s=>(s^QS()&15>>s/4).toString(16)),kb=s=>new Promise(s);Promise.all.bind(Promise);const Ab=s=>s===void 0?null:s;class Yk{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let XS=new Yk,Vk=!0;try{typeof localStorage<"u"&&localStorage&&(XS=localStorage,Vk=!1)}catch{}const Gk=XS,Qk=Object.assign,Xk=Object.keys,Kk=(s,e)=>{for(const t in s)e(s[t],t)},Rb=s=>Xk(s).length,Jk=s=>{for(const e in s)return!1;return!0},Zk=(s,e)=>{for(const t in s)if(!e(s[t],t))return!1;return!0},Wk=(s,e)=>Object.prototype.hasOwnProperty.call(s,e),eA=(s,e)=>s===e||Rb(s)===Rb(e)&&Zk(s,(t,n)=>(t!==void 0||Wk(e,n))&&e[n]===t),tA=Object.freeze,KS=s=>{for(const e in s){const t=s[e];(typeof t=="object"||typeof t=="function")&&KS(s[e])}return tA(s)},Lv=(s,e,t=0)=>{try{for(;t<s.length;t++)s[t](...e)}finally{t<s.length&&Lv(s,e,t+1)}},nA=s=>s,iA=(s,e)=>e.includes(s);var JS={};const cc=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let _i;const sA=()=>{if(_i===void 0)if(cc){_i=ui();const s=process.argv;let e=null;for(let t=0;t<s.length;t++){const n=s[t];n[0]==="-"?(e!==null&&_i.set(e,""),e=n):e!==null&&(_i.set(e,n),e=null)}e!==null&&_i.set(e,"")}else typeof location=="object"?(_i=ui(),(location.search||"?").slice(1).split("&").forEach(s=>{if(s.length!==0){const[e,t]=s.split("=");_i.set(`--${Sb(e,"-")}`,t),_i.set(`-${Sb(e,"-")}`,t)}})):_i=ui();return _i},Ep=s=>sA().has(s),md=s=>Ab(cc?JS[s.toUpperCase().replaceAll("-","_")]:Gk.getItem(s)),ZS=s=>Ep("--"+s)||md(s)!==null;ZS("production");const rA=cc&&iA(JS.FORCE_COLOR,["true","1","2"]),aA=rA||!Ep("--no-colors")&&!ZS("no-color")&&(!cc||process.stdout.isTTY)&&(!cc||Ep("--color")||md("COLORTERM")!==null||(md("TERM")||"").includes("color")),oA=s=>new Uint8Array(s),lA=s=>{const e=oA(s.byteLength);return e.set(s),e};class cA{constructor(e,t){this.left=e,this.right=t}}const Ji=(s,e)=>new cA(s,e);typeof DOMParser<"u"&&new DOMParser;const uA=s=>ck(s,(e,t)=>`${t}:${e};`).join(""),ls=Symbol,WS=ls(),eE=ls(),dA=ls(),hA=ls(),fA=ls(),tE=ls(),gA=ls(),jv=ls(),pA=ls(),vA=s=>{s.length===1&&s[0]?.constructor===Function&&(s=s[0]());const e=[],t=[];let n=0;for(;n<s.length;n++){const a=s[n];if(a===void 0)break;if(a.constructor===String||a.constructor===Number)e.push(a);else if(a.constructor===Object)break}for(n>0&&t.push(e.join(""));n<s.length;n++){const a=s[n];a instanceof Symbol||t.push(a)}return t},mA={[WS]:Ji("font-weight","bold"),[eE]:Ji("font-weight","normal"),[dA]:Ji("color","blue"),[fA]:Ji("color","green"),[hA]:Ji("color","grey"),[tE]:Ji("color","red"),[gA]:Ji("color","purple"),[jv]:Ji("color","orange"),[pA]:Ji("color","black")},yA=s=>{s.length===1&&s[0]?.constructor===Function&&(s=s[0]());const e=[],t=[],n=ui();let a=[],o=0;for(;o<s.length;o++){const c=s[o],d=mA[c];if(d!==void 0)n.set(d.left,d.right);else{if(c===void 0)break;if(c.constructor===String||c.constructor===Number){const h=uA(n);o>0||h.length>0?(e.push("%c"+c),t.push(h)):e.push(c)}else break}}for(o>0&&(a=t,a.unshift(e.join("")));o<s.length;o++){const c=s[o];c instanceof Symbol||a.push(c)}return a},nE=aA?yA:vA,_A=(...s)=>{console.log(...nE(s)),iE.forEach(e=>e.print(s))},bA=(...s)=>{console.warn(...nE(s)),s.unshift(jv),iE.forEach(e=>e.print(s))},iE=ho(),sE=s=>({[Symbol.iterator](){return this},next:s}),wA=(s,e)=>sE(()=>{let t;do t=s.next();while(!t.done&&!e(t.value));return t}),Ng=(s,e)=>sE(()=>{const{done:t,value:n}=s.next();return{done:t,value:t?void 0:e(n)}});class Nv{constructor(e,t){this.clock=e,this.len=t}}class Cc{constructor(){this.clients=new Map}}const rE=(s,e,t)=>e.clients.forEach((n,a)=>{const o=s.doc.store.clients.get(a);if(o!=null){const c=o[o.length-1],d=c.id.clock+c.length;for(let h=0,g=n[h];h<n.length&&g.clock<d;g=n[++h])pE(s,o,g.clock,g.len,t)}}),SA=(s,e)=>{let t=0,n=s.length-1;for(;t<=n;){const a=er((t+n)/2),o=s[a],c=o.clock;if(c<=e){if(e<c+o.len)return a;t=a+1}else n=a-1}return null},aE=(s,e)=>{const t=s.clients.get(e.client);return t!==void 0&&SA(t,e.clock)!==null},Mv=s=>{s.clients.forEach(e=>{e.sort((a,o)=>a.clock-o.clock);let t,n;for(t=1,n=1;t<e.length;t++){const a=e[n-1],o=e[t];a.clock+a.len>=o.clock?a.len=Yr(a.len,o.clock+o.len-a.clock):(n<t&&(e[n]=o),n++)}e.length=n})},EA=s=>{const e=new Cc;for(let t=0;t<s.length;t++)s[t].clients.forEach((n,a)=>{if(!e.clients.has(a)){const o=n.slice();for(let c=t+1;c<s.length;c++)dk(o,s[c].clients.get(a)||[]);e.clients.set(a,o)}});return Mv(e),e},yd=(s,e,t,n)=>{sr(s.clients,e,()=>[]).push(new Nv(t,n))},xA=()=>new Cc,CA=s=>{const e=xA();return s.clients.forEach((t,n)=>{const a=[];for(let o=0;o<t.length;o++){const c=t[o];if(c.deleted){const d=c.id.clock;let h=c.length;if(o+1<t.length)for(let g=t[o+1];o+1<t.length&&g.deleted;g=t[++o+1])h+=g.length;a.push(new Nv(d,h))}}a.length>0&&e.clients.set(n,a)}),e},Co=(s,e)=>{$e(s.restEncoder,e.clients.size),$r(e.clients.entries()).sort((t,n)=>n[0]-t[0]).forEach(([t,n])=>{s.resetDsCurVal(),$e(s.restEncoder,t);const a=n.length;$e(s.restEncoder,a);for(let o=0;o<a;o++){const c=n[o];s.writeDsClock(c.clock),s.writeDsLen(c.len)}})},Uv=s=>{const e=new Cc,t=De(s.restDecoder);for(let n=0;n<t;n++){s.resetDsCurVal();const a=De(s.restDecoder),o=De(s.restDecoder);if(o>0){const c=sr(e.clients,a,()=>[]);for(let d=0;d<o;d++)c.push(new Nv(s.readDsClock(),s.readDsLen()))}}return e},Ob=(s,e,t)=>{const n=new Cc,a=De(s.restDecoder);for(let o=0;o<a;o++){s.resetDsCurVal();const c=De(s.restDecoder),d=De(s.restDecoder),h=t.clients.get(c)||[],g=Vt(t,c);for(let p=0;p<d;p++){const m=s.readDsClock(),y=m+s.readDsLen();if(m<g){g<y&&yd(n,c,g,y-g);let _=Di(h,m),E=h[_];for(!E.deleted&&E.id.clock<m&&(h.splice(_+1,0,Cd(e,E,m-E.id.clock)),_++);_<h.length&&(E=h[_++],E.id.clock<y);)E.deleted||(y<E.id.clock+E.length&&h.splice(_,0,Cd(e,E,y-E.id.clock)),E.delete(e))}else yd(n,c,m,y-m)}}if(n.clients.size>0){const o=new Br;return $e(o.restEncoder,0),Co(o,n),o.toUint8Array()}return null},oE=QS;class Ir extends fk{constructor({guid:e=Fk(),collectionid:t=null,gc:n=!0,gcFilter:a=()=>!0,meta:o=null,autoLoad:c=!1,shouldLoad:d=!0}={}){super(),this.gc=n,this.gcFilter=a,this.clientID=oE(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new fE,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=d,this.autoLoad=c,this.meta=o,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=kb(g=>{this.on("load",()=>{this.isLoaded=!0,g(this)})});const h=()=>kb(g=>{const p=m=>{(m===void 0||m===!0)&&(this.off("sync",p),g())};this.on("sync",p)});this.on("sync",g=>{g===!1&&this.isSynced&&(this.whenSynced=h()),this.isSynced=g===void 0||g===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=h()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Ze(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set($r(this.subdocs).map(e=>e.guid))}transact(e,t=null){return Ze(this,e,t)}get(e,t=tn){const n=sr(this.share,e,()=>{const o=new t;return o._integrate(this,null),o}),a=n.constructor;if(t!==tn&&a!==t)if(a===tn){const o=new t;o._map=n._map,n._map.forEach(c=>{for(;c!==null;c=c.left)c.parent=o}),o._start=n._start;for(let c=o._start;c!==null;c=c.right)c.parent=o;return o._length=n._length,this.share.set(e,o),o._integrate(this,null),o}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return n}getArray(e=""){return this.get(e,oo)}getText(e=""){return this.get(e,vo)}getMap(e=""){return this.get(e,po)}getXmlElement(e=""){return this.get(e,mo)}getXmlFragment(e=""){return this.get(e,zr)}toJSON(){const e={};return this.share.forEach((t,n)=>{e[n]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,$r(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new Ir({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,Ze(e.parent.doc,n=>{const a=t.doc;e.deleted||n.subdocsAdded.add(a),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class lE{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return De(this.restDecoder)}readDsLen(){return De(this.restDecoder)}}class cE extends lE{readLeftID(){return Ne(De(this.restDecoder),De(this.restDecoder))}readRightID(){return Ne(De(this.restDecoder),De(this.restDecoder))}readClient(){return De(this.restDecoder)}readInfo(){return fo(this.restDecoder)}readString(){return ro(this.restDecoder)}readParentInfo(){return De(this.restDecoder)===1}readTypeRef(){return De(this.restDecoder)}readLen(){return De(this.restDecoder)}readAny(){return lc(this.restDecoder)}readBuf(){return lA($n(this.restDecoder))}readJSON(){return JSON.parse(ro(this.restDecoder))}readKey(){return ro(this.restDecoder)}}class TA{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=De(this.restDecoder),this.dsCurrVal}readDsLen(){const e=De(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class go extends TA{constructor(e){super(e),this.keys=[],De(e),this.keyClockDecoder=new jg($n(e)),this.clientDecoder=new ud($n(e)),this.leftClockDecoder=new jg($n(e)),this.rightClockDecoder=new jg($n(e)),this.infoDecoder=new Db($n(e),fo),this.stringDecoder=new Pk($n(e)),this.parentInfoDecoder=new Db($n(e),fo),this.typeRefDecoder=new ud($n(e)),this.lenDecoder=new ud($n(e))}readLeftID(){return new ao(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ao(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return lc(this.restDecoder)}readBuf(){return $n(this.restDecoder)}readJSON(){return lc(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class DA{constructor(){this.restEncoder=Kd()}toUint8Array(){return wi(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){$e(this.restEncoder,e)}writeDsLen(e){$e(this.restEncoder,e)}}class Tc extends DA{writeLeftID(e){$e(this.restEncoder,e.client),$e(this.restEncoder,e.clock)}writeRightID(e){$e(this.restEncoder,e.client),$e(this.restEncoder,e.clock)}writeClient(e){$e(this.restEncoder,e)}writeInfo(e){wp(this.restEncoder,e)}writeString(e){so(this.restEncoder,e)}writeParentInfo(e){$e(this.restEncoder,e?1:0)}writeTypeRef(e){$e(this.restEncoder,e)}writeLen(e){$e(this.restEncoder,e)}writeAny(e){oc(this.restEncoder,e)}writeBuf(e){Un(this.restEncoder,e)}writeJSON(e){so(this.restEncoder,JSON.stringify(e))}writeKey(e){so(this.restEncoder,e)}}class kA{constructor(){this.restEncoder=Kd(),this.dsCurrVal=0}toUint8Array(){return wi(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,$e(this.restEncoder,t)}writeDsLen(e){e===0&&Ti(),$e(this.restEncoder,e-1),this.dsCurrVal+=e}}class Br extends kA{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Lg,this.clientEncoder=new cd,this.leftClockEncoder=new Lg,this.rightClockEncoder=new Lg,this.infoEncoder=new xb(wp),this.stringEncoder=new Lk,this.parentInfoEncoder=new xb(wp),this.typeRefEncoder=new cd,this.lenEncoder=new cd}toUint8Array(){const e=Kd();return $e(e,0),Un(e,this.keyClockEncoder.toUint8Array()),Un(e,this.clientEncoder.toUint8Array()),Un(e,this.leftClockEncoder.toUint8Array()),Un(e,this.rightClockEncoder.toUint8Array()),Un(e,wi(this.infoEncoder)),Un(e,this.stringEncoder.toUint8Array()),Un(e,wi(this.parentInfoEncoder)),Un(e,this.typeRefEncoder.toUint8Array()),Un(e,this.lenEncoder.toUint8Array()),Jd(e,wi(this.restEncoder)),wi(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){oc(this.restEncoder,e)}writeBuf(e){Un(this.restEncoder,e)}writeJSON(e){oc(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const AA=(s,e,t,n)=>{n=Yr(n,e[0].id.clock);const a=Di(e,n);$e(s.restEncoder,e.length-a),s.writeClient(t),$e(s.restEncoder,n);const o=e[a];o.write(s,n-o.id.clock);for(let c=a+1;c<e.length;c++)e[c].write(s,0)},$v=(s,e,t)=>{const n=new Map;t.forEach((a,o)=>{Vt(e,o)>a&&n.set(o,a)}),Iv(e).forEach((a,o)=>{t.has(o)||n.set(o,0)}),$e(s.restEncoder,n.size),$r(n.entries()).sort((a,o)=>o[0]-a[0]).forEach(([a,o])=>{AA(s,e.clients.get(a),a,o)})},RA=(s,e)=>{const t=ui(),n=De(s.restDecoder);for(let a=0;a<n;a++){const o=De(s.restDecoder),c=new Array(o),d=s.readClient();let h=De(s.restDecoder);t.set(d,{i:0,refs:c});for(let g=0;g<o;g++){const p=s.readInfo();switch(Xd&p){case 0:{const m=s.readLen();c[g]=new Zn(Ne(d,h),m),h+=m;break}case 10:{const m=De(s.restDecoder);c[g]=new Wn(Ne(d,h),m),h+=m;break}default:{const m=(p&(as|Bn))===0,y=new jt(Ne(d,h),null,(p&Bn)===Bn?s.readLeftID():null,null,(p&as)===as?s.readRightID():null,m?s.readParentInfo()?e.get(s.readString()):s.readLeftID():null,m&&(p&rc)===rc?s.readString():null,NE(s,p));c[g]=y,h+=y.length}}}}return t},OA=(s,e,t)=>{const n=[];let a=$r(t.keys()).sort((_,E)=>_-E);if(a.length===0)return null;const o=()=>{if(a.length===0)return null;let _=t.get(a[a.length-1]);for(;_.refs.length===_.i;)if(a.pop(),a.length>0)_=t.get(a[a.length-1]);else return null;return _};let c=o();if(c===null)return null;const d=new fE,h=new Map,g=(_,E)=>{const S=h.get(_);(S==null||S>E)&&h.set(_,E)};let p=c.refs[c.i++];const m=new Map,y=()=>{for(const _ of n){const E=_.id.client,S=t.get(E);S?(S.i--,d.clients.set(E,S.refs.slice(S.i)),t.delete(E),S.i=0,S.refs=[]):d.clients.set(E,[_]),a=a.filter(T=>T!==E)}n.length=0};for(;;){if(p.constructor!==Wn){const E=sr(m,p.id.client,()=>Vt(e,p.id.client))-p.id.clock;if(E<0)n.push(p),g(p.id.client,p.id.clock-1),y();else{const S=p.getMissing(s,e);if(S!==null){n.push(p);const T=t.get(S)||{refs:[],i:0};if(T.refs.length===T.i)g(S,Vt(e,S)),y();else{p=T.refs[T.i++];continue}}else(E===0||E<p.length)&&(p.integrate(s,E),m.set(p.id.client,p.id.clock+p.length))}}if(n.length>0)p=n.pop();else if(c!==null&&c.i<c.refs.length)p=c.refs[c.i++];else{if(c=o(),c===null)break;p=c.refs[c.i++]}}if(d.clients.size>0){const _=new Br;return $v(_,d,new Map),$e(_.restEncoder,0),{missing:h,update:_.toUint8Array()}}return null},LA=(s,e)=>$v(s,e.doc.store,e.beforeState),jA=(s,e,t,n=new go(s))=>Ze(e,a=>{a.local=!1;let o=!1;const c=a.doc,d=c.store,h=RA(n,c),g=OA(a,d,h),p=d.pendingStructs;if(p){for(const[y,_]of p.missing)if(_<Vt(d,y)){o=!0;break}if(g){for(const[y,_]of g.missing){const E=p.missing.get(y);(E==null||E>_)&&p.missing.set(y,_)}p.update=_d([p.update,g.update])}}else d.pendingStructs=g;const m=Ob(n,a,d);if(d.pendingDs){const y=new go(xo(d.pendingDs));De(y.restDecoder);const _=Ob(y,a,d);m&&_?d.pendingDs=_d([m,_]):d.pendingDs=m||_}else d.pendingDs=m;if(o){const y=d.pendingStructs.update;d.pendingStructs=null,uE(a.doc,y)}},t,!1),uE=(s,e,t,n=go)=>{const a=xo(e);jA(a,s,t,new n(a))},NA=(s,e,t)=>uE(s,e,t,cE),MA=(s,e,t=new Map)=>{$v(s,e.store,t),Co(s,CA(e.store))},UA=(s,e=new Uint8Array([0]),t=new Br)=>{const n=dE(e);MA(t,s,n);const a=[t.toUint8Array()];if(s.store.pendingDs&&a.push(s.store.pendingDs),s.store.pendingStructs&&a.push(XA(s.store.pendingStructs.update,e)),a.length>1){if(t.constructor===Tc)return GA(a.map((o,c)=>c===0?o:JA(o)));if(t.constructor===Br)return _d(a)}return a[0]},$A=(s,e)=>UA(s,e,new Tc),IA=s=>{const e=new Map,t=De(s.restDecoder);for(let n=0;n<t;n++){const a=De(s.restDecoder),o=De(s.restDecoder);e.set(a,o)}return e},dE=s=>IA(new lE(xo(s)));class BA{constructor(){this.l=[]}}const Lb=()=>new BA,jb=(s,e)=>s.l.push(e),Nb=(s,e)=>{const t=s.l,n=t.length;s.l=t.filter(a=>e!==a),n===s.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},hE=(s,e,t)=>Lv(s.l,[e,t]);class ao{constructor(e,t){this.client=e,this.clock=t}}const Yu=(s,e)=>s===e||s!==null&&e!==null&&s.client===e.client&&s.clock===e.clock,Ne=(s,e)=>new ao(s,e),zA=s=>{for(const[e,t]of s.doc.share.entries())if(t===s)return e;throw Ti()},Ka=(s,e)=>e===void 0?!s.deleted:e.sv.has(s.id.client)&&(e.sv.get(s.id.client)||0)>s.id.clock&&!aE(e.ds,s.id),xp=(s,e)=>{const t=sr(s.meta,xp,ho),n=s.doc.store;t.has(e)||(e.sv.forEach((a,o)=>{a<Vt(n,o)&&nr(s,Ne(o,a))}),rE(s,e.ds,a=>{}),t.add(e))};class fE{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Iv=s=>{const e=new Map;return s.clients.forEach((t,n)=>{const a=t[t.length-1];e.set(n,a.id.clock+a.length)}),e},Vt=(s,e)=>{const t=s.clients.get(e);if(t===void 0)return 0;const n=t[t.length-1];return n.id.clock+n.length},gE=(s,e)=>{let t=s.clients.get(e.id.client);if(t===void 0)t=[],s.clients.set(e.id.client,t);else{const n=t[t.length-1];if(n.id.clock+n.length!==e.id.clock)throw Ti()}t.push(e)},Di=(s,e)=>{let t=0,n=s.length-1,a=s[n],o=a.id.clock;if(o===e)return n;let c=er(e/(o+a.length-1)*n);for(;t<=n;){if(a=s[c],o=a.id.clock,o<=e){if(e<o+a.length)return c;t=c+1}else n=c-1;c=er((t+n)/2)}throw Ti()},PA=(s,e)=>{const t=s.clients.get(e.client);return t[Di(t,e.clock)]},Mg=PA,Cp=(s,e,t)=>{const n=Di(e,t),a=e[n];return a.id.clock<t&&a instanceof jt?(e.splice(n+1,0,Cd(s,a,t-a.id.clock)),n+1):n},nr=(s,e)=>{const t=s.doc.store.clients.get(e.client);return t[Cp(s,t,e.clock)]},Mb=(s,e,t)=>{const n=e.clients.get(t.client),a=Di(n,t.clock),o=n[a];return t.clock!==o.id.clock+o.length-1&&o.constructor!==Zn&&n.splice(a+1,0,Cd(s,o,t.clock-o.id.clock+1)),o},qA=(s,e,t)=>{const n=s.clients.get(e.id.client);n[Di(n,e.id.clock)]=t},pE=(s,e,t,n,a)=>{if(n===0)return;const o=t+n;let c=Cp(s,e,t),d;do d=e[c++],o<d.id.clock+d.length&&Cp(s,e,o),a(d);while(c<e.length&&e[c].id.clock<o)};class HA{constructor(e,t,n){this.doc=e,this.deleteSet=new Cc,this.beforeState=Iv(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Ub=(s,e)=>e.deleteSet.clients.size===0&&!uk(e.afterState,(t,n)=>e.beforeState.get(n)!==t)?!1:(Mv(e.deleteSet),LA(s,e),Co(s,e.deleteSet),!0),$b=(s,e,t)=>{const n=e._item;(n===null||n.id.clock<(s.beforeState.get(n.id.client)||0)&&!n.deleted)&&sr(s.changed,e,ho).add(t)},dd=(s,e)=>{let t=s[e],n=s[e-1],a=e;for(;a>0;t=n,n=s[--a-1]){if(n.deleted===t.deleted&&n.constructor===t.constructor&&n.mergeWith(t)){t instanceof jt&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,n);continue}break}const o=e-a;return o&&s.splice(e+1-o,o),o},FA=(s,e,t)=>{for(const[n,a]of s.clients.entries()){const o=e.clients.get(n);for(let c=a.length-1;c>=0;c--){const d=a[c],h=d.clock+d.len;for(let g=Di(o,d.clock),p=o[g];g<o.length&&p.id.clock<h;p=o[++g]){const m=o[g];if(d.clock+d.len<=m.id.clock)break;m instanceof jt&&m.deleted&&!m.keep&&t(m)&&m.gc(e,!1)}}}},YA=(s,e)=>{s.clients.forEach((t,n)=>{const a=e.clients.get(n);for(let o=t.length-1;o>=0;o--){const c=t[o],d=HS(a.length-1,1+Di(a,c.clock+c.len-1));for(let h=d,g=a[h];h>0&&g.id.clock>=c.clock;g=a[h])h-=1+dd(a,h)}})},vE=(s,e)=>{if(e<s.length){const t=s[e],n=t.doc,a=n.store,o=t.deleteSet,c=t._mergeStructs;try{Mv(o),t.afterState=Iv(t.doc.store),n.emit("beforeObserverCalls",[t,n]);const d=[];t.changed.forEach((h,g)=>d.push(()=>{(g._item===null||!g._item.deleted)&&g._callObserver(t,h)})),d.push(()=>{t.changedParentTypes.forEach((h,g)=>{g._dEH.l.length>0&&(g._item===null||!g._item.deleted)&&(h=h.filter(p=>p.target._item===null||!p.target._item.deleted),h.forEach(p=>{p.currentTarget=g,p._path=null}),h.sort((p,m)=>p.path.length-m.path.length),hE(g._dEH,h,t))})}),d.push(()=>n.emit("afterTransaction",[t,n])),Lv(d,[]),t._needFormattingCleanup&&dR(t)}finally{n.gc&&FA(o,a,n.gcFilter),YA(o,a),t.afterState.forEach((p,m)=>{const y=t.beforeState.get(m)||0;if(y!==p){const _=a.clients.get(m),E=Yr(Di(_,y),1);for(let S=_.length-1;S>=E;)S-=1+dd(_,S)}});for(let p=c.length-1;p>=0;p--){const{client:m,clock:y}=c[p].id,_=a.clients.get(m),E=Di(_,y);E+1<_.length&&dd(_,E+1)>1||E>0&&dd(_,E)}if(!t.local&&t.afterState.get(n.clientID)!==t.beforeState.get(n.clientID)&&(_A(jv,WS,"[yjs] ",eE,tE,"Changed the client-id because another client seems to be using it."),n.clientID=oE()),n.emit("afterTransactionCleanup",[t,n]),n._observers.has("update")){const p=new Tc;Ub(p,t)&&n.emit("update",[p.toUint8Array(),t.origin,n,t])}if(n._observers.has("updateV2")){const p=new Br;Ub(p,t)&&n.emit("updateV2",[p.toUint8Array(),t.origin,n,t])}const{subdocsAdded:d,subdocsLoaded:h,subdocsRemoved:g}=t;(d.size>0||g.size>0||h.size>0)&&(d.forEach(p=>{p.clientID=n.clientID,p.collectionid==null&&(p.collectionid=n.collectionid),n.subdocs.add(p)}),g.forEach(p=>n.subdocs.delete(p)),n.emit("subdocs",[{loaded:h,added:d,removed:g},n,t]),g.forEach(p=>p.destroy())),s.length<=e+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,s])):vE(s,e+1)}}},Ze=(s,e,t=null,n=!0)=>{const a=s._transactionCleanups;let o=!1,c=null;s._transaction===null&&(o=!0,s._transaction=new HA(s,t,n),a.push(s._transaction),a.length===1&&s.emit("beforeAllTransactions",[s]),s.emit("beforeTransaction",[s._transaction,s]));try{c=e(s._transaction)}finally{if(o){const d=s._transaction===a[0];s._transaction=null,d&&vE(a,0)}}return c};function*VA(s){const e=De(s.restDecoder);for(let t=0;t<e;t++){const n=De(s.restDecoder),a=s.readClient();let o=De(s.restDecoder);for(let c=0;c<n;c++){const d=s.readInfo();if(d===10){const h=De(s.restDecoder);yield new Wn(Ne(a,o),h),o+=h}else if((Xd&d)!==0){const h=(d&(as|Bn))===0,g=new jt(Ne(a,o),null,(d&Bn)===Bn?s.readLeftID():null,null,(d&as)===as?s.readRightID():null,h?s.readParentInfo()?s.readString():s.readLeftID():null,h&&(d&rc)===rc?s.readString():null,NE(s,d));yield g,o+=g.length}else{const h=s.readLen();yield new Zn(Ne(a,o),h),o+=h}}}}class Bv{constructor(e,t){this.gen=VA(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Wn);return this.curr}}class zv{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const GA=s=>_d(s,cE,Tc),QA=(s,e)=>{if(s.constructor===Zn){const{client:t,clock:n}=s.id;return new Zn(Ne(t,n+e),s.length-e)}else if(s.constructor===Wn){const{client:t,clock:n}=s.id;return new Wn(Ne(t,n+e),s.length-e)}else{const t=s,{client:n,clock:a}=t.id;return new jt(Ne(n,a+e),null,Ne(n,a+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},_d=(s,e=go,t=Br)=>{if(s.length===1)return s[0];const n=s.map(p=>new e(xo(p)));let a=n.map(p=>new Bv(p,!0)),o=null;const c=new t,d=new zv(c);for(;a=a.filter(y=>y.curr!==null),a.sort((y,_)=>{if(y.curr.id.client===_.curr.id.client){const E=y.curr.id.clock-_.curr.id.clock;return E===0?y.curr.constructor===_.curr.constructor?0:y.curr.constructor===Wn?1:-1:E}else return _.curr.id.client-y.curr.id.client}),a.length!==0;){const p=a[0],m=p.curr.id.client;if(o!==null){let y=p.curr,_=!1;for(;y!==null&&y.id.clock+y.length<=o.struct.id.clock+o.struct.length&&y.id.client>=o.struct.id.client;)y=p.next(),_=!0;if(y===null||y.id.client!==m||_&&y.id.clock>o.struct.id.clock+o.struct.length)continue;if(m!==o.struct.id.client)Fs(d,o.struct,o.offset),o={struct:y,offset:0},p.next();else if(o.struct.id.clock+o.struct.length<y.id.clock)if(o.struct.constructor===Wn)o.struct.length=y.id.clock+y.length-o.struct.id.clock;else{Fs(d,o.struct,o.offset);const E=y.id.clock-o.struct.id.clock-o.struct.length;o={struct:new Wn(Ne(m,o.struct.id.clock+o.struct.length),E),offset:0}}else{const E=o.struct.id.clock+o.struct.length-y.id.clock;E>0&&(o.struct.constructor===Wn?o.struct.length-=E:y=QA(y,E)),o.struct.mergeWith(y)||(Fs(d,o.struct,o.offset),o={struct:y,offset:0},p.next())}}else o={struct:p.curr,offset:0},p.next();for(let y=p.curr;y!==null&&y.id.client===m&&y.id.clock===o.struct.id.clock+o.struct.length&&y.constructor!==Wn;y=p.next())Fs(d,o.struct,o.offset),o={struct:y,offset:0}}o!==null&&(Fs(d,o.struct,o.offset),o=null),Pv(d);const h=n.map(p=>Uv(p)),g=EA(h);return Co(c,g),c.toUint8Array()},XA=(s,e,t=go,n=Br)=>{const a=dE(e),o=new n,c=new zv(o),d=new t(xo(s)),h=new Bv(d,!1);for(;h.curr;){const p=h.curr,m=p.id.client,y=a.get(m)||0;if(h.curr.constructor===Wn){h.next();continue}if(p.id.clock+p.length>y)for(Fs(c,p,Yr(y-p.id.clock,0)),h.next();h.curr&&h.curr.id.client===m;)Fs(c,h.curr,0),h.next();else for(;h.curr&&h.curr.id.client===m&&h.curr.id.clock+h.curr.length<=y;)h.next()}Pv(c);const g=Uv(d);return Co(o,g),o.toUint8Array()},mE=s=>{s.written>0&&(s.clientStructs.push({written:s.written,restEncoder:wi(s.encoder.restEncoder)}),s.encoder.restEncoder=Kd(),s.written=0)},Fs=(s,e,t)=>{s.written>0&&s.currClient!==e.id.client&&mE(s),s.written===0&&(s.currClient=e.id.client,s.encoder.writeClient(e.id.client),$e(s.encoder.restEncoder,e.id.clock+t)),e.write(s.encoder,t),s.written++},Pv=s=>{mE(s);const e=s.encoder.restEncoder;$e(e,s.clientStructs.length);for(let t=0;t<s.clientStructs.length;t++){const n=s.clientStructs[t];$e(e,n.written),Jd(e,n.restEncoder)}},KA=(s,e,t,n)=>{const a=new t(xo(s)),o=new Bv(a,!1),c=new n,d=new zv(c);for(let g=o.curr;g!==null;g=o.next())Fs(d,e(g),0);Pv(d);const h=Uv(a);return Co(c,h),c.toUint8Array()},JA=s=>KA(s,nA,go,Tc),Ib="You must not compute changes after the event-handler fired.";class Wd{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=ZA(this.currentTarget,this.target))}deletes(e){return aE(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw tr(Ib);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(a=>{if(a!==null){const o=t._map.get(a);let c,d;if(this.adds(o)){let h=o.left;for(;h!==null&&this.adds(h);)h=h.left;if(this.deletes(o))if(h!==null&&this.deletes(h))c="delete",d=Ag(h.content.getContent());else return;else h!==null&&this.deletes(h)?(c="update",d=Ag(h.content.getContent())):(c="add",d=void 0)}else if(this.deletes(o))c="delete",d=Ag(o.content.getContent());else return;e.set(a,{action:c,oldValue:d})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw tr(Ib);const t=this.target,n=ho(),a=ho(),o=[];if(e={added:n,deleted:a,delta:o,keys:this.keys},this.transaction.changed.get(t).has(null)){let d=null;const h=()=>{d&&o.push(d)};for(let g=t._start;g!==null;g=g.right)g.deleted?this.deletes(g)&&!this.adds(g)&&((d===null||d.delete===void 0)&&(h(),d={delete:0}),d.delete+=g.length,a.add(g)):this.adds(g)?((d===null||d.insert===void 0)&&(h(),d={insert:[]}),d.insert=d.insert.concat(g.content.getContent()),n.add(g)):((d===null||d.retain===void 0)&&(h(),d={retain:0}),d.retain+=g.length);d!==null&&d.retain===void 0&&h()}this._changes=e}return e}}const ZA=(s,e)=>{const t=[];for(;e._item!==null&&e!==s;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let n=0,a=e._item.parent._start;for(;a!==e._item&&a!==null;)!a.deleted&&a.countable&&(n+=a.length),a=a.right;t.unshift(n)}e=e._item.parent}return t},cn=()=>{bA("Invalid access: Add Yjs type to a document before reading data.")},yE=80;let qv=0;class WA{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=qv++}}const eR=s=>{s.timestamp=qv++},_E=(s,e,t)=>{s.p.marker=!1,s.p=e,e.marker=!0,s.index=t,s.timestamp=qv++},tR=(s,e,t)=>{if(s.length>=yE){const n=s.reduce((a,o)=>a.timestamp<o.timestamp?a:o);return _E(n,e,t),n}else{const n=new WA(e,t);return s.push(n),n}},eh=(s,e)=>{if(s._start===null||e===0||s._searchMarker===null)return null;const t=s._searchMarker.length===0?null:s._searchMarker.reduce((o,c)=>ld(e-o.index)<ld(e-c.index)?o:c);let n=s._start,a=0;for(t!==null&&(n=t.p,a=t.index,eR(t));n.right!==null&&a<e;){if(!n.deleted&&n.countable){if(e<a+n.length)break;a+=n.length}n=n.right}for(;n.left!==null&&a>e;)n=n.left,!n.deleted&&n.countable&&(a-=n.length);for(;n.left!==null&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)n=n.left,!n.deleted&&n.countable&&(a-=n.length);return t!==null&&ld(t.index-a)<n.parent.length/yE?(_E(t,n,a),t):tR(s._searchMarker,n,a)},uc=(s,e,t)=>{for(let n=s.length-1;n>=0;n--){const a=s[n];if(t>0){let o=a.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)o=o.left,o&&!o.deleted&&o.countable&&(a.index-=o.length);if(o===null||o.marker===!0){s.splice(n,1);continue}a.p=o,o.marker=!0}(e<a.index||t>0&&e===a.index)&&(a.index=Yr(e,a.index+t))}},th=(s,e,t)=>{const n=s,a=e.changedParentTypes;for(;sr(a,s,()=>[]).push(t),s._item!==null;)s=s._item.parent;hE(n._eH,t,e)};class tn{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Lb(),this._dEH=Lb(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw xi()}clone(){throw xi()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){jb(this._eH,e)}observeDeep(e){jb(this._dEH,e)}unobserve(e){Nb(this._eH,e)}unobserveDeep(e){Nb(this._dEH,e)}toJSON(){}}const bE=(s,e,t)=>{s.doc??cn(),e<0&&(e=s._length+e),t<0&&(t=s._length+t);let n=t-e;const a=[];let o=s._start;for(;o!==null&&n>0;){if(o.countable&&!o.deleted){const c=o.content.getContent();if(c.length<=e)e-=c.length;else{for(let d=e;d<c.length&&n>0;d++)a.push(c[d]),n--;e=0}}o=o.right}return a},wE=s=>{s.doc??cn();const e=[];let t=s._start;for(;t!==null;){if(t.countable&&!t.deleted){const n=t.content.getContent();for(let a=0;a<n.length;a++)e.push(n[a])}t=t.right}return e},dc=(s,e)=>{let t=0,n=s._start;for(s.doc??cn();n!==null;){if(n.countable&&!n.deleted){const a=n.content.getContent();for(let o=0;o<a.length;o++)e(a[o],t++,s)}n=n.right}},SE=(s,e)=>{const t=[];return dc(s,(n,a)=>{t.push(e(n,a,s))}),t},nR=s=>{let e=s._start,t=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),n=0,e=e.right}const a=t[n++];return t.length<=n&&(t=null),{done:!1,value:a}}}},EE=(s,e)=>{s.doc??cn();const t=eh(s,e);let n=s._start;for(t!==null&&(n=t.p,e-=t.index);n!==null;n=n.right)if(!n.deleted&&n.countable){if(e<n.length)return n.content.getContent()[e];e-=n.length}},bd=(s,e,t,n)=>{let a=t;const o=s.doc,c=o.clientID,d=o.store,h=t===null?e._start:t.right;let g=[];const p=()=>{g.length>0&&(a=new jt(Ne(c,Vt(d,c)),a,a&&a.lastId,h,h&&h.id,e,null,new Pr(g)),a.integrate(s,0),g=[])};n.forEach(m=>{if(m===null)g.push(m);else switch(m.constructor){case Number:case Object:case Boolean:case Array:case String:g.push(m);break;default:switch(p(),m.constructor){case Uint8Array:case ArrayBuffer:a=new jt(Ne(c,Vt(d,c)),a,a&&a.lastId,h,h&&h.id,e,null,new Dc(new Uint8Array(m))),a.integrate(s,0);break;case Ir:a=new jt(Ne(c,Vt(d,c)),a,a&&a.lastId,h,h&&h.id,e,null,new kc(m)),a.integrate(s,0);break;default:if(m instanceof tn)a=new jt(Ne(c,Vt(d,c)),a,a&&a.lastId,h,h&&h.id,e,null,new cs(m)),a.integrate(s,0);else throw new Error("Unexpected content type in insert operation")}}}),p()},xE=()=>tr("Length exceeded!"),CE=(s,e,t,n)=>{if(t>e._length)throw xE();if(t===0)return e._searchMarker&&uc(e._searchMarker,t,n.length),bd(s,e,null,n);const a=t,o=eh(e,t);let c=e._start;for(o!==null&&(c=o.p,t-=o.index,t===0&&(c=c.prev,t+=c&&c.countable&&!c.deleted?c.length:0));c!==null;c=c.right)if(!c.deleted&&c.countable){if(t<=c.length){t<c.length&&nr(s,Ne(c.id.client,c.id.clock+t));break}t-=c.length}return e._searchMarker&&uc(e._searchMarker,a,n.length),bd(s,e,c,n)},iR=(s,e,t)=>{let a=(e._searchMarker||[]).reduce((o,c)=>c.index>o.index?c:o,{index:0,p:e._start}).p;if(a)for(;a.right;)a=a.right;return bd(s,e,a,t)},TE=(s,e,t,n)=>{if(n===0)return;const a=t,o=n,c=eh(e,t);let d=e._start;for(c!==null&&(d=c.p,t-=c.index);d!==null&&t>0;d=d.right)!d.deleted&&d.countable&&(t<d.length&&nr(s,Ne(d.id.client,d.id.clock+t)),t-=d.length);for(;n>0&&d!==null;)d.deleted||(n<d.length&&nr(s,Ne(d.id.client,d.id.clock+n)),d.delete(s),n-=d.length),d=d.right;if(n>0)throw xE();e._searchMarker&&uc(e._searchMarker,a,-o+n)},wd=(s,e,t)=>{const n=e._map.get(t);n!==void 0&&n.delete(s)},Hv=(s,e,t,n)=>{const a=e._map.get(t)||null,o=s.doc,c=o.clientID;let d;if(n==null)d=new Pr([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:d=new Pr([n]);break;case Uint8Array:d=new Dc(n);break;case Ir:d=new kc(n);break;default:if(n instanceof tn)d=new cs(n);else throw new Error("Unexpected content type")}new jt(Ne(c,Vt(o.store,c)),a,a&&a.lastId,null,null,e,t,d).integrate(s,0)},Fv=(s,e)=>{s.doc??cn();const t=s._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},DE=s=>{const e={};return s.doc??cn(),s._map.forEach((t,n)=>{t.deleted||(e[n]=t.content.getContent()[t.length-1])}),e},kE=(s,e)=>{s.doc??cn();const t=s._map.get(e);return t!==void 0&&!t.deleted},sR=(s,e)=>{const t={};return s._map.forEach((n,a)=>{let o=n;for(;o!==null&&(!e.sv.has(o.id.client)||o.id.clock>=(e.sv.get(o.id.client)||0));)o=o.left;o!==null&&Ka(o,e)&&(t[a]=o.content.getContent()[o.length-1])}),t},Vu=s=>(s.doc??cn(),wA(s._map.entries(),e=>!e[1].deleted));class rR extends Wd{}class oo extends tn{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new oo;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new oo}clone(){const e=new oo;return e.insert(0,this.toArray().map(t=>t instanceof tn?t.clone():t)),e}get length(){return this.doc??cn(),this._length}_callObserver(e,t){super._callObserver(e,t),th(this,e,new rR(this,e))}insert(e,t){this.doc!==null?Ze(this.doc,n=>{CE(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?Ze(this.doc,t=>{iR(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?Ze(this.doc,n=>{TE(n,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return EE(this,e)}toArray(){return wE(this)}slice(e=0,t=this.length){return bE(this,e,t)}toJSON(){return this.map(e=>e instanceof tn?e.toJSON():e)}map(e){return SE(this,e)}forEach(e){dc(this,e)}[Symbol.iterator](){return nR(this)}_write(e){e.writeTypeRef(RR)}}const aR=s=>new oo;class oR extends Wd{constructor(e,t,n){super(e,t),this.keysChanged=n}}class po extends tn{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((n,a)=>{this.set(a,n)}),this._prelimContent=null}_copy(){return new po}clone(){const e=new po;return this.forEach((t,n)=>{e.set(n,t instanceof tn?t.clone():t)}),e}_callObserver(e,t){th(this,e,new oR(this,e,t))}toJSON(){this.doc??cn();const e={};return this._map.forEach((t,n)=>{if(!t.deleted){const a=t.content.getContent()[t.length-1];e[n]=a instanceof tn?a.toJSON():a}}),e}get size(){return[...Vu(this)].length}keys(){return Ng(Vu(this),e=>e[0])}values(){return Ng(Vu(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return Ng(Vu(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??cn(),this._map.forEach((t,n)=>{t.deleted||e(t.content.getContent()[t.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Ze(this.doc,t=>{wd(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?Ze(this.doc,n=>{Hv(n,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return Fv(this,e)}has(e){return kE(this,e)}clear(){this.doc!==null?Ze(this.doc,e=>{this.forEach(function(t,n,a){wd(e,a,n)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(OR)}}const lR=s=>new po,Gs=(s,e)=>s===e||typeof s=="object"&&typeof e=="object"&&s&&e&&eA(s,e);class Tp{constructor(e,t,n,a){this.left=e,this.right=t,this.index=n,this.currentAttributes=a}forward(){switch(this.right===null&&Ti(),this.right.content.constructor){case Nt:this.right.deleted||To(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Bb=(s,e,t)=>{for(;e.right!==null&&t>0;){switch(e.right.content.constructor){case Nt:e.right.deleted||To(e.currentAttributes,e.right.content);break;default:e.right.deleted||(t<e.right.length&&nr(s,Ne(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},Gu=(s,e,t,n)=>{const a=new Map,o=n?eh(e,t):null;if(o){const c=new Tp(o.p.left,o.p,o.index,a);return Bb(s,c,t-o.index)}else{const c=new Tp(null,e._start,0,a);return Bb(s,c,t)}},AE=(s,e,t,n)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===Nt&&Gs(n.get(t.right.content.key),t.right.content.value));)t.right.deleted||n.delete(t.right.content.key),t.forward();const a=s.doc,o=a.clientID;n.forEach((c,d)=>{const h=t.left,g=t.right,p=new jt(Ne(o,Vt(a.store,o)),h,h&&h.lastId,g,g&&g.id,e,null,new Nt(d,c));p.integrate(s,0),t.right=p,t.forward()})},To=(s,e)=>{const{key:t,value:n}=e;n===null?s.delete(t):s.set(t,n)},RE=(s,e)=>{for(;s.right!==null;){if(!(s.right.deleted||s.right.content.constructor===Nt&&Gs(e[s.right.content.key]??null,s.right.content.value)))break;s.forward()}},OE=(s,e,t,n)=>{const a=s.doc,o=a.clientID,c=new Map;for(const d in n){const h=n[d],g=t.currentAttributes.get(d)??null;if(!Gs(g,h)){c.set(d,g);const{left:p,right:m}=t;t.right=new jt(Ne(o,Vt(a.store,o)),p,p&&p.lastId,m,m&&m.id,e,null,new Nt(d,h)),t.right.integrate(s,0),t.forward()}}return c},Ug=(s,e,t,n,a)=>{t.currentAttributes.forEach((y,_)=>{a[_]===void 0&&(a[_]=null)});const o=s.doc,c=o.clientID;RE(t,a);const d=OE(s,e,t,a),h=n.constructor===String?new ki(n):n instanceof tn?new cs(n):new Vr(n);let{left:g,right:p,index:m}=t;e._searchMarker&&uc(e._searchMarker,t.index,h.getLength()),p=new jt(Ne(c,Vt(o.store,c)),g,g&&g.lastId,p,p&&p.id,e,null,h),p.integrate(s,0),t.right=p,t.index=m,t.forward(),AE(s,e,t,d)},zb=(s,e,t,n,a)=>{const o=s.doc,c=o.clientID;RE(t,a);const d=OE(s,e,t,a);e:for(;t.right!==null&&(n>0||d.size>0&&(t.right.deleted||t.right.content.constructor===Nt));){if(!t.right.deleted)switch(t.right.content.constructor){case Nt:{const{key:h,value:g}=t.right.content,p=a[h];if(p!==void 0){if(Gs(p,g))d.delete(h);else{if(n===0)break e;d.set(h,g)}t.right.delete(s)}else t.currentAttributes.set(h,g);break}default:n<t.right.length&&nr(s,Ne(t.right.id.client,t.right.id.clock+n)),n-=t.right.length;break}t.forward()}if(n>0){let h="";for(;n>0;n--)h+=`
`;t.right=new jt(Ne(c,Vt(o.store,c)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new ki(h)),t.right.integrate(s,0),t.forward()}AE(s,e,t,d)},LE=(s,e,t,n,a)=>{let o=e;const c=ui();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===Nt){const g=o.content;c.set(g.key,g)}o=o.right}let d=0,h=!1;for(;e!==o;){if(t===e&&(h=!0),!e.deleted){const g=e.content;switch(g.constructor){case Nt:{const{key:p,value:m}=g,y=n.get(p)??null;(c.get(p)!==g||y===m)&&(e.delete(s),d++,!h&&(a.get(p)??null)===m&&y!==m&&(y===null?a.delete(p):a.set(p,y))),!h&&!e.deleted&&To(a,g);break}}}e=e.right}return d},cR=(s,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Nt){const n=e.content.key;t.has(n)?e.delete(s):t.add(n)}e=e.left}},uR=s=>{let e=0;return Ze(s.doc,t=>{let n=s._start,a=s._start,o=ui();const c=_p(o);for(;a;){if(a.deleted===!1)switch(a.content.constructor){case Nt:To(c,a.content);break;default:e+=LE(t,n,a,o,c),o=_p(c),n=a;break}a=a.right}}),e},dR=s=>{const e=new Set,t=s.doc;for(const[n,a]of s.afterState.entries()){const o=s.beforeState.get(n)||0;a!==o&&pE(s,t.store.clients.get(n),o,a,c=>{!c.deleted&&c.content.constructor===Nt&&c.constructor!==Zn&&e.add(c.parent)})}Ze(t,n=>{rE(s,s.deleteSet,a=>{if(a instanceof Zn||!a.parent._hasFormatting||e.has(a.parent))return;const o=a.parent;a.content.constructor===Nt?e.add(o):cR(n,a)});for(const a of e)uR(a)})},Pb=(s,e,t)=>{const n=t,a=_p(e.currentAttributes),o=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case cs:case Vr:case ki:t<e.right.length&&nr(s,Ne(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(s);break}e.forward()}o&&LE(s,o,e.right,a,e.currentAttributes);const c=(e.left||e.right).parent;return c._searchMarker&&uc(c._searchMarker,e.index,-n+t),e};class hR extends Wd{constructor(e,t,n){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(a=>{a===null?this.childListChanged=!0:this.keysChanged.add(a)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];Ze(e,n=>{const a=new Map,o=new Map;let c=this.target._start,d=null;const h={};let g="",p=0,m=0;const y=()=>{if(d!==null){let _=null;switch(d){case"delete":m>0&&(_={delete:m}),m=0;break;case"insert":(typeof g=="object"||g.length>0)&&(_={insert:g},a.size>0&&(_.attributes={},a.forEach((E,S)=>{E!==null&&(_.attributes[S]=E)}))),g="";break;case"retain":p>0&&(_={retain:p},Jk(h)||(_.attributes=Qk({},h))),p=0;break}_&&t.push(_),d=null}};for(;c!==null;){switch(c.content.constructor){case cs:case Vr:this.adds(c)?this.deletes(c)||(y(),d="insert",g=c.content.getContent()[0],y()):this.deletes(c)?(d!=="delete"&&(y(),d="delete"),m+=1):c.deleted||(d!=="retain"&&(y(),d="retain"),p+=1);break;case ki:this.adds(c)?this.deletes(c)||(d!=="insert"&&(y(),d="insert"),g+=c.content.str):this.deletes(c)?(d!=="delete"&&(y(),d="delete"),m+=c.length):c.deleted||(d!=="retain"&&(y(),d="retain"),p+=c.length);break;case Nt:{const{key:_,value:E}=c.content;if(this.adds(c)){if(!this.deletes(c)){const S=a.get(_)??null;Gs(S,E)?E!==null&&c.delete(n):(d==="retain"&&y(),Gs(E,o.get(_)??null)?delete h[_]:h[_]=E)}}else if(this.deletes(c)){o.set(_,E);const S=a.get(_)??null;Gs(S,E)||(d==="retain"&&y(),h[_]=S)}else if(!c.deleted){o.set(_,E);const S=h[_];S!==void 0&&(Gs(S,E)?S!==null&&c.delete(n):(d==="retain"&&y(),E===null?delete h[_]:h[_]=E))}c.deleted||(d==="insert"&&y(),To(a,c.content));break}}c=c.right}for(y();t.length>0;){const _=t[t.length-1];if(_.retain!==void 0&&_.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class vo extends tn{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??cn(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(n=>n())}catch(n){console.error(n)}this._pending=null}_copy(){return new vo}clone(){const e=new vo;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const n=new hR(this,e,t);th(this,e,n),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??cn();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===ki&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?Ze(this.doc,n=>{const a=new Tp(null,this._start,0,new Map);for(let o=0;o<e.length;o++){const c=e[o];if(c.insert!==void 0){const d=!t&&typeof c.insert=="string"&&o===e.length-1&&a.right===null&&c.insert.slice(-1)===`
`?c.insert.slice(0,-1):c.insert;(typeof d!="string"||d.length>0)&&Ug(n,this,a,d,c.attributes||{})}else c.retain!==void 0?zb(n,this,a,c.retain,c.attributes||{}):c.delete!==void 0&&Pb(n,a,c.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,n){this.doc??cn();const a=[],o=new Map,c=this.doc;let d="",h=this._start;function g(){if(d.length>0){const m={};let y=!1;o.forEach((E,S)=>{y=!0,m[S]=E});const _={insert:d};y&&(_.attributes=m),a.push(_),d=""}}const p=()=>{for(;h!==null;){if(Ka(h,e)||t!==void 0&&Ka(h,t))switch(h.content.constructor){case ki:{const m=o.get("ychange");e!==void 0&&!Ka(h,e)?(m===void 0||m.user!==h.id.client||m.type!=="removed")&&(g(),o.set("ychange",n?n("removed",h.id):{type:"removed"})):t!==void 0&&!Ka(h,t)?(m===void 0||m.user!==h.id.client||m.type!=="added")&&(g(),o.set("ychange",n?n("added",h.id):{type:"added"})):m!==void 0&&(g(),o.delete("ychange")),d+=h.content.str;break}case cs:case Vr:{g();const m={insert:h.content.getContent()[0]};if(o.size>0){const y={};m.attributes=y,o.forEach((_,E)=>{y[E]=_})}a.push(m);break}case Nt:Ka(h,e)&&(g(),To(o,h.content));break}h=h.right}g()};return e||t?Ze(c,m=>{e&&xp(m,e),t&&xp(m,t),p()},"cleanup"):p(),a}insert(e,t,n){if(t.length<=0)return;const a=this.doc;a!==null?Ze(a,o=>{const c=Gu(o,this,e,!n);n||(n={},c.currentAttributes.forEach((d,h)=>{n[h]=d})),Ug(o,this,c,t,n)}):this._pending.push(()=>this.insert(e,t,n))}insertEmbed(e,t,n){const a=this.doc;a!==null?Ze(a,o=>{const c=Gu(o,this,e,!n);Ug(o,this,c,t,n||{})}):this._pending.push(()=>this.insertEmbed(e,t,n||{}))}delete(e,t){if(t===0)return;const n=this.doc;n!==null?Ze(n,a=>{Pb(a,Gu(a,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,n){if(t===0)return;const a=this.doc;a!==null?Ze(a,o=>{const c=Gu(o,this,e,!1);c.right!==null&&zb(o,this,c,t,n)}):this._pending.push(()=>this.format(e,t,n))}removeAttribute(e){this.doc!==null?Ze(this.doc,t=>{wd(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?Ze(this.doc,n=>{Hv(n,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return Fv(this,e)}getAttributes(){return DE(this)}_write(e){e.writeTypeRef(LR)}}const fR=s=>new vo;class $g{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??cn()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===mo||t.constructor===zr)&&t._start!==null)e=t._start;else for(;e!==null;){const n=e.next;if(n!==null){e=n;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class zr extends tn{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new zr}clone(){const e=new zr;return e.insert(0,this.toArray().map(t=>t instanceof tn?t.clone():t)),e}get length(){return this.doc??cn(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new $g(this,e)}querySelector(e){e=e.toUpperCase();const n=new $g(this,a=>a.nodeName&&a.nodeName.toUpperCase()===e).next();return n.done?null:n.value}querySelectorAll(e){return e=e.toUpperCase(),$r(new $g(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){th(this,e,new vR(this,t,e))}toString(){return SE(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},n){const a=e.createDocumentFragment();return n!==void 0&&n._createAssociation(a,this),dc(this,o=>{a.insertBefore(o.toDOM(e,t,n),null)}),a}insert(e,t){this.doc!==null?Ze(this.doc,n=>{CE(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)Ze(this.doc,n=>{const a=e&&e instanceof tn?e._item:e;bd(n,this,a,t)});else{const n=this._prelimContent,a=e===null?0:n.findIndex(o=>o===e)+1;if(a===0&&e!==null)throw tr("Reference item not found");n.splice(a,0,...t)}}delete(e,t=1){this.doc!==null?Ze(this.doc,n=>{TE(n,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return wE(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return EE(this,e)}slice(e=0,t=this.length){return bE(this,e,t)}forEach(e){dc(this,e)}_write(e){e.writeTypeRef(NR)}}const gR=s=>new zr;class mo extends zr{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((n,a)=>{this.setAttribute(a,n)}),this._prelimAttrs=null}_copy(){return new mo(this.nodeName)}clone(){const e=new mo(this.nodeName),t=this.getAttributes();return Kk(t,(n,a)=>{typeof n=="string"&&e.setAttribute(a,n)}),e.insert(0,this.toArray().map(n=>n instanceof tn?n.clone():n)),e}toString(){const e=this.getAttributes(),t=[],n=[];for(const d in e)n.push(d);n.sort();const a=n.length;for(let d=0;d<a;d++){const h=n[d];t.push(h+'="'+e[h]+'"')}const o=this.nodeName.toLocaleLowerCase(),c=t.length>0?" "+t.join(" "):"";return`<${o}${c}>${super.toString()}</${o}>`}removeAttribute(e){this.doc!==null?Ze(this.doc,t=>{wd(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?Ze(this.doc,n=>{Hv(n,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return Fv(this,e)}hasAttribute(e){return kE(this,e)}getAttributes(e){return e?sR(this,e):DE(this)}toDOM(e=document,t={},n){const a=e.createElement(this.nodeName),o=this.getAttributes();for(const c in o){const d=o[c];typeof d=="string"&&a.setAttribute(c,d)}return dc(this,c=>{a.appendChild(c.toDOM(e,t,n))}),n!==void 0&&n._createAssociation(a,this),a}_write(e){e.writeTypeRef(jR),e.writeKey(this.nodeName)}}const pR=s=>new mo(s.readKey());class vR extends Wd{constructor(e,t,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(a=>{a===null?this.childListChanged=!0:this.attributesChanged.add(a)})}}class Sd extends po{constructor(e){super(),this.hookName=e}_copy(){return new Sd(this.hookName)}clone(){const e=new Sd(this.hookName);return this.forEach((t,n)=>{e.set(n,t)}),e}toDOM(e=document,t={},n){const a=t[this.hookName];let o;return a!==void 0?o=a.createDom(this):o=document.createElement(this.hookName),o.setAttribute("data-yjs-hook",this.hookName),n!==void 0&&n._createAssociation(o,this),o}_write(e){e.writeTypeRef(MR),e.writeKey(this.hookName)}}const mR=s=>new Sd(s.readKey());class Ed extends vo{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new Ed}clone(){const e=new Ed;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,n){const a=e.createTextNode(this.toString());return n!==void 0&&n._createAssociation(a,this),a}toString(){return this.toDelta().map(e=>{const t=[];for(const a in e.attributes){const o=[];for(const c in e.attributes[a])o.push({key:c,value:e.attributes[a][c]});o.sort((c,d)=>c.key<d.key?-1:1),t.push({nodeName:a,attrs:o})}t.sort((a,o)=>a.nodeName<o.nodeName?-1:1);let n="";for(let a=0;a<t.length;a++){const o=t[a];n+=`<${o.nodeName}`;for(let c=0;c<o.attrs.length;c++){const d=o.attrs[c];n+=` ${d.key}="${d.value}"`}n+=">"}n+=e.insert;for(let a=t.length-1;a>=0;a--)n+=`</${t[a].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(UR)}}const yR=s=>new Ed;class Yv{constructor(e,t){this.id=e,this.length=t}get deleted(){throw xi()}mergeWith(e){return!1}write(e,t,n){throw xi()}integrate(e,t){throw xi()}}const _R=0;class Zn extends Yv{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),gE(e.doc.store,this)}write(e,t){e.writeInfo(_R),e.writeLen(this.length-t)}getMissing(e,t){return null}}class Dc{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Dc(this.content)}splice(e){throw xi()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const bR=s=>new Dc(s.readBuf());class hc{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new hc(this.len)}splice(e){const t=new hc(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){yd(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const wR=s=>new hc(s.readLen()),jE=(s,e)=>new Ir({guid:s,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class kc{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new kc(jE(this.doc.guid,this.opts))}splice(e){throw xi()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const SR=s=>new kc(jE(s.readString(),s.readAny()));class Vr{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Vr(this.embed)}splice(e){throw xi()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const ER=s=>new Vr(s.readJSON());class Nt{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Nt(this.key,this.value)}splice(e){throw xi()}mergeWith(e){return!1}integrate(e,t){const n=t.parent;n._searchMarker=null,n._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const xR=s=>new Nt(s.readKey(),s.readJSON());class xd{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new xd(this.arr)}splice(e){const t=new xd(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let a=t;a<n;a++){const o=this.arr[a];e.writeString(o===void 0?"undefined":JSON.stringify(o))}}getRef(){return 2}}const CR=s=>{const e=s.readLen(),t=[];for(let n=0;n<e;n++){const a=s.readString();a==="undefined"?t.push(void 0):t.push(JSON.parse(a))}return new xd(t)},TR=md("node_env")==="development";class Pr{constructor(e){this.arr=e,TR&&KS(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Pr(this.arr)}splice(e){const t=new Pr(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let a=t;a<n;a++){const o=this.arr[a];e.writeAny(o)}}getRef(){return 8}}const DR=s=>{const e=s.readLen(),t=[];for(let n=0;n<e;n++)t.push(s.readAny());return new Pr(t)};class ki{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ki(this.str)}splice(e){const t=new ki(this.str.slice(e));this.str=this.str.slice(0,e);const n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const kR=s=>new ki(s.readString()),AR=[aR,lR,fR,pR,gR,mR,yR],RR=0,OR=1,LR=2,jR=3,NR=4,MR=5,UR=6;class cs{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new cs(this.type._copy())}splice(e){throw xi()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(n=>{n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(n=>{for(;n!==null;)n.gc(e,!0),n=n.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const $R=s=>new cs(AR[s.readTypeRef()](s)),Cd=(s,e,t)=>{const{client:n,clock:a}=e.id,o=new jt(Ne(n,a+t),e,Ne(n,a+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&o.markDeleted(),e.keep&&(o.keep=!0),e.redone!==null&&(o.redone=Ne(e.redone.client,e.redone.clock+t)),e.right=o,o.right!==null&&(o.right.left=o),s._mergeStructs.push(o),o.parentSub!==null&&o.right===null&&o.parent._map.set(o.parentSub,o),e.length=t,o};class jt extends Yv{constructor(e,t,n,a,o,c,d,h){super(e,h.getLength()),this.origin=n,this.left=t,this.right=a,this.rightOrigin=o,this.parent=c,this.parentSub=d,this.redone=null,this.content=h,this.info=this.content.isCountable()?wb:0}set marker(e){(this.info&Og)>0!==e&&(this.info^=Og)}get marker(){return(this.info&Og)>0}get keep(){return(this.info&bb)>0}set keep(e){this.keep!==e&&(this.info^=bb)}get countable(){return(this.info&wb)>0}get deleted(){return(this.info&Rg)>0}set deleted(e){this.deleted!==e&&(this.info^=Rg)}markDeleted(){this.info|=Rg}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Vt(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Vt(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ao&&this.id.client!==this.parent.client&&this.parent.clock>=Vt(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Mb(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=nr(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Zn||this.right&&this.right.constructor===Zn)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===jt?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===jt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===ao){const n=Mg(t,this.parent);n.constructor===Zn?this.parent=null:this.parent=n.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=Mb(e,e.doc.store,Ne(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let n=this.left,a;if(n!==null)a=n.right;else if(this.parentSub!==null)for(a=this.parent._map.get(this.parentSub)||null;a!==null&&a.left!==null;)a=a.left;else a=this.parent._start;const o=new Set,c=new Set;for(;a!==null&&a!==this.right;){if(c.add(a),o.add(a),Yu(this.origin,a.origin)){if(a.id.client<this.id.client)n=a,o.clear();else if(Yu(this.rightOrigin,a.rightOrigin))break}else if(a.origin!==null&&c.has(Mg(e.doc.store,a.origin)))o.has(Mg(e.doc.store,a.origin))||(n=a,o.clear());else break;a=a.right}this.left=n}if(this.left!==null){const n=this.left.right;this.right=n,this.left.right=this}else{let n;if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start,this.parent._start=this;this.right=n}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),gE(e.doc.store,this),this.content.integrate(e,this),$b(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new Zn(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Ne(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&Yu(e.origin,this.lastId)&&this.right===e&&Yu(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(n=>{n.p===e&&(n.p=this,!this.deleted&&this.countable&&(n.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),yd(e.deleteSet,this.id.client,this.id.clock,this.length),$b(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw Ti();this.content.gc(e),t?qA(e,this,new Zn(this.id,this.length)):this.content=new hc(this.length)}write(e,t){const n=t>0?Ne(this.id.client,this.id.clock+t-1):this.origin,a=this.rightOrigin,o=this.parentSub,c=this.content.getRef()&Xd|(n===null?0:Bn)|(a===null?0:as)|(o===null?0:rc);if(e.writeInfo(c),n!==null&&e.writeLeftID(n),a!==null&&e.writeRightID(a),n===null&&a===null){const d=this.parent;if(d._item!==void 0){const h=d._item;if(h===null){const g=zA(d);e.writeParentInfo(!0),e.writeString(g)}else e.writeParentInfo(!1),e.writeLeftID(h.id)}else d.constructor===String?(e.writeParentInfo(!0),e.writeString(d)):d.constructor===ao?(e.writeParentInfo(!1),e.writeLeftID(d)):Ti();o!==null&&e.writeString(o)}this.content.write(e,t)}}const NE=(s,e)=>IR[e&Xd](s),IR=[()=>{Ti()},wR,CR,bR,kR,ER,xR,$R,DR,SR,()=>{Ti()}],BR=10;class Wn extends Yv{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){Ti()}write(e,t){e.writeInfo(BR),$e(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const ME=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},UE="__ $YJS$ __";ME[UE]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");ME[UE]=!0;function zR(s){const e=s.length,t=s.filter(a=>a.isCompleted).length,n=e>0?t/e*100:0;return{totalItems:e,completedItems:t,completionPercentage:n}}const Zt=[];for(let s=0;s<256;++s)Zt.push((s+256).toString(16).slice(1));function PR(s,e=0){return(Zt[s[e+0]]+Zt[s[e+1]]+Zt[s[e+2]]+Zt[s[e+3]]+"-"+Zt[s[e+4]]+Zt[s[e+5]]+"-"+Zt[s[e+6]]+Zt[s[e+7]]+"-"+Zt[s[e+8]]+Zt[s[e+9]]+"-"+Zt[s[e+10]]+Zt[s[e+11]]+Zt[s[e+12]]+Zt[s[e+13]]+Zt[s[e+14]]+Zt[s[e+15]]).toLowerCase()}let Ig;const qR=new Uint8Array(16);function HR(){if(!Ig){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ig=crypto.getRandomValues.bind(crypto)}return Ig(qR)}const FR=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),qb={randomUUID:FR};function YR(s,e,t){if(qb.randomUUID&&!s)return qb.randomUUID();s=s||{};const n=s.random??s.rng?.()??HR();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,PR(n)}function Kn(){return YR()}function VR(){return`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}class GR{documents=new Map;logger;constructor(e){this.logger=e}updateTimestamp(e){const t=this.documents.get(e);t&&t.getMap("meta").set("updatedAt",new Date().toISOString())}createList(e,t,n,a){if(this.documents.has(e)){this.logger.warnSync(`List ${e} already exists`);return}const o=new Ir,c=o.getMap("meta"),d=new Date;c.set("title",t),n&&c.set("description",n),a&&c.set("ownerId",a),c.set("createdAt",d.toISOString()),c.set("updatedAt",d.toISOString()),this.documents.set(e,o),this.logger.infoSync(`Created YJS document for list ${e} with title: ${t}${n?` and description: ${n}`:""}${a?` and ownerId: ${a}`:""}`)}deleteList(e){const t=this.documents.get(e);if(!t){this.logger.warnSync(`List ${e} not found for deletion`);return}t.destroy(),this.documents.delete(e),this.logger.infoSync(`Deleted YJS document for list ${e}`)}getAllLists(){const e=[];for(const[t,n]of this.documents){const o=n.getMap("meta").get("title")||"Untitled List";e.push({id:t,title:o})}return e}getList(e){const t=this.documents.get(e);if(!t)return null;const n=t.getMap("meta"),a=n.get("title")||"Untitled List",o=n.get("description"),c=n.get("ownerId"),d=n.get("createdAt"),h=n.get("updatedAt"),g=t.getArray("items"),p=[];g.forEach(y=>{p.push({id:y.id,content:y.content,isCompleted:y.isCompleted})});const m=zR(p);return{id:e,title:a,description:o,items:p,statistics:m,isConnected:!0,isSynced:!0,createdAt:d?new Date(d):void 0,updatedAt:h?new Date(h):void 0,ownerId:c}}addItem(e,t){const n=this.documents.get(e);if(!n)return this.logger.warnSync(`List ${e} not found for adding item`),null;const a=n.getArray("items"),o={id:Kn(),content:t,isCompleted:!1};return a.push([o]),this.updateTimestamp(e),this.logger.infoSync(`Added item to list ${e}: ${t}`),o.id}editItem(e,t,n){const a=this.documents.get(e);if(!a){this.logger.warnSync(`List ${e} not found for editing item`);return}const o=a.getArray("items");for(let c=0;c<o.length;c++){const d=o.get(c);if(d&&d.id===t){o.delete(c,1),o.insert(c,[{...d,content:n}]),this.updateTimestamp(e),this.logger.infoSync(`Edited item ${t} in list ${e}`);return}}this.logger.warnSync(`Item ${t} not found in list ${e}`)}deleteItem(e,t){const n=this.documents.get(e);if(!n){this.logger.warnSync(`List ${e} not found for deleting item`);return}const a=n.getArray("items");for(let o=0;o<a.length;o++){const c=a.get(o);if(c&&c.id===t){a.delete(o,1),this.updateTimestamp(e),this.logger.infoSync(`Deleted item ${t} from list ${e}`);return}}this.logger.warnSync(`Item ${t} not found in list ${e}`)}toggleItem(e,t){const n=this.documents.get(e);if(!n){this.logger.warnSync(`List ${e} not found for toggling item`);return}const a=n.getArray("items");for(let o=0;o<a.length;o++){const c=a.get(o);if(c&&c.id===t){a.delete(o,1),a.insert(o,[{...c,isCompleted:!c.isCompleted}]),this.updateTimestamp(e),this.logger.infoSync(`Toggled item ${t} in list ${e}`);return}}this.logger.warnSync(`Item ${t} not found in list ${e}`)}moveItem(e,t,n){const a=this.documents.get(e);if(!a){this.logger.warnSync(`List ${e} not found for moving item`);return}const o=a.getArray("items");let c=-1,d=null;for(let p=0;p<o.length;p++){const m=o.get(p);if(m&&m.id===t){c=p,d=m;break}}if(c===-1||!d){this.logger.warnSync(`Item ${t} not found in list ${e}`);return}const h=Math.max(0,Math.min(n,o.length-1));if(c===h){this.logger.debugSync(`Item ${t} is already at position ${h}`);return}o.delete(c,1);const g=c<h?h-1:h;o.insert(g,[d]),this.updateTimestamp(e),this.logger.infoSync(`Moved item ${t} from position ${c} to ${g} in list ${e}`)}getYjsState(e){const t=this.documents.get(e);return t?$A(t):null}applyYjsUpdate(e,t){let n=this.documents.get(e);n||(n=new Ir,this.documents.set(e,n),this.logger.infoSync(`Created new YJS document for list ${e} during update application`)),NA(n,t),this.logger.infoSync(`Applied YJS update to list ${e}`)}isListLoaded(e){return this.documents.has(e)}editListTitle(e,t){const n=this.documents.get(e);if(!n){this.logger.warnSync(`List ${e} not found for editing title`);return}n.getMap("meta").set("title",t),this.updateTimestamp(e),this.logger.infoSync(`Edited title of list ${e} to: ${t}`)}editListDescription(e,t){const n=this.documents.get(e);if(!n){this.logger.warnSync(`List ${e} not found for editing description`);return}n.getMap("meta").set("description",t),this.updateTimestamp(e),this.logger.infoSync(`Edited description of list ${e} to: ${t}`)}clearCompletedItems(e){const t=this.documents.get(e);if(!t){this.logger.warnSync(`List ${e} not found for clearing completed items`);return}const n=t.getArray("items");let a=0;for(let o=n.length-1;o>=0;o--){const c=n.get(o);c&&c.isCompleted&&(n.delete(o,1),a++)}a>0?(this.updateTimestamp(e),this.logger.infoSync(`Cleared ${a} completed items from list ${e}`)):this.logger.debugSync(`No completed items found in list ${e}`)}clearAllState(){for(const[,e]of this.documents)e.destroy();this.documents.clear(),this.logger.infoSync("Cleared all YJS documents")}}const ye={LIST_CREATED:"list_created",LIST_DELETED:"list_deleted",LIST_LEFT:"list_left",LIST_METADATA_CHANGED:"list_metadata_changed",ITEM_ADDED:"item_added",ITEM_DELETED:"item_deleted",ITEM_CONTENT_CHANGED:"item_content_changed",ITEM_COMPLETED:"item_completed",ITEM_UNCOMPLETED:"item_uncompleted",ITEM_MOVED:"item_moved",USER_JOINED_LIST:"user_joined_list",USER_LEFT_LIST:"user_left_list",CONNECTION_ESTABLISHED:"connection_established",CONNECTION_LOST:"connection_lost",SYNC_COMPLETED:"sync_completed",BOOTSTRAP_COMPLETED:"bootstrap_completed"};class QR{constructor(e){this.logger=e}eventSubscriptions=new Map;publish(e){const n={...e,timestamp:new Date};this.notifyEventSubscribers(n)}subscribe(e,t){const n=this.wrapHandler(t);return this.eventSubscriptions.has(e)||this.eventSubscriptions.set(e,new Set),this.eventSubscriptions.get(e).add(n),()=>{const a=this.eventSubscriptions.get(e);a&&(a.delete(n),a.size===0&&this.eventSubscriptions.delete(e))}}subscribeToMultiple(e,t){const n=e.map(a=>this.subscribe(a,t));return()=>{n.forEach(a=>a())}}subscribeToListEvents(e){const t=[ye.LIST_CREATED,ye.LIST_DELETED,ye.LIST_METADATA_CHANGED,ye.ITEM_ADDED,ye.ITEM_DELETED,ye.ITEM_CONTENT_CHANGED,ye.ITEM_COMPLETED,ye.ITEM_UNCOMPLETED,ye.ITEM_MOVED];return this.subscribeToMultiple(t,e)}clearAllSubscriptions(){this.eventSubscriptions.clear()}notifyEventSubscribers(e){const t=this.eventSubscriptions.get(e.type);t&&t.forEach(n=>{try{n(e)}catch(a){this.logger.errorSync("Error in event handler:",a)}})}wrapHandler(e){return t=>{e(t)}}}const XR="modulepreload",KR=function(s){return"/"+s},Hb={},Do=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){let g=function(p){return Promise.all(p.map(m=>Promise.resolve(m).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};var c=g;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=d?.nonce||d?.getAttribute("nonce");a=g(t.map(p=>{if(p=KR(p),p in Hb)return;Hb[p]=!0;const m=p.endsWith(".css"),y=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${y}`))return;const _=document.createElement("link");if(_.rel=m?"stylesheet":XR,m||(_.as="script"),_.crossOrigin="",_.href=p,h&&_.setAttribute("nonce",h),document.head.appendChild(_),m)return new Promise((E,S)=>{_.addEventListener("load",E),_.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(d){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=d,window.dispatchEvent(h),!h.defaultPrevented)throw d}return a.then(d=>{for(const h of d||[])h.status==="rejected"&&o(h.reason);return e().catch(o)})},JR=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Do(async()=>{const{default:n}=await Promise.resolve().then(()=>ko);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class Vv extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class ZR extends Vv{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Fb extends Vv{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Yb extends Vv{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Dp;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Dp||(Dp={}));var WR=function(s,e,t,n){function a(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function d(p){try{g(n.next(p))}catch(m){c(m)}}function h(p){try{g(n.throw(p))}catch(m){c(m)}}function g(p){p.done?o(p.value):a(p.value).then(d,h)}g((n=n.apply(s,e||[])).next())})};class eO{constructor(e,{headers:t={},customFetch:n,region:a=Dp.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=JR(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return WR(this,void 0,void 0,function*(){try{const{headers:a,method:o,body:c}=t;let d={},{region:h}=t;h||(h=this.region);const g=new URL(`${this.url}/${e}`);h&&h!=="any"&&(d["x-region"]=h,g.searchParams.set("forceFunctionRegion",h));let p;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",p=c):typeof c=="string"?(d["Content-Type"]="text/plain",p=c):typeof FormData<"u"&&c instanceof FormData?p=c:(d["Content-Type"]="application/json",p=JSON.stringify(c)));const m=yield this.fetch(g.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),a),body:p}).catch(S=>{throw new ZR(S)}),y=m.headers.get("x-relay-error");if(y&&y==="true")throw new Fb(m);if(!m.ok)throw new Yb(m);let _=((n=m.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),E;return _==="application/json"?E=yield m.json():_==="application/octet-stream"?E=yield m.blob():_==="text/event-stream"?E=m:_==="multipart/form-data"?E=yield m.formData():E=yield m.text(),{data:E,error:null,response:m}}catch(a){return{data:null,error:a,response:a instanceof Yb||a instanceof Fb?a.context:void 0}}})}}var Ht={},Ba={},za={},Pa={},qa={},Ha={},tO=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},yo=tO();const nO=yo.fetch,$E=yo.fetch.bind(yo),IE=yo.Headers,iO=yo.Request,sO=yo.Response,ko=Object.freeze(Object.defineProperty({__proto__:null,Headers:IE,Request:iO,Response:sO,default:$E,fetch:nO},Symbol.toStringTag,{value:"Module"})),rO=XT(ko);var Qu={},Vb;function BE(){if(Vb)return Qu;Vb=1,Object.defineProperty(Qu,"__esModule",{value:!0});class s extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Qu.default=s,Qu}var Gb;function zE(){if(Gb)return Ha;Gb=1;var s=Ha&&Ha.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ha,"__esModule",{value:!0});const e=s(rO),t=s(BE());class n{constructor(o){var c,d;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(c=o.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=o.signal,this.isMaybeSingle=(d=o.isMaybeSingle)!==null&&d!==void 0?d:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,c){return this.headers=new Headers(this.headers),this.headers.set(o,c),this}then(o,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let h=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var p,m,y,_;let E=null,S=null,T=null,O=g.status,$=g.statusText;if(g.ok){if(this.method!=="HEAD"){const Y=await g.text();Y===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?S=Y:S=JSON.parse(Y))}const U=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),A=(y=g.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");U&&A&&A.length>1&&(T=parseInt(A[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(S)&&(S.length>1?(E={code:"PGRST116",details:`Results contain ${S.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},S=null,T=null,O=406,$="Not Acceptable"):S.length===1?S=S[0]:S=null)}else{const U=await g.text();try{E=JSON.parse(U),Array.isArray(E)&&g.status===404&&(S=[],E=null,O=200,$="OK")}catch{g.status===404&&U===""?(O=204,$="No Content"):E={message:U}}if(E&&this.isMaybeSingle&&(!((_=E?.details)===null||_===void 0)&&_.includes("0 rows"))&&(E=null,O=200,$="OK"),E&&this.shouldThrowOnError)throw new t.default(E)}return{error:E,data:S,count:T,status:O,statusText:$}});return this.shouldThrowOnError||(h=h.catch(g=>{var p,m,y;return{error:{message:`${(p=g?.name)!==null&&p!==void 0?p:"FetchError"}: ${g?.message}`,details:`${(m=g?.stack)!==null&&m!==void 0?m:""}`,hint:"",code:`${(y=g?.code)!==null&&y!==void 0?y:""}`},data:null,count:null,status:0,statusText:""}})),h.then(o,c)}returns(){return this}overrideTypes(){return this}}return Ha.default=n,Ha}var Qb;function PE(){if(Qb)return qa;Qb=1;var s=qa&&qa.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(qa,"__esModule",{value:!0});const e=s(zE());class t extends e.default{select(a){let o=!1;const c=(a??"*").split("").map(d=>/\s/.test(d)&&!o?"":(d==='"'&&(o=!o),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:o=!0,nullsFirst:c,foreignTable:d,referencedTable:h=d}={}){const g=h?`${h}.order`:"order",p=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${p?`${p},`:""}${a}.${o?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:o,referencedTable:c=o}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,o,{foreignTable:c,referencedTable:d=c}={}){const h=typeof d>"u"?"offset":`${d}.offset`,g=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(h,`${a}`),this.url.searchParams.set(g,`${o-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:o=!1,settings:c=!1,buffers:d=!1,wal:h=!1,format:g="text"}={}){var p;const m=[a?"analyze":null,o?"verbose":null,c?"settings":null,d?"buffers":null,h?"wal":null].filter(Boolean).join("|"),y=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${y}"; options=${m};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return qa.default=t,qa}var Xb;function Gv(){if(Xb)return Pa;Xb=1;var s=Pa&&Pa.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Pa,"__esModule",{value:!0});const e=s(PE());class t extends e.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}in(a,o){const c=Array.from(new Set(o)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:c,type:d}={}){let h="";d==="plain"?h="pl":d==="phrase"?h="ph":d==="websearch"&&(h="w");const g=c===void 0?"":`(${c})`;return this.url.searchParams.append(a,`${h}fts${g}.${o}`),this}match(a){return Object.entries(a).forEach(([o,c])=>{this.url.searchParams.append(o,`eq.${c}`)}),this}not(a,o,c){return this.url.searchParams.append(a,`not.${o}.${c}`),this}or(a,{foreignTable:o,referencedTable:c=o}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,o,c){return this.url.searchParams.append(a,`${o}.${c}`),this}}return Pa.default=t,Pa}var Kb;function qE(){if(Kb)return za;Kb=1;var s=za&&za.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(za,"__esModule",{value:!0});const e=s(Gv());class t{constructor(a,{headers:o={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(o),this.schema=c,this.fetch=d}select(a,{head:o=!1,count:c}={}){const d=o?"HEAD":"GET";let h=!1;const g=(a??"*").split("").map(p=>/\s/.test(p)&&!h?"":(p==='"'&&(h=!h),p)).join("");return this.url.searchParams.set("select",g),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:o,defaultToNull:c=!0}={}){var d;const h="POST";if(o&&this.headers.append("Prefer",`count=${o}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const g=a.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(g.length>0){const p=[...new Set(g)].map(m=>`"${m}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(a,{onConflict:o,ignoreDuplicates:c=!1,count:d,defaultToNull:h=!0}={}){var g;const p="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const m=a.reduce((y,_)=>y.concat(Object.keys(_)),[]);if(m.length>0){const y=[...new Set(m)].map(_=>`"${_}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(a,{count:o}={}){var c;const d="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var o;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return za.default=t,za}var Jb;function aO(){if(Jb)return Ba;Jb=1;var s=Ba&&Ba.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ba,"__esModule",{value:!0});const e=s(qE()),t=s(Gv());class n{constructor(o,{headers:c={},schema:d,fetch:h}={}){this.url=o,this.headers=new Headers(c),this.schemaName=d,this.fetch=h}from(o){const c=new URL(`${this.url}/${o}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,c={},{head:d=!1,get:h=!1,count:g}={}){var p;let m;const y=new URL(`${this.url}/rpc/${o}`);let _;d||h?(m=d?"HEAD":"GET",Object.entries(c).filter(([S,T])=>T!==void 0).map(([S,T])=>[S,Array.isArray(T)?`{${T.join(",")}}`:`${T}`]).forEach(([S,T])=>{y.searchParams.append(S,T)})):(m="POST",_=c);const E=new Headers(this.headers);return g&&E.set("Prefer",`count=${g}`),new t.default({method:m,url:y,headers:E,schema:this.schemaName,body:_,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return Ba.default=n,Ba}var Zb;function oO(){if(Zb)return Ht;Zb=1;var s=Ht&&Ht.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.PostgrestError=Ht.PostgrestBuilder=Ht.PostgrestTransformBuilder=Ht.PostgrestFilterBuilder=Ht.PostgrestQueryBuilder=Ht.PostgrestClient=void 0;const e=s(aO());Ht.PostgrestClient=e.default;const t=s(qE());Ht.PostgrestQueryBuilder=t.default;const n=s(Gv());Ht.PostgrestFilterBuilder=n.default;const a=s(PE());Ht.PostgrestTransformBuilder=a.default;const o=s(zE());Ht.PostgrestBuilder=o.default;const c=s(BE());return Ht.PostgrestError=c.default,Ht.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:o.default,PostgrestError:c.default},Ht}var lO=oO();const cO=wv(lO),{PostgrestClient:uO,PostgrestQueryBuilder:FU,PostgrestFilterBuilder:YU,PostgrestTransformBuilder:VU,PostgrestBuilder:GU,PostgrestError:QU}=cO;class dO{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const hO="2.15.4",fO=`realtime-js/${hO}`,gO="1.0.0",kp=1e4,pO=1e3,vO=100;var Xl;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Xl||(Xl={}));var At;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(At||(At={}));var ci;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(ci||(ci={}));var Ap;(function(s){s.websocket="websocket"})(Ap||(Ap={}));var Lr;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(Lr||(Lr={}));class mO{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const a=t.getUint8(1),o=t.getUint8(2);let c=this.HEADER_LENGTH+2;const d=n.decode(e.slice(c,c+a));c=c+a;const h=n.decode(e.slice(c,c+o));c=c+o;const g=JSON.parse(n.decode(e.slice(c,e.byteLength)));return{ref:null,topic:d,event:h,payload:g}}}class HE{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Je;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(Je||(Je={}));const Wb=(s,e,t={})=>{var n;const a=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((o,c)=>(o[c]=yO(c,s,e,a),o),{})},yO=(s,e,t,n)=>{const a=e.find(d=>d.name===s),o=a?.type,c=t[s];return o&&!n.includes(o)?FE(o,c):Rp(c)},FE=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return SO(e,t)}switch(s){case Je.bool:return _O(e);case Je.float4:case Je.float8:case Je.int2:case Je.int4:case Je.int8:case Je.numeric:case Je.oid:return bO(e);case Je.json:case Je.jsonb:return wO(e);case Je.timestamp:return EO(e);case Je.abstime:case Je.date:case Je.daterange:case Je.int4range:case Je.int8range:case Je.money:case Je.reltime:case Je.text:case Je.time:case Je.timestamptz:case Je.timetz:case Je.tsrange:case Je.tstzrange:return Rp(e);default:return Rp(e)}},Rp=s=>s,_O=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},bO=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},wO=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},SO=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,n=s[t];if(s[0]==="{"&&n==="}"){let o;const c=s.slice(1,t);try{o=JSON.parse("["+c+"]")}catch{o=c?c.split(","):[]}return o.map(d=>FE(e,d))}return s},EO=s=>typeof s=="string"?s.replace(" ","T"):s,YE=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Bg{constructor(e,t,n={},a=kp){this.channel=e,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ew;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(ew||(ew={}));class Kl{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:o,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Kl.syncState(this.state,a,o,c),this.pendingDiffs.forEach(h=>{this.state=Kl.syncDiff(this.state,h,o,c)}),this.pendingDiffs=[],d()}),this.channel._on(n.diff,{},a=>{const{onJoin:o,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Kl.syncDiff(this.state,a,o,c),d())}),this.onJoin((a,o,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:o,newPresences:c})}),this.onLeave((a,o,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:o,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,a){const o=this.cloneDeep(e),c=this.transformState(t),d={},h={};return this.map(o,(g,p)=>{c[g]||(h[g]=p)}),this.map(c,(g,p)=>{const m=o[g];if(m){const y=p.map(T=>T.presence_ref),_=m.map(T=>T.presence_ref),E=p.filter(T=>_.indexOf(T.presence_ref)<0),S=m.filter(T=>y.indexOf(T.presence_ref)<0);E.length>0&&(d[g]=E),S.length>0&&(h[g]=S)}else d[g]=p}),this.syncDiff(o,{joins:d,leaves:h},n,a)}static syncDiff(e,t,n,a){const{joins:o,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(o,(d,h)=>{var g;const p=(g=e[d])!==null&&g!==void 0?g:[];if(e[d]=this.cloneDeep(h),p.length>0){const m=e[d].map(_=>_.presence_ref),y=p.filter(_=>m.indexOf(_.presence_ref)<0);e[d].unshift(...y)}n(d,p,h)}),this.map(c,(d,h)=>{let g=e[d];if(!g)return;const p=h.map(m=>m.presence_ref);g=g.filter(m=>p.indexOf(m.presence_ref)<0),e[d]=g,a(d,g,h),g.length===0&&delete e[d]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const a=e[n];return"metas"in a?t[n]=a.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[n]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tw;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(tw||(tw={}));var Jl;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(Jl||(Jl={}));var ts;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(ts||(ts={}));class Qv{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=At.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Bg(this,ci.join,this.params,this.timeout),this.rejoinTimer=new HE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=At.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=At.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=At.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=At.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=At.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ci.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new Kl(this),this.broadcastEndpointURL=YE(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,a,o;if(this.socket.isConnected()||this.socket.connect(),this.state==At.closed){const{config:{broadcast:c,presence:d,private:h}}=this.params,g=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(_=>_.filter))!==null&&a!==void 0?a:[],p=!!this.bindings[Jl.PRESENCE]&&this.bindings[Jl.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,m={},y={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:p}),postgres_changes:g,private:h};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(_=>e?.(ts.CHANNEL_ERROR,_)),this._onClose(()=>e?.(ts.CLOSED)),this.updateJoinPayload(Object.assign({config:y},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:_})=>{var E;if(this.socket.setAuth(),_===void 0){e?.(ts.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,T=(E=S?.length)!==null&&E!==void 0?E:0,O=[];for(let $=0;$<T;$++){const L=S[$],{filter:{event:U,schema:A,table:Y,filter:Z}}=L,J=_&&_[$];if(J&&J.event===U&&J.schema===A&&J.table===Y&&J.filter===Z)O.push(Object.assign(Object.assign({},L),{id:J.id}));else{this.unsubscribe(),this.state=At.errored,e?.(ts.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=O,e&&e(ts.SUBSCRIBED);return}}).receive("error",_=>{this.state=At.errored,e?.(ts.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{e?.(ts.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===At.joined&&e===Jl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,n)}async send(e,t={}){var n,a;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:c}=e,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:c,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=g.body)===null||a===void 0?void 0:a.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var c,d,h;const g=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||h===void 0)&&h.ack)&&o("ok"),g.receive("ok",()=>o("ok")),g.receive("error",()=>o("error")),g.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=At.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ci.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Bg(this,ci.leave,{},e),n.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=At.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const a=new AbortController,o=setTimeout(()=>a.abort(),n),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(o),c}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Bg(this,e,t,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>vO){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var a,o;const c=e.toLocaleLowerCase(),{close:d,error:h,leave:g,join:p}=ci;if(n&&[d,h,g,p].indexOf(c)>=0&&n!==this._joinRef())return;let y=this._onMessage(c,t,n);if(t&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(_=>{var E,S,T;return((E=_.filter)===null||E===void 0?void 0:E.event)==="*"||((T=(S=_.filter)===null||S===void 0?void 0:S.event)===null||T===void 0?void 0:T.toLocaleLowerCase())===c}).map(_=>_.callback(y,n)):(o=this.bindings[c])===null||o===void 0||o.filter(_=>{var E,S,T,O,$,L;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const U=_.id,A=(E=_.filter)===null||E===void 0?void 0:E.event;return U&&((S=t.ids)===null||S===void 0?void 0:S.includes(U))&&(A==="*"||A?.toLocaleLowerCase()===((T=t.data)===null||T===void 0?void 0:T.type.toLocaleLowerCase()))}else{const U=($=(O=_?.filter)===null||O===void 0?void 0:O.event)===null||$===void 0?void 0:$.toLocaleLowerCase();return U==="*"||U===((L=t?.event)===null||L===void 0?void 0:L.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof y=="object"&&"ids"in y){const E=y.data,{schema:S,table:T,commit_timestamp:O,type:$,errors:L}=E;y=Object.assign(Object.assign({},{schema:S,table:T,commit_timestamp:O,eventType:$,new:{},old:{},errors:L}),this._getPayloadRecords(E))}_.callback(y,n)})}_isClosed(){return this.state===At.closed}_isJoined(){return this.state===At.joined}_isJoining(){return this.state===At.joining}_isLeaving(){return this.state===At.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const a=e.toLocaleLowerCase(),o={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(o):this.bindings[a]=[o],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var o;return!(((o=a.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&Qv.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ci.close,{},e)}_onError(e){this._on(ci.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=At.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Wb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Wb(e.columns,e.old_record)),t}}const zg=()=>{},Xu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},xO=[1e3,2e3,5e3,1e4],CO=1e4,TO=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class DO{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=kp,this.transport=null,this.heartbeatIntervalMs=Xu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=zg,this.ref=0,this.reconnectTimer=null,this.logger=zg,this.conn=null,this.sendBuffer=[],this.serializer=new mO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let o;return a?o=a:typeof fetch>"u"?o=(...c)=>Do(async()=>{const{default:d}=await Promise.resolve().then(()=>ko);return{default:d}},void 0).then(({default:d})=>d(...c)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...c)=>o(...c)},!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Ap.websocket}`,this.httpEndpoint=YE(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=dO.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:gO}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Xl.connecting:return Lr.Connecting;case Xl.open:return Lr.Open;case Xl.closing:return Lr.Closing;default:return Lr.Closed}}isConnected(){return this.connectionState()===Lr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,a=this.getChannels().find(o=>o.topic===n);if(a)return a;{const o=new Qv(`realtime:${e}`,t,this);return this.channels.push(o),o}}push(e){const{topic:t,event:n,payload:a,ref:o}=e,c=()=>{this.encode(e,d=>{var h;(h=this.conn)===null||h===void 0||h.send(d)})};this.log("push",`${t} ${n} (${o})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(pO,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Xu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(g){this.log("error","error in heartbeat callback",g)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:o,ref:c}=t,d=c?`(${c})`:"",h=o.status||"";this.log("receive",`${h} ${n} ${a} ${d}`.trim(),o),this.channels.filter(g=>g._isMember(n)).forEach(g=>g._trigger(a,o,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ci.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${n}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([TO],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const a={access_token:t,version:fO};t&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(ci.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new HE(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Xu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,a,o,c,d,h,g,p;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:kp,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:Xu.HEARTBEAT_INTERVAL,this.worker=(o=e?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=e?.heartbeatCallback)!==null&&d!==void 0?d:zg,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e?.reconnectAfterMs)!==null&&h!==void 0?h:(m=>xO[m-1]||CO),this.encode=(g=e?.encode)!==null&&g!==void 0?g:((m,y)=>y(JSON.stringify(m))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Xv extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Rt(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class kO extends Xv{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Op extends Xv{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var AO=function(s,e,t,n){function a(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function d(p){try{g(n.next(p))}catch(m){c(m)}}function h(p){try{g(n.throw(p))}catch(m){c(m)}}function g(p){p.done?o(p.value):a(p.value).then(d,h)}g((n=n.apply(s,e||[])).next())})};const VE=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Do(async()=>{const{default:n}=await Promise.resolve().then(()=>ko);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},RO=()=>AO(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Do(()=>Promise.resolve().then(()=>ko),void 0)).Response:Response}),Lp=s=>{if(Array.isArray(s))return s.map(t=>Lp(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,n])=>{const a=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[a]=Lp(n)}),e},OO=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)};var Gr=function(s,e,t,n){function a(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function d(p){try{g(n.next(p))}catch(m){c(m)}}function h(p){try{g(n.throw(p))}catch(m){c(m)}}function g(p){p.done?o(p.value):a(p.value).then(d,h)}g((n=n.apply(s,e||[])).next())})};const Pg=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),LO=(s,e,t)=>Gr(void 0,void 0,void 0,function*(){const n=yield RO();s instanceof n&&!t?.noResolveJson?s.json().then(a=>{const o=s.status||500,c=a?.statusCode||o+"";e(new kO(Pg(a),o,c))}).catch(a=>{e(new Op(Pg(a),a))}):e(new Op(Pg(s),s))}),jO=(s,e,t,n)=>{const a={method:s,headers:e?.headers||{}};return s==="GET"||!n?a:(OO(n)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(n)):a.body=n,e?.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),t))};function Ac(s,e,t,n,a,o){return Gr(this,void 0,void 0,function*(){return new Promise((c,d)=>{s(t,jO(e,n,a,o)).then(h=>{if(!h.ok)throw h;return n?.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>LO(h,d,n))})})}function Td(s,e,t,n){return Gr(this,void 0,void 0,function*(){return Ac(s,"GET",e,t,n)})}function bi(s,e,t,n,a){return Gr(this,void 0,void 0,function*(){return Ac(s,"POST",e,n,a,t)})}function jp(s,e,t,n,a){return Gr(this,void 0,void 0,function*(){return Ac(s,"PUT",e,n,a,t)})}function NO(s,e,t,n){return Gr(this,void 0,void 0,function*(){return Ac(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function GE(s,e,t,n,a){return Gr(this,void 0,void 0,function*(){return Ac(s,"DELETE",e,n,a,t)})}var dn=function(s,e,t,n){function a(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function d(p){try{g(n.next(p))}catch(m){c(m)}}function h(p){try{g(n.throw(p))}catch(m){c(m)}}function g(p){p.done?o(p.value):a(p.value).then(d,h)}g((n=n.apply(s,e||[])).next())})};const MO={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},nw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class UO{constructor(e,t={},n,a){this.url=e,this.headers=t,this.bucketId=n,this.fetch=VE(a)}uploadOrUpdate(e,t,n,a){return dn(this,void 0,void 0,function*(){try{let o;const c=Object.assign(Object.assign({},nw),a);let d=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",c.cacheControl),h&&o.append("metadata",this.encodeMetadata(h)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",c.cacheControl),h&&o.append("metadata",this.encodeMetadata(h))):(o=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,h&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),a?.headers&&(d=Object.assign(Object.assign({},d),a.headers));const g=this._removeEmptyFolders(t),p=this._getFinalPath(g),m=yield(e=="PUT"?jp:bi)(this.fetch,`${this.url}/object/${p}`,o,Object.assign({headers:d},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:g,id:m.Id,fullPath:m.Key},error:null}}catch(o){if(Rt(o))return{data:null,error:o};throw o}})}upload(e,t,n){return dn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,a){return dn(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),c=this._getFinalPath(o),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",t);try{let h;const g=Object.assign({upsert:nw.upsert},a),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&n instanceof Blob?(h=new FormData,h.append("cacheControl",g.cacheControl),h.append("",n)):typeof FormData<"u"&&n instanceof FormData?(h=n,h.append("cacheControl",g.cacheControl)):(h=n,p["cache-control"]=`max-age=${g.cacheControl}`,p["content-type"]=g.contentType);const m=yield jp(this.fetch,d.toString(),h,{headers:p});return{data:{path:o,fullPath:m.Key},error:null}}catch(h){if(Rt(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(e,t){return dn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const a=Object.assign({},this.headers);t?.upsert&&(a["x-upsert"]="true");const o=yield bi(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),c=new URL(this.url+o.url),d=c.searchParams.get("token");if(!d)throw new Xv("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:d},error:null}}catch(n){if(Rt(n))return{data:null,error:n};throw n}})}update(e,t,n){return dn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return dn(this,void 0,void 0,function*(){try{return{data:yield bi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Rt(a))return{data:null,error:a};throw a}})}copy(e,t,n){return dn(this,void 0,void 0,function*(){try{return{data:{path:(yield bi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Rt(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,n){return dn(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),o=yield bi(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n?.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${c}`)},{data:o,error:null}}catch(a){if(Rt(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,n){return dn(this,void 0,void 0,function*(){try{const a=yield bi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${o}`):null})),error:null}}catch(a){if(Rt(a))return{data:null,error:a};throw a}})}download(e,t){return dn(this,void 0,void 0,function*(){const a=typeof t?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(t?.transform||{}),c=o?`?${o}`:"";try{const d=this._getFinalPath(e);return{data:yield(yield Td(this.fetch,`${this.url}/${a}/${d}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(Rt(d))return{data:null,error:d};throw d}})}info(e){return dn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield Td(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Lp(n),error:null}}catch(n){if(Rt(n))return{data:null,error:n};throw n}})}exists(e){return dn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield NO(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Rt(n)&&n instanceof Op){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),a=[],o=t?.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&a.push(o);const d=typeof t?.transform<"u"?"render/image":"object",h=this.transformOptsToQueryString(t?.transform||{});h!==""&&a.push(h);let g=a.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${n}${g}`)}}}remove(e){return dn(this,void 0,void 0,function*(){try{return{data:yield GE(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Rt(t))return{data:null,error:t};throw t}})}list(e,t,n){return dn(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},MO),t),{prefix:e||""});return{data:yield bi(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Rt(a))return{data:null,error:a};throw a}})}listV2(e,t){return dn(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield bi(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(Rt(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const $O="2.11.1",IO={"X-Client-Info":`storage-js/${$O}`};var Fa=function(s,e,t,n){function a(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function d(p){try{g(n.next(p))}catch(m){c(m)}}function h(p){try{g(n.throw(p))}catch(m){c(m)}}function g(p){p.done?o(p.value):a(p.value).then(d,h)}g((n=n.apply(s,e||[])).next())})};class BO{constructor(e,t={},n,a){const o=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},IO),t),this.fetch=VE(n)}listBuckets(){return Fa(this,void 0,void 0,function*(){try{return{data:yield Td(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Rt(e))return{data:null,error:e};throw e}})}getBucket(e){return Fa(this,void 0,void 0,function*(){try{return{data:yield Td(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Rt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Fa(this,void 0,void 0,function*(){try{return{data:yield bi(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Rt(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return Fa(this,void 0,void 0,function*(){try{return{data:yield jp(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Rt(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Fa(this,void 0,void 0,function*(){try{return{data:yield bi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Rt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Fa(this,void 0,void 0,function*(){try{return{data:yield GE(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Rt(t))return{data:null,error:t};throw t}})}}class zO extends BO{constructor(e,t={},n,a){super(e,t,n,a)}from(e){return new UO(this.url,this.headers,e,this.fetch)}}const PO="2.57.0";let Bl="";typeof Deno<"u"?Bl="deno":typeof document<"u"?Bl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bl="react-native":Bl="node";const qO={"X-Client-Info":`supabase-js-${Bl}/${PO}`},HO={headers:qO},FO={schema:"public"},YO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},VO={};var GO=function(s,e,t,n){function a(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function d(p){try{g(n.next(p))}catch(m){c(m)}}function h(p){try{g(n.throw(p))}catch(m){c(m)}}function g(p){p.done?o(p.value):a(p.value).then(d,h)}g((n=n.apply(s,e||[])).next())})};const QO=s=>{let e;return s?e=s:typeof fetch>"u"?e=$E:e=fetch,(...t)=>e(...t)},XO=()=>typeof Headers>"u"?IE:Headers,KO=(s,e,t)=>{const n=QO(t),a=XO();return(o,c)=>GO(void 0,void 0,void 0,function*(){var d;const h=(d=yield e())!==null&&d!==void 0?d:s;let g=new a(c?.headers);return g.has("apikey")||g.set("apikey",s),g.has("Authorization")||g.set("Authorization",`Bearer ${h}`),n(o,Object.assign(Object.assign({},c),{headers:g}))})};var JO=function(s,e,t,n){function a(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function d(p){try{g(n.next(p))}catch(m){c(m)}}function h(p){try{g(n.throw(p))}catch(m){c(m)}}function g(p){p.done?o(p.value):a(p.value).then(d,h)}g((n=n.apply(s,e||[])).next())})};function ZO(s){return s.endsWith("/")?s:s+"/"}function WO(s,e){var t,n;const{db:a,auth:o,realtime:c,global:d}=s,{db:h,auth:g,realtime:p,global:m}=e,y={db:Object.assign(Object.assign({},h),a),auth:Object.assign(Object.assign({},g),o),realtime:Object.assign(Object.assign({},p),c),storage:{},global:Object.assign(Object.assign(Object.assign({},m),d),{headers:Object.assign(Object.assign({},(t=m?.headers)!==null&&t!==void 0?t:{}),(n=d?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>JO(this,void 0,void 0,function*(){return""})};return s.accessToken?y.accessToken=s.accessToken:delete y.accessToken,y}const QE="2.71.1",Ja=30*1e3,Np=3,qg=Np*Ja,eL="http://localhost:9999",tL="supabase.auth.token",nL={"X-Client-Info":`gotrue-js/${QE}`},Mp="X-Supabase-Api-Version",XE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},iL=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,sL=600*1e3;class Kv extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function be(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class rL extends Kv{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function aL(s){return be(s)&&s.name==="AuthApiError"}class KE extends Kv{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class rr extends Kv{constructor(e,t,n,a){super(e,n,a),this.name=t,this.status=n}}class Ps extends rr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function oL(s){return be(s)&&s.name==="AuthSessionMissingError"}class Ku extends rr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ju extends rr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Zu extends rr{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function lL(s){return be(s)&&s.name==="AuthImplicitGrantRedirectError"}class iw extends rr{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Up extends rr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Hg(s){return be(s)&&s.name==="AuthRetryableFetchError"}class sw extends rr{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class $p extends rr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Dd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),rw=` 	
\r=`.split(""),cL=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<rw.length;e+=1)s[rw[e].charCodeAt(0)]=-2;for(let e=0;e<Dd.length;e+=1)s[Dd[e].charCodeAt(0)]=e;return s})();function aw(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Dd[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Dd[n]),e.queuedBits-=6}}function JE(s,e,t){const n=cL[s];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function ow(s){const e=[],t=c=>{e.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},o=c=>{hL(c,n,t)};for(let c=0;c<s.length;c+=1)JE(s.charCodeAt(c),a,o);return e.join("")}function uL(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function dL(s,e){for(let t=0;t<s.length;t+=1){let n=s.charCodeAt(t);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(s.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}uL(n,e)}}function hL(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let n=1;n<6;n+=1)if((s>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function fL(s){const e=[],t={queue:0,queuedBits:0},n=a=>{e.push(a)};for(let a=0;a<s.length;a+=1)JE(s.charCodeAt(a),t,n);return new Uint8Array(e)}function gL(s){const e=[];return dL(s,t=>e.push(t)),new Uint8Array(e)}function pL(s){const e=[],t={queue:0,queuedBits:0},n=a=>{e.push(a)};return s.forEach(a=>aw(a,t,n)),aw(null,t,n),e.join("")}function vL(s){return Math.round(Date.now()/1e3)+s}function mL(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const oi=()=>typeof window<"u"&&typeof document<"u",Cr={tested:!1,writable:!1},ZE=()=>{if(!oi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Cr.tested)return Cr.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Cr.tested=!0,Cr.writable=!0}catch{Cr.tested=!0,Cr.writable=!1}return Cr.writable};function yL(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,o)=>{e[o]=a})}catch{}return t.searchParams.forEach((n,a)=>{e[a]=n}),e}const WE=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Do(async()=>{const{default:n}=await Promise.resolve().then(()=>ko);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},_L=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",Za=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Tr=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Is=async(s,e)=>{await s.removeItem(e)};class nh{constructor(){this.promise=new nh.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}nh.promiseConstructor=Promise;function Fg(s){const e=s.split(".");if(e.length!==3)throw new $p("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!iL.test(e[n]))throw new $p("JWT not in base64url format");return{header:JSON.parse(ow(e[0])),payload:JSON.parse(ow(e[1])),signature:fL(e[2]),raw:{header:e[0],payload:e[1]}}}async function bL(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function wL(s,e){return new Promise((n,a)=>{(async()=>{for(let o=0;o<1/0;o++)try{const c=await s(o);if(!e(o,null,c)){n(c);return}}catch(c){if(!e(o,c)){a(c);return}}})()})}function SL(s){return("0"+s.toString(16)).substr(-2)}function EL(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let a="";for(let o=0;o<56;o++)a+=t.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(e),Array.from(e,SL).join("")}async function xL(s){const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map(o=>String.fromCharCode(o)).join("")}async function CL(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await xL(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ya(s,e,t=!1){const n=EL();let a=n;t&&(a+="/PASSWORD_RECOVERY"),await Za(s,`${e}-code-verifier`,a);const o=await CL(n);return[o,n===o?"plain":"s256"]}const TL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function DL(s){const e=s.headers.get(Mp);if(!e||!e.match(TL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function kL(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function AL(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const RL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Va(s){if(!RL.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Yg(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function lw(s){return JSON.parse(JSON.stringify(s))}var OL=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t};const Rr=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),LL=[502,503,504];async function cw(s){var e;if(!_L(s))throw new Up(Rr(s),0);if(LL.includes(s.status))throw new Up(Rr(s),s.status);let t;try{t=await s.json()}catch(o){throw new KE(Rr(o),o)}let n;const a=DL(s);if(a&&a.getTime()>=XE["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new sw(Rr(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Ps}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,c)=>o&&typeof c=="string",!0))throw new sw(Rr(t),s.status,t.weak_password.reasons);throw new rL(Rr(t),s.status||500,n)}const jL=(s,e,t,n)=>{const a={method:s,headers:e?.headers||{}};return s==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),t))};async function Re(s,e,t,n){var a;const o=Object.assign({},n?.headers);o[Mp]||(o[Mp]=XE["2024-01-01"].name),n?.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const c=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(c.redirect_to=n.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await NL(s,e,t+d,{headers:o,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(h):{data:Object.assign({},h),error:null}}async function NL(s,e,t,n,a,o){const c=jL(e,n,a,o);let d;try{d=await s(t,Object.assign({},c))}catch(h){throw console.error(h),new Up(Rr(h),0)}if(d.ok||await cw(d),n?.noResolveJson)return d;try{return await d.json()}catch(h){await cw(h)}}function es(s){var e;let t=null;IL(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=vL(s.expires_in)));const n=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:n},error:null}}function uw(s){const e=es(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=s.weak_password),e}function Ys(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function ML(s){return{data:s,error:null}}function UL(s){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:a,verification_type:o}=s,c=OL(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:t,hashed_token:n,redirect_to:a,verification_type:o},h=Object.assign({},c);return{data:{properties:d,user:h},error:null}}function $L(s){return s}function IL(s){return s.access_token&&s.refresh_token&&s.expires_in}const Vg=["global","local","others"];var BL=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t};class zL{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=WE(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Vg[0]){if(Vg.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Vg.join(", ")}`);try{return await Re(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await Re(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ys})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=BL(e,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await Re(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:UL,redirectTo:t?.redirectTo})}catch(t){if(be(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Re(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ys})}catch(t){if(be(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,a,o,c,d,h;try{const g={nextPage:null,lastPage:0,total:0},p=await Re(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(o=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:$L});if(p.error)throw p.error;const m=await p.json(),y=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(d=p.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(E=>{const S=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),T=JSON.parse(E.split(";")[1].split("=")[1]);g[`${T}Page`]=S}),g.total=parseInt(y)),{data:Object.assign(Object.assign({},m),g),error:null}}catch(g){if(be(g))return{data:{users:[]},error:g};throw g}}async getUserById(e){Va(e);try{return await Re(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ys})}catch(t){if(be(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Va(e);try{return await Re(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ys})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){Va(e);try{return await Re(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ys})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Va(e.userId);try{const{data:t,error:n}=await Re(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:n}}catch(t){if(be(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Va(e.userId),Va(e.id);try{return{data:await Re(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(be(t))return{data:null,error:t};throw t}}}function dw(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}function PL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ga={debug:!!(globalThis&&ZE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ex extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class qL extends ex{}async function HL(s,e,t){Ga.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Ga.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Ga.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,a.name);try{return await t()}finally{Ga.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,a.name)}}else{if(e===0)throw Ga.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new qL(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(Ga.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}PL();const FL={url:eL,storageKey:tL,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:nL,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hw(s,e,t){return await t()}const Qa={};class fc{constructor(e){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=fc.nextInstanceID,fc.nextInstanceID+=1,this.instanceID>0&&oi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},FL),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new zL({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=WE(a.fetch),this.lock=a.lock||hw,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:oi()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=HL:this.lock=hw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:ZE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=dw(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=dw(this.memoryStorage)),oi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Qa[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Qa[this.storageKey]=Object.assign(Object.assign({},Qa[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Qa[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Qa[this.storageKey]=Object.assign(Object.assign({},Qa[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${QE}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=yL(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),oi()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:o}=await this._getSessionFromURL(t,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),lL(o)){const h=(e=o.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return be(t)?{error:t}:{error:new KE("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,a;try{const o=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:es}),{data:c,error:d}=o;if(d||!c)return{data:{user:null,session:null},error:d};const h=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:g,session:h},error:null}}catch(o){if(be(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var t,n,a;try{let o;if("email"in e){const{email:p,password:m,options:y}=e;let _=null,E=null;this.flowType==="pkce"&&([_,E]=await Ya(this.storage,this.storageKey)),o=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:p,password:m,data:(t=y?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:_,code_challenge_method:E},xform:es})}else if("phone"in e){const{phone:p,password:m,options:y}=e;o=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:m,data:(n=y?.data)!==null&&n!==void 0?n:{},channel:(a=y?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:es})}else throw new Ju("You must provide either an email or phone number and a password");const{data:c,error:d}=o;if(d||!c)return{data:{user:null,session:null},error:d};const h=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:g,session:h},error:null}}catch(o){if(be(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:c,options:d}=e;t=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:uw})}else if("phone"in e){const{phone:o,password:c,options:d}=e;t=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:uw})}else throw new Ju("You must provide either an email or phone number and a password");const{data:n,error:a}=t;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ku}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,a,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,n,a,o,c,d,h,g,p,m,y,_;let E,S;if("message"in e)E=e.message,S=e.signature;else{const{chain:T,wallet:O,statement:$,options:L}=e;let U;if(oi())if(typeof O=="object")U=O;else{const Y=window;if("solana"in Y&&typeof Y.solana=="object"&&("signIn"in Y.solana&&typeof Y.solana.signIn=="function"||"signMessage"in Y.solana&&typeof Y.solana.signMessage=="function"))U=Y.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!L?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");U=O}const A=new URL((t=L?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in U&&U.signIn){const Y=await U.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},L?.signInWithSolana),{version:"1",domain:A.host,uri:A.href}),$?{statement:$}:null));let Z;if(Array.isArray(Y)&&Y[0]&&typeof Y[0]=="object")Z=Y[0];else if(Y&&typeof Y=="object"&&"signedMessage"in Y&&"signature"in Y)Z=Y;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Z&&"signature"in Z&&(typeof Z.signedMessage=="string"||Z.signedMessage instanceof Uint8Array)&&Z.signature instanceof Uint8Array)E=typeof Z.signedMessage=="string"?Z.signedMessage:new TextDecoder().decode(Z.signedMessage),S=Z.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in U)||typeof U.signMessage!="function"||!("publicKey"in U)||typeof U!="object"||!U.publicKey||!("toBase58"in U.publicKey)||typeof U.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${A.host} wants you to sign in with your Solana account:`,U.publicKey.toBase58(),...$?["",$,""]:[""],"Version: 1",`URI: ${A.href}`,`Issued At: ${(a=(n=L?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((o=L?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${L.signInWithSolana.notBefore}`]:[],...!((c=L?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${L.signInWithSolana.expirationTime}`]:[],...!((d=L?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${L.signInWithSolana.chainId}`]:[],...!((h=L?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${L.signInWithSolana.nonce}`]:[],...!((g=L?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${L.signInWithSolana.requestId}`]:[],...!((m=(p=L?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||m===void 0)&&m.length?["Resources",...L.signInWithSolana.resources.map(Z=>`- ${Z}`)]:[]].join(`
`);const Y=await U.signMessage(new TextEncoder().encode(E),"utf8");if(!Y||!(Y instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=Y}}try{const{data:T,error:O}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:pL(S)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:es});if(O)throw O;return!T||!T.session||!T.user?{data:{user:null,session:null},error:new Ku}:(T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("SIGNED_IN",T.session)),{data:Object.assign({},T),error:O})}catch(T){if(be(T))return{data:{user:null,session:null},error:T};throw T}}async _exchangeCodeForSession(e){const t=await Tr(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(t??"").split("/");try{const{data:o,error:c}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:es});if(await Is(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Ku}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:a??null}),error:c})}catch(o){if(be(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:t,provider:n,token:a,access_token:o,nonce:c}=e,d=await Re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:o,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:es}),{data:h,error:g}=d;return g?{data:{user:null,session:null},error:g}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new Ku}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:g})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,a,o,c;try{if("email"in e){const{email:d,options:h}=e;let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Ya(this.storage,this.storageKey));const{error:m}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(t=h?.data)!==null&&t!==void 0?t:{},create_user:(n=h?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:g,code_challenge_method:p},redirectTo:h?.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in e){const{phone:d,options:h}=e,{data:g,error:p}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=h?.data)!==null&&a!==void 0?a:{},create_user:(o=h?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(c=h?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:g?.message_id},error:p}}throw new Ju("You must provide either an email or phone number.")}catch(d){if(be(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(e){var t,n;try{let a,o;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:d}=await Re(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:a,xform:es});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,g=c.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:g,session:h},error:null}}catch(a){if(be(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var t,n,a;try{let o=null,c=null;return this.flowType==="pkce"&&([o,c]=await Ya(this.storage,this.storageKey)),await Re(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:c}),headers:this.headers,xform:ML})}catch(o){if(be(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Ps;const{error:a}=await Re(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(be(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:a,options:o}=e,{error:c}=await Re(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:n,type:a,options:o}=e,{data:c,error:d}=await Re(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:d}}throw new Ju("You must provide either an email or phone number and a type")}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Tr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<qg:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const c=await Tr(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=Yg()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(h,g,p)=>(!c&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(h,g,p))})}return{data:{session:e},error:null}}const{session:a,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ys}):await this._useSession(async t=>{var n,a,o;const{data:c,error:d}=t;if(d)throw d;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ps}:await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&o!==void 0?o:void 0,xform:Ys})})}catch(t){if(be(t))return oL(t)&&(await this._removeSession(),await Is(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:a,error:o}=n;if(o)throw o;if(!a.session)throw new Ps;const c=a.session;let d=null,h=null;this.flowType==="pkce"&&e.email!=null&&([d,h]=await Ya(this.storage,this.storageKey));const{data:g,error:p}=await Re(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:h}),jwt:c.access_token,xform:Ys});if(p)throw p;return c.user=g.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ps;const t=Date.now()/1e3;let n=t,a=!0,o=null;const{payload:c}=Fg(e.access_token);if(c.exp&&(n=c.exp,a=n<=t),a){const{session:d,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!d)return{data:{user:null,session:null},error:null};o=d}else{const{data:d,error:h}=await this._getUser(e.access_token);if(h)throw h;o={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(t){if(be(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:c,error:d}=t;if(d)throw d;e=(n=c.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Ps;const{session:a,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!oi())throw new Zu("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Zu(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new iw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Zu("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new iw("No code detected.");const{data:$,error:L}=await this._exchangeCodeForSession(e.code);if(L)throw L;const U=new URL(window.location.href);return U.searchParams.delete("code"),window.history.replaceState(window.history.state,"",U.toString()),{data:{session:$.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:o,refresh_token:c,expires_in:d,expires_at:h,token_type:g}=e;if(!o||!d||!c||!g)throw new Zu("No session defined in URL");const p=Math.round(Date.now()/1e3),m=parseInt(d);let y=p+m;h&&(y=parseInt(h));const _=y-p;_*1e3<=Ja&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${m}s`);const E=y-m;p-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,y,p):p-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,y,p);const{data:S,error:T}=await this._getUser(o);if(T)throw T;const O={provider_token:n,provider_refresh_token:a,access_token:o,expires_in:m,expires_at:y,refresh_token:c,token_type:g,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:O,redirectType:e.type},error:null}}catch(n){if(be(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Tr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:a,error:o}=t;if(o)return{error:o};const c=(n=a.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:d}=await this.admin.signOut(c,e);if(d&&!(aL(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return e!=="others"&&(await this._removeSession(),await Is(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=mL(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,a;try{const{data:{session:o},error:c}=t;if(c)throw c;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Ya(this.storage,this.storageKey,!0));try{return await Re(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(be(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(be(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:a}=await this._useSession(async o=>{var c,d,h,g,p;const{data:m,error:y}=o;if(y)throw y;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Re(this.fetch,"GET",_,{headers:this.headers,jwt:(p=(g=m.session)===null||g===void 0?void 0:g.access_token)!==null&&p!==void 0?p:void 0})});if(a)throw a;return oi()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(be(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,a;const{data:o,error:c}=t;if(c)throw c;return await Re(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(be(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await wL(async a=>(a>0&&await bL(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await Re(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:es})),(a,o)=>{const c=200*Math.pow(2,a);return o&&Hg(o)&&Date.now()+c-n<Ja})}catch(n){if(this._debug(t,"error",n),be(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),oi()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Tr(this.storage,this.storageKey);if(a&&this.userStorage){let c=await Tr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await Za(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c?.user)!==null&&e!==void 0?e:Yg()}else if(a&&!a.user&&!a.user){const c=await Tr(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await Is(this.storage,this.storageKey+"-user"),await Za(this.storage,this.storageKey,a)):a.user=Yg()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const o=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<qg;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${qg}s`),o){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),Hg(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Ps;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new nh;const{data:o,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!o.session)throw new Ps;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const d={session:o.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(o){if(this._debug(a,"error",o),be(o)){const c={session:null,error:o};return Hg(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,n=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,t)}catch(h){o.push(h)}});if(await Promise.all(c),o.length>0){for(let d=0;d<o.length;d+=1)console.error(o[d]);throw o[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await Za(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const o=lw(a);await Za(this.storage,this.storageKey,o)}else{const a=lw(t);await Za(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Is(this.storage,this.storageKey),await Is(this.storage,this.storageKey+"-code-verifier"),await Is(this.storage,this.storageKey+"-user"),this.userStorage&&await Is(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&oi()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ja);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-e)/Ja);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ja}ms, refresh threshold is ${Np} ticks`),a<=Np&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ex)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!oi()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const a=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,c]=await Ya(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(n?.queryParams){const o=new URLSearchParams(n.queryParams);a.push(o.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:a,error:o}=t;return o?{data:null,error:o}:await Re(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(be(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,a;const{data:o,error:c}=t;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:h,error:g}=await Re(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return g?{data:null,error:g}:(e.factorType==="totp"&&(!((a=h?.totp)===null||a===void 0)&&a.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(t){if(be(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:o}=t;if(o)return{data:null,error:o};const{data:c,error:d}=await Re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:d})})}catch(t){if(be(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:o}=t;return o?{data:null,error:o}:await Re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(be(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=e?.factors||[],a=n.filter(c=>c.factor_type==="totp"&&c.status==="verified"),o=n.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:n,totp:a,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:a},error:o}=e;if(o)return{data:null,error:o};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=Fg(a.access_token);let d=null;c.aal&&(d=c.aal);let h=d;((n=(t=a.user.factors)===null||t===void 0?void 0:t.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(h="aal2");const p=c.amr||[];return{data:{currentLevel:d,nextLevel:h,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(d=>d.kid===e);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(d=>d.kid===e),n&&this.jwks_cached_at+sL>a)return n;const{data:o,error:c}=await Re(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=a,n=o.keys.find(d=>d.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:_,error:E}=await this.getSession();if(E||!_.session)return{data:null,error:E};n=_.session.access_token}const{header:a,payload:o,signature:c,raw:{header:d,payload:h}}=Fg(n);t?.allowExpired||kL(o.exp);const g=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!g){const{error:_}=await this.getUser(n);if(_)throw _;return{data:{claims:o,header:a,signature:c},error:null}}const p=AL(a.alg),m=await crypto.subtle.importKey("jwk",g,p,!0,["verify"]);if(!await crypto.subtle.verify(p,m,c,gL(`${d}.${h}`)))throw new $p("Invalid JWT signature");return{data:{claims:o,header:a,signature:c},error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}}fc.nextInstanceID=0;const YL=fc;class VL extends YL{constructor(e){super(e)}}var GL=function(s,e,t,n){function a(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function d(p){try{g(n.next(p))}catch(m){c(m)}}function h(p){try{g(n.throw(p))}catch(m){c(m)}}function g(p){p.done?o(p.value):a(p.value).then(d,h)}g((n=n.apply(s,e||[])).next())})};class QL{constructor(e,t,n){var a,o,c;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const d=ZO(e),h=new URL(d);this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const g=`sb-${h.hostname.split(".")[0]}-auth-token`,p={db:FO,realtime:VO,auth:Object.assign(Object.assign({},YO),{storageKey:g}),global:HO},m=WO(n??{},p);this.storageKey=(a=m.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(o=m.global.headers)!==null&&o!==void 0?o:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(y,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=m.auth)!==null&&c!==void 0?c:{},this.headers,m.global.fetch),this.fetch=KO(t,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.rest=new uO(new URL("rest/v1",h).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new zO(this.storageUrl.href,this.headers,this.fetch,n?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new eO(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return GL(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:a,userStorage:o,storageKey:c,flowType:d,lock:h,debug:g},p,m){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new VL({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),p),storageKey:c,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:a,userStorage:o,flowType:d,lock:h,debug:g,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new DO(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n?.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const XL=(s,e,t)=>new QL(s,e,t);function KL(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const e=s.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}KL()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");class Wt{static instance=null;static url=null;static key=null;static getInstance(e,t){return Wt.instance&&Wt.url===e&&Wt.key===t||(Wt.instance=XL(e,t),Wt.url=e,Wt.key=t),Wt.instance}static reset(){Wt.instance=null,Wt.url=null,Wt.key=null}static hasInstance(){return Wt.instance!==null}}function Jv(){const s=window.location.hash.substring(1),e={};if(s){const t=s.split("#");for(const n of t)if(n.includes("access_token")||n.includes("type=")){const a=n.split("&");for(const o of a){const[c,d]=o.split("=");c&&d&&(e[c]=decodeURIComponent(d))}break}}return e}function JL(){const s=window.location.search.substring(1),e={};if(s){const t=s.split("&");for(const n of t){const[a,o]=n.split("=");a&&o&&(e[a]=decodeURIComponent(o))}}return e}function kd(){const s=Jv(),e=JL();return(s.type==="recovery"||e.type==="recovery")&&!!(s.access_token||e.access_token)}function ZL(){window.location.hash&&window.history.replaceState(null,"",window.location.pathname+window.location.search),window.location.search&&window.history.replaceState(null,"",window.location.pathname)}class Le{static sharedState=null;supabase;logger;constructor(e,t,n){this.supabase=Wt.getInstance(e,t),this.logger=n,Le.sharedState||(Le.sharedState={isInitialized:!1,currentUser:null,authStateCallbacks:new Set,supabaseListenerSetup:!1,recoverySession:null}),Le.sharedState.supabaseListenerSetup||(Le.sharedState.supabaseListenerSetup=!0,this.supabase.auth.onAuthStateChange((a,o)=>{if(Le.sharedState){if(a==="PASSWORD_RECOVERY"){Le.sharedState.recoverySession=o;return}const c=o?.user?this.mapSupabaseUserToAuthUser(o.user):null,d=Le.sharedState.currentUser?.id!==c?.id;Le.sharedState.isInitialized=!0,Le.sharedState.currentUser=c,d&&Le.sharedState.authStateCallbacks.forEach(h=>h(Le.sharedState.currentUser))}}),this.initializeSession())}async initializeSession(){try{const{data:{session:e}}=await this.supabase.auth.getSession();if(Le.sharedState){const t=e?.user?this.mapSupabaseUserToAuthUser(e.user):null,n=Le.sharedState.currentUser?.id!==t?.id;Le.sharedState.isInitialized=!0,Le.sharedState.currentUser=t,n&&Le.sharedState.authStateCallbacks.forEach(a=>a(Le.sharedState.currentUser))}}catch(e){if(this.logger.errorSync("Error initializing session:",e),Le.sharedState){const t=Le.sharedState.currentUser!==null;Le.sharedState.isInitialized=!0,Le.sharedState.currentUser=null,t&&Le.sharedState.authStateCallbacks.forEach(n=>n(null))}}}async getCurrentUser(){return Le.sharedState?Le.sharedState.isInitialized?Le.sharedState.currentUser:new Promise(e=>{if(Le.sharedState?.currentUser){e(Le.sharedState.currentUser);return}const t=setTimeout(()=>{e(null)},5e3),n=this.onAuthStateChange(a=>{clearTimeout(t),n(),e(a)})}):null}async signUp(e){try{const{data:t,error:n}=await this.supabase.auth.signUp({email:e.email,password:e.password,options:{data:{display_name:e.displayName}}});if(n)throw new Error(n.message);if(!t.user)throw new Error("No user returned from sign up");return this.mapSupabaseUserToAuthUser(t.user)}catch(t){throw this.logger.errorSync("Sign up error:",t),t}}async signIn(e){try{const{data:t,error:n}=await this.supabase.auth.signInWithPassword({email:e.email,password:e.password});if(n)throw new Error(n.message);if(!t.user)throw new Error("No user returned from sign in");return this.mapSupabaseUserToAuthUser(t.user)}catch(t){throw this.logger.errorSync("Sign in error:",t),t}}async signOut(){try{const{error:e}=await this.supabase.auth.signOut({scope:"local"});if(e){if(e.message.includes("session")||e.message.includes("Auth session missing")){this.logger.infoSync("Session already expired during logout, continuing...",e);return}throw new Error(e.message)}}catch(e){if(e instanceof Error&&(e.message.includes("session")||e.message.includes("Auth session missing")||e.message.includes("403")||e.message.includes("Forbidden"))){this.logger.infoSync("Session error during logout (expected):",e.message);return}throw this.logger.errorSync("Sign out error:",e),e}}onAuthStateChange(e){return Le.sharedState?(Le.sharedState.authStateCallbacks.add(e),()=>{Le.sharedState?.authStateCallbacks.delete(e)}):()=>{}}async refreshSession(){try{const{data:e,error:t}=await this.supabase.auth.refreshSession();return t?(this.logger.errorSync("Error refreshing session:",t),null):e.user?this.mapSupabaseUserToAuthUser(e.user):null}catch(e){return this.logger.errorSync("Unexpected error refreshing session:",e),null}}mapSupabaseUserToAuthUser(e){return{id:e.id,email:e.email||"",displayName:e.user_metadata?.display_name||e.user_metadata?.full_name,avatarUrl:e.user_metadata?.avatar_url}}static reset(){Le.sharedState=null,Wt.reset()}async resetPassword(e){try{const t=`${window.location.origin}/manage/#/password-reset`;this.logger.infoSync("Sending password reset email to:",e),this.logger.infoSync("Redirect URL:",t);const{error:n}=await this.supabase.auth.resetPasswordForEmail(e,{redirectTo:t});if(n)throw this.logger.errorSync("Supabase resetPasswordForEmail error:",n),new Error(n.message);this.logger.infoSync("Password reset email sent successfully")}catch(t){throw this.logger.errorSync("Password reset error:",t),t}}async updateProfile(e){try{const{data:t,error:n}=await this.supabase.auth.updateUser({data:{display_name:e.displayName,avatar_url:e.avatarUrl}});if(n)throw new Error(n.message);if(!t.user)throw new Error("No user returned from profile update");return this.mapSupabaseUserToAuthUser(t.user)}catch(t){throw this.logger.errorSync("Profile update error:",t),t}}async updatePassword(e){try{const t=Jv();if(t.type==="recovery"&&t.access_token){this.logger.infoSync("Updating password using recovery token");const{data:o,error:c}=await this.supabase.auth.setSession({access_token:t.access_token,refresh_token:t.refresh_token||""});if(c)throw new Error(`Failed to set recovery session: ${c.message}`);if(!o.session)throw new Error("No session created from recovery token")}const{data:n,error:a}=await this.supabase.auth.updateUser({password:e});if(a)throw new Error(a.message);if(!n.user)throw new Error("No user returned from password update");return this.logger.infoSync("Password updated successfully"),this.mapSupabaseUserToAuthUser(n.user)}catch(t){throw this.logger.errorSync("Password update error:",t),t}}hasRecoverySession(){return kd()}clearRecoverySession(){ZL(),Le.sharedState&&(Le.sharedState.recoverySession=null)}}const Ip=(s,e)=>e.some(t=>s instanceof t);let fw,gw;function WL(){return fw||(fw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ej(){return gw||(gw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Bp=new WeakMap,Gg=new WeakMap,ih=new WeakMap;function tj(s){const e=new Promise((t,n)=>{const a=()=>{s.removeEventListener("success",o),s.removeEventListener("error",c)},o=()=>{t(Ur(s.result)),a()},c=()=>{n(s.error),a()};s.addEventListener("success",o),s.addEventListener("error",c)});return ih.set(e,s),e}function nj(s){if(Bp.has(s))return;const e=new Promise((t,n)=>{const a=()=>{s.removeEventListener("complete",o),s.removeEventListener("error",c),s.removeEventListener("abort",c)},o=()=>{t(),a()},c=()=>{n(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",o),s.addEventListener("error",c),s.addEventListener("abort",c)});Bp.set(s,e)}let zp={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return Bp.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ur(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function tx(s){zp=s(zp)}function ij(s){return ej().includes(s)?function(...e){return s.apply(Pp(this),e),Ur(this.request)}:function(...e){return Ur(s.apply(Pp(this),e))}}function sj(s){return typeof s=="function"?ij(s):(s instanceof IDBTransaction&&nj(s),Ip(s,WL())?new Proxy(s,zp):s)}function Ur(s){if(s instanceof IDBRequest)return tj(s);if(Gg.has(s))return Gg.get(s);const e=sj(s);return e!==s&&(Gg.set(s,e),ih.set(e,s)),e}const Pp=s=>ih.get(s);function rj(s,e,{blocked:t,upgrade:n,blocking:a,terminated:o}={}){const c=indexedDB.open(s,e),d=Ur(c);return n&&c.addEventListener("upgradeneeded",h=>{n(Ur(c.result),h.oldVersion,h.newVersion,Ur(c.transaction),h)}),t&&c.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),d.then(h=>{o&&h.addEventListener("close",()=>o()),a&&h.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),d}const aj=["get","getKey","getAll","getAllKeys","count"],oj=["put","add","delete","clear"],Qg=new Map;function pw(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Qg.get(e))return Qg.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,a=oj.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(a||aj.includes(t)))return;const o=async function(c,...d){const h=this.transaction(c,a?"readwrite":"readonly");let g=h.store;return n&&(g=g.index(d.shift())),(await Promise.all([g[t](...d),a&&h.done]))[0]};return Qg.set(e,o),o}tx(s=>({...s,get:(e,t,n)=>pw(e,t)||s.get(e,t,n),has:(e,t)=>!!pw(e,t)||s.has(e,t)}));const lj=["continue","continuePrimaryKey","advance"],vw={},qp=new WeakMap,nx=new WeakMap,cj={get(s,e){if(!lj.includes(e))return s[e];let t=vw[e];return t||(t=vw[e]=function(...n){qp.set(this,nx.get(this)[e](...n))}),t}};async function*uj(...s){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...s)),!e)return;e=e;const t=new Proxy(e,cj);for(nx.set(t,e),ih.set(t,Pp(e));e;)yield t,e=await(qp.get(t)||e.continue()),qp.delete(t)}function mw(s,e){return e===Symbol.asyncIterator&&Ip(s,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&Ip(s,[IDBIndex,IDBObjectStore])}tx(s=>({...s,get(e,t,n){return mw(e,t)?uj:s.get(e,t,n)},has(e,t){return mw(e,t)||s.has(e,t)}}));class dj{db=null;storeName;dbName;version;constructor(e,t="ListAppDB",n=1){this.storeName=e,this.dbName=t,this.version=n}async getDB(){return this.db||(this.db=await rj(this.dbName,this.version,{upgrade(e){e.objectStoreNames.contains("lists")||e.createObjectStore("lists",{keyPath:"uuid"}),e.objectStoreNames.contains("metadata")||e.createObjectStore("metadata",{keyPath:"key"}),e.objectStoreNames.contains("syncQueue")||e.createObjectStore("syncQueue",{keyPath:"uuid"})}})),this.db}async get(e){return await(await this.getDB()).get(this.storeName,e)}async getAll(){return await(await this.getDB()).getAll(this.storeName)}async save(e){await(await this.getDB()).put(this.storeName,e)}async delete(e){await(await this.getDB()).delete(this.storeName,e)}async clear(){await(await this.getDB()).clear(this.storeName)}}class hj{supabase;userId=null;logger;constructor(e,t,n){this.supabase=Wt.getInstance(e,t),this.logger=n}async setUserId(e){this.userId!==e?(this.logger.infoSync(`Setting user ID in remote storage service: ${e}`),this.userId=e):this.logger.debugSync(`User ID already set to: ${e}, skipping redundant setUserId call`)}getUserId(){return this.userId}async listExists(e){if(!this.userId)throw new Error("User not authenticated");const{data:t,error:n}=await this.supabase.from("lists").select("id").eq("yjs_document_id",e).is("deleted_by",null).single();if(n){if(n.code==="PGRST116")return!1;throw new Error(`Failed to check if list exists: ${n.message}`)}return!!t}async createList(e){if(!this.userId)throw new Error("User not authenticated");this.logger.infoSync("Creating list in Supabase:",{yjsDocumentId:e,userId:this.userId});const{data:t,error:n}=await this.supabase.from("lists").insert({yjs_document_id:e,owner_id:this.userId}).select().single();if(n)throw this.logger.errorSync("Failed to create list:",n),new Error(`Failed to create list: ${n.message}`);this.logger.infoSync("List created successfully:",t);const{error:a}=await this.supabase.from("list_participants").insert({list_id:t.id,user_id:this.userId,role:"owner"});return a?this.logger.warnSync("Failed to add owner as participant:",a.message):this.logger.infoSync(`Owner added as participant for list: ${t.id}`),{id:t.id,yjsDocumentId:t.yjs_document_id,ownerId:t.owner_id,isShared:!1,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at)}}async getUserLists(){if(!this.userId)throw new Error("User not authenticated");try{const{data:e,error:t}=await this.supabase.from("lists").select("id, yjs_document_id, owner_id, created_at, updated_at").eq("owner_id",this.userId).is("deleted_by",null);if(t)throw new Error(`Failed to get owned lists: ${t.message}`);const{data:n,error:a}=await this.supabase.from("list_participants").select(`
          list_id,
          lists!inner(id, yjs_document_id, owner_id, created_at, updated_at)
        `).eq("user_id",this.userId).neq("lists.owner_id",this.userId).is("lists.deleted_by",null);if(a)throw new Error(`Failed to get participant lists: ${a.message}`);const o=[];if(e)for(const c of e)o.push({id:c.id,yjsDocumentId:c.yjs_document_id,ownerId:c.owner_id,isShared:!1,createdAt:new Date(c.created_at),updatedAt:new Date(c.updated_at)});if(n)for(const c of n){const d=c.lists;o.push({id:d.id,yjsDocumentId:d.yjs_document_id,ownerId:d.owner_id,isShared:!0,createdAt:new Date(d.created_at),updatedAt:new Date(d.updated_at)})}return o}catch(e){throw this.logger.errorSync("Error in getUserLists:",e),e}}async getAllUserLists(e){if(!this.userId)throw new Error("User not authenticated");try{let t=this.supabase.from("lists").select(`
          id,
          yjs_document_id,
          owner_id,
          created_at,
          updated_at,
          deleted_by,
          deleted_at
        `).eq("owner_id",this.userId);e&&(t=t.or(`deleted_by.is.null,deleted_at.gte.${e.toISOString()}`));const{data:n,error:a}=await t;if(a)throw new Error(`Failed to get owned lists: ${a.message}`);const{data:o,error:c}=await this.supabase.from("list_participants").select(`
          list_id,
          lists!inner(id, yjs_document_id, owner_id, created_at, updated_at, deleted_by, deleted_at)
        `).eq("user_id",this.userId).neq("lists.owner_id",this.userId).is("lists.deleted_by",null);if(c)throw new Error(`Failed to get participant lists: ${c.message}`);const d=[],h=[];if(n)for(const g of n)g.deleted_by===null?d.push({id:g.id,yjsDocumentId:g.yjs_document_id,ownerId:g.owner_id,isShared:!1,createdAt:new Date(g.created_at),updatedAt:new Date(g.updated_at)}):(!e||new Date(g.deleted_at)>=e)&&h.push(g.yjs_document_id);if(o)for(const g of o){const p=g.lists;d.push({id:p.id,yjsDocumentId:p.yjs_document_id,ownerId:p.owner_id,isShared:!0,createdAt:new Date(p.created_at),updatedAt:new Date(p.updated_at)})}return{activeLists:d,deletedLists:h}}catch(t){throw this.logger.errorSync("Error in getAllUserLists:",t),t}}async deleteList(e){if(!this.userId)throw new Error("User not authenticated");const{error:t}=await this.supabase.from("lists").update({deleted_by:this.userId,deleted_at:new Date().toISOString()}).eq("yjs_document_id",e).is("deleted_by",null);if(t)throw new Error(`Failed to delete list: ${t.message}`);this.logger.infoSync(`Successfully soft deleted list for yjs_document_id: ${e}`)}async pushUpdate(e,t){if(!this.userId)throw new Error("User not authenticated");const n=Array.from(t.data),{error:a}=await this.supabase.from("crdt_updates").insert({yjs_document_id:e,user_id:this.userId,client_id:t.clientId,update_data:n});if(a)throw new Error(`Failed to push update: ${a.message}`)}async pullUpdates(e,t,n){if(!this.userId)throw new Error("User not authenticated");let a=this.supabase.from("crdt_updates").select("*").eq("yjs_document_id",e).order("created_at",{ascending:!0});t&&(a=a.gt("created_at",t.toISOString())),n&&(a=a.neq("client_id",n));const{data:o,error:c}=await a;if(c)throw new Error(`Failed to pull updates: ${c.message}`);return this.logger.infoSync(`Pulled ${o.length} remote updates since ${t?.toISOString()||"beginning"}${n?` (excluding client ${n})`:""}`),o.map(d=>{let h;try{if(typeof d.update_data=="string"){const g=new Uint8Array(d.update_data.length);for(let p=0;p<d.update_data.length;p++)g[p]=d.update_data.charCodeAt(p);h=g}else Array.isArray(d.update_data)?h=new Uint8Array(d.update_data):d.update_data instanceof Uint8Array?h=d.update_data:(this.logger.warnSync("Unknown update_data type:",typeof d.update_data),h=new Uint8Array(0))}catch(g){this.logger.errorSync("Failed to convert update_data:",g),h=new Uint8Array(0)}return{id:d.id,yjsDocumentId:d.yjs_document_id,userId:d.user_id,clientId:d.client_id,data:h,timestamp:new Date(d.created_at)}})}async pushSnapshot(e,t){if(!this.userId)throw new Error("User not authenticated");const{error:n}=await this.supabase.from("crdt_snapshots").insert({yjs_document_id:e,snapshot_data:t.data,version:t.version});if(n)throw new Error(`Failed to push snapshot: ${n.message}`)}async pullLatestSnapshot(e){const{data:t,error:n}=await this.supabase.from("crdt_snapshots").select("*").eq("yjs_document_id",e).order("version",{ascending:!1}).limit(1).single();if(n&&n.code!=="PGRST116")throw new Error(`Failed to pull snapshot: ${n.message}`);return t?{id:t.id,yjsDocumentId:t.yjs_document_id,data:t.snapshot_data,version:t.version,timestamp:new Date(t.created_at)}:null}async shareList(e,t){throw this.userId?new Error("List sharing not yet implemented"):new Error("User not authenticated")}async acceptInvite(e){if(!this.userId)throw new Error("User not authenticated");this.logger.infoSync("Accepting invite with token:",e);const{data:t,error:n}=await this.supabase.from("list_invites").select("*").eq("token",e).eq("status","pending").single();if(n)throw n.code==="PGRST116"?new Error("Invite not found or already used"):new Error(`Failed to get invite: ${n.message}`);if(new Date(t.expires_at)<new Date)throw new Error("Invite has expired");const{data:a,error:o}=await this.supabase.rpc("accept_invite",{invite_token:e,user_id:this.userId});if(o)throw new Error(`Failed to accept invite: ${o.message}`);if(!a)throw new Error("Failed to accept invite - invite may be invalid or expired");this.logger.infoSync("Successfully accepted invite:",{inviteId:t.id,listId:t.list_id,userId:this.userId})}async getListParticipants(e){throw this.userId?new Error("Participant retrieval not yet implemented"):new Error("User not authenticated")}async removeParticipant(e){if(!this.userId)throw new Error("User not authenticated");this.logger.infoSync("Removing participant from list:",{yjsDocumentId:e,userId:this.userId});const{data:t,error:n}=await this.supabase.from("lists").select("id").eq("yjs_document_id",e).single();if(n)throw this.logger.errorSync("Failed to find list by YJS document ID:",n),new Error(`Failed to find list: ${n.message}`);if(!t)throw new Error(`List not found for YJS document ID: ${e}`);const{error:a}=await this.supabase.from("list_participants").delete().eq("list_id",t.id).eq("user_id",this.userId);if(a)throw this.logger.errorSync("Failed to remove participant:",a),new Error(`Failed to remove participant: ${a.message}`);this.logger.infoSync(`Successfully removed participant from list: ${e} (database ID: ${t.id})`)}async createInvite(e,t){const n=t||this.userId;if(!n)throw new Error("User not authenticated");const{data:{user:a},error:o}=await this.supabase.auth.getUser();this.logger.infoSync("Current auth state:",{currentUserId:n,supabaseUserId:a?.id,authError:o?.message});const c=Kn(),{data:d,error:h}=await this.supabase.from("lists").select("id, yjs_document_id, owner_id").eq("yjs_document_id",e.listId).is("deleted_by",null).single();if(h)throw new Error(`List not found: ${h.message}`);if(d.owner_id!==n)throw this.logger.errorSync("User is not the owner of the list:",{listOwnerId:d.owner_id,currentUserId:n,listId:e.listId}),new Error("Only the list owner can create invites");this.logger.infoSync("Creating invite with data:",{list_id:d.id,yjs_document_id:d.yjs_document_id,invited_by:n,invitation_for:e.invitationFor,token:c});const{data:g,error:p}=await this.supabase.from("list_invites").insert({list_id:d.id,yjs_document_id:d.yjs_document_id,invited_by:n,invitation_for:e.invitationFor,token:c,status:"pending",expires_at:new Date(Date.now()+10080*60*1e3).toISOString()}).select().single();if(p)throw new Error(`Failed to create invite: ${p.message}`);const m={id:g.id,listId:g.list_id,yjsDocumentId:g.yjs_document_id,invitedBy:g.invited_by,invitationFor:g.invitation_for,token:g.token,status:g.status,acceptedBy:g.accepted_by,createdAt:new Date(g.created_at),expiresAt:new Date(g.expires_at)},y=`${window.location.origin}/manage/#/invite/${c}`;return{invite:m,inviteUrl:y}}async getListInvites(e,t){const n=t||this.userId;if(!n)throw new Error("User not authenticated");const{data:a,error:o}=await this.supabase.from("lists").select("id").eq("yjs_document_id",e).is("deleted_by",null).single();if(o)throw new Error(`List not found: ${o.message}`);const{data:c,error:d}=await this.supabase.from("list_invites").select("*").eq("list_id",a.id).eq("invited_by",n).order("created_at",{ascending:!1});if(d)throw new Error(`Failed to get list invites: ${d.message}`);return c.map(h=>({id:h.id,listId:h.list_id,yjsDocumentId:h.yjs_document_id,invitedBy:h.invited_by,invitationFor:h.invitation_for,token:h.token,status:h.status,acceptedBy:h.accepted_by,createdAt:new Date(h.created_at),expiresAt:new Date(h.expires_at)}))}async getInviteByToken(e){const{data:t,error:n}=await this.supabase.from("list_invites").select("*").eq("token",e).single();if(n)throw n.code==="PGRST116"?new Error("Invite not found"):new Error(`Failed to get invite: ${n.message}`);return{id:t.id,listId:t.list_id,yjsDocumentId:t.yjs_document_id,invitedBy:t.invited_by,invitationFor:t.invitation_for,token:t.token,status:t.status,acceptedBy:t.accepted_by,createdAt:new Date(t.created_at),expiresAt:new Date(t.expires_at)}}async revokeInvite(e,t){const n=t||this.userId;if(!n)throw new Error("User not authenticated");const{error:a}=await this.supabase.from("list_invites").update({status:"expired"}).eq("id",e).eq("invited_by",n);if(a)throw new Error(`Failed to revoke invite: ${a.message}`)}}class fj{supabase;logger;connectionStatus="disconnected";subscriptions=new Map;errorTimeout=null;connectionListeners=[];subscriptionStates=new Map;hasNotifiedConnection=!1;constructor(e,t,n){this.supabase=Wt.getInstance(e,t),this.logger=n}async disconnect(){try{this.logger.infoSync("Disconnecting from Supabase realtime..."),this.errorTimeout&&(clearTimeout(this.errorTimeout),this.errorTimeout=null);for(const[e,t]of this.subscriptions)t.unsubscribe(),this.logger.infoSync(`Unsubscribed from ${e}`);this.subscriptions.clear(),this.subscriptionStates.clear(),this.hasNotifiedConnection=!1,this.connectionStatus="disconnected",this.logger.infoSync("Disconnected from Supabase realtime"),this.notifyConnectionListeners(!1)}catch(e){throw this.logger.errorSync("Error disconnecting from Supabase realtime:",e),e}}isConnected(){const e=this.connectionStatus==="connected";return this.logger.debugSync(`Realtime service isConnected(): ${e} (status: ${this.connectionStatus})`),e}onConnectionChange(e){this.connectionListeners.push(e)}removeConnectionListener(e){const t=this.connectionListeners.indexOf(e);t>-1&&this.connectionListeners.splice(t,1)}getConnectionStatus(){return this.subscriptions.size>0&&this.connectionStatus==="connected"?"connected":this.connectionStatus==="connecting"||this.subscriptions.size>0&&this.connectionStatus==="error"?"connecting":this.connectionStatus}checkAndNotifyConnectionStatus(){Array.from(this.subscriptionStates.values()).every(t=>t==="subscribed")&&!this.hasNotifiedConnection&&(this.connectionStatus="connected",this.hasNotifiedConnection=!0,this.logger.infoSync("All subscriptions ready - notifying connection listeners"),this.notifyConnectionListeners(!0))}notifyConnectionListeners(e){this.connectionListeners.forEach(t=>{try{t(e)}catch(n){this.logger.errorSync("Error in connection listener:",n)}})}async setAuth(){const{data:{session:e},error:t}=await this.supabase.auth.getSession();if(t)throw this.logger.errorSync("Error getting session:",t),t;if(!e?.access_token)throw this.logger.errorSync("No access token found"),new Error("No access token found");this.logger.infoSync("Access token found:",e.access_token),await this.supabase.realtime.setAuth(e.access_token)}async subscribeToCRDTUpdates(e){await this.setAuth();const t="crdt_updates";this.logger.infoSync(`Starting CRDT subscription to table: ${t}`),this.subscriptionStates.set(t,"subscribing");try{const n=this.supabase.channel(`${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:`${t}`},o=>{const c=o;this.logger.debugSync(`Received realtime update for ${t}:`,o);const d={type:"list_updated",table:t,record:c.new,eventType:c.eventType};e(d)}).subscribe(o=>{this.logger.infoSync(`Subscription status for ${t}:`,o),o==="SUBSCRIBED"?(this.subscriptionStates.set(t,"subscribed"),this.errorTimeout&&(clearTimeout(this.errorTimeout),this.errorTimeout=null),this.logger.infoSync(`Successfully subscribed to ${t}`),this.checkAndNotifyConnectionStatus()):o==="CHANNEL_ERROR"?(this.subscriptionStates.set(t,"error"),this.logger.warnSync(`Channel error for ${t}, but keeping current status: ${this.connectionStatus}`)):o==="TIMED_OUT"?(this.subscriptionStates.set(t,"error"),this.logger.warnSync(`Subscription timed out for ${t}, status: ${o}`)):o==="CLOSED"?(this.subscriptionStates.set(t,"error"),this.logger.warnSync(`Subscription closed for ${t}, status: ${o}`)):this.logger.infoSync(`Subscription status for ${t}: ${o}`)}),a={unsubscribe:()=>{this.logger.infoSync(`Unsubscribing from table: ${t}`),this.supabase.removeChannel(n),this.subscriptions.delete(t),this.subscriptionStates.delete(t)}};return this.subscriptions.set(t,a),a}catch(n){throw this.logger.errorSync(`Failed to subscribe to table ${t}:`,n),n}}async subscribeToListUpdates(e){await this.setAuth();const t="lists";this.subscriptionStates.set(t,"subscribing");try{const n=this.supabase.channel(`${t}_changes`).on("postgres_changes",{event:"*",schema:"public",table:t},o=>{this.logger.debugSync(`Received realtime update for ${t}:`,o);const c={type:this.determineUpdateType(t,o.eventType),table:t,record:o.new,oldRecord:o.old,eventType:o.eventType};e(c)}).subscribe(o=>{this.logger.infoSync(`Subscription status for ${t}:`,o),o==="SUBSCRIBED"?(this.subscriptionStates.set(t,"subscribed"),this.errorTimeout&&(clearTimeout(this.errorTimeout),this.errorTimeout=null),this.logger.infoSync(`Successfully subscribed to ${t}`),this.checkAndNotifyConnectionStatus()):o==="CHANNEL_ERROR"?(this.subscriptionStates.set(t,"error"),this.logger.warnSync(`Channel error for ${t}, but keeping current status: ${this.connectionStatus}`)):o==="TIMED_OUT"?(this.subscriptionStates.set(t,"error"),this.logger.warnSync(`Subscription timed out for ${t}, status: ${o}`)):o==="CLOSED"?(this.subscriptionStates.set(t,"error"),this.logger.warnSync(`Subscription closed for ${t}, status: ${o}`)):this.logger.infoSync(`Subscription status for ${t}: ${o}`)}),a={unsubscribe:()=>{this.logger.infoSync(`Unsubscribing from table: ${t}`),this.supabase.removeChannel(n),this.subscriptions.delete(t),this.subscriptionStates.delete(t)}};return this.subscriptions.set(t,a),a}catch(n){throw this.logger.errorSync(`Failed to subscribe to table ${t}:`,n),n}}determineUpdateType(e,t){switch(e){case"lists":switch(t){case"INSERT":return"list_created";case"UPDATE":return"list_updated";case"DELETE":return"list_deleted";default:return"list_updated"}default:return"list_updated"}}}class gj{constructor(e,t,n,a,o,c,d,h){this.yjsListManager=e,this.eventService=t,this.logger=n,this.remoteStorageService=a,this.connectionMonitor=o,this.listRepository=c,this.syncQueueRepository=d,this.metadataRepository=h}cachedClientId=null;isBootstrapping=!1;async getCurrentUserId(){return this.remoteStorageService.getUserId()?this.remoteStorageService.getUserId():(this.logger.warnSync("No user ID available in remote storage service"),null)}async createList(e,t){try{const n=Kn(),a=await this.getCurrentUserId()??void 0;this.yjsListManager.createList(n,e,t,a);const o=this.yjsListManager.getYjsState(n);if(o){await this.listRepository.saveList({uuid:n,data:o});const c=this.connectionMonitor.getConnectionState();if(this.logger.infoSync("Connection state during list creation:",{browserOnline:c.browserOnline,realtimeConnected:c.realtimeConnected,isOnline:c.isOnline}),this.connectionMonitor.isOnline())try{this.logger.infoSync(`Attempting real-time sync for list creation: ${n}`),await this.remoteStorageService.createList(n),this.logger.infoSync(`Real-time sync successful for list creation ${n}`);const d=await this.getClientId();this.logger.infoSync(`Pushing initial YJS update for list: ${n} with clientId: ${d}`),await this.remoteStorageService.pushUpdate(n,{id:Kn(),yjsDocumentId:n,clientId:d,data:o,timestamp:new Date}),this.logger.infoSync(`Real-time sync successful for initial YJS update ${n}`)}catch(d){this.logger.errorSync(`Real-time sync failed for list creation ${n}:`,d),this.logger.warnSync(`Falling back to queue for list creation ${n}`),await this.syncQueueRepository.addListCreateItem(n),await this.syncQueueRepository.addYjsUpdateItem(n,o),await this.triggerBackgroundSync()}else this.logger.infoSync(`Offline mode - queuing list creation: ${n}`),await this.syncQueueRepository.addListCreateItem(n),await this.syncQueueRepository.addYjsUpdateItem(n,o),await this.triggerBackgroundSync()}return this.eventService.publish({type:ye.LIST_CREATED,payload:{listId:n,title:e,createdAt:new Date},timestamp:new Date,listId:n}),this.logger.infoSync(`Created new list: ${n} with name: ${e}`),n}catch(n){throw this.logger.errorSync(`Failed to create list "${e}":`,n),n}}async deleteList(e){try{if(this.yjsListManager.deleteList(e),await this.listRepository.deleteList(e),await this.syncQueueRepository.clearSyncQueueItemsForList(e),this.connectionMonitor.isOnline())try{await this.remoteStorageService.deleteList(e),this.logger.infoSync(`Real-time sync successful for list deletion ${e}`)}catch(t){this.logger.warnSync(`Real-time sync failed for list deletion ${e}, falling back to queue:`,t),await this.syncQueueRepository.addListDeleteItem(e),await this.triggerBackgroundSync()}else await this.syncQueueRepository.addListDeleteItem(e),await this.triggerBackgroundSync();this.eventService.publish({type:ye.LIST_DELETED,payload:{listId:e,title:"",deletedAt:new Date},timestamp:new Date,listId:e}),this.logger.infoSync(`Deleted list: ${e}`)}catch(t){throw this.logger.errorSync(`Failed to delete list ${e}:`,t),t}}async addItem(e,t){try{const n=this.yjsListManager.addItem(e,t);if(!n)throw new Error(`Failed to add item to list ${e}`);const a=this.yjsListManager.getYjsState(e);if(a)if(await this.listRepository.saveList({uuid:e,data:a}),this.connectionMonitor.isOnline())try{const o=await this.getClientId();await this.remoteStorageService.pushUpdate(e,{id:Kn(),yjsDocumentId:e,clientId:o,data:a,timestamp:new Date}),this.logger.infoSync(`Real-time sync successful for item add to list ${e}`)}catch(o){this.logger.warnSync(`Real-time sync failed for item add to list ${e}, falling back to queue:`,o),await this.syncQueueRepository.addYjsUpdateItem(e,a),await this.triggerBackgroundSync()}else await this.syncQueueRepository.addYjsUpdateItem(e,a),await this.triggerBackgroundSync();this.eventService.publish({type:ye.ITEM_ADDED,payload:{listId:e,itemId:n,content:t,position:0,addedAt:new Date},timestamp:new Date,listId:e}),this.logger.infoSync(`Added item to list ${e}: ${t}`)}catch(n){throw this.logger.errorSync(`Failed to add item to list ${e}:`,n),n}}async editItem(e,t,n){try{this.yjsListManager.editItem(e,t,n);const a=this.yjsListManager.getYjsState(e);if(a)if(await this.listRepository.saveList({uuid:e,data:a}),this.connectionMonitor.isOnline())try{const o=await this.getClientId();await this.remoteStorageService.pushUpdate(e,{id:Kn(),yjsDocumentId:e,clientId:o,data:a,timestamp:new Date}),this.logger.infoSync(`Real-time sync successful for item edit in list ${e}`)}catch(o){this.logger.warnSync(`Real-time sync failed for item edit in list ${e}, falling back to queue:`,o),await this.syncQueueRepository.addYjsUpdateItem(e,a),await this.triggerBackgroundSync()}else await this.syncQueueRepository.addYjsUpdateItem(e,a),await this.triggerBackgroundSync();this.eventService.publish({type:ye.ITEM_CONTENT_CHANGED,payload:{listId:e,itemId:t,content:n,changedAt:new Date},timestamp:new Date,listId:e,itemId:t}),this.logger.infoSync(`Edited item ${t} in list ${e}: ${n}`)}catch(a){throw this.logger.errorSync(`Failed to edit item ${t} in list ${e}:`,a),a}}async deleteItem(e,t){try{this.yjsListManager.deleteItem(e,t);const n=this.yjsListManager.getYjsState(e);if(n)if(await this.listRepository.saveList({uuid:e,data:n}),this.connectionMonitor.isOnline())try{const a=await this.getClientId();await this.remoteStorageService.pushUpdate(e,{id:Kn(),yjsDocumentId:e,clientId:a,data:n,timestamp:new Date}),this.logger.infoSync(`Real-time sync successful for item delete in list ${e}`)}catch(a){this.logger.warnSync(`Real-time sync failed for item delete in list ${e}, falling back to queue:`,a),await this.syncQueueRepository.addYjsUpdateItem(e,n),await this.triggerBackgroundSync()}else await this.syncQueueRepository.addYjsUpdateItem(e,n),await this.triggerBackgroundSync();this.eventService.publish({type:ye.ITEM_DELETED,payload:{listId:e,itemId:t,content:"",deletedAt:new Date},timestamp:new Date,listId:e,itemId:t}),this.logger.infoSync(`Deleted item ${t} from list ${e}`)}catch(n){throw this.logger.errorSync(`Failed to delete item ${t} from list ${e}:`,n),n}}async toggleItem(e,t){try{this.yjsListManager.toggleItem(e,t);const n=this.yjsListManager.getYjsState(e);if(n)if(await this.listRepository.saveList({uuid:e,data:n}),this.connectionMonitor.isOnline())try{const a=await this.getClientId();await this.remoteStorageService.pushUpdate(e,{id:Kn(),yjsDocumentId:e,clientId:a,data:n,timestamp:new Date}),this.logger.infoSync(`Real-time sync successful for item toggle in list ${e}`)}catch(a){this.logger.warnSync(`Real-time sync failed for item toggle in list ${e}, falling back to queue:`,a),await this.syncQueueRepository.addYjsUpdateItem(e,n),await this.triggerBackgroundSync()}else await this.syncQueueRepository.addYjsUpdateItem(e,n),await this.triggerBackgroundSync();this.eventService.publish({type:ye.ITEM_CONTENT_CHANGED,payload:{listId:e,itemId:t,oldContent:"",newContent:"",changedAt:new Date},timestamp:new Date,listId:e,itemId:t}),this.logger.infoSync(`Toggled item ${t} in list ${e}`)}catch(n){throw this.logger.errorSync(`Failed to toggle item ${t} in list ${e}:`,n),n}}async moveItem(e,t,n){try{this.yjsListManager.moveItem(e,t,n);const a=this.yjsListManager.getYjsState(e);if(a)if(await this.listRepository.saveList({uuid:e,data:a}),this.connectionMonitor.isOnline())try{const o=await this.getClientId();await this.remoteStorageService.pushUpdate(e,{id:Kn(),yjsDocumentId:e,clientId:o,data:a,timestamp:new Date}),this.logger.infoSync(`Real-time sync successful for item move in list ${e}`)}catch(o){this.logger.warnSync(`Real-time sync failed for item move in list ${e}, falling back to queue:`,o),await this.syncQueueRepository.addYjsUpdateItem(e,a),await this.triggerBackgroundSync()}else await this.syncQueueRepository.addYjsUpdateItem(e,a),await this.triggerBackgroundSync();this.eventService.publish({type:ye.ITEM_MOVED,payload:{listId:e,itemId:t,newIndex:n,movedAt:new Date},timestamp:new Date,listId:e,itemId:t}),this.logger.infoSync(`Moved item ${t} to position ${n} in list ${e}`)}catch(a){throw this.logger.errorSync(`Failed to move item ${t} in list ${e}:`,a),a}}async getAllLists(){try{const e=await this.listRepository.getAllLists(),t=[];for(const n of e){this.yjsListManager.isListLoaded(n.uuid)||this.yjsListManager.applyYjsUpdate(n.uuid,n.data);const a=this.yjsListManager.getList(n.uuid);a&&t.push(a)}try{const n=await this.remoteStorageService.getUserLists();t.forEach(a=>{const o=n.find(c=>c.yjsDocumentId===a.id);o&&(a.ownerId=o.ownerId)})}catch(n){this.logger.warnSync("Failed to get ownership info for lists:",n)}return t}catch(e){throw this.logger.errorSync("Failed to get all lists:",e),e}}async bootstrapFromRemote(){if(this.isBootstrapping){this.logger.debugSync("Bootstrap already in progress, skipping duplicate call");return}this.isBootstrapping=!0;try{this.logger.infoSync("Starting bootstrap from remote server...");const e=this.connectionMonitor.getConnectionState();if(this.logger.infoSync("Connection state during bootstrap:",{browserOnline:e.browserOnline,realtimeConnected:e.realtimeConnected,isOnline:e.isOnline}),!e.browserOnline){this.logger.warnSync("Cannot bootstrap from remote: browser is offline");return}e.realtimeConnected||this.logger.warnSync("Realtime service not connected, but attempting bootstrap anyway...");const t=await this.remoteStorageService.getUserLists();this.logger.infoSync(`Found ${t.length} lists on remote server`);for(const n of t)try{if(await this.listRepository.getList(n.yjsDocumentId)){this.logger.debugSync(`Checking for updates to existing list: ${n.yjsDocumentId}`);try{const o=await this.getClientId(),c=await this.getLastSyncTimestamp(n.yjsDocumentId);this.logger.infoSync(`Pulling updates for existing list ${n.yjsDocumentId}${c?` since ${c.toISOString()}`:" (all updates)"}`);const d=await this.remoteStorageService.pullUpdates(n.yjsDocumentId,c||void 0,o);if(d.length>0){this.logger.infoSync(`Applying ${d.length} updates for existing list ${n.yjsDocumentId}`);for(const p of d)this.yjsListManager.applyYjsUpdate(n.yjsDocumentId,p.data);const h=this.yjsListManager.getYjsState(n.yjsDocumentId);h&&await this.listRepository.saveList({uuid:n.yjsDocumentId,data:h}),this.eventService.publish({type:ye.LIST_METADATA_CHANGED,payload:{listId:n.yjsDocumentId,metadata:{lastRemoteUpdate:new Date,source:"remote",action:"content_changed"},changedAt:new Date},timestamp:new Date,listId:n.yjsDocumentId}),this.logger.infoSync(`Updated list ${n.yjsDocumentId} with ${d.length} remote updates`);const g=d[d.length-1]?.timestamp;g&&await this.setLastSyncTimestamp(n.yjsDocumentId,g)}else this.logger.debugSync(`No updates found for existing list ${n.yjsDocumentId}`)}catch(o){this.logger.warnSync(`Failed to pull updates for existing list ${n.yjsDocumentId}:`,o)}}else{this.logger.infoSync(`Creating new list from remote: ${n.yjsDocumentId}`);try{const c=await this.getClientId(),d=await this.getLastSyncTimestamp(n.yjsDocumentId);this.logger.infoSync(`Pulling updates for new list ${n.yjsDocumentId}${d?` since ${d.toISOString()}`:" (all updates)"}`);const h=await this.remoteStorageService.pullUpdates(n.yjsDocumentId,d||void 0,c);if(h.length>0){this.logger.infoSync(`Applying ${h.length} updates for list ${n.yjsDocumentId}`);for(const p of h)this.yjsListManager.applyYjsUpdate(n.yjsDocumentId,p.data);this.logger.infoSync(`Applied ${h.length} updates for list ${n.yjsDocumentId}`);const g=h[h.length-1]?.timestamp;g&&await this.setLastSyncTimestamp(n.yjsDocumentId,g)}else this.logger.infoSync(`No updates found for list ${n.yjsDocumentId}`),this.yjsListManager.createList(n.yjsDocumentId,n.title||"Untitled List",void 0,n.ownerId)}catch(c){this.logger.warnSync(`Failed to pull updates for list ${n.yjsDocumentId}:`,c)}const o=this.yjsListManager.getYjsState(n.yjsDocumentId);o&&await this.listRepository.saveList({uuid:n.yjsDocumentId,data:o}),this.logger.infoSync(`Emitting list_created events for remote list: ${n.yjsDocumentId}`),this.eventService.publish({type:ye.LIST_CREATED,payload:{listId:n.yjsDocumentId,title:n.title||"Untitled List",createdAt:new Date},timestamp:new Date,listId:n.yjsDocumentId})}}catch(a){this.logger.errorSync(`Failed to process remote list ${n.yjsDocumentId}:`,a)}this.logger.infoSync("Bootstrap from remote server completed"),this.eventService.publish({type:ye.BOOTSTRAP_COMPLETED,payload:{listId:"all",metadata:{action:ye.BOOTSTRAP_COMPLETED,completedAt:new Date}},timestamp:new Date})}catch(e){throw this.logger.errorSync("Failed to bootstrap from remote server:",e),e}finally{this.isBootstrapping=!1}}async getList(e){try{if(!this.yjsListManager.isListLoaded(e)){const n=await this.listRepository.getList(e);if(n)this.yjsListManager.applyYjsUpdate(e,n.data);else return null}const t=this.yjsListManager.getList(e);if(!t)return null;try{const a=(await this.remoteStorageService.getUserLists()).find(o=>o.yjsDocumentId===e);a&&(t.ownerId=a.ownerId)}catch(n){this.logger.warnSync(`Failed to get ownership info for list ${e}:`,n)}return t}catch(t){throw this.logger.errorSync(`Failed to get list ${e}:`,t),t}}async applyRemoteUpdate(e,t,n){try{this.yjsListManager.applyYjsUpdate(e,t);const a=this.yjsListManager.getYjsState(e);a&&await this.listRepository.saveList({uuid:e,data:a}),this.eventService.publish({type:ye.LIST_METADATA_CHANGED,payload:{listId:e,metadata:{lastRemoteUpdate:new Date,source:"remote",action:"content_changed"},changedAt:new Date},timestamp:new Date,listId:e}),n&&await this.setLastSyncTimestamp(e,n),this.logger.infoSync(`Applied remote update to list ${e}`)}catch(a){throw this.logger.errorSync(`Failed to apply remote update to list ${e}:`,a),a}}async handleRemoteListCreation(e){try{if(this.logger.infoSync(`Handling remote list creation: ${e}`),await this.listRepository.getList(e)){this.logger.debugSync(`List ${e} already exists locally, skipping creation`);return}const a=(await this.remoteStorageService.getUserLists()).find(c=>c.yjsDocumentId===e);if(!a){this.logger.warnSync(`Remote list ${e} not found in user lists`);return}this.logger.infoSync(`Creating new list from remote: ${e}`);try{const c=await this.getClientId(),d=await this.getLastSyncTimestamp(e);this.logger.infoSync(`Pulling updates for new remote list ${e}${d?` since ${d.toISOString()}`:" (all updates)"}`);const h=await this.remoteStorageService.pullUpdates(e,d||void 0,c);if(h.length>0){this.logger.infoSync(`Applying ${h.length} updates for list ${e}`);for(const p of h)this.yjsListManager.applyYjsUpdate(e,p.data);this.logger.infoSync(`Applied ${h.length} updates for list ${e}`);const g=h[h.length-1]?.timestamp;g&&await this.setLastSyncTimestamp(e,g)}else this.logger.infoSync(`No updates found for list ${e}`),this.yjsListManager.createList(e,a.title||"Untitled List",void 0,a.ownerId)}catch(c){this.logger.warnSync(`Failed to pull updates for list ${e}:`,c)}const o=this.yjsListManager.getYjsState(e);o&&await this.listRepository.saveList({uuid:e,data:o}),this.logger.infoSync(`Emitting list_created events for remote list: ${e}`),this.eventService.publish({type:ye.LIST_CREATED,payload:{listId:e,title:a.title||"Untitled List",createdAt:new Date},timestamp:new Date,listId:e}),this.logger.infoSync(`Successfully handled remote list creation: ${e}`)}catch(t){this.logger.errorSync(`Failed to handle remote list creation ${e}:`,t)}}async handleRemoteListDeletion(e){try{this.logger.infoSync(`Handling remote deletion of list: ${e}`),this.yjsListManager.deleteList(e),await this.listRepository.deleteList(e),await this.syncQueueRepository.clearSyncQueueItemsForList(e),await this.clearSyncMetadataForDocument(e),this.eventService.publish({type:ye.LIST_DELETED,payload:{listId:e,title:"",deletedAt:new Date},timestamp:new Date,listId:e}),this.logger.infoSync(`Successfully handled remote deletion of list: ${e}`)}catch(t){throw this.logger.errorSync(`Failed to handle remote deletion of list ${e}:`,t),t}}async getSyncQueueItems(){try{return await this.syncQueueRepository.getAllSyncQueueItems()}catch(e){throw this.logger.errorSync("Failed to get sync queue items:",e),e}}async removeSyncQueueItem(e){try{await this.syncQueueRepository.deleteSyncQueueItem(e),this.logger.infoSync(`Removed sync queue item: ${e}`)}catch(t){throw this.logger.errorSync(`Failed to remove sync queue item ${e}:`,t),t}}async editListMetadata(e,t){try{t.title!==void 0&&this.yjsListManager.editListTitle(e,t.title),t.description!==void 0&&this.yjsListManager.editListDescription(e,t.description);const n=this.yjsListManager.getYjsState(e);n&&await this.listRepository.saveList({uuid:e,data:n}),await this.syncQueueRepository.addYjsUpdateItem(e,n),await this.triggerBackgroundSync(),this.eventService.publish({type:ye.LIST_METADATA_CHANGED,payload:{listId:e,metadata:{...t,action:"metadata_changed"},changedAt:new Date},timestamp:new Date,listId:e});const a=[];t.title!==void 0&&a.push(`title: ${t.title}`),t.description!==void 0&&a.push(`description: ${t.description}`),this.logger.infoSync(`Edited metadata of list ${e}: ${a.join(", ")}`)}catch(n){throw this.logger.errorSync(`Failed to edit metadata of list ${e}:`,n),n}}async clearCompletedItems(e){try{this.yjsListManager.clearCompletedItems(e);const t=this.yjsListManager.getYjsState(e);t&&await this.listRepository.saveList({uuid:e,data:t}),await this.syncQueueRepository.addYjsUpdateItem(e,t),await this.triggerBackgroundSync(),this.eventService.publish({type:ye.LIST_METADATA_CHANGED,payload:{listId:e,metadata:{action:"completed_items_cleared"},changedAt:new Date},timestamp:new Date,listId:e}),this.logger.infoSync(`Cleared completed items from list ${e}`)}catch(t){throw this.logger.errorSync(`Failed to clear completed items from list ${e}:`,t),t}}async leaveList(e){try{if(this.yjsListManager.deleteList(e),await this.listRepository.deleteList(e),await this.syncQueueRepository.clearSyncQueueItemsForList(e),await this.clearSyncMetadataForDocument(e),this.connectionMonitor.isOnline())try{await this.remoteStorageService.removeParticipant(e),this.logger.infoSync(`Real-time sync successful for leaving list ${e}`)}catch(t){this.logger.warnSync(`Real-time sync failed for leaving list ${e}, falling back to queue:`,t),await this.syncQueueRepository.addListLeaveItem(e),await this.triggerBackgroundSync()}else await this.syncQueueRepository.addListLeaveItem(e),await this.triggerBackgroundSync();this.eventService.publish({type:ye.LIST_LEFT,payload:{listId:e,title:"",leftAt:new Date},timestamp:new Date,listId:e}),this.logger.infoSync(`Left list: ${e}`)}catch(t){throw this.logger.errorSync(`Failed to leave list ${e}:`,t),t}}async clearAllData(){try{this.yjsListManager.clearAllState(),await this.listRepository.clearAllLists(),await this.syncQueueRepository.clearAllSyncQueueItems(),await this.metadataRepository.clearAllMetadata(),this.logger.infoSync("Cleared all data")}catch(e){throw this.logger.errorSync("Failed to clear all data:",e),e}}async getClientId(){if(this.cachedClientId)return this.cachedClientId;try{const e=await this.metadataRepository.getMetadata("client_id");if(e&&e.value.clientId)return this.cachedClientId=e.value.clientId,e.value.clientId;const t=Kn();return await this.setClientId(t),t}catch(e){this.logger.errorSync("Error getting client ID:",e);const t=Kn();return await this.setClientId(t),t}}async setClientId(e){this.cachedClientId=e;try{await this.metadataRepository.saveMetadata({key:"client_id",value:{clientId:e,createdAt:new Date().toISOString()}}),this.logger.debugSync("Set client ID:",{clientId:e})}catch(t){throw this.logger.errorSync("Error setting client ID:",t),t}}async saveSyncState(e){const t=`sync_state_${e.yjsDocumentId}`;await this.metadataRepository.saveMetadata({key:t,value:{lastSyncTime:e.lastSyncTime?.toISOString(),isOnline:e.isOnline,pendingChangesCount:e.pendingChangesCount,lastUpdated:new Date().toISOString()}}),this.logger.debugSync("Saved sync state:",{yjsDocumentId:e.yjsDocumentId,lastSyncTime:e.lastSyncTime,isOnline:e.isOnline,pendingChangesCount:e.pendingChangesCount})}async getSyncState(e){const t=`sync_state_${e}`,n=await this.metadataRepository.getMetadata(t);return n?{yjsDocumentId:e,lastSyncTime:n.value.lastSyncTime?new Date(n.value.lastSyncTime):void 0,isOnline:n.value.isOnline||!1,pendingChangesCount:n.value.pendingChangesCount||0}:null}async getAllSyncStates(){const e=await this.metadataRepository.getAllMetadata(),t=[];for(const n of e)if(n.key.startsWith("sync_state_")){const a=n.key.replace("sync_state_","");t.push({yjsDocumentId:a,lastSyncTime:n.value.lastSyncTime?new Date(n.value.lastSyncTime):void 0,isOnline:n.value.isOnline||!1,pendingChangesCount:n.value.pendingChangesCount||0})}return t}async saveAppliedRemoteUpdate(e,t){const n=`applied_remote_updates_${e}`,a=await this.metadataRepository.getMetadata(n),o=a?a.value.appliedUpdates||[]:[];o.push(t),await this.metadataRepository.saveMetadata({key:n,value:{appliedUpdates:o,lastUpdated:new Date().toISOString()}}),this.logger.debugSync("Saved applied remote update:",{yjsDocumentId:e,updateId:t})}async getAppliedRemoteUpdates(e){const t=`applied_remote_updates_${e}`,n=await this.metadataRepository.getMetadata(t);return n?n.value.appliedUpdates||[]:[]}async clearAppliedRemoteUpdates(e){const t=`applied_remote_updates_${e}`;await this.metadataRepository.deleteMetadata(t),this.logger.debugSync("Cleared applied remote updates:",{yjsDocumentId:e})}async clearSyncMetadataForDocument(e){try{await this.metadataRepository.deleteMetadata(`sync_state_${e}`),await this.metadataRepository.deleteMetadata(`applied_remote_updates_${e}`),await this.metadataRepository.deleteMetadata(`last_sync_${e}`),this.logger.debugSync("Cleared sync metadata for document:",{yjsDocumentId:e})}catch(t){throw this.logger.errorSync("Error clearing sync metadata for document:",t),t}}async getLastSyncTimestamp(e){try{const t=`last_sync_${e}`,n=await this.metadataRepository.getMetadata(t);return!n||!n.value.lastSyncTimestamp?null:new Date(n.value.lastSyncTimestamp)}catch(t){return this.logger.errorSync("Error getting last sync timestamp:",t),null}}async setLastSyncTimestamp(e,t){try{const n=`last_sync_${e}`;await this.metadataRepository.saveMetadata({key:n,value:{lastSyncTimestamp:t.toISOString(),lastUpdated:new Date().toISOString()}}),this.logger.debugSync(`Set last sync timestamp for ${e}:`,{timestamp:t.toISOString()})}catch(n){throw this.logger.errorSync("Error setting last sync timestamp:",n),n}}async triggerBackgroundSync(){try{const{ServiceContainer:e}=await Do(async()=>{const{ServiceContainer:a}=await Promise.resolve().then(()=>L2);return{ServiceContainer:a}},void 0),n=e.getInstance().getBackgroundSyncService();n.isServiceStarted()&&await n.triggerSync()}catch(e){this.logger.errorSync("Error triggering background sync:",e)}}}var St=(s=>(s[s.DEBUG=0]="DEBUG",s[s.INFO=1]="INFO",s[s.WARN=2]="WARN",s[s.ERROR=3]="ERROR",s[s.NONE=4]="NONE",s))(St||{});class pj{level;constructor(e=St.INFO){this.level=e}setLevel(e){this.level=e}getLevel(){return this.level}getCallerInfo(){const e=new Error().stack;if(!e)return"";const n=e.split(`
`)[3];if(!n)return"";const a=n.match(/at\s+(.+?)\s+\((.+?):(\d+):(\d+)\)/);if(a){const[,c,d,h,g]=a;return`[${d.split("/").pop()?.split("?")[0]||d}:${h}]`}const o=n.match(/at\s+(.+?):(\d+):(\d+)/);if(o){const[,c,d,h]=o;return`[${c.split("/").pop()?.split("?")[0]||c}:${d}]`}return""}debug(e,...t){if(this.level<=St.DEBUG){const n=this.getCallerInfo();console.log(` ${e} ${n}`,...t)}}info(e,...t){if(this.level<=St.INFO){const n=this.getCallerInfo();console.log(` ${e} ${n}`,...t)}}warn(e,...t){if(this.level<=St.WARN){const n=this.getCallerInfo();console.warn(` ${e} ${n}`,...t)}}error(e,...t){if(this.level<=St.ERROR){const n=this.getCallerInfo();console.error(` ${n} ${e}`,...t)}}debugSync(e,...t){if(this.level<=St.DEBUG){const n=this.getCallerInfo();console.log(` ${e} ${n}`,...t)}}infoSync(e,...t){if(this.level<=St.INFO){const n=this.getCallerInfo();console.log(` ${e} ${n}`,...t)}}warnSync(e,...t){if(this.level<=St.WARN){const n=this.getCallerInfo();console.warn(` ${e} ${n}`,...t)}}errorSync(e,...t){if(this.level<=St.ERROR){const n=this.getCallerInfo();console.error(` ${e} ${n}`,...t)}}}var q=typeof window<"u"?window:void 0,wn=typeof globalThis<"u"?globalThis:q,ix=Array.prototype,yw=ix.forEach,_w=ix.indexOf,In=wn?.navigator,ie=wn?.document,bn=wn?.location,Hp=wn?.fetch,Fp=wn!=null&&wn.XMLHttpRequest&&"withCredentials"in new wn.XMLHttpRequest?wn.XMLHttpRequest:void 0,bw=wn?.AbortController,_n=In?.userAgent,me=q??{},ns={DEBUG:!1,LIB_VERSION:"1.283.0"};function ww(s,e,t,n,a,o,c){try{var d=s[o](c),h=d.value}catch(g){return void t(g)}d.done?e(h):Promise.resolve(h).then(n,a)}function Sw(s){return function(){var e=this,t=arguments;return new Promise((function(n,a){var o=s.apply(e,t);function c(h){ww(o,n,a,c,d,"next",h)}function d(h){ww(o,n,a,c,d,"throw",h)}c(void 0)}))}}function oe(){return oe=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},oe.apply(null,arguments)}function sx(s,e){if(s==null)return{};var t={};for(var n in s)if({}.hasOwnProperty.call(s,n)){if(e.indexOf(n)!==-1)continue;t[n]=s[n]}return t}var vj=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],Ew=function(s,e){if(e===void 0&&(e=[]),!s)return!1;var t=s.toLowerCase();return vj.concat(e).some((n=>{var a=n.toLowerCase();return t.indexOf(a)!==-1}))},mj=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function Oe(s,e){return s.indexOf(e)!==-1}var sh=function(s){return s.trim()},Yp=function(s){return s.replace(/^\$/,"")},yj=Array.isArray,rx=Object.prototype,ax=rx.hasOwnProperty,rh=rx.toString,nt=yj||function(s){return rh.call(s)==="[object Array]"},Ks=s=>typeof s=="function",ln=s=>s===Object(s)&&!nt(s),eo=s=>{if(ln(s)){for(var e in s)if(ax.call(s,e))return!1;return!0}return!1},te=s=>s===void 0,Lt=s=>rh.call(s)=="[object String]",Vp=s=>Lt(s)&&s.trim().length===0,us=s=>s===null,tt=s=>te(s)||us(s),Ai=s=>rh.call(s)=="[object Number]",Js=s=>rh.call(s)==="[object Boolean]",_j=s=>s instanceof FormData,bj=s=>Oe(mj,s);function Gp(s){return s===null||typeof s!="object"}function Ad(s,e){return Object.prototype.toString.call(s)==="[object "+e+"]"}function ox(s){return!te(Event)&&(function(e,t){try{return e instanceof t}catch{return!1}})(s,Event)}var wj=[!0,"true",1,"1","yes"],Xg=s=>Oe(wj,s),Sj=[!1,"false",0,"0","no"];function Si(s,e,t,n,a){return e>t&&(n.warn("min cannot be greater than max."),e=t),Ai(s)?s>t?(n.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):s<e?(n.warn(" cannot be less than min: "+e+". Using min value instead."),e):s:(n.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+a),Si(a||t,e,t,n))}class Ej{constructor(e){this.t={},this.i=e.i,this.o=Si(e.bucketSize,0,100,e.h),this.m=Si(e.refillRate,0,this.o,e.h),this.S=Si(e.refillInterval,0,864e5,e.h)}$(e,t){var n=t-e.lastAccess,a=Math.floor(n/this.S);if(a>0){var o=a*this.m;e.tokens=Math.min(e.tokens+o,this.o),e.lastAccess=e.lastAccess+a*this.S}}consumeRateLimit(e){var t,n=Date.now(),a=String(e),o=this.t[a];return o?this.$(o,n):(o={tokens:this.o,lastAccess:n},this.t[a]=o),o.tokens===0||(o.tokens--,o.tokens===0&&((t=this.i)==null||t.call(this,e)),o.tokens===0)}stop(){this.t={}}}var Wu,xw,Kg,xj=s=>s instanceof Error;function Cj(s){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return Kg&&t.length===xw||(xw=t.length,Kg=t.reduce(((n,a)=>{Wu||(Wu={});var o=Wu[a];if(o)n[o[0]]=o[1];else for(var c=s(a),d=c.length-1;d>=0;d--){var h=c[d],g=h?.filename,p=e[a];if(g&&p){n[g]=p,Wu[a]=[g,p];break}}return n}),{})),Kg}}var _o="?";function Qp(s,e,t,n){var a={platform:"web:javascript",filename:s,function:e==="<anonymous>"?_o:e,in_app:!0};return te(t)||(a.lineno=t),te(n)||(a.colno=n),a}var lx=(s,e)=>{var t=s.indexOf("safari-extension")!==-1,n=s.indexOf("safari-web-extension")!==-1;return t||n?[s.indexOf("@")!==-1?s.split("@")[0]:_o,t?"safari-extension:"+e:"safari-web-extension:"+e]:[s,e]},Tj=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Dj=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,kj=/\((\S*)(?::(\d+))(?::(\d+))\)/,Aj=s=>{var e=Tj.exec(s);if(e){var[,t,n,a]=e;return Qp(t,_o,+n,+a)}var o=Dj.exec(s);if(o){if(o[2]&&o[2].indexOf("eval")===0){var c=kj.exec(o[2]);c&&(o[2]=c[1],o[3]=c[2],o[4]=c[3])}var[d,h]=lx(o[1]||_o,o[2]);return Qp(h,d,o[3]?+o[3]:void 0,o[4]?+o[4]:void 0)}},Rj=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Oj=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Lj=s=>{var e=Rj.exec(s);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){var t=Oj.exec(e[3]);t&&(e[1]=e[1]||"eval",e[3]=t[1],e[4]=t[2],e[5]="")}var n=e[3],a=e[1]||_o;return[a,n]=lx(a,n),Qp(n,a,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},Cw=/\(error: (.*)\)/,Tw=50;function jj(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return function(n,a){a===void 0&&(a=0);for(var o=[],c=n.split(`
`),d=a;d<c.length;d++){var h=c[d];if(!(h.length>1024)){var g=Cw.test(h)?h.replace(Cw,"$1"):h;if(!g.match(/\S*Error: /)){for(var p of e){var m=p(g);if(m){o.push(m);break}}if(o.length>=Tw)break}}}return(function(y){if(!y.length)return[];var _=Array.from(y);return _.reverse(),_.slice(0,Tw).map((E=>{return oe({},E,{filename:E.filename||(S=_,S[S.length-1]||{}).filename,function:E.function||_o});var S}))})(o)}}class Nj{constructor(e,t,n){e===void 0&&(e=[]),t===void 0&&(t=[]),n===void 0&&(n=[]),this.coercers=e,this.modifiers=n,this.stackParser=jj(...t)}buildFromUnknown(e,t){t===void 0&&(t={});var n=t&&t.mechanism||{handled:!0,type:"generic"},a=this.buildCoercingContext(n,t,0).apply(e),o=this.buildParsingContext(),c=this.parseStacktrace(a,o);return{$exception_list:this.convertToExceptionList(c,n),$exception_level:"error"}}modifyFrames(e){var t=this;return Sw((function*(){for(var n of e)n.stacktrace&&n.stacktrace.frames&&nt(n.stacktrace.frames)&&(n.stacktrace.frames=yield t.applyModifiers(n.stacktrace.frames));return e}))()}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var n,a;return e.cause!=null&&(n=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(a=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?1:0),t.chunkIdMap)),oe({},e,{cause:n,stack:a})}applyChunkIds(e,t){return e.map((n=>(n.filename&&t&&(n.chunk_id=t[n.filename]),n)))}applyCoercers(e,t){for(var n of this.coercers)if(n.match(e))return n.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return Sw((function*(){var n=e;for(var a of t.modifiers)n=yield a(n);return n}))()}convertToExceptionList(e,t){var n,a,o,c={type:e.type,value:e.value,mechanism:{type:(n=t.type)!==null&&n!==void 0?n:"generic",handled:(a=t.handled)===null||a===void 0||a,synthetic:(o=e.synthetic)!==null&&o!==void 0&&o}};e.stack&&(c.stacktrace={type:"raw",frames:e.stack});var d=[c];return e.cause!=null&&d.push(...this.convertToExceptionList(e.cause,oe({},t,{handled:!0}))),d}buildParsingContext(){return{chunkIdMap:Cj(this.stackParser)}}buildCoercingContext(e,t,n){n===void 0&&(n=0);var a=(o,c)=>{if(c<=4){var d=this.buildCoercingContext(e,t,c);return this.applyCoercers(o,d)}};return oe({},t,{syntheticException:n==0?t.syntheticException:void 0,mechanism:e,apply:o=>a(o,n),next:o=>a(o,n+1)})}}class Mj{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var n=Lt(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:n?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return Ad(e,"DOMException")}isDOMError(e){return Ad(e,"DOMError")}}class Uj{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var n=e.message;return n.error&&typeof n.error.message=="string"?String(n.error.message):String(n)}getStack(e){return e.stacktrace||e.stack||void 0}}class $j{constructor(){}match(e){return Ad(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var n,a=t.apply(e.error);return a||{type:"ErrorEvent",value:e.message,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}var Ij=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class Bj{match(e){return typeof e=="string"}coerce(e,t){var n,[a,o]=this.getInfos(e);return{type:a??"Error",value:o??e,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}getInfos(e){var t="Error",n=e,a=e.match(Ij);return a&&(t=a[1],n=a[2]),[t,n]}}var zj=["fatal","error","warning","log","info","debug"];function cx(s,e){e===void 0&&(e=40);var t=Object.keys(s);if(t.sort(),!t.length)return"[object has no keys]";for(var n=t.length;n>0;n--){var a=t.slice(0,n).join(", ");if(!(a.length>e))return n===t.length||a.length<=e?a:a.slice(0,e)+"..."}return""}class Pj{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var n,a=this.getErrorPropertyFromObject(e);return a?t.apply(a):{type:this.getType(e),value:this.getValue(e),stack:(n=t.syntheticException)==null?void 0:n.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return ox(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var n=this.getObjectClassName(e);return(n&&n!=="Object"?"'"+n+"'":"Object")+" captured as exception with keys: "+cx(e)}isSeverityLevel(e){return Lt(e)&&!Vp(e)&&zj.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if(xj(n))return n}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}}class qj{match(e){return ox(e)}coerce(e,t){var n,a=e.constructor.name;return{type:a,value:a+" captured as exception with keys: "+cx(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class Hj{match(e){return Gp(e)}coerce(e,t){var n;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class Fj{match(e){return Ad(e,"PromiseRejectionEvent")}coerce(e,t){var n,a=this.getUnhandledRejectionReason(e);return Gp(a)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(a),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}:t.apply(a)}getUnhandledRejectionReason(e){if(Gp(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}}var ux=s=>{var e={k:function(t){if(q&&(ns.DEBUG||me.POSTHOG_DEBUG)&&!te(q.console)&&q.console){for(var n=("__rrweb_original__"in q.console[t])?q.console[t].__rrweb_original__:q.console[t],a=arguments.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=arguments[c];n(s,...o)}},info:function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];e.k("log",...n)},warn:function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];e.k("warn",...n)},error:function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];e.k("error",...n)},critical:function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];console.error(s,...n)},uninitializedWarning:t=>{e.error("You must initialize PostHog before calling "+t)},createLogger:t=>ux(s+" "+t)};return e},ae=ux("[PostHog.js]"),Gt=ae.createLogger,Yj=Gt("[ExternalScriptsLoader]"),Dw=(s,e,t)=>{if(s.config.disable_external_dependency_loading)return Yj.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var n=ie?.querySelectorAll("script");if(n){for(var a,o=function(){if(n[c].src===e){var h=n[c];return h.__posthog_loading_callback_fired?{v:t()}:(h.addEventListener("load",(g=>{h.__posthog_loading_callback_fired=!0,t(void 0,g)})),h.onerror=g=>t(g),{v:void 0})}},c=0;c<n.length;c++)if(a=o())return a.v}var d=()=>{if(!ie)return t("document not found");var h=ie.createElement("script");if(h.type="text/javascript",h.crossOrigin="anonymous",h.src=e,h.onload=m=>{h.__posthog_loading_callback_fired=!0,t(void 0,m)},h.onerror=m=>t(m),s.config.prepare_external_dependency_script&&(h=s.config.prepare_external_dependency_script(h)),!h)return t("prepare_external_dependency_script returned null");var g,p=ie.querySelectorAll("body > script");p.length>0?(g=p[0].parentNode)==null||g.insertBefore(h,p[0]):ie.body.appendChild(h)};ie!=null&&ie.body?d():ie?.addEventListener("DOMContentLoaded",d)};me.__PosthogExtensions__=me.__PosthogExtensions__||{},me.__PosthogExtensions__.loadExternalDependency=(s,e,t)=>{var n="/static/"+e+".js?v="+s.version;if(e==="remote-config"&&(n="/array/"+s.config.token+"/config.js"),e==="toolbar"){var a=3e5;n=n+"&t="+Math.floor(Date.now()/a)*a}var o=s.requestRouter.endpointFor("assets",n);Dw(s,o,t)},me.__PosthogExtensions__.loadSiteApp=(s,e,t)=>{var n=s.requestRouter.endpointFor("api",e);Dw(s,n,t)};var Rd={};function Zs(s,e,t){if(nt(s)){if(yw&&s.forEach===yw)s.forEach(e,t);else if("length"in s&&s.length===+s.length){for(var n=0,a=s.length;n<a;n++)if(n in s&&e.call(t,s[n],n)===Rd)return}}}function We(s,e,t){if(!tt(s)){if(nt(s))return Zs(s,e,t);if(_j(s)){for(var n of s.entries())if(e.call(t,n[1],n[0])===Rd)return}else for(var a in s)if(ax.call(s,a)&&e.call(t,s[a],a)===Rd)return}}var mt=function(s){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Zs(t,(function(a){for(var o in a)a[o]!==void 0&&(s[o]=a[o])})),s},Ao=function(s){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Zs(t,(function(a){Zs(a,(function(o){s.push(o)}))})),s};function hd(s){for(var e=Object.keys(s),t=e.length,n=new Array(t);t--;)n[t]=[e[t],s[e[t]]];return n}var kw=function(s){try{return s()}catch{return}},Vj=function(s){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(this,t)}catch(a){ae.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),ae.critical(a)}}},Zv=function(s){var e={};return We(s,(function(t,n){(Lt(t)&&t.length>0||Ai(t))&&(e[n]=t)})),e};function Gj(s,e){return t=s,n=o=>Lt(o)&&!us(e)?o.slice(0,e):o,a=new Set,(function o(c,d){return c!==Object(c)?n?n(c,d):c:a.has(c)?void 0:(a.add(c),nt(c)?(h=[],Zs(c,(g=>{h.push(o(g))}))):(h={},We(c,((g,p)=>{a.has(g)||(h[p]=o(g,p))}))),h);var h})(t);var t,n,a}var Qj=["herokuapp.com","vercel.app","netlify.app"];function Xj(s){var e=s?.hostname;if(!Lt(e))return!1;var t=e.split(".").slice(-2).join(".");for(var n of Qj)if(t===n)return!1;return!0}function dx(s,e){for(var t=0;t<s.length;t++)if(e(s[t]))return s[t]}function Et(s,e,t,n){var{capture:a=!1,passive:o=!0}=n??{};s?.addEventListener(e,t,{capture:a,passive:o})}var hx="$people_distinct_id",zl="__alias",Pl="__timers",Aw="$autocapture_disabled_server_side",Xp="$heatmaps_enabled_server_side",Rw="$exception_capture_enabled_server_side",Kp="$error_tracking_suppression_rules",Ow="$error_tracking_capture_extension_exceptions",Lw="$web_vitals_enabled_server_side",fx="$dead_clicks_enabled_server_side",jw="$web_vitals_allowed_metrics",Jg="$session_recording_remote_config",Od="$sesid",gx="$session_is_sampled",to="$enabled_feature_flags",ql="$early_access_features",Jp="$feature_flag_details",Hl="$stored_person_properties",Or="$stored_group_properties",Zp="$surveys",ed="$surveys_activated",Ld="$flag_call_reported",is="$user_state",Wp="$client_session_props",ev="$capture_rate_limit",tv="$initial_campaign_params",nv="$initial_referrer_info",jd="$initial_person_info",Nd="$epp",px="__POSTHOG_TOOLBAR__",Rl="$posthog_cookieless",Kj=[hx,zl,"__cmpns",Pl,"$session_recording_enabled_server_side",Xp,Od,to,Kp,is,ql,Jp,Or,Hl,Zp,Ld,Wp,ev,tv,nv,Nd,jd];function Nw(s){return s instanceof Element&&(s.id===px||!(s.closest==null||!s.closest(".toolbar-global-fade-container")))}function ah(s){return!!s&&s.nodeType===1}function Ws(s,e){return!!s&&!!s.tagName&&s.tagName.toLowerCase()===e.toLowerCase()}function vx(s){return!!s&&s.nodeType===3}function mx(s){return!!s&&s.nodeType===11}function Wv(s){return s?sh(s).split(/\s+/):[]}function Mw(s){var e=q?.location.href;return!!(e&&s&&s.some((t=>e.match(t))))}function Md(s){var e="";switch(typeof s.className){case"string":e=s.className;break;case"object":e=(s.className&&"baseVal"in s.className?s.className.baseVal:null)||s.getAttribute("class")||"";break;default:e=""}return Wv(e)}function yx(s){return tt(s)?null:sh(s).split(/(\s+)/).filter((e=>gc(e))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function oh(s){var e="";return iv(s)&&!Ex(s)&&s.childNodes&&s.childNodes.length&&We(s.childNodes,(function(t){var n;vx(t)&&t.textContent&&(e+=(n=yx(t.textContent))!==null&&n!==void 0?n:"")})),sh(e)}function _x(s){return te(s.target)?s.srcElement||null:(e=s.target)!=null&&e.shadowRoot?s.composedPath()[0]||null:s.target||null;var e}var em=["a","button","form","input","select","textarea","label"];function bx(s,e){if(te(e))return!0;var t,n=function(o){if(e.some((c=>o.matches(c))))return{v:!0}};for(var a of s)if(t=n(a))return t.v;return!1}function wx(s){var e=s.parentNode;return!(!e||!ah(e))&&e}var Uw=[".ph-no-rageclick",".ph-no-capture"],tm=s=>!s||Ws(s,"html")||!ah(s),Sx=(s,e)=>{if(!q||tm(s))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,n=[s],a=s;a.parentNode&&!Ws(a,"body");)if(mx(a.parentNode))n.push(a.parentNode.host),a=a.parentNode.host;else{var o=wx(a);if(!o)break;if(e||em.indexOf(o.tagName.toLowerCase())>-1)t=!0;else{var c=q.getComputedStyle(o);c&&c.getPropertyValue("cursor")==="pointer"&&(t=!0)}n.push(o),a=o}return{parentIsUsefulElement:t,targetElementList:n}};function Jj(s,e,t,n,a){var o,c,d,h;if(t===void 0&&(t=void 0),!q||tm(s)||(o=t)!=null&&o.url_allowlist&&!Mw(t.url_allowlist)||(c=t)!=null&&c.url_ignorelist&&Mw(t.url_ignorelist))return!1;if((d=t)!=null&&d.dom_event_allowlist){var g=t.dom_event_allowlist;if(g&&!g.some((E=>e.type===E)))return!1}var{parentIsUsefulElement:p,targetElementList:m}=Sx(s,n);if(!(function(E,S){var T=S?.element_allowlist;if(te(T))return!0;var O,$=function(U){if(T.some((A=>U.tagName.toLowerCase()===A)))return{v:!0}};for(var L of E)if(O=$(L))return O.v;return!1})(m,t)||!bx(m,(h=t)==null?void 0:h.css_selector_allowlist))return!1;var y=q.getComputedStyle(s);if(y&&y.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var _=s.tagName.toLowerCase();switch(_){case"html":return!1;case"form":return(a||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(a||["change","click"]).indexOf(e.type)>=0;default:return p?(a||["click"]).indexOf(e.type)>=0:(a||["click"]).indexOf(e.type)>=0&&(em.indexOf(_)>-1||s.getAttribute("contenteditable")==="true")}}function iv(s){for(var e=s;e.parentNode&&!Ws(e,"body");e=e.parentNode){var t=Md(e);if(Oe(t,"ph-sensitive")||Oe(t,"ph-no-capture"))return!1}if(Oe(Md(s),"ph-include"))return!0;var n=s.type||"";if(Lt(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var a=s.name||s.id||"";return!(Lt(a)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(a.replace(/[^a-zA-Z0-9]/g,"")))}function Ex(s){return!!(Ws(s,"input")&&!["button","checkbox","submit","reset"].includes(s.type)||Ws(s,"select")||Ws(s,"textarea")||s.getAttribute("contenteditable")==="true")}var xx="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",Zj=new RegExp("^(?:"+xx+")$"),Wj=new RegExp(xx),Cx="\\d{3}-?\\d{2}-?\\d{4}",eN=new RegExp("^("+Cx+")$"),tN=new RegExp("("+Cx+")");function gc(s,e){return e===void 0&&(e=!0),!(tt(s)||Lt(s)&&(s=sh(s),(e?Zj:Wj).test((s||"").replace(/[- ]/g,""))||(e?eN:tN).test(s)))}function Tx(s){var e=oh(s);return gc(e=(e+" "+Dx(s)).trim())?e:""}function Dx(s){var e="";return s&&s.childNodes&&s.childNodes.length&&We(s.childNodes,(function(t){var n;if(t&&((n=t.tagName)==null?void 0:n.toLowerCase())==="span")try{var a=oh(t);e=(e+" "+a).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+Dx(t)).trim())}catch(o){ae.error("[AutoCapture]",o)}})),e}function nN(s){return(function(e){var t=e.map((n=>{var a,o,c="";if(n.tag_name&&(c+=n.tag_name),n.attr_class)for(var d of(n.attr_class.sort(),n.attr_class))c+="."+d.replace(/"/g,"");var h=oe({},n.text?{text:n.text}:{},{"nth-child":(a=n.nth_child)!==null&&a!==void 0?a:0,"nth-of-type":(o=n.nth_of_type)!==null&&o!==void 0?o:0},n.href?{href:n.href}:{},n.attr_id?{attr_id:n.attr_id}:{},n.attributes),g={};return hd(h).sort(((p,m)=>{var[y]=p,[_]=m;return y.localeCompare(_)})).forEach((p=>{var[m,y]=p;return g[$w(m.toString())]=$w(y.toString())})),c+=":",c+=hd(g).map((p=>{var[m,y]=p;return m+'="'+y+'"'})).join("")}));return t.join(";")})((function(e){return e.map((t=>{var n,a,o={text:(n=t.$el_text)==null?void 0:n.slice(0,400),tag_name:t.tag_name,href:(a=t.attr__href)==null?void 0:a.slice(0,2048),attr_class:iN(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return hd(t).filter((c=>{var[d]=c;return d.indexOf("attr__")===0})).forEach((c=>{var[d,h]=c;return o.attributes[d]=h})),o}))})(s))}function $w(s){return s.replace(/"|\\"/g,'\\"')}function iN(s){var e=s.attr__class;return e?nt(e)?e:Wv(e):void 0}class kx{constructor(){this.clicks=[]}isRageClick(e,t,n){var a=this.clicks[this.clicks.length-1];if(a&&Math.abs(e-a.x)+Math.abs(t-a.y)<30&&n-a.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:n}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}var Zg="$copy_autocapture",rs=(function(s){return s.GZipJS="gzip-js",s.Base64="base64",s})({}),Ud=s=>{var e=ie?.createElement("a");return te(e)?null:(e.href=s,e)},sN=function(s,e){var t,n;e===void 0&&(e="&");var a=[];return We(s,(function(o,c){te(o)||te(c)||c==="undefined"||(t=encodeURIComponent((d=>d instanceof File)(o)?o.name:o.toString()),n=encodeURIComponent(c),a[a.length]=n+"="+t)})),a.join(e)},$d=function(s,e){for(var t,n=((s.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),a=0;a<n.length;a++){var o=n[a].split("=");if(o[0]===e){t=o;break}}if(!nt(t)||t.length<2)return"";var c=t[1];try{c=decodeURIComponent(c)}catch{ae.error("Skipping decoding for malformed query param: "+c)}return c.replace(/\+/g," ")},Rc=function(s,e,t){if(!s||!e||!e.length)return s;for(var n=s.split("#"),a=n[0]||"",o=n[1],c=a.split("?"),d=c[1],h=c[0],g=(d||"").split("&"),p=[],m=0;m<g.length;m++){var y=g[m].split("=");nt(y)&&(e.includes(y[0])?p.push(y[0]+"="+t):p.push(g[m]))}var _=h;return d!=null&&(_+="?"+p.join("&")),o!=null&&(_+="#"+o),_},Id=function(s,e){var t=s.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},Iw=Gt("[AutoCapture]");function Wg(s,e){return e.length>s?e.slice(0,s)+"...":e}function rN(s){if(s.previousElementSibling)return s.previousElementSibling;var e=s;do e=e.previousSibling;while(e&&!ah(e));return e}function aN(s,e,t,n){var a=s.tagName.toLowerCase(),o={tag_name:a};em.indexOf(a)>-1&&!t&&(a.toLowerCase()==="a"||a.toLowerCase()==="button"?o.$el_text=Wg(1024,Tx(s)):o.$el_text=Wg(1024,oh(s)));var c=Md(s);c.length>0&&(o.classes=c.filter((function(p){return p!==""}))),We(s.attributes,(function(p){var m;if((!Ex(s)||["name","id","class","aria-label"].indexOf(p.name)!==-1)&&(n==null||!n.includes(p.name))&&!e&&gc(p.value)&&(m=p.name,!Lt(m)||m.substring(0,10)!=="_ngcontent"&&m.substring(0,7)!=="_nghost")){var y=p.value;p.name==="class"&&(y=Wv(y).join(" ")),o["attr__"+p.name]=Wg(1024,y)}}));for(var d=1,h=1,g=s;g=rN(g);)d++,g.tagName===s.tagName&&h++;return o.nth_child=d,o.nth_of_type=h,o}function oN(s,e){for(var t,n,{e:a,maskAllElementAttributes:o,maskAllText:c,elementAttributeIgnoreList:d,elementsChainAsString:h}=e,g=[s],p=s;p.parentNode&&!Ws(p,"body");)mx(p.parentNode)?(g.push(p.parentNode.host),p=p.parentNode.host):(g.push(p.parentNode),p=p.parentNode);var m,y=[],_={},E=!1,S=!1;if(We(g,(U=>{var A=iv(U);U.tagName.toLowerCase()==="a"&&(E=U.getAttribute("href"),E=A&&E&&gc(E)&&E),Oe(Md(U),"ph-no-capture")&&(S=!0),y.push(aN(U,o,c,d));var Y=(function(Z){if(!iv(Z))return{};var J={};return We(Z.attributes,(function(fe){if(fe.name&&fe.name.indexOf("data-ph-capture-attribute")===0){var ee=fe.name.replace("data-ph-capture-attribute-",""),ce=fe.value;ee&&ce&&gc(ce)&&(J[ee]=ce)}})),J})(U);mt(_,Y)})),S)return{props:{},explicitNoCapture:S};if(c||(s.tagName.toLowerCase()==="a"||s.tagName.toLowerCase()==="button"?y[0].$el_text=Tx(s):y[0].$el_text=oh(s)),E){var T,O;y[0].attr__href=E;var $=(T=Ud(E))==null?void 0:T.host,L=q==null||(O=q.location)==null?void 0:O.host;$&&L&&$!==L&&(m=E)}return{props:mt({$event_type:a.type,$ce_version:1},h?{}:{$elements:y},{$elements_chain:nN(y)},(t=y[0])!=null&&t.$el_text?{$el_text:(n=y[0])==null?void 0:n.$el_text}:{},m&&a.type==="click"?{$external_click_url:m}:{},_)}}class lN{constructor(e){this.P=!1,this.T=null,this.rageclicks=new kx,this.R=!1,this.instance=e,this.I=null}get C(){var e,t,n=ln(this.instance.config.autocapture)?this.instance.config.autocapture:{};return n.url_allowlist=(e=n.url_allowlist)==null?void 0:e.map((a=>new RegExp(a))),n.url_ignorelist=(t=n.url_ignorelist)==null?void 0:t.map((a=>new RegExp(a))),n}O(){if(this.isBrowserSupported()){if(q&&ie){var e=n=>{n=n||q?.event;try{this.F(n)}catch(a){Iw.error("Failed to capture event",a)}};if(Et(ie,"submit",e,{capture:!0}),Et(ie,"change",e,{capture:!0}),Et(ie,"click",e,{capture:!0}),this.C.capture_copied_text){var t=n=>{n=n||q?.event,this.F(n,Zg)};Et(ie,"copy",t,{capture:!0}),Et(ie,"cut",t,{capture:!0})}}}else Iw.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.P&&(this.O(),this.P=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.R=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[Aw]:!!e.autocapture_opt_out}),this.T=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.I=e}getElementSelectors(e){var t,n=[];return(t=this.I)==null||t.forEach((a=>{var o=ie?.querySelectorAll(a);o?.forEach((c=>{e===c&&n.push(a)}))})),n}get isEnabled(){var e,t,n=(e=this.instance.persistence)==null?void 0:e.props[Aw],a=this.T;if(us(a)&&!Js(n)&&!this.instance.M())return!1;var o=(t=this.T)!==null&&t!==void 0?t:!!n;return!!this.instance.config.autocapture&&!o}F(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var n,a=_x(e);vx(a)&&(a=a.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&(function(y,_){if(!q||tm(y))return!1;var E,S;if((E=Js(_)?!!_&&Uw:(S=_?.css_selector_ignorelist)!==null&&S!==void 0?S:Uw)===!1)return!1;var{targetElementList:T}=Sx(y,!1);return!bx(T,E)})(a,this.instance.config.rageclick)&&this.F(e,"$rageclick");var o=t===Zg;if(a&&Jj(a,e,this.C,o,o?["copy","cut"]:void 0)){var{props:c,explicitNoCapture:d}=oN(a,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.C.element_attribute_ignorelist,elementsChainAsString:this.R});if(d)return!1;var h=this.getElementSelectors(a);if(h&&h.length>0&&(c.$element_selectors=h),t===Zg){var g,p=yx(q==null||(g=q.getSelection())==null?void 0:g.toString()),m=e.type||"clipboard";if(!p)return!1;c.$selected_content=p,c.$copy_type=m}return this.instance.capture(t,c),!0}}}isBrowserSupported(){return Ks(ie?.querySelectorAll)}}Math.trunc||(Math.trunc=function(s){return s<0?Math.ceil(s):Math.floor(s)}),Number.isInteger||(Number.isInteger=function(s){return Ai(s)&&isFinite(s)&&Math.floor(s)===s});var Bw="0123456789abcdef";class Bd{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,n,a){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(a)||e<0||t<0||n<0||a<0||e>0xffffffffffff||t>4095||n>1073741823||a>4294967295)throw new RangeError("invalid field value");var o=new Uint8Array(16);return o[0]=e/Math.pow(2,40),o[1]=e/Math.pow(2,32),o[2]=e/Math.pow(2,24),o[3]=e/Math.pow(2,16),o[4]=e/Math.pow(2,8),o[5]=e,o[6]=112|t>>>8,o[7]=t,o[8]=128|n>>>24,o[9]=n>>>16,o[10]=n>>>8,o[11]=n,o[12]=a>>>24,o[13]=a>>>16,o[14]=a>>>8,o[15]=a,new Bd(o)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+Bw.charAt(this.bytes[t]>>>4)+Bw.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new Bd(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(n!==0)return Math.sign(n)}return 0}}class cN{constructor(){this.A=0,this.D=0,this.j=new uN}generate(){var e=this.generateOrAbort();if(te(e)){this.A=0;var t=this.generateOrAbort();if(te(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.A)this.A=e,this.L();else{if(!(e+1e4>this.A))return;this.D++,this.D>4398046511103&&(this.A++,this.L())}return Bd.fromFieldsV7(this.A,Math.trunc(this.D/Math.pow(2,30)),this.D&Math.pow(2,30)-1,this.j.nextUint32())}L(){this.D=1024*this.j.nextUint32()+(1023&this.j.nextUint32())}}var zw,Ax=s=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<s.length;e++)s[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return s};q&&!te(q.crypto)&&crypto.getRandomValues&&(Ax=s=>crypto.getRandomValues(s));class uN{constructor(){this.N=new Uint32Array(8),this.U=1/0}nextUint32(){return this.U>=this.N.length&&(Ax(this.N),this.U=0),this.N[this.U++]}}var Qs=()=>dN().toString(),dN=()=>(zw||(zw=new cN)).generate(),Ol="",hN=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function fN(s,e){if(e){var t=(function(a,o){if(o===void 0&&(o=ie),Ol)return Ol;if(!o||["localhost","127.0.0.1"].includes(a))return"";for(var c=a.split("."),d=Math.min(c.length,8),h="dmn_chk_"+Qs();!Ol&&d--;){var g=c.slice(d).join("."),p=h+"=1;domain=."+g+";path=/";o.cookie=p+";max-age=3",o.cookie.includes(h)&&(o.cookie=p+";max-age=0",Ol=g)}return Ol})(s);if(!t){var n=(a=>{var o=a.match(hN);return o?o[0]:""})(s);n!==t&&ae.info("Warning: cookie subdomain discovery mismatch",n,t),t=n}return t?"; domain=."+t:""}return""}var Ci={H:()=>!!ie,B:function(s){ae.error("cookieStore error: "+s)},q:function(s){if(ie){try{for(var e=s+"=",t=ie.cookie.split(";").filter((o=>o.length)),n=0;n<t.length;n++){for(var a=t[n];a.charAt(0)==" ";)a=a.substring(1,a.length);if(a.indexOf(e)===0)return decodeURIComponent(a.substring(e.length,a.length))}}catch{}return null}},W:function(s){var e;try{e=JSON.parse(Ci.q(s))||{}}catch{}return e},G:function(s,e,t,n,a){if(ie)try{var o="",c="",d=fN(ie.location.hostname,n);if(t){var h=new Date;h.setTime(h.getTime()+24*t*60*60*1e3),o="; expires="+h.toUTCString()}a&&(c="; secure");var g=s+"="+encodeURIComponent(JSON.stringify(e))+o+"; SameSite=Lax; path=/"+d+c;return g.length>3686.4&&ae.warn("cookieStore warning: large cookie, len="+g.length),ie.cookie=g,g}catch{return}},V:function(s,e){if(ie!=null&&ie.cookie)try{Ci.G(s,"",-1,e)}catch{return}}},ep=null,ot={H:function(){if(!us(ep))return ep;var s=!0;if(te(q))s=!1;else try{var e="__mplssupport__";ot.G(e,"xyz"),ot.q(e)!=='"xyz"'&&(s=!1),ot.V(e)}catch{s=!1}return s||ae.error("localStorage unsupported; falling back to cookie store"),ep=s,s},B:function(s){ae.error("localStorage error: "+s)},q:function(s){try{return q?.localStorage.getItem(s)}catch(e){ot.B(e)}return null},W:function(s){try{return JSON.parse(ot.q(s))||{}}catch{}return null},G:function(s,e){try{q?.localStorage.setItem(s,JSON.stringify(e))}catch(t){ot.B(t)}},V:function(s){try{q?.localStorage.removeItem(s)}catch(e){ot.B(e)}}},gN=["distinct_id",Od,gx,Nd,jd],td=oe({},ot,{W:function(s){try{var e={};try{e=Ci.W(s)||{}}catch{}var t=mt(e,JSON.parse(ot.q(s)||"{}"));return ot.G(s,t),t}catch{}return null},G:function(s,e,t,n,a,o){try{ot.G(s,e,void 0,void 0,o);var c={};gN.forEach((d=>{e[d]&&(c[d]=e[d])})),Object.keys(c).length&&Ci.G(s,c,t,n,a,o)}catch(d){ot.B(d)}},V:function(s,e){try{q?.localStorage.removeItem(s),Ci.V(s,e)}catch(t){ot.B(t)}}}),nd={},pN={H:function(){return!0},B:function(s){ae.error("memoryStorage error: "+s)},q:function(s){return nd[s]||null},W:function(s){return nd[s]||null},G:function(s,e){nd[s]=e},V:function(s){delete nd[s]}},Dr=null,en={H:function(){if(!us(Dr))return Dr;if(Dr=!0,te(q))Dr=!1;else try{var s="__support__";en.G(s,"xyz"),en.q(s)!=='"xyz"'&&(Dr=!1),en.V(s)}catch{Dr=!1}return Dr},B:function(s){ae.error("sessionStorage error: ",s)},q:function(s){try{return q?.sessionStorage.getItem(s)}catch(e){en.B(e)}return null},W:function(s){try{return JSON.parse(en.q(s))||null}catch{}return null},G:function(s,e){try{q?.sessionStorage.setItem(s,JSON.stringify(e))}catch(t){en.B(t)}},V:function(s){try{q?.sessionStorage.removeItem(s)}catch(e){en.B(e)}}},ss=(function(s){return s[s.PENDING=-1]="PENDING",s[s.DENIED=0]="DENIED",s[s.GRANTED=1]="GRANTED",s})({});class vN{constructor(e){this._instance=e}get C(){return this._instance.config}get consent(){return this.J()?ss.DENIED:this.K}isOptedOut(){return this.C.cookieless_mode==="always"||this.consent===ss.DENIED||this.consent===ss.PENDING&&(this.C.opt_out_capturing_by_default||this.C.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===ss.DENIED}optInOut(e){this.Y.G(this.X,e?1:0,this.C.cookie_expiration,this.C.cross_subdomain_cookie,this.C.secure_cookie)}reset(){this.Y.V(this.X,this.C.cross_subdomain_cookie)}get X(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:n}=this._instance.config;return n||(t?t+e:"__ph_opt_in_out_"+e)}get K(){var e=this.Y.q(this.X);return Xg(e)?ss.GRANTED:Oe(Sj,e)?ss.DENIED:ss.PENDING}get Y(){if(!this.Z){var e=this.C.opt_out_capturing_persistence_type;this.Z=e==="localStorage"?ot:Ci;var t=e==="localStorage"?Ci:ot;t.q(this.X)&&(this.Z.q(this.X)||this.optInOut(Xg(t.q(this.X))),t.V(this.X,this.C.cross_subdomain_cookie))}return this.Z}J(){return!!this.C.respect_dnt&&!!dx([In?.doNotTrack,In?.msDoNotTrack,me.doNotTrack],(e=>Xg(e)))}}var id=Gt("[Dead Clicks]"),mN=()=>!0,yN=s=>{var e,t=!((e=s.instance.persistence)==null||!e.get_property(fx)),n=s.instance.config.capture_dead_clicks;return Js(n)?n:t};class Rx{get lazyLoadedDeadClicksAutocapture(){return this.tt}constructor(e,t,n){this.instance=e,this.isEnabled=t,this.onCapture=n,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[fx]:e?.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.it((()=>{this.et()}))}it(e){var t,n;(t=me.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(n=me.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"dead-clicks-autocapture",(a=>{a?id.error("failed to load script",a):e()}))}et(){var e;if(ie){if(!this.tt&&(e=me.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=ln(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.tt=me.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.tt.start(ie),id.info("starting...")}}else id.error("`document` not found. Cannot start.")}stop(){this.tt&&(this.tt.stop(),this.tt=void 0,id.info("stopping..."))}}var Ll=Gt("[ExceptionAutocapture]");class _N{constructor(e){var t,n,a;this.rt=()=>{var o;if(q&&this.isEnabled&&(o=me.__PosthogExtensions__)!=null&&o.errorWrappingFunctions){var c=me.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,d=me.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,h=me.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.st&&this.C.capture_unhandled_errors&&(this.st=c(this.captureException.bind(this))),!this.nt&&this.C.capture_unhandled_rejections&&(this.nt=d(this.captureException.bind(this))),!this.ot&&this.C.capture_console_errors&&(this.ot=h(this.captureException.bind(this)))}catch(g){Ll.error("failed to start",g),this.lt()}}},this._instance=e,this.ut=!((t=this._instance.persistence)==null||!t.props[Rw]),this.C=this.ht(),this.dt=new Ej({refillRate:(n=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&n!==void 0?n:1,bucketSize:(a=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&a!==void 0?a:10,refillInterval:1e4,h:Ll}),this.startIfEnabled()}ht(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return ln(e)?t=oe({},t,e):(te(e)?this.ut:e)&&(t=oe({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.C.capture_console_errors||this.C.capture_unhandled_errors||this.C.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(Ll.info("enabled"),this.it(this.rt))}it(e){var t,n;(t=me.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(n=me.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"exception-autocapture",(a=>{if(a)return Ll.error("failed to load script",a);e()}))}lt(){var e,t,n;(e=this.st)==null||e.call(this),this.st=void 0,(t=this.nt)==null||t.call(this),this.nt=void 0,(n=this.ot)==null||n.call(this),this.ot=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ut=!!t||!1,this.C=this.ht(),this._instance.persistence&&this._instance.persistence.register({[Rw]:this.ut}),this.startIfEnabled()}captureException(e){var t,n,a=(t=e==null||(n=e.$exception_list)==null||(n=n[0])==null?void 0:n.type)!==null&&t!==void 0?t:"Exception";this.dt.consumeRateLimit(a)?Ll.info("Skipping exception capture because of client rate limiting.",{exception:a}):this._instance.exceptions.sendExceptionEvent(e)}}function Pw(s,e,t){try{if(!(e in s))return()=>{};var n=s[e],a=t(n);return Ks(a)&&(a.prototype=a.prototype||{},Object.defineProperties(a,{__posthog_wrapped__:{enumerable:!1,value:!0}})),s[e]=a,()=>{s[e]=n}}catch{return()=>{}}}class bN{constructor(e){var t;this._instance=e,this.vt=(q==null||(t=q.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(ae.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.ct&&this.ct(),this.ct=void 0,ae.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(q&&q.history){var n=this;(e=q.history.pushState)!=null&&e.__posthog_wrapped__||Pw(q.history,"pushState",(a=>function(o,c,d){a.call(this,o,c,d),n.ft("pushState")})),(t=q.history.replaceState)!=null&&t.__posthog_wrapped__||Pw(q.history,"replaceState",(a=>function(o,c,d){a.call(this,o,c,d),n.ft("replaceState")})),this.gt()}}ft(e){try{var t,n=q==null||(t=q.location)==null?void 0:t.pathname;if(!n)return;n!==this.vt&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.vt=n}catch(a){ae.error("Error capturing "+e+" pageview",a)}}gt(){if(!this.ct){var e=()=>{this.ft("popstate")};Et(q,"popstate",e),this.ct=()=>{q&&q.removeEventListener("popstate",e)}}}}var tp=Gt("[SegmentIntegration]");function wN(s,e){var t=s.config.segment;if(!t)return e();(function(n,a){var o=n.config.segment;if(!o)return a();var c=h=>{var g=()=>h.anonymousId()||Qs();n.config.get_device_id=g,h.id()&&(n.register({distinct_id:h.id(),$device_id:g()}),n.persistence.set_property(is,"identified")),a()},d=o.user();"then"in d&&Ks(d.then)?d.then((h=>c(h))):c(d)})(s,(()=>{t.register((n=>{Promise&&Promise.resolve||tp.warn("This browser does not have Promise support, and can not use the segment integration");var a=(o,c)=>{if(!c)return o;o.event.userId||o.event.anonymousId===n.get_distinct_id()||(tp.info("No userId set, resetting PostHog"),n.reset()),o.event.userId&&o.event.userId!==n.get_distinct_id()&&(tp.info("UserId set, identifying with PostHog"),n.identify(o.event.userId));var d=n.calculateEventProperties(c,o.event.properties);return o.event.properties=Object.assign({},d,o.event.properties),o};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:o=>a(o,o.event.event),page:o=>a(o,"$pageview"),identify:o=>a(o,"$identify"),screen:o=>a(o,"$screen")}})(s)).then((()=>{e()}))}))}var Ox="posthog-js";function Lx(s,e){var{organization:t,projectId:n,prefix:a,severityAllowList:o=["error"],sendExceptionsToPostHog:c=!0}=e===void 0?{}:e;return d=>{var h,g,p,m,y;if(!(o==="*"||o.includes(d.level))||!s.__loaded)return d;d.tags||(d.tags={});var _=s.requestRouter.endpointFor("ui","/project/"+s.config.token+"/person/"+s.get_distinct_id());d.tags["PostHog Person URL"]=_,s.sessionRecordingStarted()&&(d.tags["PostHog Recording URL"]=s.get_session_replay_url({withTimestamp:!0}));var E=((h=d.exception)==null?void 0:h.values)||[],S=E.map((O=>oe({},O,{stacktrace:O.stacktrace?oe({},O.stacktrace,{type:"raw",frames:(O.stacktrace.frames||[]).map(($=>oe({},$,{platform:"web:javascript"})))}):void 0}))),T={$exception_message:((g=E[0])==null?void 0:g.value)||d.message,$exception_type:(p=E[0])==null?void 0:p.type,$exception_level:d.level,$exception_list:S,$sentry_event_id:d.event_id,$sentry_exception:d.exception,$sentry_exception_message:((m=E[0])==null?void 0:m.value)||d.message,$sentry_exception_type:(y=E[0])==null?void 0:y.type,$sentry_tags:d.tags};return t&&n&&(T.$sentry_url=(a||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+d.event_id),c&&s.exceptions.sendExceptionEvent(T),d}}class SN{constructor(e,t,n,a,o,c){this.name=Ox,this.setupOnce=function(d){d(Lx(e,{organization:t,projectId:n,prefix:a,severityAllowList:o,sendExceptionsToPostHog:c==null||c}))}}}var EN=q!=null&&q.location?Id(q.location.hash,"__posthog")||Id(location.hash,"state"):null,qw="_postHogToolbarParams",Hw=Gt("[Toolbar]"),qs=(function(s){return s[s.UNINITIALIZED=0]="UNINITIALIZED",s[s.LOADING=1]="LOADING",s[s.LOADED=2]="LOADED",s})(qs||{});class xN{constructor(e){this.instance=e}_t(e){me.ph_toolbar_state=e}yt(){var e;return(e=me.ph_toolbar_state)!==null&&e!==void 0?e:qs.UNINITIALIZED}maybeLoadToolbar(e,t,n){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),!q||!ie)return!1;e=e??q.location,n=n??q.history;try{if(!t){try{q.localStorage.setItem("test","test"),q.localStorage.removeItem("test")}catch{return!1}t=q?.localStorage}var a,o=EN||Id(e.hash,"__posthog")||Id(e.hash,"state"),c=o?kw((()=>JSON.parse(atob(decodeURIComponent(o)))))||kw((()=>JSON.parse(decodeURIComponent(o)))):null;return c&&c.action==="ph_authorize"?((a=c).source="url",a&&Object.keys(a).length>0&&(c.desiredHash?e.hash=c.desiredHash:n?n.replaceState(n.state,"",e.pathname+e.search):e.hash="")):((a=JSON.parse(t.getItem(qw)||"{}")).source="localstorage",delete a.userIntent),!(!a.token||this.instance.config.token!==a.token)&&(this.loadToolbar(a),!0)}catch{return!1}}bt(e){var t=me.ph_load_toolbar||me.ph_load_editor;!tt(t)&&Ks(t)?t(e,this.instance):Hw.warn("No toolbar load function found")}loadToolbar(e){var t=!(ie==null||!ie.getElementById(px));if(!q||t)return!1;var n=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,a=oe({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(q.localStorage.setItem(qw,JSON.stringify(oe({},a,{source:void 0}))),this.yt()===qs.LOADED)this.bt(a);else if(this.yt()===qs.UNINITIALIZED){var o;this._t(qs.LOADING),(o=me.__PosthogExtensions__)==null||o.loadExternalDependency==null||o.loadExternalDependency(this.instance,"toolbar",(c=>{if(c)return Hw.error("[Toolbar] Failed to load",c),void this._t(qs.UNINITIALIZED);this._t(qs.LOADED),this.bt(a)})),Et(q,"turbolinks:load",(()=>{this._t(qs.UNINITIALIZED),this.loadToolbar(a)}))}return!0}wt(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,n){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),this.maybeLoadToolbar(e,t,n)}}var CN=Gt("[TracingHeaders]");class TN{constructor(e){this.xt=void 0,this.St=void 0,this.rt=()=>{var t,n;te(this.xt)&&((t=me.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),te(this.St)&&((n=me.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}it(e){var t,n;(t=me.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(n=me.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"tracing-headers",(a=>{if(a)return CN.error("failed to load script",a);e()}))}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.it(this.rt):((e=this.xt)==null||e.call(this),(t=this.St)==null||t.call(this),this.xt=void 0,this.St=void 0)}}var ei="Mobile",zd="iOS",Ei="Android",pc="Tablet",jx=Ei+" "+pc,Nx="iPad",Mx="Apple",Ux=Mx+" Watch",vc="Safari",bo="BlackBerry",$x="Samsung",Ix=$x+"Browser",Bx=$x+" Internet",qr="Chrome",DN=qr+" OS",zx=qr+" "+zd,nm="Internet Explorer",Px=nm+" "+ei,im="Opera",kN=im+" Mini",sm="Edge",qx="Microsoft "+sm,lo="Firefox",Hx=lo+" "+zd,mc="Nintendo",yc="PlayStation",co="Xbox",Fx=Ei+" "+ei,Yx=ei+" "+vc,Fl="Windows",sv=Fl+" Phone",Fw="Nokia",rv="Ouya",Vx="Generic",AN=Vx+" "+ei.toLowerCase(),Gx=Vx+" "+pc.toLowerCase(),av="Konqueror",hn="(\\d+(\\.\\d+)?)",np=new RegExp("Version/"+hn),RN=new RegExp(co,"i"),ON=new RegExp(yc+" \\w+","i"),LN=new RegExp(mc+" \\w+","i"),rm=new RegExp(bo+"|PlayBook|BB10","i"),jN={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},NN=(s,e)=>e&&Oe(e,Mx)||(function(t){return Oe(t,vc)&&!Oe(t,qr)&&!Oe(t,Ei)})(s),Qx=function(s,e){return e=e||"",Oe(s," OPR/")&&Oe(s,"Mini")?kN:Oe(s," OPR/")?im:rm.test(s)?bo:Oe(s,"IE"+ei)||Oe(s,"WPDesktop")?Px:Oe(s,Ix)?Bx:Oe(s,sm)||Oe(s,"Edg/")?qx:Oe(s,"FBIOS")?"Facebook "+ei:Oe(s,"UCWEB")||Oe(s,"UCBrowser")?"UC Browser":Oe(s,"CriOS")?zx:Oe(s,"CrMo")||Oe(s,qr)?qr:Oe(s,Ei)&&Oe(s,vc)?Fx:Oe(s,"FxiOS")?Hx:Oe(s.toLowerCase(),av.toLowerCase())?av:NN(s,e)?Oe(s,ei)?Yx:vc:Oe(s,lo)?lo:Oe(s,"MSIE")||Oe(s,"Trident/")?nm:Oe(s,"Gecko")?lo:""},MN={[Px]:[new RegExp("rv:"+hn)],[qx]:[new RegExp(sm+"?\\/"+hn)],[qr]:[new RegExp("("+qr+"|CrMo)\\/"+hn)],[zx]:[new RegExp("CriOS\\/"+hn)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+hn)],[vc]:[np],[Yx]:[np],[im]:[new RegExp("(Opera|OPR)\\/"+hn)],[lo]:[new RegExp(lo+"\\/"+hn)],[Hx]:[new RegExp("FxiOS\\/"+hn)],[av]:[new RegExp("Konqueror[:/]?"+hn,"i")],[bo]:[new RegExp(bo+" "+hn),np],[Fx]:[new RegExp("android\\s"+hn,"i")],[Bx]:[new RegExp(Ix+"\\/"+hn)],[nm]:[new RegExp("(rv:|MSIE )"+hn)],Mozilla:[new RegExp("rv:"+hn)]},UN=function(s,e){var t=Qx(s,e),n=MN[t];if(te(n))return null;for(var a=0;a<n.length;a++){var o=n[a],c=s.match(o);if(c)return parseFloat(c[c.length-2])}return null},Yw=[[new RegExp(co+"; "+co+" (.*?)[);]","i"),s=>[co,s&&s[1]||""]],[new RegExp(mc,"i"),[mc,""]],[new RegExp(yc,"i"),[yc,""]],[rm,[bo,""]],[new RegExp(Fl,"i"),(s,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[sv,""];if(new RegExp(ei).test(e)&&!/IEMobile\b/.test(e))return[Fl+" "+ei,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var n=t[1],a=jN[n]||"";return/arm/i.test(e)&&(a="RT"),[Fl,a]}return[Fl,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,s=>{if(s&&s[3]){var e=[s[3],s[4],s[5]||"0"];return[zd,e.join(".")]}return[zd,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,s=>{var e="";return s&&s.length>=3&&(e=te(s[2])?s[3]:s[2]),["watchOS",e]}],[new RegExp("("+Ei+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Ei+")","i"),s=>{if(s&&s[2]){var e=[s[2],s[3],s[4]||"0"];return[Ei,e.join(".")]}return[Ei,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,s=>{var e=["Mac OS X",""];if(s&&s[1]){var t=[s[1],s[2],s[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[DN,""]],[/Linux|debian/i,["Linux",""]]],Vw=function(s){return LN.test(s)?mc:ON.test(s)?yc:RN.test(s)?co:new RegExp(rv,"i").test(s)?rv:new RegExp("("+sv+"|WPDesktop)","i").test(s)?sv:/iPad/.test(s)?Nx:/iPod/.test(s)?"iPod Touch":/iPhone/.test(s)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(s)?Ux:rm.test(s)?bo:/(kobo)\s(ereader|touch)/i.test(s)?"Kobo":new RegExp(Fw,"i").test(s)?Fw:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(s)||/(kf[a-z]+)( bui|\)).+silk\//i.test(s)?"Kindle Fire":/(Android|ZTE)/i.test(s)?!new RegExp(ei).test(s)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(s)?/pixel[\daxl ]{1,6}/i.test(s)&&!/pixel c/i.test(s)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(s)||/lmy47v/i.test(s)&&!/QTAQZ3/i.test(s)?Ei:jx:Ei:new RegExp("(pda|"+ei+")","i").test(s)?AN:new RegExp(pc,"i").test(s)&&!new RegExp(pc+" pc","i").test(s)?Gx:""},sd="https?://(.*)",Ro=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],$N=Ao(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],Ro),Oc="<masked>",IN=["li_fat_id"];function Xx(s,e,t){if(!ie)return{};var n,a=e?Ao([],Ro,t||[]):[],o=Kx(Rc(ie.URL,a,Oc),s),c=(n={},We(IN,(function(d){var h=Ci.q(d);n[d]=h||null})),n);return mt(c,o)}function Kx(s,e){var t=$N.concat(e||[]),n={};return We(t,(function(a){var o=$d(s,a);n[a]=o||null})),n}function Jx(s){var e=(function(o){return o?o.search(sd+"google.([^/?]*)")===0?"google":o.search(sd+"bing.com")===0?"bing":o.search(sd+"yahoo.com")===0?"yahoo":o.search(sd+"duckduckgo.com")===0?"duckduckgo":null:null})(s),t=e!="yahoo"?"q":"p",n={};if(!us(e)){n.$search_engine=e;var a=ie?$d(ie.referrer,t):"";a.length&&(n.ph_keyword=a)}return n}function Gw(){return navigator.language||navigator.userLanguage}function Zx(){return ie?.referrer||"$direct"}function Wx(s,e){var t=s?Ao([],Ro,e||[]):[],n=bn?.href.substring(0,1e3);return{r:Zx().substring(0,1e3),u:n?Rc(n,t,Oc):void 0}}function e1(s){var e,{r:t,u:n}=s,a={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=Ud(t))==null?void 0:e.host};if(n){a.$current_url=n;var o=Ud(n);a.$host=o?.host,a.$pathname=o?.pathname;var c=Kx(n);mt(a,c)}if(t){var d=Jx(t);mt(a,d)}return a}function t1(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function BN(){try{return new Date().getTimezoneOffset()}catch{return}}function zN(s,e){if(!_n)return{};var t,n,a,o=s?Ao([],Ro,e||[]):[],[c,d]=(function(h){for(var g=0;g<Yw.length;g++){var[p,m]=Yw[g],y=p.exec(h),_=y&&(Ks(m)?m(y,h):m);if(_)return _}return["",""]})(_n);return mt(Zv({$os:c,$os_version:d,$browser:Qx(_n,navigator.vendor),$device:Vw(_n),$device_type:(n=_n,a=Vw(n),a===Nx||a===jx||a==="Kobo"||a==="Kindle Fire"||a===Gx?pc:a===mc||a===co||a===yc||a===rv?"Console":a===Ux?"Wearable":a?ei:"Desktop"),$timezone:t1(),$timezone_offset:BN()}),{$current_url:Rc(bn?.href,o,Oc),$host:bn?.host,$pathname:bn?.pathname,$raw_user_agent:_n.length>1e3?_n.substring(0,997)+"...":_n,$browser_version:UN(_n,navigator.vendor),$browser_language:Gw(),$browser_language_prefix:(t=Gw(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:q?.screen.height,$screen_width:q?.screen.width,$viewport_height:q?.innerHeight,$viewport_width:q?.innerWidth,$lib:"web",$lib_version:ns.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Bs=Gt("[Web Vitals]"),Qw=9e5;class PN{constructor(e){var t;this.Et=!1,this.P=!1,this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.$t=()=>{clearTimeout(this.kt),this.N.metrics.length!==0&&(this._instance.capture("$web_vitals",this.N.metrics.reduce(((n,a)=>oe({},n,{["$web_vitals_"+a.name+"_event"]:oe({},a),["$web_vitals_"+a.name+"_value"]:a.value})),{})),this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.Pt=n=>{var a,o=(a=this._instance.sessionManager)==null?void 0:a.checkAndGetSessionAndWindowId(!0);if(te(o))Bs.error("Could not read session ID. Dropping metrics!");else{this.N=this.N||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var c=this.Tt();te(c)||(tt(n?.name)||tt(n?.value)?Bs.error("Invalid metric received",n):this.Rt&&n.value>=this.Rt?Bs.error("Ignoring metric with value >= "+this.Rt,n):(this.N.url!==c&&(this.$t(),this.kt=setTimeout(this.$t,this.flushToCaptureTimeoutMs)),te(this.N.url)&&(this.N.url=c),this.N.firstMetricTimestamp=te(this.N.firstMetricTimestamp)?Date.now():this.N.firstMetricTimestamp,n.attribution&&n.attribution.interactionTargetElement&&(n.attribution.interactionTargetElement=void 0),this.N.metrics.push(oe({},n,{$current_url:c,$session_id:o.sessionId,$window_id:o.windowId,timestamp:Date.now()})),this.N.metrics.length===this.allowedMetrics.length&&this.$t()))}},this.rt=()=>{var n,a,o,c,d=me.__PosthogExtensions__;te(d)||te(d.postHogWebVitalsCallbacks)||({onLCP:n,onCLS:a,onFCP:o,onINP:c}=d.postHogWebVitalsCallbacks),n&&a&&o&&c?(this.allowedMetrics.indexOf("LCP")>-1&&n(this.Pt.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&a(this.Pt.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&o(this.Pt.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&c(this.Pt.bind(this)),this.P=!0):Bs.error("web vitals callbacks not loaded - not starting")},this._instance=e,this.Et=!((t=this._instance.persistence)==null||!t.props[Lw]),this.startIfEnabled()}get allowedMetrics(){var e,t,n=ln(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return te(n)?((t=this._instance.persistence)==null?void 0:t.props[jw])||["CLS","FCP","INP","LCP"]:n}get flushToCaptureTimeoutMs(){return(ln(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get Rt(){var e=ln(this._instance.config.capture_performance)&&Ai(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:Qw;return 0<e&&e<=6e4?Qw:e}get isEnabled(){var e=bn?.protocol;if(e!=="http:"&&e!=="https:")return Bs.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=ln(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Js(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Js(t)?t:this.Et}startIfEnabled(){this.isEnabled&&!this.P&&(Bs.info("enabled, starting..."),this.it(this.rt))}onRemoteConfig(e){var t=ln(e.capturePerformance)&&!!e.capturePerformance.web_vitals,n=ln(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[Lw]:t}),this._instance.persistence.register({[jw]:n})),this.Et=t,this.startIfEnabled()}it(e){var t,n;(t=me.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks&&e(),(n=me.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"web-vitals",(a=>{a?Bs.error("failed to load script",a):e()}))}Tt(){var e=q?q.location.href:void 0;if(e){var t=this._instance.config.mask_personal_data_properties,n=this._instance.config.custom_personal_data_properties,a=t?Ao([],Ro,n||[]):[];return Rc(e,a,Oc)}Bs.error("Could not determine current URL")}}var qN=Gt("[Heatmaps]");function Xw(s){return ln(s)&&"clientX"in s&&"clientY"in s&&Ai(s.clientX)&&Ai(s.clientY)}class HN{constructor(e){var t;this.rageclicks=new kx,this.Et=!1,this.P=!1,this.It=null,this.instance=e,this.Et=!((t=this.instance.persistence)==null||!t.props[Xp])}get flushIntervalMilliseconds(){var e=5e3;return ln(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return te(this.instance.config.capture_heatmaps)?te(this.instance.config.enable_heatmaps)?this.Et:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.P)return;qN.info("starting..."),this.Ct(),this.Ot()}else{var e;clearInterval((e=this.It)!==null&&e!==void 0?e:void 0),this.Ft(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Xp]:t}),this.Et=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.N;return this.N=void 0,e}Mt(e){this.At(e.originalEvent,"deadclick")}Ot(){this.It&&clearInterval(this.It),this.It=(function(e){return e?.visibilityState==="visible"})(ie)?setInterval(this.Dt.bind(this),this.flushIntervalMilliseconds):null}Ct(){q&&ie&&(this.jt=this.Dt.bind(this),Et(q,"beforeunload",this.jt),this.Lt=e=>this.At(e||q?.event),Et(ie,"click",this.Lt,{capture:!0}),this.Nt=e=>this.Ut(e||q?.event),Et(ie,"mousemove",this.Nt,{capture:!0}),this.zt=new Rx(this.instance,mN,this.Mt.bind(this)),this.zt.startIfEnabled(),this.Ht=this.Ot.bind(this),Et(ie,"visibilitychange",this.Ht),this.P=!0)}Ft(){var e;q&&ie&&(this.jt&&q.removeEventListener("beforeunload",this.jt),this.Lt&&ie.removeEventListener("click",this.Lt,{capture:!0}),this.Nt&&ie.removeEventListener("mousemove",this.Nt,{capture:!0}),this.Ht&&ie.removeEventListener("visibilitychange",this.Ht),clearTimeout(this.Bt),(e=this.zt)==null||e.stop(),this.P=!1)}qt(e,t){var n=this.instance.scrollManager.scrollY(),a=this.instance.scrollManager.scrollX(),o=this.instance.scrollManager.scrollElement(),c=(function(d,h,g){for(var p=d;p&&ah(p)&&!Ws(p,"body");){if(p===g)return!1;if(Oe(h,q?.getComputedStyle(p).position))return!0;p=wx(p)}return!1})(_x(e),["fixed","sticky"],o);return{x:e.clientX+(c?0:a),y:e.clientY+(c?0:n),target_fixed:c,type:t}}At(e,t){var n;if(t===void 0&&(t="click"),!Nw(e.target)&&Xw(e)){var a=this.qt(e,t);(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.Wt(oe({},a,{type:"rageclick"})),this.Wt(a)}}Ut(e){!Nw(e.target)&&Xw(e)&&(clearTimeout(this.Bt),this.Bt=setTimeout((()=>{this.Wt(this.qt(e,"mousemove"))}),500))}Wt(e){if(q){var t=q.location.href,n=this.instance.config.mask_personal_data_properties,a=this.instance.config.custom_personal_data_properties,o=n?Ao([],Ro,a||[]):[],c=Rc(t,o,Oc);this.N=this.N||{},this.N[c]||(this.N[c]=[]),this.N[c].push(e)}}Dt(){this.N&&!eo(this.N)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class FN{constructor(e){this._instance=e}doPageView(e,t){var n,a=this.Gt(e,t);return this.Vt={pathname:(n=q?.location.pathname)!==null&&n!==void 0?n:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),a}doPageLeave(e){var t;return this.Gt(e,(t=this.Vt)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.Vt)==null?void 0:e.pageViewId}}Gt(e,t){var n=this.Vt;if(!n)return{$pageview_id:t};var a={$pageview_id:t,$prev_pageview_id:n.pageViewId},o=this._instance.scrollManager.getContext();if(o&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:c,lastScrollY:d,maxScrollY:h,maxContentHeight:g,lastContentY:p,maxContentY:m}=o;if(!(te(c)||te(d)||te(h)||te(g)||te(p)||te(m))){c=Math.ceil(c),d=Math.ceil(d),h=Math.ceil(h),g=Math.ceil(g),p=Math.ceil(p),m=Math.ceil(m);var y=c<=1?1:Si(d/c,0,1,ae),_=c<=1?1:Si(h/c,0,1,ae),E=g<=1?1:Si(p/g,0,1,ae),S=g<=1?1:Si(m/g,0,1,ae);a=mt(a,{$prev_pageview_last_scroll:d,$prev_pageview_last_scroll_percentage:y,$prev_pageview_max_scroll:h,$prev_pageview_max_scroll_percentage:_,$prev_pageview_last_content:p,$prev_pageview_last_content_percentage:E,$prev_pageview_max_content:m,$prev_pageview_max_content_percentage:S})}}return n.pathname&&(a.$prev_pageview_pathname=n.pathname),n.timestamp&&(a.$prev_pageview_duration=(e.getTime()-n.timestamp.getTime())/1e3),a}}var ti=Uint8Array,Sn=Uint16Array,wo=Uint32Array,am=new ti([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),om=new ti([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Kw=new ti([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),n1=function(s,e){for(var t=new Sn(31),n=0;n<31;++n)t[n]=e+=1<<s[n-1];var a=new wo(t[30]);for(n=1;n<30;++n)for(var o=t[n];o<t[n+1];++o)a[o]=o-t[n]<<5|n;return[t,a]},i1=n1(am,2),YN=i1[0],ov=i1[1];YN[28]=258,ov[258]=28;for(var Jw=n1(om,0)[1],s1=new Sn(32768),it=0;it<32768;++it){var kr=(43690&it)>>>1|(21845&it)<<1;kr=(61680&(kr=(52428&kr)>>>2|(13107&kr)<<2))>>>4|(3855&kr)<<4,s1[it]=((65280&kr)>>>8|(255&kr)<<8)>>>1}var Zl=function(s,e,t){for(var n=s.length,a=0,o=new Sn(e);a<n;++a)++o[s[a]-1];var c,d=new Sn(e);for(a=0;a<e;++a)d[a]=d[a-1]+o[a-1]<<1;for(c=new Sn(n),a=0;a<n;++a)c[a]=s1[d[s[a]-1]++]>>>15-s[a];return c},Hr=new ti(288);for(it=0;it<144;++it)Hr[it]=8;for(it=144;it<256;++it)Hr[it]=9;for(it=256;it<280;++it)Hr[it]=7;for(it=280;it<288;++it)Hr[it]=8;var Pd=new ti(32);for(it=0;it<32;++it)Pd[it]=5;var VN=Zl(Hr,9),GN=Zl(Pd,5),r1=function(s){return(s/8>>0)+(7&s&&1)},a1=function(s,e,t){(t==null||t>s.length)&&(t=s.length);var n=new(s instanceof Sn?Sn:s instanceof wo?wo:ti)(t-e);return n.set(s.subarray(e,t)),n},Zi=function(s,e,t){t<<=7&e;var n=e/8>>0;s[n]|=t,s[n+1]|=t>>>8},jl=function(s,e,t){t<<=7&e;var n=e/8>>0;s[n]|=t,s[n+1]|=t>>>8,s[n+2]|=t>>>16},ip=function(s,e){for(var t=[],n=0;n<s.length;++n)s[n]&&t.push({s:n,f:s[n]});var a=t.length,o=t.slice();if(!a)return[new ti(0),0];if(a==1){var c=new ti(t[0].s+1);return c[t[0].s]=1,[c,1]}t.sort((function(A,Y){return A.f-Y.f})),t.push({s:-1,f:25001});var d=t[0],h=t[1],g=0,p=1,m=2;for(t[0]={s:-1,f:d.f+h.f,l:d,r:h};p!=a-1;)d=t[t[g].f<t[m].f?g++:m++],h=t[g!=p&&t[g].f<t[m].f?g++:m++],t[p++]={s:-1,f:d.f+h.f,l:d,r:h};var y=o[0].s;for(n=1;n<a;++n)o[n].s>y&&(y=o[n].s);var _=new Sn(y+1),E=lv(t[p-1],_,0);if(E>e){n=0;var S=0,T=E-e,O=1<<T;for(o.sort((function(A,Y){return _[Y.s]-_[A.s]||A.f-Y.f}));n<a;++n){var $=o[n].s;if(!(_[$]>e))break;S+=O-(1<<E-_[$]),_[$]=e}for(S>>>=T;S>0;){var L=o[n].s;_[L]<e?S-=1<<e-_[L]++-1:++n}for(;n>=0&&S;--n){var U=o[n].s;_[U]==e&&(--_[U],++S)}E=e}return[new ti(_),E]},lv=function(s,e,t){return s.s==-1?Math.max(lv(s.l,e,t+1),lv(s.r,e,t+1)):e[s.s]=t},Zw=function(s){for(var e=s.length;e&&!s[--e];);for(var t=new Sn(++e),n=0,a=s[0],o=1,c=function(h){t[n++]=h},d=1;d<=e;++d)if(s[d]==a&&d!=e)++o;else{if(!a&&o>2){for(;o>138;o-=138)c(32754);o>2&&(c(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(c(a),--o;o>6;o-=6)c(8304);o>2&&(c(o-3<<5|8208),o=0)}for(;o--;)c(a);o=1,a=s[d]}return[t.subarray(0,n),e]},Nl=function(s,e){for(var t=0,n=0;n<e.length;++n)t+=s[n]*e[n];return t},cv=function(s,e,t){var n=t.length,a=r1(e+2);s[a]=255&n,s[a+1]=n>>>8,s[a+2]=255^s[a],s[a+3]=255^s[a+1];for(var o=0;o<n;++o)s[a+o+4]=t[o];return 8*(a+4+n)},Ww=function(s,e,t,n,a,o,c,d,h,g,p){Zi(e,p++,t),++a[256];for(var m=ip(a,15),y=m[0],_=m[1],E=ip(o,15),S=E[0],T=E[1],O=Zw(y),$=O[0],L=O[1],U=Zw(S),A=U[0],Y=U[1],Z=new Sn(19),J=0;J<$.length;++J)Z[31&$[J]]++;for(J=0;J<A.length;++J)Z[31&A[J]]++;for(var fe=ip(Z,7),ee=fe[0],ce=fe[1],de=19;de>4&&!ee[Kw[de-1]];--de);var Se,Ue,xe,H,K=g+5<<3,re=Nl(a,Hr)+Nl(o,Pd)+c,V=Nl(a,y)+Nl(o,S)+c+14+3*de+Nl(Z,ee)+(2*Z[16]+3*Z[17]+7*Z[18]);if(K<=re&&K<=V)return cv(e,p,s.subarray(h,h+g));if(Zi(e,p,1+(V<re)),p+=2,V<re){Se=Zl(y,_),Ue=y,xe=Zl(S,T),H=S;var D=Zl(ee,ce);for(Zi(e,p,L-257),Zi(e,p+5,Y-1),Zi(e,p+10,de-4),p+=14,J=0;J<de;++J)Zi(e,p+3*J,ee[Kw[J]]);p+=3*de;for(var z=[$,A],F=0;F<2;++F){var P=z[F];for(J=0;J<P.length;++J){var W=31&P[J];Zi(e,p,D[W]),p+=ee[W],W>15&&(Zi(e,p,P[J]>>>5&127),p+=P[J]>>>12)}}}else Se=VN,Ue=Hr,xe=GN,H=Pd;for(J=0;J<d;++J)if(n[J]>255){W=n[J]>>>18&31,jl(e,p,Se[W+257]),p+=Ue[W+257],W>7&&(Zi(e,p,n[J]>>>23&31),p+=am[W]);var ge=31&n[J];jl(e,p,xe[ge]),p+=H[ge],ge>3&&(jl(e,p,n[J]>>>5&8191),p+=om[ge])}else jl(e,p,Se[n[J]]),p+=Ue[n[J]];return jl(e,p,Se[256]),p+Ue[256]},QN=new wo([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),XN=(function(){for(var s=new wo(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;s[e]=t}return s})(),KN=function(s,e,t,n,a){return(function(o,c,d,h,g,p){var m=o.length,y=new ti(h+m+5*(1+Math.floor(m/7e3))+g),_=y.subarray(h,y.length-g),E=0;if(!c||m<8)for(var S=0;S<=m;S+=65535){var T=S+65535;T<m?E=cv(_,E,o.subarray(S,T)):(_[S]=p,E=cv(_,E,o.subarray(S,m)))}else{for(var O=QN[c-1],$=O>>>13,L=8191&O,U=(1<<d)-1,A=new Sn(32768),Y=new Sn(U+1),Z=Math.ceil(d/3),J=2*Z,fe=function(Ct){return(o[Ct]^o[Ct+1]<<Z^o[Ct+2]<<J)&U},ee=new wo(25e3),ce=new Sn(288),de=new Sn(32),Se=0,Ue=0,xe=(S=0,0),H=0,K=0;S<m;++S){var re=fe(S),V=32767&S,D=Y[re];if(A[V]=D,Y[re]=V,H<=S){var z=m-S;if((Se>7e3||xe>24576)&&z>423){E=Ww(o,_,0,ee,ce,de,Ue,xe,K,S-K,E),xe=Se=Ue=0,K=S;for(var F=0;F<286;++F)ce[F]=0;for(F=0;F<30;++F)de[F]=0}var P=2,W=0,ge=L,ne=V-D&32767;if(z>2&&re==fe(S-ne))for(var lt=Math.min($,z)-1,Ce=Math.min(32767,S),ct=Math.min(258,z);ne<=Ce&&--ge&&V!=D;){if(o[S+P]==o[S+P-ne]){for(var _e=0;_e<ct&&o[S+_e]==o[S+_e-ne];++_e);if(_e>P){if(P=_e,W=ne,_e>lt)break;var fn=Math.min(ne,_e-2),xt=0;for(F=0;F<fn;++F){var nn=S-ne+F+32768&32767,Mt=nn-A[nn]+32768&32767;Mt>xt&&(xt=Mt,D=nn)}}}ne+=(V=D)-(D=A[V])+32768&32767}if(W){ee[xe++]=268435456|ov[P]<<18|Jw[W];var xn=31&ov[P],Cn=31&Jw[W];Ue+=am[xn]+om[Cn],++ce[257+xn],++de[Cn],H=S+P,++Se}else ee[xe++]=o[S],++ce[o[S]]}}E=Ww(o,_,p,ee,ce,de,Ue,xe,K,S-K,E)}return a1(y,0,h+r1(E)+g)})(s,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(s.length)))):12+e.mem,t,n,!0)},sp=function(s,e,t){for(;t;++e)s[e]=t,t>>>=8};function JN(s,e){e===void 0&&(e={});var t=(function(){var d=4294967295;return{p:function(h){for(var g=d,p=0;p<h.length;++p)g=XN[255&g^h[p]]^g>>>8;d=g},d:function(){return 4294967295^d}}})(),n=s.length;t.p(s);var a,o=KN(s,e,10+((a=e).filename&&a.filename.length+1||0),8),c=o.length;return(function(d,h){var g=h.filename;if(d[0]=31,d[1]=139,d[2]=8,d[8]=h.level<2?4:h.level==9?2:0,d[9]=3,h.mtime!=0&&sp(d,4,Math.floor(new Date(h.mtime||Date.now())/1e3)),g){d[3]=8;for(var p=0;p<=g.length;++p)d[p+10]=g.charCodeAt(p)}})(o,e),sp(o,c-8,t.d()),sp(o,c-4,n),o}var ZN=function(s){var e,t,n,a,o="";for(e=t=0,n=(s=(s+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,a=0;a<n;a++){var c=s.charCodeAt(a),d=null;c<128?t++:d=c>127&&c<2048?String.fromCharCode(c>>6|192,63&c|128):String.fromCharCode(c>>12|224,c>>6&63|128,63&c|128),us(d)||(t>e&&(o+=s.substring(e,t)),o+=d,e=t=a+1)}return t>e&&(o+=s.substring(e,s.length)),o},WN=!!Fp||!!Hp,eS="text/plain",qd=function(s,e,t){var n;t===void 0&&(t=!0);var[a,o]=s.split("?"),c=oe({},e),d=(n=o?.split("&").map((g=>{var p,[m,y]=g.split("="),_=t&&(p=c[m])!==null&&p!==void 0?p:y;return delete c[m],m+"="+_})))!==null&&n!==void 0?n:[],h=sN(c);return h&&d.push(h),a+"?"+d.join("&")},Yl=(s,e)=>JSON.stringify(s,((t,n)=>typeof n=="bigint"?n.toString():n),e),rp=s=>{var{data:e,compression:t}=s;if(e){if(t===rs.GZipJS){var n=JN((function(h,g){var p=h.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(h);for(var m=new ti(h.length+(h.length>>>1)),y=0,_=function(O){m[y++]=O},E=0;E<p;++E){if(y+5>m.length){var S=new ti(y+8+(p-E<<1));S.set(m),m=S}var T=h.charCodeAt(E);T<128||g?_(T):T<2048?(_(192|T>>>6),_(128|63&T)):T>55295&&T<57344?(_(240|(T=65536+(1047552&T)|1023&h.charCodeAt(++E))>>>18),_(128|T>>>12&63),_(128|T>>>6&63),_(128|63&T)):(_(224|T>>>12),_(128|T>>>6&63),_(128|63&T))}return a1(m,0,y)})(Yl(e)),{mtime:0}),a=new Blob([n],{type:eS});return{contentType:eS,body:a,estimatedSize:a.size}}if(t===rs.Base64){var o=(function(h){var g,p,m,y,_,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",S=0,T=0,O="",$=[];if(!h)return h;h=ZN(h);do g=(_=h.charCodeAt(S++)<<16|h.charCodeAt(S++)<<8|h.charCodeAt(S++))>>18&63,p=_>>12&63,m=_>>6&63,y=63&_,$[T++]=E.charAt(g)+E.charAt(p)+E.charAt(m)+E.charAt(y);while(S<h.length);switch(O=$.join(""),h.length%3){case 1:O=O.slice(0,-2)+"==";break;case 2:O=O.slice(0,-1)+"="}return O})(Yl(e)),c=(h=>"data="+encodeURIComponent(typeof h=="string"?h:Yl(h)))(o);return{contentType:"application/x-www-form-urlencoded",body:c,estimatedSize:new Blob([c]).size}}var d=Yl(e);return{contentType:"application/json",body:d,estimatedSize:new Blob([d]).size}}},fd=[];Hp&&fd.push({transport:"fetch",method:s=>{var e,t,{contentType:n,body:a,estimatedSize:o}=(e=rp(s))!==null&&e!==void 0?e:{},c=new Headers;We(s.headers,(function(p,m){c.append(m,p)})),n&&c.append("Content-Type",n);var d=s.url,h=null;if(bw){var g=new bw;h={signal:g.signal,timeout:setTimeout((()=>g.abort()),s.timeout)}}Hp(d,oe({method:s?.method||"GET",headers:c,keepalive:s.method==="POST"&&(o||0)<52428.8,body:a,signal:(t=h)==null?void 0:t.signal},s.fetchOptions)).then((p=>p.text().then((m=>{var y={statusCode:p.status,text:m};if(p.status===200)try{y.json=JSON.parse(m)}catch(_){ae.error(_)}s.callback==null||s.callback(y)})))).catch((p=>{ae.error(p),s.callback==null||s.callback({statusCode:0,text:p})})).finally((()=>h?clearTimeout(h.timeout):null))}}),Fp&&fd.push({transport:"XHR",method:s=>{var e,t=new Fp;t.open(s.method||"GET",s.url,!0);var{contentType:n,body:a}=(e=rp(s))!==null&&e!==void 0?e:{};We(s.headers,(function(o,c){t.setRequestHeader(c,o)})),n&&t.setRequestHeader("Content-Type",n),s.timeout&&(t.timeout=s.timeout),s.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var o={statusCode:t.status,text:t.responseText};if(t.status===200)try{o.json=JSON.parse(t.responseText)}catch{}s.callback==null||s.callback(o)}},t.send(a)}}),In!=null&&In.sendBeacon&&fd.push({transport:"sendBeacon",method:s=>{var e=qd(s.url,{beacon:"1"});try{var t,{contentType:n,body:a}=(t=rp(s))!==null&&t!==void 0?t:{},o=typeof a=="string"?new Blob([a],{type:n}):a;In.sendBeacon(e,o)}catch{}}});var So=function(s,e){if(!(function(t){try{new RegExp(t)}catch{return!1}return!0})(e))return!1;try{return new RegExp(e).test(s)}catch{return!1}};function tS(s,e,t){return Yl({distinct_id:s,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var o1={exact:(s,e)=>e.some((t=>s.some((n=>t===n)))),is_not:(s,e)=>e.every((t=>s.every((n=>t!==n)))),regex:(s,e)=>e.some((t=>s.some((n=>So(t,n))))),not_regex:(s,e)=>e.every((t=>s.every((n=>!So(t,n))))),icontains:(s,e)=>e.map(rd).some((t=>s.map(rd).some((n=>t.includes(n))))),not_icontains:(s,e)=>e.map(rd).every((t=>s.map(rd).every((n=>!t.includes(n)))))},rd=s=>s.toLowerCase(),ap=Gt("[Error tracking]");class e2{constructor(e){var t,n;this.Jt=[],this.Kt=new Nj([new Mj,new Fj,new $j,new Uj,new qj,new Pj,new Bj,new Hj],[Aj,Lj]),this._instance=e,this.Jt=(t=(n=this._instance.persistence)==null?void 0:n.get_property(Kp))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,n,a,o=(t=(n=e.errorTracking)==null?void 0:n.suppressionRules)!==null&&t!==void 0?t:[],c=(a=e.errorTracking)==null?void 0:a.captureExtensionExceptions;this.Jt=o,this._instance.persistence&&this._instance.persistence.register({[Kp]:this.Jt,[Ow]:c})}get Yt(){var e,t=!!this._instance.get_property(Ow),n=this._instance.config.error_tracking.captureExtensionExceptions;return(e=n??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.Kt.buildFromUnknown(e,{syntheticException:t?.syntheticException,mechanism:{handled:t?.handled}})}sendExceptionEvent(e){var t=e.$exception_list;if(this.Xt(t)){if(this.Qt(t))return void ap.info("Skipping exception capture because a suppression rule matched");if(!this.Yt&&this.Zt(t))return void ap.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.ti(t))return void ap.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}Qt(e){if(e.length===0)return!1;var t=e.reduce(((n,a)=>{var{type:o,value:c}=a;return Lt(o)&&o.length>0&&n.$exception_types.push(o),Lt(c)&&c.length>0&&n.$exception_values.push(c),n}),{$exception_types:[],$exception_values:[]});return this.Jt.some((n=>{var a=n.values.map((o=>{var c,d=o1[o.operator],h=nt(o.value)?o.value:[o.value],g=(c=t[o.key])!==null&&c!==void 0?c:[];return h.length>0&&d(h,g)}));return n.type==="OR"?a.some(Boolean):a.every(Boolean)}))}Zt(e){return e.flatMap((t=>{var n,a;return(n=(a=t.stacktrace)==null?void 0:a.frames)!==null&&n!==void 0?n:[]})).some((t=>t.filename&&t.filename.startsWith("chrome-extension://")))}ti(e){if(e.length>0){var t,n,a,o,c=(t=(n=e[0].stacktrace)==null?void 0:n.frames)!==null&&t!==void 0?t:[],d=c[c.length-1];return(a=d==null||(o=d.filename)==null?void 0:o.includes("posthog.com/static"))!==null&&a!==void 0&&a}return!1}Xt(e){return!tt(e)&&nt(e)}}var li=Gt("[FeatureFlags]"),op="$active_feature_flags",Xa="$override_feature_flags",nS="$feature_flag_payloads",Ml="$override_feature_flag_payloads",iS="$feature_flag_request_id",sS=s=>{var e={};for(var[t,n]of hd(s||{}))n&&(e[t]=n);return e},t2=s=>{var e=s.flags;return e?(s.featureFlags=Object.fromEntries(Object.keys(e).map((t=>{var n;return[t,(n=e[t].variant)!==null&&n!==void 0?n:e[t].enabled]}))),s.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter((t=>e[t].enabled)).filter((t=>{var n;return(n=e[t].metadata)==null?void 0:n.payload})).map((t=>{var n;return[t,(n=e[t].metadata)==null?void 0:n.payload]})))):li.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),s},n2=(function(s){return s.FeatureFlags="feature_flags",s.Recordings="recordings",s})({});class i2{constructor(e){this.ii=!1,this.ei=!1,this.ri=!1,this.si=!1,this.ni=!1,this.oi=!1,this.ai=!1,this._instance=e,this.featureFlagEventHandlers=[]}li(){var e=this._instance.config.evaluation_environments;return e!=null&&e.length?e.filter((t=>{var n=t&&typeof t=="string"&&t.trim().length>0;return n||li.error("Invalid evaluation environment found:",t,"Expected non-empty string"),n})):[]}ui(){return this.li().length>0}flags(){if(this._instance.config.__preview_remote_config)this.oi=!0;else{var e=!this.hi&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.di({disableFlags:e})}}get hasLoadedFlags(){return this.ei}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(Jp),t=this._instance.get_property(Xa),n=this._instance.get_property(Ml);if(!n&&!t)return e||{};var a=mt({},e||{}),o=[...new Set([...Object.keys(n||{}),...Object.keys(t||{})])];for(var c of o){var d,h,g=a[c],p=t?.[c],m=te(p)?(d=g?.enabled)!==null&&d!==void 0&&d:!!p,y=te(p)?g.variant:typeof p=="string"?p:void 0,_=n?.[c],E=oe({},g,{enabled:m,variant:m?y??g?.variant:void 0});m!==g?.enabled&&(E.original_enabled=g?.enabled),y!==g?.variant&&(E.original_variant=g?.variant),_&&(E.metadata=oe({},g?.metadata,{payload:_,original_payload:g==null||(h=g.metadata)==null?void 0:h.payload})),a[c]=E}return this.ii||(li.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:n,finalDetails:a}),this.ii=!0),a}getFlagVariants(){var e=this._instance.get_property(to),t=this._instance.get_property(Xa);if(!t)return e||{};for(var n=mt({},e),a=Object.keys(t),o=0;o<a.length;o++)n[a[o]]=t[a[o]];return this.ii||(li.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this.ii=!0),n}getFlagPayloads(){var e=this._instance.get_property(nS),t=this._instance.get_property(Ml);if(!t)return e||{};for(var n=mt({},e||{}),a=Object.keys(t),o=0;o<a.length;o++)n[a[o]]=t[a[o]];return this.ii||(li.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:n}),this.ii=!0),n}reloadFeatureFlags(){this.si||this._instance.config.advanced_disable_feature_flags||this.hi||(this.hi=setTimeout((()=>{this.di()}),5))}vi(){clearTimeout(this.hi),this.hi=void 0}ensureFlagsLoaded(){this.ei||this.ri||this.hi||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.si=e}di(e){var t;if(this.vi(),!this._instance.M())if(this.ri)this.ni=!0;else{var n={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:oe({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(Hl)||{}),group_properties:this._instance.get_property(Or)};(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(n.disable_flags=!0),this.ui()&&(n.evaluation_environments=this.li());var a=this._instance.config.__preview_remote_config,o=a?"/flags/?v=2":"/flags/?v=2&config=true",c=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",d=this._instance.requestRouter.endpointFor("api",o+c);a&&(n.timezone=t1()),this.ri=!0,this._instance.ci({method:"POST",url:d,data:n,compression:this._instance.config.disable_compression?void 0:rs.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:h=>{var g,p,m=!0;if(h.statusCode===200&&(this.ni||(this.$anon_distinct_id=void 0),m=!1),this.ri=!1,this.oi||(this.oi=!0,this._instance.fi((p=h.json)!==null&&p!==void 0?p:{})),!n.disable_flags||this.ni)if(this.ai=!m,h.json&&(g=h.json.quotaLimited)!=null&&g.includes(n2.FeatureFlags))li.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var y;n.disable_flags||this.receivedFeatureFlags((y=h.json)!==null&&y!==void 0?y:{},m),this.ni&&(this.ni=!1,this.di())}}})}}getFeatureFlag(e,t){if(t===void 0&&(t={}),this.ei||this.getFlags()&&this.getFlags().length>0){var n=this.getFlagVariants()[e],a=""+n,o=this._instance.get_property(iS)||void 0,c=this._instance.get_property(Ld)||{};if((t.send_event||!("send_event"in t))&&(!(e in c)||!c[e].includes(a))){var d,h,g,p,m,y,_,E,S;nt(c[e])?c[e].push(a):c[e]=[a],(d=this._instance.persistence)==null||d.register({[Ld]:c});var T=this.getFeatureFlagDetails(e),O={$feature_flag:e,$feature_flag_response:n,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_request_id:o,$feature_flag_bootstrapped_response:((h=this._instance.config.bootstrap)==null||(h=h.featureFlags)==null?void 0:h[e])||null,$feature_flag_bootstrapped_payload:((g=this._instance.config.bootstrap)==null||(g=g.featureFlagPayloads)==null?void 0:g[e])||null,$used_bootstrap_value:!this.ai};te(T==null||(p=T.metadata)==null?void 0:p.version)||(O.$feature_flag_version=T.metadata.version);var $,L=(m=T==null||(y=T.reason)==null?void 0:y.description)!==null&&m!==void 0?m:T==null||(_=T.reason)==null?void 0:_.code;L&&(O.$feature_flag_reason=L),T!=null&&(E=T.metadata)!=null&&E.id&&(O.$feature_flag_id=T.metadata.id),te(T?.original_variant)&&te(T?.original_enabled)||(O.$feature_flag_original_response=te(T.original_variant)?T.original_enabled:T.original_variant),T!=null&&(S=T.metadata)!=null&&S.original_payload&&(O.$feature_flag_original_payload=T==null||($=T.metadata)==null?void 0:$.original_payload),this._instance.capture("$feature_flag_called",O)}return n}li.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}getRemoteConfigPayload(e,t){var n=this._instance.config.token,a={distinct_id:this._instance.get_distinct_id(),token:n};this.ui()&&(a.evaluation_environments=this.li()),this._instance.ci({method:"POST",url:this._instance.requestRouter.endpointFor("api","/flags/?v=2&config=true"),data:a,compression:this._instance.config.disable_compression?void 0:rs.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:o=>{var c,d=(c=o.json)==null?void 0:c.featureFlagPayloads;t(d?.[e]||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.ei||this.getFlags()&&this.getFlags().length>0){var n=this.getFeatureFlag(e,t);return te(n)?void 0:!!n}li.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((t=>t!==e))}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ei=!0;var n=this.getFlagVariants(),a=this.getFlagPayloads(),o=this.getFlagsWithDetails();(function(c,d,h,g,p){h===void 0&&(h={}),g===void 0&&(g={}),p===void 0&&(p={});var m=t2(c),y=m.flags,_=m.featureFlags,E=m.featureFlagPayloads;if(_){var S=c.requestId;if(nt(_)){li.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var T={};if(_)for(var O=0;O<_.length;O++)T[_[O]]=!0;d&&d.register({[op]:_,[to]:T})}else{var $=_,L=E,U=y;c.errorsWhileComputingFlags&&($=oe({},h,$),L=oe({},g,L),U=oe({},p,U)),d&&d.register(oe({[op]:Object.keys(sS($)),[to]:$||{},[nS]:L||{},[Jp]:U||{}},S?{[iS]:S}:{}))}}})(e,this._instance.persistence,n,a,o),this.pi(t)}}override(e,t){t===void 0&&(t=!1),li.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return li.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(Xa),this._instance.persistence.unregister(Ml),void this.pi();if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,n=e;if(this.ii=!!((t=n.suppressWarning)!==null&&t!==void 0&&t),"flags"in n){if(n.flags===!1)this._instance.persistence.unregister(Xa);else if(n.flags)if(nt(n.flags)){for(var a={},o=0;o<n.flags.length;o++)a[n.flags[o]]=!0;this._instance.persistence.register({[Xa]:a})}else this._instance.persistence.register({[Xa]:n.flags})}return"payloads"in n&&(n.payloads===!1?this._instance.persistence.unregister(Ml):n.payloads&&this._instance.persistence.register({[Ml]:n.payloads})),void this.pi()}this.pi()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ei){var{flags:t,flagVariants:n}=this.gi();e(t,n)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,n){var a,o=(this._instance.get_property(ql)||[]).find((g=>g.flagKey===e)),c={["$feature_enrollment/"+e]:t},d={$feature_flag:e,$feature_enrollment:t,$set:c};o&&(d.$early_access_feature_name=o.name),n&&(d.$feature_enrollment_stage=n),this._instance.capture("$feature_enrollment_update",d),this.setPersonPropertiesForFlags(c,!1);var h=oe({},this.getFlagVariants(),{[e]:t});(a=this._instance.persistence)==null||a.register({[op]:Object.keys(sS(h)),[to]:h}),this.pi()}getEarlyAccessFeatures(e,t,n){t===void 0&&(t=!1);var a=this._instance.get_property(ql),o=n?"&"+n.map((c=>"stage="+c)).join("&"):"";if(a&&!t)return e(a);this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+o),method:"GET",callback:c=>{var d,h;if(c.json){var g=c.json.earlyAccessFeatures;return(d=this._instance.persistence)==null||d.unregister(ql),(h=this._instance.persistence)==null||h.register({[ql]:g}),e(g)}}})}gi(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((n=>t[n])),flagVariants:Object.keys(t).filter((n=>t[n])).reduce(((n,a)=>(n[a]=t[a],n)),{})}}pi(e){var{flags:t,flagVariants:n}=this.gi();this.featureFlagEventHandlers.forEach((a=>a(t,n,{errorsLoading:e})))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(Hl)||{};this._instance.register({[Hl]:oe({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(Hl)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(Or)||{};Object.keys(n).length!==0&&Object.keys(n).forEach((a=>{n[a]=oe({},n[a],e[a]),delete e[a]})),this._instance.register({[Or]:oe({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(Or)||{};this._instance.register({[Or]:oe({},t,{[e]:{}})})}else this._instance.unregister(Or)}reset(){this.ei=!1,this.ri=!1,this.si=!1,this.ni=!1,this.oi=!1,this.ai=!1,this.$anon_distinct_id=void 0,this.vi(),this.ii=!1}}var s2=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class lp{constructor(e,t){this.C=e,this.props={},this.mi=!1,this.yi=(n=>{var a="";return n.token&&(a=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+a+"_posthog"})(e),this.Y=this.bi(e),this.load(),e.debug&&ae.info("Persistence loaded",e.persistence,oe({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.wi}bi(e){s2.indexOf(e.persistence.toLowerCase())===-1&&(ae.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return t==="localstorage"&&ot.H()?ot:t==="localstorage+cookie"&&td.H()?td:t==="sessionstorage"&&en.H()?en:t==="memory"?pN:t==="cookie"?Ci:td.H()?td:Ci}properties(){var e={};return We(this.props,(function(t,n){if(n===to&&ln(t))for(var a=Object.keys(t),o=0;o<a.length;o++)e["$feature/"+a[o]]=t[a[o]];else d=n,h=!1,(us(c=Kj)?h:_w&&c.indexOf===_w?c.indexOf(d)!=-1:(We(c,(function(g){if(h||(h=g===d))return Rd})),h))||(e[n]=t);var c,d,h})),e}load(){if(!this.wi){var e=this.Y.W(this.yi);e&&(this.props=mt({},e))}}save(){this.wi||this.Y.G(this.yi,this.props,this.xi,this.Si,this.Ei,this.C.debug)}remove(){this.Y.V(this.yi,!1),this.Y.V(this.yi,!0)}clear(){this.remove(),this.props={}}register_once(e,t,n){if(ln(e)){te(t)&&(t="None"),this.xi=te(n)?this.$i:n;var a=!1;if(We(e,((o,c)=>{this.props.hasOwnProperty(c)&&this.props[c]!==t||(this.props[c]=o,a=!0)})),a)return this.save(),!0}return!1}register(e,t){if(ln(e)){this.xi=te(t)?this.$i:t;var n=!1;if(We(e,((a,o)=>{e.hasOwnProperty(o)&&this.props[o]!==a&&(this.props[o]=a,n=!0)})),n)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.mi){var e=Xx(this.C.custom_campaign_params,this.C.mask_personal_data_properties,this.C.custom_personal_data_properties);eo(Zv(e))||this.register(e),this.mi=!0}}update_search_keyword(){var e;this.register((e=ie?.referrer)?Jx(e):{})}update_referrer_info(){var e;this.register_once({$referrer:Zx(),$referring_domain:ie!=null&&ie.referrer&&((e=Ud(ie.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[tv]||this.props[nv]||this.register_once({[jd]:Wx(this.C.mask_personal_data_properties,this.C.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};We([nv,tv],(c=>{var d=this.props[c];d&&We(d,(function(h,g){e["$initial_"+Yp(g)]=h}))}));var t,n,a=this.props[jd];if(a){var o=(t=e1(a),n={},We(t,(function(c,d){n["$initial_"+Yp(d)]=c})),n);mt(e,o)}return e}safe_merge(e){return We(this.props,(function(t,n){n in e||(e[n]=t)})),e}update_config(e,t,n){if(this.$i=this.xi=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!n),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var a=this.bi(e),o=this.props;this.clear(),this.Y=a,this.props=o,this.save()}}set_disabled(e){this.wi=e,this.wi?this.remove():this.save()}set_cross_subdomain(e){e!==this.Si&&(this.Si=e,this.remove(),this.save())}set_secure(e){e!==this.Ei&&(this.Ei=e,this.remove(),this.save())}set_event_timer(e,t){var n=this.props[Pl]||{};n[e]=t,this.props[Pl]=n,this.save()}remove_event_timer(e){var t=(this.props[Pl]||{})[e];return te(t)||(delete this.props[Pl][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}(function(s){return s.Button="button",s.Tab="tab",s.Selector="selector",s})({});(function(s){return s.TopLeft="top_left",s.TopRight="top_right",s.TopCenter="top_center",s.MiddleLeft="middle_left",s.MiddleRight="middle_right",s.MiddleCenter="middle_center",s.Left="left",s.Center="center",s.Right="right",s.NextToTrigger="next_to_trigger",s})({});var cp=(function(s){return s.Popover="popover",s.API="api",s.Widget="widget",s.ExternalSurvey="external_survey",s})({});(function(s){return s.Open="open",s.MultipleChoice="multiple_choice",s.SingleChoice="single_choice",s.Rating="rating",s.Link="link",s})({});(function(s){return s.NextQuestion="next_question",s.End="end",s.ResponseBased="response_based",s.SpecificQuestion="specific_question",s})({});(function(s){return s.Once="once",s.Recurring="recurring",s.Always="always",s})({});var gd=(function(s){return s.SHOWN="survey shown",s.DISMISSED="survey dismissed",s.SENT="survey sent",s})({}),rS=(function(s){return s.SURVEY_ID="$survey_id",s.SURVEY_NAME="$survey_name",s.SURVEY_RESPONSE="$survey_response",s.SURVEY_ITERATION="$survey_iteration",s.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",s.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",s.SURVEY_SUBMISSION_ID="$survey_submission_id",s.SURVEY_QUESTIONS="$survey_questions",s.SURVEY_COMPLETED="$survey_completed",s})({}),l1=(function(s){return s.Popover="popover",s.Inline="inline",s})({});class lm{constructor(){this.ki={},this.ki={}}on(e,t){return this.ki[e]||(this.ki[e]=[]),this.ki[e].push(t),()=>{this.ki[e]=this.ki[e].filter((n=>n!==t))}}emit(e,t){for(var n of this.ki[e]||[])n(t);for(var a of this.ki["*"]||[])a(e,t)}}class jr{constructor(e){this.Pi=new lm,this.Ti=(t,n)=>this.Ri(t,n)&&this.Ii(t,n)&&this.Ci(t,n),this.Ri=(t,n)=>n==null||!n.event||t?.event===n?.event,this._instance=e,this.Oi=new Set,this.Fi=new Set}init(){var e;if(!te((e=this._instance)==null?void 0:e.Mi)){var t;(t=this._instance)==null||t.Mi(((n,a)=>{this.on(n,a)}))}}register(e){var t,n;if(!te((t=this._instance)==null?void 0:t.Mi)&&(e.forEach((c=>{var d,h;(d=this.Fi)==null||d.add(c),(h=c.steps)==null||h.forEach((g=>{var p;(p=this.Oi)==null||p.add(g?.event||"")}))})),(n=this._instance)!=null&&n.autocapture)){var a,o=new Set;e.forEach((c=>{var d;(d=c.steps)==null||d.forEach((h=>{h!=null&&h.selector&&o.add(h?.selector)}))})),(a=this._instance)==null||a.autocapture.setElementSelectors(o)}}on(e,t){var n;t!=null&&e.length!=0&&(this.Oi.has(e)||this.Oi.has(t?.event))&&this.Fi&&((n=this.Fi)==null?void 0:n.size)>0&&this.Fi.forEach((a=>{this.Ai(t,a)&&this.Pi.emit("actionCaptured",a.name)}))}Di(e){this.onAction("actionCaptured",(t=>e(t)))}Ai(e,t){if(t?.steps==null)return!1;for(var n of t.steps)if(this.Ti(e,n))return!0;return!1}onAction(e,t){return this.Pi.on(e,t)}Ii(e,t){if(t!=null&&t.url){var n,a=e==null||(n=e.properties)==null?void 0:n.$current_url;if(!a||typeof a!="string"||!jr.ji(a,t?.url,t?.url_matching||"contains"))return!1}return!0}static ji(e,t,n){switch(n){case"regex":return!!q&&So(e,t);case"exact":return t===e;case"contains":var a=jr.Li(t).replace(/_/g,".").replace(/%/g,".*");return So(e,a);default:return!1}}static Li(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}Ci(e,t){if((t!=null&&t.href||t!=null&&t.tag_name||t!=null&&t.text)&&!this.Ni(e).some((o=>!(t!=null&&t.href&&!jr.ji(o.href||"",t?.href,t?.href_matching||"exact"))&&(t==null||!t.tag_name||o.tag_name===t?.tag_name)&&!(t!=null&&t.text&&!jr.ji(o.text||"",t?.text,t?.text_matching||"exact")&&!jr.ji(o.$el_text||"",t?.text,t?.text_matching||"exact")))))return!1;if(t!=null&&t.selector){var n,a=e==null||(n=e.properties)==null?void 0:n.$element_selectors;if(!a||!a.includes(t?.selector))return!1}return!0}Ni(e){return e?.properties.$elements==null?[]:e?.properties.$elements}}var Ge=Gt("[Surveys]"),uv="seenSurvey_",r2=(s,e)=>{var t="$survey_"+e+"/"+s.id;return s.current_iteration&&s.current_iteration>0&&(t="$survey_"+e+"/"+s.id+"/"+s.current_iteration),t},aS=s=>{var e=""+uv+s.id;return s.current_iteration&&s.current_iteration>0&&(e=""+uv+s.id+"_"+s.current_iteration),e},a2=[cp.Popover,cp.Widget,cp.API],o2={ignoreConditions:!1,ignoreDelay:!1,displayType:l1.Popover};class l2{constructor(e){this._instance=e,this.Ui=new Map,this.zi=new Map}register(e){var t;te((t=this._instance)==null?void 0:t.Mi)||(this.Hi(e),this.Bi(e))}Bi(e){var t=e.filter((n=>{var a,o;return((a=n.conditions)==null?void 0:a.actions)&&((o=n.conditions)==null||(o=o.actions)==null||(o=o.values)==null?void 0:o.length)>0}));t.length!==0&&(this.qi==null&&(this.qi=new jr(this._instance),this.qi.init(),this.qi.Di((n=>{this.onAction(n)}))),t.forEach((n=>{var a,o,c,d,h;n.conditions&&(a=n.conditions)!=null&&a.actions&&(o=n.conditions)!=null&&(o=o.actions)!=null&&o.values&&((c=n.conditions)==null||(c=c.actions)==null||(c=c.values)==null?void 0:c.length)>0&&((d=this.qi)==null||d.register(n.conditions.actions.values),(h=n.conditions)==null||(h=h.actions)==null||(h=h.values)==null||h.forEach((g=>{if(g&&g.name){var p=this.zi.get(g.name);p&&p.push(n.id),this.zi.set(g.name,p||[n.id])}})))})))}Hi(e){var t;e.filter((n=>{var a,o;return((a=n.conditions)==null?void 0:a.events)&&((o=n.conditions)==null||(o=o.events)==null||(o=o.values)==null?void 0:o.length)>0})).length!==0&&((t=this._instance)==null||t.Mi(((n,a)=>{this.onEvent(n,a)})),e.forEach((n=>{var a;(a=n.conditions)==null||(a=a.events)==null||(a=a.values)==null||a.forEach((o=>{if(o&&o.name){var c=this.Ui.get(o.name);c&&c.push(n.id),this.Ui.set(o.name,c||[n.id])}}))})))}onEvent(e,t){var n,a,o=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[ed])||[];if(gd.SHOWN===e&&t&&o.length>0){var c;Ge.info("survey event matched, removing survey from activated surveys",{event:e,eventPayload:t,existingActivatedSurveys:o});var d=t==null||(c=t.properties)==null?void 0:c.$survey_id;if(d){var h=o.indexOf(d);h>=0&&(o.splice(h,1),this.Wi(o))}}else if(this.Ui.has(e)){Ge.info("survey event name matched",{event:e,eventPayload:t,surveys:this.Ui.get(e)});var g=[];(a=this._instance)==null||a.getSurveys((m=>{g=m.filter((y=>{var _;return(_=this.Ui.get(e))==null?void 0:_.includes(y.id)}))}));var p=g.filter((m=>{var y,_=(y=m.conditions)==null||(y=y.events)==null||(y=y.values)==null?void 0:y.find((E=>E.name===e));return!!_&&(!_.propertyFilters||Object.entries(_.propertyFilters).every((E=>{var S,[T,O]=E,$=t==null||(S=t.properties)==null?void 0:S[T];if(te($)||us($))return!1;var L=[String($)],U=o1[O.operator];return U?U(O.values,L):(Ge.warn("Unknown property comparison operator: "+O.operator),!1)})))}));this.Wi(o.concat(p.map((m=>m.id))||[]))}}onAction(e){var t,n=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[ed])||[];this.zi.has(e)&&this.Wi(n.concat(this.zi.get(e)||[]))}Wi(e){var t;Ge.info("updating activated surveys",{activatedSurveys:e}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[ed]:[...new Set(e)]})}getSurveys(){var e,t=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[ed];return t||[]}getEventToSurveys(){return this.Ui}Gi(){return this.qi}}class c2{constructor(e){this.Vi=void 0,this._surveyManager=null,this.Ji=!1,this.Ki=!1,this.Yi=[],this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(tt(t))return Ge.warn("Flags not loaded yet. Not loading surveys.");var n=nt(t);this.Vi=n?t.length>0:t,Ge.info("flags response received, isSurveysEnabled: "+this.Vi),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);(n!=null&&n.startsWith(uv)||n!=null&&n.startsWith("inProgressSurvey_"))&&e.push(n)}e.forEach((a=>localStorage.removeItem(a)))}loadIfEnabled(){if(!this._surveyManager)if(this.Ki)Ge.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)Ge.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())Ge.info("Not loading surveys in cookieless mode without consent.");else{var e=me?.__PosthogExtensions__;if(e){if(!te(this.Vi)||this._instance.config.advanced_enable_surveys){var t=this.Vi||this._instance.config.advanced_enable_surveys;this.Ki=!0;try{var n=e.generateSurveys;if(n)return void this.Xi(n,t);var a=e.loadExternalDependency;if(!a)return void this.Qi("PostHog loadExternalDependency extension not found.");a(this._instance,"surveys",(o=>{o||!e.generateSurveys?this.Qi("Could not load surveys script",o):this.Xi(e.generateSurveys,t)}))}catch(o){throw this.Qi("Error initializing surveys",o),o}finally{this.Ki=!1}}}else Ge.error("PostHog Extensions not found.")}}Xi(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new l2(this._instance),Ge.info("Surveys loaded successfully"),this.Zi({isLoaded:!0})}Qi(e,t){Ge.error(e,t),this.Zi({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.Yi.push(e),this._surveyManager&&this.Zi({isLoaded:!0}),()=>{this.Yi=this.Yi.filter((t=>t!==e))}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return Ge.info("Disabled. Not loading surveys."),e([]);var n=this._instance.get_property(Zp);if(n&&!t)return e(n,{isLoaded:!0});if(this.Ji)return e([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this.Ji=!0,this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:a=>{var o;this.Ji=!1;var c=a.statusCode;if(c!==200||!a.json){var d="Surveys API could not be loaded, status: "+c;return Ge.error(d),e([],{isLoaded:!1,error:d})}var h,g=a.json.surveys||[],p=g.filter((m=>(function(y){return!(!y.start_date||y.end_date)})(m)&&((function(y){var _;return!((_=y.conditions)==null||(_=_.events)==null||(_=_.values)==null||!_.length)})(m)||(function(y){var _;return!((_=y.conditions)==null||(_=_.actions)==null||(_=_.values)==null||!_.length)})(m))));return p.length>0&&((h=this._surveyEventReceiver)==null||h.register(p)),(o=this._instance.persistence)==null||o.register({[Zp]:g}),e(g,{isLoaded:!0})}})}catch(a){throw this.Ji=!1,a}}Zi(e){for(var t of this.Yi)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(n){Ge.error("Error in survey callback",n)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!tt(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);Ge.warn("init was not called")}te(e){var t=null;return this.getSurveys((n=>{var a;t=(a=n.find((o=>o.id===e)))!==null&&a!==void 0?a:null})),t}ie(e){if(tt(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.te(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(tt(this._surveyManager))return Ge.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.ie(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return tt(this._surveyManager)?(Ge.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((n=>{this.getSurveys((a=>{var o,c=(o=a.find((h=>h.id===e)))!==null&&o!==void 0?o:null;if(c){var d=this.ie(c);n({visible:d.eligible,disabledReason:d.reason})}else n({visible:!1,disabledReason:"Survey not found"})}),t)}))}renderSurvey(e,t){var n;if(tt(this._surveyManager))Ge.warn("init was not called");else{var a=typeof e=="string"?this.te(e):e;if(a!=null&&a.id)if(a2.includes(a.type)){var o=ie?.querySelector(t);if(o)return(n=a.appearance)!=null&&n.surveyPopupDelaySeconds?(Ge.info("Rendering survey "+a.id+" with delay of "+a.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var c,d;Ge.info("Rendering survey "+a.id+" with delay of "+((c=a.appearance)==null?void 0:c.surveyPopupDelaySeconds)+" seconds"),(d=this._surveyManager)==null||d.renderSurvey(a,o),Ge.info("Survey "+a.id+" rendered")}),1e3*a.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(a,o);Ge.warn("Survey element not found")}else Ge.warn("Surveys of type "+a.type+" cannot be rendered in the app");else Ge.warn("Survey not found")}}displaySurvey(e,t){var n;if(tt(this._surveyManager))Ge.warn("init was not called");else{var a=this.te(e);if(a){var o=a;if((n=a.appearance)!=null&&n.surveyPopupDelaySeconds&&t.ignoreDelay&&(o=oe({},a,{appearance:oe({},a.appearance,{surveyPopupDelaySeconds:0})})),t.ignoreConditions===!1){var c=this.canRenderSurvey(a);if(!c.visible)return void Ge.warn("Survey is not eligible to be displayed: ",c.disabledReason)}t.displayType!==l1.Inline?this._surveyManager.handlePopoverSurvey(o):this.renderSurvey(o,t.selector)}else Ge.warn("Survey not found")}}}var oS=Gt("[RateLimiter]");class u2{constructor(e){var t,n;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=a=>{var o=a.text;if(o&&o.length)try{(JSON.parse(o).quota_limited||[]).forEach((c=>{oS.info((c||"events")+" is quota limited."),this.serverLimits[c]=new Date().getTime()+6e4}))}catch(c){return void oS.warn('could not rate limit - continuing. Error: "'+c?.message+'"',{text:o})}},this.instance=e,this.captureEventsPerSecond=((t=e.config.rate_limiting)==null?void 0:t.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((n=e.config.rate_limiting)==null?void 0:n.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(e){var t,n,a;e===void 0&&(e=!1);var o=new Date().getTime(),c=(t=(n=this.instance.persistence)==null?void 0:n.get_property(ev))!==null&&t!==void 0?t:{tokens:this.captureEventsBurstLimit,last:o};c.tokens+=(o-c.last)/1e3*this.captureEventsPerSecond,c.last=o,c.tokens>this.captureEventsBurstLimit&&(c.tokens=this.captureEventsBurstLimit);var d=c.tokens<1;return d||e||(c.tokens=Math.max(0,c.tokens-1)),!d||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=d,(a=this.instance.persistence)==null||a.set_property(ev,c),{isRateLimited:d,remainingTokens:c.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var Ar=Gt("[RemoteConfig]");class d2{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=me._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}ee(e){var t,n;(t=me.__PosthogExtensions__)!=null&&t.loadExternalDependency?(n=me.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"remote-config",(()=>e(this.remoteConfig))):(Ar.error("PostHog Extensions not found. Cannot load remote config."),e())}re(e){this._instance.ci({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return Ar.info("Using preloaded remote config",this.remoteConfig),void this.fi(this.remoteConfig);if(this._instance.M())return void Ar.warn("Remote config is disabled. Falling back to local config.");this.ee((e=>{if(!e)return Ar.info("No config found after loading remote JS config. Falling back to JSON."),void this.re((t=>{this.fi(t)}));this.fi(e)}))}catch(e){Ar.error("Error loading remote config",e)}}fi(e){e?this._instance.config.__preview_remote_config?(this._instance.fi(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):Ar.info("__preview_remote_config is disabled. Logging config instead",e):Ar.error("Failed to fetch remote config from PostHog.")}}var dv=3e3;class h2{constructor(e,t){this.se=!0,this.ne=[],this.oe=Si(t?.flush_interval_ms||dv,250,5e3,ae.createLogger("flush interval"),dv),this.ae=e}enqueue(e){this.ne.push(e),this.le||this.ue()}unload(){this.he();var e=this.ne.length>0?this.de():{},t=Object.values(e);[...t.filter((n=>n.url.indexOf("/e")===0)),...t.filter((n=>n.url.indexOf("/e")!==0))].map((n=>{this.ae(oe({},n,{transport:"sendBeacon"}))}))}enable(){this.se=!1,this.ue()}ue(){var e=this;this.se||(this.le=setTimeout((()=>{if(this.he(),this.ne.length>0){var t=this.de(),n=function(){var o=t[a],c=new Date().getTime();o.data&&nt(o.data)&&We(o.data,(d=>{d.offset=Math.abs(d.timestamp-c),delete d.timestamp})),e.ae(o)};for(var a in t)n()}}),this.oe))}he(){clearTimeout(this.le),this.le=void 0}de(){var e={};return We(this.ne,(t=>{var n,a=t,o=(a?a.batchKey:null)||a.url;te(e[o])&&(e[o]=oe({},a,{data:[]})),(n=e[o].data)==null||n.push(a.data)})),this.ne=[],e}}var f2=["retriesPerformedSoFar"];class g2{constructor(e){this.ve=!1,this.ce=3e3,this.ne=[],this._instance=e,this.ne=[],this.fe=!0,!te(q)&&"onLine"in q.navigator&&(this.fe=q.navigator.onLine,this.pe=()=>{this.fe=!0,this.Dt()},this.ge=()=>{this.fe=!1},Et(q,"online",this.pe),Et(q,"offline",this.ge))}get length(){return this.ne.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,n=sx(e,f2);Ai(t)&&t>0&&(n.url=qd(n.url,{retry_count:t})),this._instance.ci(oe({},n,{callback:a=>{a.statusCode!==200&&(a.statusCode<400||a.statusCode>=500)&&(t??0)<10?this._e(oe({retriesPerformedSoFar:t},n)):n.callback==null||n.callback(a)}}))}_e(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=(function(c){var d=3e3*Math.pow(2,c),h=d/2,g=Math.min(18e5,d),p=(Math.random()-.5)*(g-h);return Math.ceil(g+p)})(t),a=Date.now()+n;this.ne.push({retryAt:a,requestOptions:e});var o="Enqueued failed request for retry in "+n;navigator.onLine||(o+=" (Browser is offline)"),ae.warn(o),this.ve||(this.ve=!0,this.me())}me(){if(this.ye&&clearTimeout(this.ye),this.ne.length===0)return this.ve=!1,void(this.ye=void 0);this.ye=setTimeout((()=>{this.fe&&this.ne.length>0&&this.Dt(),this.me()}),this.ce)}Dt(){var e=Date.now(),t=[],n=this.ne.filter((o=>o.retryAt<e||(t.push(o),!1)));if(this.ne=t,n.length>0)for(var{requestOptions:a}of n)this.retriableRequest(a)}unload(){for(var{requestOptions:e}of(this.ye&&(clearTimeout(this.ye),this.ye=void 0),this.ve=!1,te(q)||(this.pe&&(q.removeEventListener("online",this.pe),this.pe=void 0),this.ge&&(q.removeEventListener("offline",this.ge),this.ge=void 0)),this.ne))try{this._instance.ci(oe({},e,{transport:"sendBeacon"}))}catch(t){ae.error(t)}this.ne=[]}}class p2{constructor(e){this.be=()=>{var t,n,a,o;this.we||(this.we={});var c=this.scrollElement(),d=this.scrollY(),h=c?Math.max(0,c.scrollHeight-c.clientHeight):0,g=d+(c?.clientHeight||0),p=c?.scrollHeight||0;this.we.lastScrollY=Math.ceil(d),this.we.maxScrollY=Math.max(d,(t=this.we.maxScrollY)!==null&&t!==void 0?t:0),this.we.maxScrollHeight=Math.max(h,(n=this.we.maxScrollHeight)!==null&&n!==void 0?n:0),this.we.lastContentY=g,this.we.maxContentY=Math.max(g,(a=this.we.maxContentY)!==null&&a!==void 0?a:0),this.we.maxContentHeight=Math.max(p,(o=this.we.maxContentHeight)!==null&&o!==void 0?o:0)},this._instance=e}getContext(){return this.we}resetContext(){var e=this.we;return setTimeout(this.be,0),e}startMeasuringScrollPosition(){Et(q,"scroll",this.be,{capture:!0}),Et(q,"scrollend",this.be,{capture:!0}),Et(q,"resize",this.be)}scrollElement(){if(!this._instance.config.scroll_root_selector)return q?.document.documentElement;var e=nt(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var n=q?.document.querySelector(t);if(n)return n}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return q&&(q.scrollY||q.pageYOffset||q.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return q&&(q.scrollX||q.pageXOffset||q.document.documentElement.scrollLeft)||0}}var v2=s=>Wx(s?.config.mask_personal_data_properties,s?.config.custom_personal_data_properties);class lS{constructor(e,t,n,a){this.xe=o=>{var c=this.Se();if(!c||c.sessionId!==o){var d={sessionId:o,props:this.Ee(this._instance)};this.$e.register({[Wp]:d})}},this._instance=e,this.ke=t,this.$e=n,this.Ee=a||v2,this.ke.onSessionId(this.xe)}Se(){return this.$e.props[Wp]}getSetOnceProps(){var e,t=(e=this.Se())==null?void 0:e.props;return t?"r"in t?e1(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return We(Zv(this.getSetOnceProps()),((t,n)=>{n==="$current_url"&&(n="url"),e["$session_entry_"+Yp(n)]=t})),e}}var up=Gt("[SessionId]");class cS{on(e,t){return this.Pe.on(e,t)}constructor(e,t,n){var a;if(this.Te=[],this.Re=void 0,this.Pe=new lm,this.Ie=(p,m)=>Math.abs(p-m)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.C=e.config,this.$e=e.persistence,this.Ce=void 0,this.Oe=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.Fe=t||Qs,this.Me=n||Qs;var o=this.C.persistence_name||this.C.token,c=this.C.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*Si(c,60,36e3,up.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.Ae(),this.De="ph_"+o+"_window_id",this.je="ph_"+o+"_primary_window_exists",this.Le()){var d=en.W(this.De),h=en.W(this.je);d&&!h?this.Ce=d:en.V(this.De),en.G(this.je,!0)}if((a=this.C.bootstrap)!=null&&a.sessionID)try{var g=(p=>{var m=p.replace(/-/g,"");if(m.length!==32)throw new Error("Not a valid UUID");if(m[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(m.substring(0,12),16)})(this.C.bootstrap.sessionID);this.Ne(this.C.bootstrap.sessionID,new Date().getTime(),g)}catch(p){up.error("Invalid sessionID in bootstrap",p)}this.Ue()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return te(this.Te)&&(this.Te=[]),this.Te.push(e),this.Oe&&e(this.Oe,this.Ce),()=>{this.Te=this.Te.filter((t=>t!==e))}}Le(){return this.C.persistence!=="memory"&&!this.$e.wi&&en.H()}ze(e){e!==this.Ce&&(this.Ce=e,this.Le()&&en.G(this.De,e))}He(){return this.Ce?this.Ce:this.Le()?en.W(this.De):null}Ne(e,t,n){e===this.Oe&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this.Oe=e,this.$e.register({[Od]:[t,e,n]}))}Be(){if(this.Oe&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this.Oe,this._sessionStartTimestamp];var e=this.$e.props[Od];return nt(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.Ne(null,null,null)}destroy(){clearTimeout(this.qe),this.qe=void 0,this.Re&&q&&(q.removeEventListener("beforeunload",this.Re,{capture:!1}),this.Re=void 0),this.Te=[]}Ue(){this.Re=()=>{this.Le()&&en.V(this.je)},Et(q,"beforeunload",this.Re,{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.C.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var n=t||new Date().getTime(),[a,o,c]=this.Be(),d=this.He(),h=Ai(c)&&c>0&&Math.abs(n-c)>864e5,g=!1,p=!o,m=!e&&this.Ie(n,a);p||m||h?(o=this.Fe(),d=this.Me(),up.info("new session ID generated",{sessionId:o,windowId:d,changeReason:{noSessionId:p,activityTimeout:m,sessionPastMaximumLength:h}}),c=n,g=!0):d||(d=this.Me(),g=!0);var y=a===0||!e||h?n:a,_=c===0?new Date().getTime():c;return this.ze(d),this.Ne(o,y,_),e||this.Ae(),g&&this.Te.forEach((E=>E(o,d,g?{noSessionId:p,activityTimeout:m,sessionPastMaximumLength:h}:void 0))),{sessionId:o,windowId:d,sessionStartTimestamp:_,changeReason:g?{noSessionId:p,activityTimeout:m,sessionPastMaximumLength:h}:void 0,lastActivityTimestamp:a}}Ae(){clearTimeout(this.qe),this.qe=setTimeout((()=>{var[e]=this.Be();if(this.Ie(new Date().getTime(),e)){var t=this.Oe;this.resetSessionId(),this.Pe.emit("forcedIdleReset",{idleSessionId:t})}}),1.1*this.sessionTimeoutMs)}}var m2=["$set_once","$set"],zs=Gt("[SiteApps]");class y2{constructor(e){this._instance=e,this.We=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}Ge(e,t){if(t){var n=this.globalsForEvent(t);this.We.push(n),this.We.length>1e3&&(this.We=this.We.slice(10))}}get siteAppLoaders(){var e;return(e=me._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance.Mi(this.Ge.bind(this));this.Ve=()=>{e(),this.We=[],this.Ve=void 0}}}globalsForEvent(e){var t,n,a,o,c,d,h;if(!e)throw new Error("Event payload is required");var g={},p=this._instance.get_property("$groups")||[],m=this._instance.get_property("$stored_group_properties")||{};for(var[y,_]of Object.entries(m))g[y]={id:p[y],type:y,properties:_};var{$set_once:E,$set:S}=e;return{event:oe({},sx(e,m2),{properties:oe({},e.properties,S?{$set:oe({},(t=(n=e.properties)==null?void 0:n.$set)!==null&&t!==void 0?t:{},S)}:{},E?{$set_once:oe({},(a=(o=e.properties)==null?void 0:o.$set_once)!==null&&a!==void 0?a:{},E)}:{}),elements_chain:(c=(d=e.properties)==null?void 0:d.$elements_chain)!==null&&c!==void 0?c:"",distinct_id:(h=e.properties)==null?void 0:h.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:g}}setupSiteApp(e){var t=this.apps[e.id],n=()=>{var d;!t.errored&&this.We.length&&(zs.info("Processing "+this.We.length+" events for site app with id "+e.id),this.We.forEach((h=>t.processEvent==null?void 0:t.processEvent(h))),t.processedBuffer=!0),Object.values(this.apps).every((h=>h.processedBuffer||h.errored))&&((d=this.Ve)==null||d.call(this))},a=!1,o=d=>{t.errored=!d,t.loaded=!0,zs.info("Site app with id "+e.id+" "+(d?"loaded":"errored")),a&&n()};try{var{processEvent:c}=e.init({posthog:this._instance,callback:d=>{o(d)}});c&&(t.processEvent=c),a=!0}catch(d){zs.error("Error while initializing PostHog app with config id "+e.id,d),o(!1)}if(a&&t.loaded)try{n()}catch(d){zs.error("Error while processing buffered events PostHog app with config id "+e.id,d),t.errored=!0}}Je(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var n of e)this.setupSiteApp(n)}Ke(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var n of Object.values(this.apps))try{n.processEvent==null||n.processEvent(t)}catch(a){zs.error("Error while processing event "+e.event+" for site app "+n.id,a)}}}onRemoteConfig(e){var t,n,a,o=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.Je(),void this._instance.on("eventCaptured",(g=>this.Ke(g)))):void zs.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((n=this.Ve)==null||n.call(this),(a=e.siteApps)!=null&&a.length)if(this.isEnabled){var c=function(g){var p;me["__$$ph_site_app_"+g]=o._instance,(p=me.__PosthogExtensions__)==null||p.loadSiteApp==null||p.loadSiteApp(o._instance,h,(m=>{if(m)return zs.error("Error while initializing PostHog app with config id "+g,m)}))};for(var{id:d,url:h}of e.siteApps)c(d)}else zs.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var c1=function(s,e){if(!s)return!1;var t=s.userAgent;if(t&&Ew(t,e))return!0;try{var n=s?.userAgentData;if(n!=null&&n.brands&&n.brands.some((a=>Ew(a?.brand,e))))return!0}catch{}return!!s.webdriver},Vl=(function(s){return s.US="us",s.EU="eu",s.CUSTOM="custom",s})({}),uS="i.posthog.com";class _2{constructor(e){this.Ye={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+uS,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.Ye[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.Ye[this.apiHost]=Vl.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.Ye[this.apiHost]=Vl.EU:this.Ye[this.apiHost]=Vl.CUSTOM),this.Ye[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(this.region===Vl.CUSTOM)return this.apiHost+t;var n=uS+t;switch(e){case"assets":return"https://"+this.region+"-assets."+n;case"api":return"https://"+this.region+"."+n}}}var b2={icontains:(s,e)=>!!q&&e.href.toLowerCase().indexOf(s.toLowerCase())>-1,not_icontains:(s,e)=>!!q&&e.href.toLowerCase().indexOf(s.toLowerCase())===-1,regex:(s,e)=>!!q&&So(e.href,s),not_regex:(s,e)=>!!q&&!So(e.href,s),exact:(s,e)=>e.href===s,is_not:(s,e)=>e.href!==s};class on{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(n){n===void 0&&(n=!1),t.getWebExperiments((a=>{on.Xe("retrieved web experiments from the server"),t.Qe=new Map,a.forEach((o=>{if(o.feature_flag_key){var c;t.Qe&&(on.Xe("setting flag key ",o.feature_flag_key," to web experiment ",o),(c=t.Qe)==null||c.set(o.feature_flag_key,o));var d=t._instance.getFeatureFlag(o.feature_flag_key);Lt(d)&&o.variants[d]&&t.Ze(o.name,d,o.variants[d].transforms)}else if(o.variants)for(var h in o.variants){var g=o.variants[h];on.tr(g)&&t.Ze(o.name,h,g.transforms)}}))}),n)},this._instance=e,this._instance.onFeatureFlags((n=>{this.onFeatureFlags(n)}))}onFeatureFlags(e){if(this._is_bot())on.Xe("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(tt(this.Qe))return this.Qe=new Map,this.loadIfEnabled(),void this.previewWebExperiment();on.Xe("applying feature flags",e),e.forEach((t=>{var n;if(this.Qe&&(n=this.Qe)!=null&&n.has(t)){var a,o=this._instance.getFeatureFlag(t),c=(a=this.Qe)==null?void 0:a.get(t);o&&c!=null&&c.variants[o]&&this.Ze(c.name,o,c.variants[o].transforms)}}))}}previewWebExperiment(){var e=on.getWindowLocation();if(e!=null&&e.search){var t=$d(e?.search,"__experiment_id"),n=$d(e?.search,"__experiment_variant");t&&n&&(on.Xe("previewing web experiments "+t+" && "+n),this.getWebExperiments((a=>{this.ir(parseInt(t),n,a)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,n){if(this._instance.config.disable_web_experiments&&!n)return e([]);var a=this._instance.get_property("$web_experiments");if(a&&!t)return e(a);this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:o=>{if(o.statusCode!==200||!o.json)return e([]);var c=o.json.experiments||[];return e(c)}})}ir(e,t,n){var a=n.filter((o=>o.id===e));a&&a.length>0&&(on.Xe("Previewing web experiment ["+a[0].name+"] with variant ["+t+"]"),this.Ze(a[0].name,t,a[0].variants[t].transforms))}static tr(e){return!tt(e.conditions)&&on.er(e)&&on.rr(e)}static er(e){var t;if(tt(e.conditions)||tt((t=e.conditions)==null?void 0:t.url))return!0;var n,a,o,c=on.getWindowLocation();return!!c&&((n=e.conditions)==null||!n.url||b2[(a=(o=e.conditions)==null?void 0:o.urlMatchType)!==null&&a!==void 0?a:"icontains"](e.conditions.url,c))}static getWindowLocation(){return q?.location}static rr(e){var t;if(tt(e.conditions)||tt((t=e.conditions)==null?void 0:t.utm))return!0;var n=Xx();if(n.utm_source){var a,o,c,d,h,g,p,m,y=(a=e.conditions)==null||(a=a.utm)==null||!a.utm_campaign||((o=e.conditions)==null||(o=o.utm)==null?void 0:o.utm_campaign)==n.utm_campaign,_=(c=e.conditions)==null||(c=c.utm)==null||!c.utm_source||((d=e.conditions)==null||(d=d.utm)==null?void 0:d.utm_source)==n.utm_source,E=(h=e.conditions)==null||(h=h.utm)==null||!h.utm_medium||((g=e.conditions)==null||(g=g.utm)==null?void 0:g.utm_medium)==n.utm_medium,S=(p=e.conditions)==null||(p=p.utm)==null||!p.utm_term||((m=e.conditions)==null||(m=m.utm)==null?void 0:m.utm_term)==n.utm_term;return y&&E&&S&&_}return!1}static Xe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];ae.info("[WebExperiments] "+e,n)}Ze(e,t,n){this._is_bot()?on.Xe("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?n.forEach((a=>{if(a.selector){var o;on.Xe("applying transform of variant "+t+" for experiment "+e+" ",a);var c=(o=document)==null?void 0:o.querySelectorAll(a.selector);c?.forEach((d=>{var h=d;a.html&&(h.innerHTML=a.html),a.css&&h.setAttribute("style",a.css)}))}})):on.Xe("Control variants leave the page unmodified.")}_is_bot(){return In&&this._instance?c1(In,this._instance.config.custom_blocked_useragents):void 0}}var w2=Gt("[PostHog ExternalIntegrations]"),S2={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class E2{constructor(e){this._instance=e}it(e,t){var n;(n=me.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,e,(a=>{if(a)return w2.error("failed to load script",a);t()}))}startIfEnabledOrStop(){var e=this,t=function(c){var d,h,g;!a||(d=me.__PosthogExtensions__)!=null&&(d=d.integrations)!=null&&d[c]||e.it(S2[c],(()=>{var p;(p=me.__PosthogExtensions__)==null||(p=p.integrations)==null||(p=p[c])==null||p.start(e._instance)})),!a&&(h=me.__PosthogExtensions__)!=null&&(h=h.integrations)!=null&&h[c]&&((g=me.__PosthogExtensions__)==null||(g=g.integrations)==null||(g=g[c])==null||g.stop())};for(var[n,a]of Object.entries((o=this._instance.config.integrations)!==null&&o!==void 0?o:{})){var o;t(n)}}}var hv="[SessionRecording]",Ul=Gt(hv);class dS{get started(){var e;return!((e=this.sr)==null||!e.isStarted)}get status(){return this.sr?this.sr.status:this.nr&&!this.ar?"disabled":"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.nr=!1,this.lr=void 0,this._instance=e,!this._instance.sessionManager)throw Ul.error("started without valid sessionManager"),new Error(hv+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(hv+' cannot be used with cookieless_mode="always"')}get ar(){var e,t=!((e=this._instance.get_property(Jg))==null||!e.enabled),n=!this._instance.config.disable_session_recording,a=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return q&&t&&n&&!a}startIfEnabledOrStop(e){var t;if(!this.ar||(t=this.sr)==null||!t.isStarted){var n=!te(Object.assign)&&!te(Array.from);this.ar&&n?(this.ur(e),Ul.info("starting")):this.stopRecording()}}ur(e){var t,n,a;this.ar&&(me!=null&&(t=me.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(n=me.__PosthogExtensions__)!=null&&n.initSessionRecording?this.hr(e):(a=me.__PosthogExtensions__)==null||a.loadExternalDependency==null||a.loadExternalDependency(this._instance,this.dr,(o=>{if(o)return Ul.error("could not load recorder",o);this.hr(e)})))}stopRecording(){var e,t;(e=this.lr)==null||e.call(this),this.lr=void 0,(t=this.sr)==null||t.stop()}vr(){var e;(e=this._instance.persistence)==null||e.unregister(gx)}cr(e){if(this._instance.persistence){var t,n,a=this._instance.persistence,o=()=>{var c=e.sessionRecording===!1?void 0:e.sessionRecording,d=c?.sampleRate,h=tt(d)?null:parseFloat(d);tt(h)&&this.vr();var g=c?.minimumDurationMilliseconds;a.register({[Jg]:oe({enabled:!!c},c,{networkPayloadCapture:oe({capturePerformance:e.capturePerformance},c?.networkPayloadCapture),canvasRecording:{enabled:c?.recordCanvas,fps:c?.canvasFps,quality:c?.canvasQuality},sampleRate:h,minimumDurationMilliseconds:te(g)?null:g,endpoint:c?.endpoint,triggerMatchType:c?.triggerMatchType,masking:c?.masking,urlTriggers:c?.urlTriggers})})};o(),(t=this.lr)==null||t.call(this),this.lr=(n=this._instance.sessionManager)==null?void 0:n.onSessionId(o)}}onRemoteConfig(e){"sessionRecording"in e?e.sessionRecording!==!1?(this.cr(e),this.nr=!0,this.startIfEnabledOrStop()):this.nr=!0:Ul.info("skipping remote config with no sessionRecording",e)}log(e,t){var n;t===void 0&&(t="log"),(n=this.sr)!=null&&n.log?this.sr.log(e,t):Ul.warn("log called before recorder was ready")}get dr(){var e,t,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(Jg);return(n==null||(t=n.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}hr(e){var t,n;if((t=me.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this.sr||(this.sr=(n=me.__PosthogExtensions__)==null?void 0:n.initSessionRecording(this._instance),this.sr._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this.sr.start(e)}onRRwebEmit(e){var t;(t=this.sr)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e;(e=this.sr)==null||e.overrideLinkedFlag()}overrideSampling(){var e;(e=this.sr)==null||e.overrideSampling()}overrideTrigger(e){var t;(t=this.sr)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this.sr)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var n;return!((n=this.sr)==null||!n.tryAddCustomEvent(e,t))}}var Wl={},fv=()=>{},Wa="posthog",u1=!WN&&_n?.indexOf("MSIE")===-1&&_n?.indexOf("Mozilla")===-1,hS=s=>{var e;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:Xj(ie?.location),persistence:"localStorage+cookie",persistence_name:"",loaded:fv,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:s!=="2025-05-24"||"history_change",capture_pageleave:"if_capture_pageview",defaults:s??"unset",debug:bn&&Lt(bn?.search)&&bn.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(q==null||(e=q.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var n="Bad HTTP status: "+t.statusCode+" "+t.text;ae.error(n)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:dv},error_tracking:{},_onCapture:fv,__preview_eager_load_replay:!1}},fS=s=>{var e={};te(s.process_person)||(e.person_profiles=s.process_person),te(s.xhr_headers)||(e.request_headers=s.xhr_headers),te(s.cookie_name)||(e.persistence_name=s.cookie_name),te(s.disable_cookie)||(e.disable_persistence=s.disable_cookie),te(s.store_google)||(e.save_campaign_params=s.store_google),te(s.verbose)||(e.debug=s.verbose);var t=mt({},e,s);return nt(s.property_blacklist)&&(te(s.property_denylist)?t.property_denylist=s.property_blacklist:nt(s.property_denylist)?t.property_denylist=[...s.property_blacklist,...s.property_denylist]:ae.error("Invalid value for property_denylist config: "+s.property_denylist)),t};class x2{constructor(){this.__forceAllowLocalhost=!1}get pr(){return this.__forceAllowLocalhost}set pr(e){ae.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class lh{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new x2,this.gr=!1,this.version=ns.LIB_VERSION,this._r=new lm,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=hS(),this.SentryIntegration=SN,this.sentryIntegration=e=>(function(t,n){var a=Lx(t,n);return{name:Ox,processEvent:o=>a(o)}})(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.mr=!1,this.yr=null,this.br=null,this.wr=null,this.featureFlags=new i2(this),this.toolbar=new xN(this),this.scrollManager=new p2(this),this.pageViewManager=new FN(this),this.surveys=new c2(this),this.experiments=new on(this),this.exceptions=new e2(this),this.rateLimiter=new u2(this),this.requestRouter=new _2(this),this.consent=new vN(this),this.externalIntegrations=new E2(this),this.people={set:(e,t,n)=>{var a=Lt(e)?{[e]:t}:e;this.setPersonProperties(a),n?.({})},set_once:(e,t,n)=>{var a=Lt(e)?{[e]:t}:e;this.setPersonProperties(void 0,a),n?.({})}},this.on("eventCaptured",(e=>ae.info('send "'+e?.event+'"',e)))}init(e,t,n){if(n&&n!==Wa){var a,o=(a=Wl[n])!==null&&a!==void 0?a:new lh;return o._init(e,t,n),Wl[n]=o,Wl[Wa][n]=o,o}return this._init(e,t,n)}_init(e,t,n){var a,o;if(t===void 0&&(t={}),te(e)||Vp(e))return ae.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},t.debug=this.Sr(t.debug),this.Er=t,this.$r=[],t.person_profiles&&(this.br=t.person_profiles),this.set_config(mt({},hS(t.defaults),fS(t),{name:n,token:e})),this.config.on_xhr_error&&ae.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:rs.GZipJS;var c=this.kr();this.persistence=new lp(this.config,c),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new lp(oe({},this.config,{persistence:"sessionStorage"}),c);var d=oe({},this.persistence.props),h=oe({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Pr=new h2((L=>this.Tr(L)),this.config.request_queue_config),this.Rr=new g2(this),this.__request_queue=[];var g=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(g||(this.sessionManager=new cS(this),this.sessionPropsManager=new lS(this,this.sessionManager,this.persistence)),new TN(this).startIfEnabledOrStop(),this.siteApps=new y2(this),(a=this.siteApps)==null||a.init(),g||(this.sessionRecording=new dS(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new lN(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new HN(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new PN(this),this.exceptionObserver=new _N(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new Rx(this,yN),this.deadClicksAutocapture.startIfEnabled(),this.historyAutocapture=new bN(this),this.historyAutocapture.startIfEnabled(),ns.DEBUG=ns.DEBUG||this.config.debug,ns.DEBUG&&ae.info("Starting in debug mode",{this:this,config:t,thisC:oe({},this.config),p:d,s:h}),((o=t.bootstrap)==null?void 0:o.distinctID)!==void 0){var p,m,y=this.config.get_device_id(Qs()),_=(p=t.bootstrap)!=null&&p.isIdentifiedID?y:t.bootstrap.distinctID;this.persistence.set_property(is,(m=t.bootstrap)!=null&&m.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:_})}if(this.Ir()){var E,S,T=Object.keys(((E=t.bootstrap)==null?void 0:E.featureFlags)||{}).filter((L=>{var U;return!((U=t.bootstrap)==null||(U=U.featureFlags)==null||!U[L])})).reduce(((L,U)=>{var A;return L[U]=((A=t.bootstrap)==null||(A=A.featureFlags)==null?void 0:A[U])||!1,L}),{}),O=Object.keys(((S=t.bootstrap)==null?void 0:S.featureFlagPayloads)||{}).filter((L=>T[L])).reduce(((L,U)=>{var A,Y;return(A=t.bootstrap)!=null&&(A=A.featureFlagPayloads)!=null&&A[U]&&(L[U]=(Y=t.bootstrap)==null||(Y=Y.featureFlagPayloads)==null?void 0:Y[U]),L}),{});this.featureFlags.receivedFeatureFlags({featureFlags:T,featureFlagPayloads:O})}if(g)this.register_once({distinct_id:Rl,$device_id:null},"");else if(!this.get_distinct_id()){var $=this.config.get_device_id(Qs());this.register_once({distinct_id:$,$device_id:$},""),this.persistence.set_property(is,"anonymous")}return Et(q,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?wN(this,(()=>this.Cr())):this.Cr(),Ks(this.config._onCapture)&&this.config._onCapture!==fv&&(ae.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(L=>this.config._onCapture(L.event,L)))),this.config.ip&&ae.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}fi(e){var t,n,a,o,c,d,h,g;if(!ie||!ie.body)return ae.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this.fi(e)}),500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=Oe(e.supportedCompression,rs.GZipJS)?rs.GZipJS:Oe(e.supportedCompression,rs.Base64)?rs.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.br?this.br:"identified_only"}),(n=this.siteApps)==null||n.onRemoteConfig(e),(a=this.sessionRecording)==null||a.onRemoteConfig(e),(o=this.autocapture)==null||o.onRemoteConfig(e),(c=this.heatmaps)==null||c.onRemoteConfig(e),this.surveys.onRemoteConfig(e),(d=this.webVitalsAutocapture)==null||d.onRemoteConfig(e),(h=this.exceptionObserver)==null||h.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(g=this.deadClicksAutocapture)==null||g.onRemoteConfig(e)}Cr(){try{this.config.loaded(this)}catch(e){ae.critical("`loaded` function failed",e)}this.Or(),this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.Fr()}),1),new d2(this).load(),this.featureFlags.flags()}Or(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Pr)==null||e.enable())}_dom_loaded(){this.is_capturing()&&Zs(this.__request_queue,(e=>this.Tr(e))),this.__request_queue=[],this.Or()}_handle_unload(){var e,t;this.config.request_batching?(this.Mr()&&this.capture("$pageleave"),(e=this.Pr)==null||e.unload(),(t=this.Rr)==null||t.unload()):this.Mr()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}ci(e){this.__loaded&&(u1?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=qd(e.url,{ip:this.config.ip?1:0}),e.headers=oe({},this.config.request_headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var n,a,o,c=oe({},t);c.timeout=c.timeout||6e4,c.url=qd(c.url,{_:new Date().getTime().toString(),ver:ns.LIB_VERSION,compression:c.compression});var d=(n=c.transport)!==null&&n!==void 0?n:"fetch",h=fd.filter((p=>!c.disableTransport||!p.transport||!c.disableTransport.includes(p.transport))),g=(a=(o=dx(h,(p=>p.transport===d)))==null?void 0:o.method)!==null&&a!==void 0?a:h[0].method;if(!g)throw new Error("No available transport method");g(c)})(oe({},e,{callback:t=>{var n,a;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((n=(a=this.config).on_request_error)==null||n.call(a,t)),e.callback==null||e.callback(t)}}))))}Tr(e){this.Rr?this.Rr.retriableRequest(e):this.ci(e)}_execute_array(e){var t,n=[],a=[],o=[];Zs(e,(d=>{d&&(t=d[0],nt(t)?o.push(d):Ks(d)?d.call(this):nt(d)&&t==="alias"?n.push(d):nt(d)&&t.indexOf("capture")!==-1&&Ks(this[t])?o.push(d):a.push(d))}));var c=function(d,h){Zs(d,(function(g){if(nt(g[0])){var p=h;We(g,(function(m){p=p[m[0]].apply(p,m.slice(1))}))}else this[g[0]].apply(this,g.slice(1))}),h)};c(n,this),c(a,this),c(o,this)}Ir(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,n){var a;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Pr){if(this.is_capturing())if(!te(e)&&Lt(e)){var o=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(o&&!this.config.__preview_capture_bot_pageviews)){var c=n!=null&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(c==null||!c.isRateLimited){t!=null&&t.$current_url&&!Lt(t?.$current_url)&&(ae.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var d=new Date,h=n?.timestamp||d,g=Qs(),p={uuid:g,event:e,properties:this.calculateEventProperties(e,t||{},h,g)};e==="$pageview"&&this.config.__preview_capture_bot_pageviews&&o&&(p.event="$bot_pageview",p.properties.$browser_type="bot"),c&&(p.properties.$lib_rate_limit_remaining_tokens=c.remainingTokens),n?.$set&&(p.$set=n?.$set);var m,y=this.Ar(n?.$set_once);if(y&&(p.$set_once=y),(p=Gj(p,n!=null&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=h,te(n?.timestamp)||(p.properties.$event_time_override_provided=!0,p.properties.$event_time_override_system_time=d),e===gd.DISMISSED||e===gd.SENT){var _=t?.[rS.SURVEY_ID],E=t?.[rS.SURVEY_ITERATION];m={id:_,current_iteration:E},localStorage.getItem(aS(m))||localStorage.setItem(aS(m),"true"),p.$set=oe({},p.$set,{[r2({id:_,current_iteration:E},e===gd.SENT?"responded":"dismissed")]:!0})}var S=oe({},p.properties.$set,p.$set);if(eo(S)||this.setPersonPropertiesForFlags(S),!tt(this.config.before_send)){var T=this.Dr(p);if(!T)return;p=T}this._r.emit("eventCaptured",p);var O={method:"POST",url:(a=n?._url)!==null&&a!==void 0?a:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:p,compression:"best-available",batchKey:n?._batchKey};return!this.config.request_batching||n&&(n==null||!n._batchKey)||n!=null&&n.send_instantly?this.Tr(O):this.Pr.enqueue(O),p}ae.critical("This capture call is ignored due to client rate limiting.")}}else ae.error("No event name provided to posthog.capture")}else ae.uninitializedWarning("posthog.capture")}Mi(e){return this.on("eventCaptured",(t=>e(t.event,t)))}calculateEventProperties(e,t,n,a,o){if(n=n||new Date,!this.persistence||!this.sessionPersistence)return t;var c=o?void 0:this.persistence.remove_event_timer(e),d=oe({},t);if(d.token=this.config.token,d.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(d.$cookieless_mode=!0),e==="$snapshot"){var h=oe({},this.persistence.properties(),this.sessionPersistence.properties());return d.distinct_id=h.distinct_id,(!Lt(d.distinct_id)&&!Ai(d.distinct_id)||Vp(d.distinct_id))&&ae.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),d}var g,p=zN(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:m,windowId:y}=this.sessionManager.checkAndGetSessionAndWindowId(o,n.getTime());d.$session_id=m,d.$window_id=y}this.sessionPropsManager&&mt(d,this.sessionPropsManager.getSessionProps());try{var _;this.sessionRecording&&mt(d,this.sessionRecording.sdkDebugProperties),d.$sdk_debug_retry_queue_size=(_=this.Rr)==null?void 0:_.length}catch(O){d.$sdk_debug_error_capturing_properties=String(O)}if(this.requestRouter.region===Vl.CUSTOM&&(d.$lib_custom_api_host=this.config.api_host),g=e!=="$pageview"||o?e!=="$pageleave"||o?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(n):this.pageViewManager.doPageView(n,a),d=mt(d,g),e==="$pageview"&&ie&&(d.title=ie.title),!te(c)){var E=n.getTime()-c;d.$duration=parseFloat((E/1e3).toFixed(3))}_n&&this.config.opt_out_useragent_filter&&(d.$browser_type=this._is_bot()?"bot":"browser"),(d=mt({},p,this.persistence.properties(),this.sessionPersistence.properties(),d)).$is_identified=this._isIdentified(),nt(this.config.property_denylist)?We(this.config.property_denylist,(function(O){delete d[O]})):ae.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var S=this.config.sanitize_properties;S&&(ae.error("sanitize_properties is deprecated. Use before_send instead"),d=S(d,e));var T=this.jr();return d.$process_person_profile=T,T&&!o&&this.Lr("_calculate_event_properties"),d}Ar(e){var t;if(!this.persistence||!this.jr()||this.gr)return e;var n=this.persistence.get_initial_props(),a=(t=this.sessionPropsManager)==null?void 0:t.getSetOnceProps(),o=mt({},n,a||{},e||{}),c=this.config.sanitize_properties;return c&&(ae.error("sanitize_properties is deprecated. Use before_send instead"),o=c(o,"$set_once")),this.gr=!0,eo(o)?void 0:o}register(e,t){var n;(n=this.persistence)==null||n.register(e,t)}register_once(e,t,n){var a;(a=this.persistence)==null||a.register_once(e,t,n)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}Nr(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch{return t}}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,t,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,n)}getEarlyAccessFeatures(e,t,n){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,n)}on(e,t){return this._r.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,n;return(t=(n=this.sessionManager)==null?void 0:n.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=o2),this.surveys.displaySurvey(e,t)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,n){if(!this.__loaded||!this.persistence)return ae.uninitializedWarning("posthog.identify");if(Ai(e)&&(e=e.toString(),ae.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))ae.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==Rl){if(this.Lr("posthog.identify")){var a=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var o=a;this.register_once({$had_persisted_distinct_id:!0,$device_id:o},"")}e!==a&&e!==this.get_property(zl)&&(this.unregister(zl),this.register({distinct_id:e}));var c=(this.persistence.get_property(is)||"anonymous")==="anonymous";e!==a&&c?(this.persistence.set_property(is,"identified"),this.setPersonPropertiesForFlags(oe({},n||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:a},{$set:t||{},$set_once:n||{}}),this.wr=tS(e,t,n),this.featureFlags.setAnonymousDistinctId(a)):(t||n)&&this.setPersonProperties(t,n),e!==a&&(this.reloadFeatureFlags(),this.unregister(Ld))}}else ae.critical('The string "'+Rl+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else ae.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.Lr("posthog.setPersonProperties")){var n=tS(this.get_distinct_id(),e,t);this.wr!==n?(this.setPersonPropertiesForFlags(oe({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.wr=n):ae.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,n){if(e&&t){if(this.Lr("posthog.group")){var a=this.getGroups();a[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:oe({},a,{[e]:t})}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags({[e]:n})),a[e]===t||n||this.reloadFeatureFlags()}}else ae.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.Lr("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,n,a,o;if(ae.info("reset"),!this.__loaded)return ae.uninitializedWarning("posthog.reset");var c=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(n=this.sessionPersistence)==null||n.clear(),this.surveys.reset(),this.featureFlags.reset(),(a=this.persistence)==null||a.set_property(is,"anonymous"),(o=this.sessionManager)==null||o.resetSessionId(),this.wr=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:Rl,$device_id:null},"");else{var d=this.config.get_device_id(Qs());this.register_once({distinct_id:d,$device_id:e?d:c},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:n}=this.sessionManager.checkAndGetSessionAndWindowId(!0),a=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&n){var o,c=(o=e.timestampLookBack)!==null&&o!==void 0?o:10;if(!n)return a;a+="?t="+Math.max(Math.floor((new Date().getTime()-n)/1e3)-c,0)}return a}alias(e,t){return e===this.get_property(hx)?(ae.critical("Attempting to create alias for existing People user - aborting."),-2):this.Lr("posthog.alias")?(te(t)&&(t=this.get_distinct_id()),e!==t?(this.Nr(zl,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(ae.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=oe({},this.config);if(ln(e)){var n,a,o,c,d;mt(this.config,fS(e));var h=this.kr();(n=this.persistence)==null||n.update_config(this.config,t,h),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new lp(oe({},this.config,{persistence:"sessionStorage"}),h);var g=this.Sr(this.config.debug);Js(g)&&(this.config.debug=g),Js(this.config.debug)&&(this.config.debug?(ns.DEBUG=!0,ot.H()&&ot.G("ph_debug","true"),ae.info("set_config",{config:e,oldConfig:t,newConfig:oe({},this.config)})):(ns.DEBUG=!1,ot.H()&&ot.V("ph_debug"))),(a=this.sessionRecording)==null||a.startIfEnabledOrStop(),(o=this.autocapture)==null||o.startIfEnabled(),(c=this.heatmaps)==null||c.startIfEnabled(),this.surveys.loadIfEnabled(),this.Ur(),(d=this.externalIntegrations)==null||d.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,n={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(n).some(Boolean)){var a,o,c,d,h;(a=this.sessionManager)==null||a.checkAndGetSessionAndWindowId(),n.sampling&&((o=this.sessionRecording)==null||o.overrideSampling()),n.linked_flag&&((c=this.sessionRecording)==null||c.overrideLinkedFlag()),n.url_trigger&&((d=this.sessionRecording)==null||d.overrideTrigger("url")),n.event_trigger&&((h=this.sessionRecording)==null||h.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var n=new Error("PostHog syntheticException"),a=this.exceptions.buildProperties(e,{handled:!0,syntheticException:n});return this.exceptions.sendExceptionEvent(oe({},a,t))}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:Wa;return t!==Wa&&(t=Wa+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(is))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(is))==="identified"}jr(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&eo(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[zl])&&((t=this.persistence)==null||(t=t.props)==null||!t[Nd]))}Mr(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.jr()||this.Lr("posthog.createPersonProfile")&&this.setPersonProperties({},{})}Lr(e){return this.config.person_profiles==="never"?(ae.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.Nr(Nd,!0),!0)}kr(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}Ur(){var e,t,n,a,o=this.kr();return((e=this.persistence)==null?void 0:e.wi)!==o&&((n=this.persistence)==null||n.set_disabled(o)),((t=this.sessionPersistence)==null?void 0:t.wi)!==o&&((a=this.sessionPersistence)==null||a.set_disabled(o)),o}opt_in_capturing(e){if(this.config.cookieless_mode!=="always"){var t,n;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),(t=this.sessionManager)==null||t.destroy(),this.sessionManager=new cS(this),this.persistence&&(this.sessionPropsManager=new lS(this,this.sessionManager,this.persistence)),this.sessionRecording=new dS(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this.Ur(),this.Or(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(te(e?.captureEventName)||e!=null&&e.captureEventName)&&this.capture((n=e?.captureEventName)!==null&&n!==void 0?n:"$opt_in",e?.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.Fr()}else ae.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e,t;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this.Ur(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:Rl,$device_id:null}),(e=this.sessionManager)==null||e.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,(t=this.sessionRecording)==null||t.stopRecording(),this.sessionRecording=void 0,this.Fr())):ae.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===ss.GRANTED?"granted":e===ss.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this.Ur()}_is_bot(){return In?c1(In,this.config.custom_blocked_useragents):void 0}Fr(){ie&&(ie.visibilityState==="visible"?this.mr||(this.mr=!0,this.capture("$pageview",{title:ie.title},{send_instantly:!0}),this.yr&&(ie.removeEventListener("visibilitychange",this.yr),this.yr=null)):this.yr||(this.yr=this.Fr.bind(this),Et(ie,"visibilitychange",this.yr)))}debug(e){e===!1?(q?.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(q?.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}M(){var e,t,n,a,o,c,d,h=this.Er||{};return"advanced_disable_flags"in h?!!h.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(ae.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(n="advanced_disable_decide",a=!1,o=ae,c=(t="advanced_disable_flags")in(e=h)&&!te(e[t]),d=n in e&&!te(e[n]),c?e[t]:d?(o&&o.warn("Config field '"+n+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[n]):a)}Dr(e){if(tt(this.config.before_send))return e;var t=nt(this.config.before_send)?this.config.before_send:[this.config.before_send],n=e;for(var a of t){if(n=a(n),tt(n)){var o="Event '"+e.event+"' was rejected in beforeSend function";return bj(e.event)?ae.warn(o+". This can cause unexpected behavior."):ae.info(o),null}n.properties&&!eo(n.properties)||ae.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return n}getPageViewId(){var e;return(e=this.pageViewManager.Vt)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,n){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(n)})}Sr(e){var t=Js(e)&&!e,n=ot.H()&&ot.q("ph_debug")==="true";return!t&&(!!n||e)}}(function(s,e){for(var t=0;t<e.length;t++)s.prototype[e[t]]=Vj(s.prototype[e[t]])})(lh,["identify"]);var gS,Nr=(gS=Wl[Wa]=new lh,(function(){function s(){s.done||(s.done=!0,u1=!1,We(Wl,(function(e){e._dom_loaded()})))}ie!=null&&ie.addEventListener?ie.readyState==="complete"?s():Et(ie,"DOMContentLoaded",s,{capture:!1}):q&&ae.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")})(),gS);class C2{level;constructor(e=St.INFO){this.level=e}setLevel(e){this.level=e}getLevel(){return this.level}getCallerInfo(){const e=new Error().stack;if(!e)return"";const n=e.split(`
`)[3];if(!n)return"";const a=n.match(/at\s+(.+?)\s+\((.+?):(\d+):(\d+)\)/);if(a){const[,c,d,h,g]=a;return`${d.split("/").pop()?.split("?")[0]||d}:${h}`}const o=n.match(/at\s+(.+?):(\d+):(\d+)/);if(o){const[,c,d,h]=o;return`${c.split("/").pop()?.split("?")[0]||c}:${d}`}return""}captureEvent(e,t,n,a){const o=this.getCallerInfo(),c={level:e,message:t,caller:o,timestamp:new Date().toISOString(),...a};n.length>0&&(c.args=n.map(d=>{if(d instanceof Error)return{name:d.name,message:d.message,stack:d.stack};try{return JSON.parse(JSON.stringify(d))}catch{return String(d)}})),Nr.capture(`log_${e}`,c)}debug(e,...t){this.level<=St.DEBUG&&this.captureEvent("debug",e,t)}info(e,...t){this.level<=St.INFO&&this.captureEvent("info",e,t)}warn(e,...t){this.level<=St.WARN&&this.captureEvent("warn",e,t)}error(e,...t){this.level<=St.ERROR&&this.captureEvent("error",e,t)}debugSync(e,...t){this.level<=St.DEBUG&&this.captureEvent("debug",e,t,{category:"sync"})}infoSync(e,...t){this.level<=St.INFO&&this.captureEvent("info",e,t,{category:"sync"})}warnSync(e,...t){this.level<=St.WARN&&this.captureEvent("warn",e,t,{category:"sync"})}errorSync(e,...t){this.level<=St.ERROR&&this.captureEvent("error",e,t,{category:"sync"})}}class no{constructor(e,t,n,a){this.listController=e,this.remoteStorageService=t,this.logger=n,this.connectionMonitor=a}static instance=null;isRunning=!1;isStarted=!1;syncInterval=null;SYNC_INTERVAL_MS=5e3;MAX_BACKOFF_MS=3e4;currentBackoffMs=this.SYNC_INTERVAL_MS;consecutiveEmptyRuns=0;connectionChangeListener=null;connectionChangeTimeout=null;isProcessingConnectionChange=!1;static getInstance(e,t,n,a){return no.instance||(no.instance=new no(e,t,n,a)),no.instance}async start(){if(this.isStarted){this.logger.infoSync("Background sync service is already started");return}this.isStarted=!0,this.logger.infoSync("Background sync service started (lazy mode)"),this.setupConnectionMonitoring(),await this.checkAndStartSync()}async checkAndStartSync(){if(this.isRunning){this.logger.debugSync("Sync service already running, skipping check");return}try{const e=await this.listController.getSyncQueueItems();e.length>0?(this.logger.infoSync(`Found ${e.length} items in sync queue, starting sync service`),this.startSyncLoop()):this.logger.debugSync("No items in sync queue, sync service will remain idle")}catch(e){this.logger.errorSync("Error checking sync queue:",e)}}startSyncLoop(){if(this.isRunning){this.logger.debugSync("Background sync service is already running, skipping start");return}this.isRunning=!0,this.logger.infoSync("Starting background sync loop"),this.currentBackoffMs=this.SYNC_INTERVAL_MS,this.consecutiveEmptyRuns=0,this.syncInterval=setInterval(()=>{this.processSyncQueue().catch(e=>{this.logger.errorSync("Error in background sync:",e)})},this.currentBackoffMs),this.processSyncQueue().catch(e=>{this.logger.errorSync("Error in initial sync:",e)})}stopSyncLoop(){this.isRunning&&(this.isRunning=!1,this.logger.infoSync("Stopping background sync loop (service remains started)"),this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null))}stop(){if(!this.isStarted){this.logger.infoSync("Background sync service is not started");return}this.isStarted=!1,this.logger.infoSync("Stopping background sync service completely"),this.stopSyncLoop(),this.teardownConnectionMonitoring(),this.currentBackoffMs=this.SYNC_INTERVAL_MS,this.consecutiveEmptyRuns=0,this.isProcessingConnectionChange=!1}setupConnectionMonitoring(){this.connectionChangeListener=e=>{this.connectionChangeTimeout&&clearTimeout(this.connectionChangeTimeout),this.connectionChangeTimeout=setTimeout(()=>{this.handleConnectionChange(e)},500)},this.connectionMonitor.onConnectionChange(this.connectionChangeListener)}async handleConnectionChange(e){if(this.isProcessingConnectionChange){this.logger.debugSync("Already processing connection change, skipping");return}this.isProcessingConnectionChange=!0;try{e.isOnline&&this.isStarted&&!this.isRunning?(this.logger.infoSync("Connection restored, checking for sync queue items"),await this.checkAndStartSync()):!e.isOnline&&this.isRunning&&(this.logger.infoSync("Connection lost, pausing sync service"),this.stopSyncLoop())}catch(t){this.logger.errorSync("Error handling connection change:",t)}finally{this.isProcessingConnectionChange=!1}}teardownConnectionMonitoring(){this.connectionChangeTimeout&&(clearTimeout(this.connectionChangeTimeout),this.connectionChangeTimeout=null),this.connectionChangeListener&&(this.connectionMonitor.removeConnectionListener(this.connectionChangeListener),this.connectionChangeListener=null)}async processSyncQueue(){try{if(!this.connectionMonitor.isOnline()){this.logger.debugSync("Offline, skipping sync queue processing");return}this.logger.infoSync("Processing sync queue...");const e=await this.listController.getSyncQueueItems();if(e.length===0){this.logger.debugSync("No sync queue items to process"),this.handleEmptyQueue();return}this.consecutiveEmptyRuns=0,this.currentBackoffMs=this.SYNC_INTERVAL_MS,this.logger.infoSync(`Processing ${e.length} sync queue items`);const t=this.groupOperationsByList(e);for(const[a,o]of t)try{await this.processListOperations(a,o)}catch(c){this.logger.errorSync(`Failed to process operations for list ${a}:`,c)}this.logger.infoSync("Finished processing sync queue"),(await this.listController.getSyncQueueItems()).length===0&&(this.logger.infoSync("Sync queue is now empty, stopping sync loop"),this.stopSyncLoop())}catch(e){throw this.logger.errorSync("Error processing sync queue:",e),e}}handleEmptyQueue(){this.consecutiveEmptyRuns++,this.consecutiveEmptyRuns>3&&(this.currentBackoffMs=Math.min(this.currentBackoffMs*1.5,this.MAX_BACKOFF_MS),this.logger.debugSync(`Empty queue run ${this.consecutiveEmptyRuns}, increasing backoff to ${this.currentBackoffMs}ms`)),this.consecutiveEmptyRuns>10&&(this.logger.infoSync("Too many empty queue runs, stopping sync loop"),this.stopSyncLoop())}groupOperationsByList(e){const t=new Map;for(const n of e)t.has(n.listUUID)||t.set(n.listUUID,[]),t.get(n.listUUID).push(n);return t}async processListOperations(e,t){this.logger.infoSync(`Processing ${t.length} operations for list ${e}`);const n=t.sort((o,c)=>{const d={LIST_CREATE:1,YJS_UPDATE:2,LIST_DELETE:3,LIST_LEAVE:4},h=d[o.operationType],g=d[c.operationType];return h!==g?h-g:o.addedDate.getTime()-c.addedDate.getTime()});this.logger.infoSync(`Sorted operations for list ${e}:`,n.map(o=>`${o.operationType} (${o.uuid})`));const a=this.optimizeOperations(n);this.logger.infoSync(`Optimized ${t.length} operations to ${a.length} for list ${e}`);for(const o of a)try{await this.processSyncQueueItem(o)}catch(c){throw this.logger.errorSync(`Failed to process optimized operation ${o.uuid} for list ${e}:`,c),c}}optimizeOperations(e){const t=[];let n=!1;for(const a of e)if(a.operationType==="LIST_DELETE"){this.logger.infoSync(`Optimizing: Found DELETE operation, removing ${t.length} previous operations`),t.length=0,t.push(a),n=!0;break}else a.operationType==="LIST_CREATE"?t.push(a):a.operationType==="YJS_UPDATE"&&(n?this.logger.infoSync(`Optimizing: Skipping YJS_UPDATE ${a.uuid} because DELETE operation exists`):t.push(a));return t}async processSyncQueueItem(e){try{switch(this.logger.infoSync(`Processing sync queue item: ${e.uuid} (${e.operationType})`),e.operationType){case"YJS_UPDATE":await this.processYjsUpdate(e);break;case"LIST_CREATE":await this.processListCreate(e);break;case"LIST_DELETE":await this.processListDelete(e);break;case"LIST_LEAVE":await this.processListLeave(e);break;default:throw new Error(`Unknown operation type: ${e.operationType}`)}await this.listController.removeSyncQueueItem(e.uuid),this.logger.infoSync(`Successfully processed sync queue item: ${e.uuid} (${e.operationType})`)}catch(t){throw this.logger.errorSync(`Failed to process sync queue item ${e.uuid}:`,t),t}}async processYjsUpdate(e){if(!e.data)throw new Error("YJS update item must have data");this.logger.infoSync(`Pushing YJS update to remote storage: ${e.uuid} for list: ${e.listUUID}`);const t=await this.listController.getClientId();await this.remoteStorageService.pushUpdate(e.listUUID,{id:e.uuid,yjsDocumentId:e.listUUID,clientId:t,data:e.data,timestamp:e.addedDate}),this.logger.infoSync(`Successfully pushed YJS update to remote storage: ${e.uuid}`)}async processListCreate(e){this.logger.infoSync(`Creating list in remote storage: ${e.listUUID}`),await this.remoteStorageService.createList(e.listUUID),this.logger.infoSync(`Successfully created list in remote storage: ${e.listUUID}`)}async processListDelete(e){await this.remoteStorageService.deleteList(e.listUUID)}async processListLeave(e){await this.remoteStorageService.removeParticipant(e.listUUID)}async forceSync(){this.logger.infoSync("Forcing sync..."),await this.processSyncQueue()}async triggerSync(){if(!this.isStarted){this.logger.debugSync("Sync service not started, ignoring trigger");return}if(!this.connectionMonitor.isOnline()){this.logger.debugSync("Offline, ignoring sync trigger");return}this.isRunning?this.logger.debugSync("Sync service already running, will process new items on next cycle"):(this.logger.infoSync("Items added to sync queue, starting sync service"),await this.checkAndStartSync())}isServiceRunning(){return this.isRunning}isServiceStarted(){return this.isStarted}}class T2{constructor(e,t,n){this.listController=e,this.realtimeService=t,this.logger=n}isSubscribed=!1;async start(){if(this.isSubscribed){this.logger.infoSync("Remote update handler is already subscribed");return}this.logger.infoSync("Starting remote update handler");try{this.realtimeService.subscribeToCRDTUpdates(async e=>{try{const t=await this.listController.getClientId();if(e.record.client_id===t){this.logger.debugSync(`Ignoring update from our own client ID: ${t}`);return}const n=e.record.yjs_document_id,a=new Uint8Array(e.record.update_data),o=new Date(e.record.created_at);this.logger.infoSync(`Received remote update for list: ${n} from client: ${e.record.client_id}`),await this.listController.applyRemoteUpdate(n,a,o)}catch(t){this.logger.errorSync("Failed to apply remote update:",t)}}),this.realtimeService.subscribeToListUpdates(async e=>{console.log(">>>>>>>>>RealtimeUpdate",e);try{if(e.eventType==="INSERT"&&e.record){const t=e.record.yjs_document_id;this.logger.infoSync(`Received remote list creation for: ${t}`),await this.listController.handleRemoteListCreation(t)}else if(e.eventType==="UPDATE"&&e.record){const t=e.record.yjs_document_id;e.record.deleted_by||e.record.deleted_at?(this.logger.infoSync(`Received remote list deletion for: ${t} (deleted_by: ${e.record.deleted_by}, deleted_at: ${e.record.deleted_at})`),await this.listController.handleRemoteListDeletion(t)):this.logger.debugSync(`Received list update (not deletion) for: ${t}`)}}catch(t){this.logger.errorSync("Failed to handle list update:",t)}}),this.isSubscribed=!0,this.logger.infoSync("Remote update handler started successfully")}catch(e){throw this.logger.errorSync("Failed to start remote update handler:",e),e}}stop(){if(!this.isSubscribed){this.logger.infoSync("Remote update handler is not subscribed");return}this.logger.infoSync("Stopping remote update handler"),this.isSubscribed=!1}isHandlerSubscribed(){return this.isSubscribed}}class io{static instance;logger;realtimeService;connectionState={browserOnline:navigator.onLine,realtimeConnected:!1,isOnline:!1,lastUpdate:new Date};listeners=[];isStarted=!1;browserOnlineHandler;browserOfflineHandler;realtimeConnectionHandler;constructor(e,t){this.logger=e,this.realtimeService=t,this.browserOnlineHandler=()=>this.handleBrowserOnline(),this.browserOfflineHandler=()=>this.handleBrowserOffline(),this.realtimeConnectionHandler=n=>this.handleRealtimeConnectionChange(n)}static getInstance(e,t){return io.instance||(io.instance=new io(e,t)),io.instance}start(){if(this.isStarted){this.logger.infoSync("Connection monitor is already started");return}this.logger.infoSync("Starting connection monitor..."),window.addEventListener("online",this.browserOnlineHandler),window.addEventListener("offline",this.browserOfflineHandler),this.realtimeService.onConnectionChange(this.realtimeConnectionHandler);const e=this.realtimeService.isConnected();this.logger.infoSync("Initial connection state:",{browserOnline:navigator.onLine,realtimeConnected:e}),this.updateConnectionState({browserOnline:navigator.onLine,realtimeConnected:e}),this.isStarted=!0,this.logger.infoSync("Connection monitor started successfully")}stop(){if(!this.isStarted){this.logger.infoSync("Connection monitor is not started");return}this.logger.infoSync("Stopping connection monitor..."),window.removeEventListener("online",this.browserOnlineHandler),window.removeEventListener("offline",this.browserOfflineHandler),this.realtimeService.removeConnectionListener(this.realtimeConnectionHandler),this.isStarted=!1,this.logger.infoSync("Connection monitor stopped")}getConnectionState(){return{...this.connectionState}}isOnline(){return this.connectionState.isOnline}onConnectionChange(e){this.listeners.push(e)}removeConnectionListener(e){const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}handleBrowserOnline(){this.logger.infoSync("Browser went online"),this.updateConnectionState({browserOnline:!0,realtimeConnected:this.connectionState.realtimeConnected})}handleBrowserOffline(){this.logger.infoSync("Browser went offline"),this.updateConnectionState({browserOnline:!1,realtimeConnected:this.connectionState.realtimeConnected})}handleRealtimeConnectionChange(e){this.logger.infoSync(`Realtime service ${e?"connected":"disconnected"}`),this.updateConnectionState({browserOnline:this.connectionState.browserOnline,realtimeConnected:e})}updateConnectionState(e){const t={...this.connectionState};this.connectionState={...this.connectionState,...e,lastUpdate:new Date};const n=this.connectionState.isOnline;this.connectionState.isOnline=this.connectionState.browserOnline&&this.connectionState.realtimeConnected,this.logger.infoSync("Connection state update:",{browserOnline:this.connectionState.browserOnline,realtimeConnected:this.connectionState.realtimeConnected,isOnline:this.connectionState.isOnline,wasOnline:n}),t.isOnline!==this.connectionState.isOnline&&this.logger.infoSync(`Connection state changed: ${t.isOnline?"online":"offline"} -> ${this.connectionState.isOnline?"online":"offline"}`),this.listeners.forEach(a=>{try{a(this.connectionState)}catch(o){this.logger.errorSync("Error in connection change listener:",o)}})}}class D2{storage;constructor(e){this.storage=e}async getList(e){return this.storage.get(e)}async getAllLists(){return this.storage.getAll()}async saveList(e){await this.storage.save(e)}async deleteList(e){await this.storage.delete(e)}async clearAllLists(){await this.storage.clear()}}class k2{storage;constructor(e){this.storage=e}async getMetadata(e){return this.storage.get(e)}async getAllMetadata(){return this.storage.getAll()}async saveMetadata(e){await this.storage.save(e)}async deleteMetadata(e){await this.storage.delete(e)}async clearAllMetadata(){await this.storage.clear()}async getValue(e){return(await this.getMetadata(e))?.value||null}async setValue(e,t){const n={key:e,value:t};await this.saveMetadata(n)}}class A2{storage;constructor(e){this.storage=e}async getSyncQueueItem(e){return this.storage.get(e)}async getAllSyncQueueItems(){return this.storage.getAll()}async saveSyncQueueItem(e){await this.storage.save(e)}async deleteSyncQueueItem(e){await this.storage.delete(e)}async clearAllSyncQueueItems(){await this.storage.clear()}async getSyncQueueItemsForList(e){return(await this.getAllSyncQueueItems()).filter(n=>n.listUUID===e)}async getSyncQueueItemsAfterDate(e){return(await this.getAllSyncQueueItems()).filter(n=>n.addedDate>e)}async addSyncQueueItem(e,t,n="YJS_UPDATE"){const a=new Date,o={uuid:Kn(),listUUID:e,operationType:n,data:t,addedDate:new Date(a.getTime()-a.getTimezoneOffset()*6e4)};return await this.saveSyncQueueItem(o),o}async addYjsUpdateItem(e,t){return this.addSyncQueueItem(e,t,"YJS_UPDATE")}async addListCreateItem(e){return this.addSyncQueueItem(e,null,"LIST_CREATE")}async addListDeleteItem(e){return this.addSyncQueueItem(e,null,"LIST_DELETE")}async addListLeaveItem(e){return this.addSyncQueueItem(e,null,"LIST_LEAVE")}async clearSyncQueueItemsForList(e){const t=await this.getSyncQueueItemsForList(e);for(const n of t)await this.deleteSyncQueueItem(n.uuid)}}const pS={auth:{type:"supabase",url:"https://mrswwgwyslyqsuwzkpvg.supabase.co",apiKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1yc3d3Z3d5c2x5cXN1d3prcHZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwMzI0OTQsImV4cCI6MjA3MjYwODQ5NH0.-LMk9iqBu5h4jtAqVyoL3zdUv363HHNlWnw793hPQ88"},localStorage:{type:"indexeddb"},remoteStorage:{type:"supabase"},realtime:{type:"supabase"},logging:{type:"posthog",level:St.ERROR,enabled:!0}};function R2(){return{...pS,auth:{...pS.auth,url:"https://mrswwgwyslyqsuwzkpvg.supabase.co",apiKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1yc3d3Z3d5c2x5cXN1d3prcHZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwMzI0OTQsImV4cCI6MjA3MjYwODQ5NH0.-LMk9iqBu5h4jtAqVyoL3zdUv363HHNlWnw793hPQ88"}}}function O2(s){const e=[];return s.auth.type==="supabase"&&(s.auth.url||e.push("Supabase URL is required when using Supabase backend"),s.auth.apiKey||e.push("Supabase API key is required when using Supabase backend")),s.logging.type,e}class gt{static instance;config;authServiceInstance;eventServiceInstance;remoteStorageServiceInstance;realtimeServiceInstance;listControllerInstance;logServiceInstance;yjsListManagerInstance;backgroundSyncServiceInstance;remoteUpdateHandlerInstance;connectionMonitorInstance;listRepositoryInstance;metadataRepositoryInstance;syncQueueRepositoryInstance;constructor(){this.config=R2();const e=O2(this.config);if(e.length>0)throw this.getLogService().errorSync("Configuration validation errors:",e),new Error(`Configuration validation failed: ${e.join(", ")}`)}static getInstance(){return gt.instance||(gt.instance=new gt),gt.instance}getConfig(){return this.config}updateConfig(e){this.config={...this.config,...e},this.authServiceInstance=void 0,this.realtimeServiceInstance=void 0}getAuthService(){if(!this.authServiceInstance)switch(this.config.auth.type){case"supabase":if(!this.config.auth.url||!this.config.auth.apiKey)throw new Error("Supabase URL and API key are required for authentication");this.authServiceInstance=new Le(this.config.auth.url,this.config.auth.apiKey,this.getLogService());break;default:throw new Error(`Unsupported auth type: ${this.config.auth.type}`)}return this.authServiceInstance}getEventService(){return this.eventServiceInstance||(this.eventServiceInstance=new QR(this.getLogService())),this.eventServiceInstance}getRemoteStorageService(){if(!this.remoteStorageServiceInstance)switch(this.config.remoteStorage.type){case"supabase":if(!this.config.auth.url||!this.config.auth.apiKey)throw new Error("Supabase URL and API key are required for remote storage");this.remoteStorageServiceInstance=new hj(this.config.auth.url,this.config.auth.apiKey,this.getLogService());break;default:throw new Error(`Unsupported remote storage type: ${this.config.remoteStorage.type}`)}return this.remoteStorageServiceInstance}getRealtimeService(){if(!this.realtimeServiceInstance)switch(this.config.realtime.type){case"supabase":if(!this.config.auth.url||!this.config.auth.apiKey)throw new Error("Supabase URL and API key are required for realtime service");this.realtimeServiceInstance=new fj(this.config.auth.url,this.config.auth.apiKey,this.getLogService());break;default:throw new Error(`Unsupported realtime type: ${this.config.realtime.type}`)}return this.realtimeServiceInstance}getLogService(){if(!this.logServiceInstance)switch(this.config.logging.type){case"console":this.logServiceInstance=new pj(this.config.logging.level);break;case"posthog":this.logServiceInstance=new C2(this.config.logging.level);break;default:throw new Error(`Unsupported log type: ${this.config.logging.type}`)}return this.logServiceInstance}getYjsListManager(){if(!this.yjsListManagerInstance){const e=this.getLogService();this.yjsListManagerInstance=new GR(e)}return this.yjsListManagerInstance}getListController(){if(!this.listControllerInstance){const e=this.getYjsListManager(),t=this.getEventService(),n=this.getLogService(),a=this.getRemoteStorageService(),o=this.getConnectionMonitor(),c=this.getListRepository(),d=this.getSyncQueueRepository(),h=this.getMetadataRepository();this.listControllerInstance=new gj(e,t,n,a,o,c,d,h)}return this.listControllerInstance}getBackgroundSyncService(){if(!this.backgroundSyncServiceInstance){const e=this.getListController(),t=this.getRemoteStorageService(),n=this.getLogService(),a=this.getConnectionMonitor();this.backgroundSyncServiceInstance=no.getInstance(e,t,n,a)}return this.backgroundSyncServiceInstance}getRemoteUpdateHandler(){if(!this.remoteUpdateHandlerInstance){const e=this.getListController(),t=this.getRealtimeService(),n=this.getLogService();this.remoteUpdateHandlerInstance=new T2(e,t,n)}return this.remoteUpdateHandlerInstance}getConnectionMonitor(){if(!this.connectionMonitorInstance){const e=this.getLogService(),t=this.getRealtimeService();this.connectionMonitorInstance=io.getInstance(e,t)}return this.connectionMonitorInstance}getListRepository(){if(!this.listRepositoryInstance){const e=this.createLocalStorage("lists");this.listRepositoryInstance=new D2(e)}return this.listRepositoryInstance}getMetadataRepository(){if(!this.metadataRepositoryInstance){const e=this.createLocalStorage("metadata");this.metadataRepositoryInstance=new k2(e)}return this.metadataRepositoryInstance}getSyncQueueRepository(){if(!this.syncQueueRepositoryInstance){const e=this.createLocalStorage("syncQueue");this.syncQueueRepositoryInstance=new A2(e)}return this.syncQueueRepositoryInstance}createLocalStorage(e){switch(this.config.localStorage.type){case"indexeddb":return new dj(e);default:throw new Error(`Unsupported localStorage type: ${this.config.localStorage.type}`)}}async clearAllData(){try{const e=this.getLogService();e.infoSync("Starting to clear all local data..."),await this.getListController().clearAllData(),e.infoSync("Cleared all local data"),this.reset()}catch(e){throw this.getLogService().errorSync("Error during sign out:",e),e}}reset(){const e=this.getLogService();e.infoSync("Resetting all service instances..."),this.authServiceInstance=void 0,this.eventServiceInstance=void 0,this.remoteStorageServiceInstance=void 0,this.realtimeServiceInstance=void 0,this.listControllerInstance=void 0,this.logServiceInstance=void 0,this.yjsListManagerInstance=void 0,this.backgroundSyncServiceInstance=void 0,this.remoteUpdateHandlerInstance=void 0,this.connectionMonitorInstance=void 0,this.listRepositoryInstance=void 0,this.metadataRepositoryInstance=void 0,this.syncQueueRepositoryInstance=void 0,e.infoSync("All service instances reset")}async cleanupLeftoverDatabases(){try{const e=this.getLogService();e.infoSync("Attempting to clean up leftover databases...");try{await this.getListController().clearAllData(),e.infoSync("Successfully cleared leftover sync metadata")}catch(t){e.infoSync("Could not clear sync metadata (may not exist or be in use):",t)}e.infoSync("Completed leftover database cleanup attempt")}catch(e){this.getLogService().errorSync("Error during leftover database cleanup:",e)}}}const L2=Object.freeze(Object.defineProperty({__proto__:null,ServiceContainer:gt},Symbol.toStringTag,{value:"Module"}));function hi(){const[s,e]=C.useState({user:null,loading:!0,error:null}),t=gt.getInstance().getAuthService(),n=gt.getInstance().getLogService(),a=ni();C.useEffect(()=>{let E=!0;const S=t.onAuthStateChange(O=>{E&&(e($=>({...$,user:O,loading:!1,error:null})),O&&gt.getInstance().getRemoteStorageService().setUserId(O.id).catch(U=>{n.errorSync("Failed to set user ID in remote storage:",U)}))});return(async()=>{try{const O=await t.getCurrentUser();E&&e($=>({...$,user:O,loading:!1}))}catch(O){E&&e($=>({...$,error:O instanceof Error?O.message:"Authentication error",loading:!1}))}})(),()=>{E=!1,S()}},[t]);const o=C.useCallback(async E=>{e(S=>({...S,loading:!0,error:null}));try{const S=await t.signUp(E);return e(T=>({...T,user:S,loading:!1,error:null})),S}catch(S){const T=S instanceof Error?S.message:"Sign up failed";throw e(O=>({...O,loading:!1,error:T})),S}},[t]),c=C.useCallback(async E=>{e(S=>({...S,loading:!0,error:null}));try{try{await gt.getInstance().getListController().clearAllData()}catch(T){console.log("Database cleanup on sign in failed (this is normal):",T)}const S=await t.signIn(E);return e(T=>({...T,user:S,loading:!1,error:null})),S}catch(S){const T=S instanceof Error?S.message:"Sign in failed";throw e(O=>({...O,loading:!1,error:T})),S}},[t]),d=C.useCallback(async()=>{e(E=>({...E,loading:!0,error:null}));try{try{await t.signOut()}catch(S){console.log("Auth signOut failed (session may already be expired):",S)}await gt.getInstance().clearAllData(),e(S=>({...S,user:null,loading:!1,error:null})),a("/signout")}catch(E){const S=E instanceof Error?E.message:"Sign out failed";throw e(T=>({...T,loading:!1,error:S})),E}},[t,a]),h=C.useCallback(async E=>{e(S=>({...S,loading:!0,error:null}));try{const S=await t.updateProfile(E);return e(T=>({...T,user:S,loading:!1,error:null})),S}catch(S){const T=S instanceof Error?S.message:"Profile update failed";throw e(O=>({...O,loading:!1,error:T})),S}},[t]),g=C.useCallback(async E=>{e(S=>({...S,loading:!0,error:null}));try{await t.resetPassword(E),e(S=>({...S,loading:!1,error:null}))}catch(S){const T=S instanceof Error?S.message:"Password reset failed";throw e(O=>({...O,loading:!1,error:T})),S}},[t]),p=C.useCallback(async E=>{e(S=>({...S,loading:!0,error:null}));try{const S=await t.updatePassword(E);return e(T=>({...T,user:S,loading:!1,error:null})),S}catch(S){const T=S instanceof Error?S.message:"Password update failed";throw e(O=>({...O,loading:!1,error:T})),S}},[t]),m=C.useCallback(()=>t.hasRecoverySession(),[t]),y=C.useCallback(()=>{t.clearRecoverySession()},[t]),_=C.useCallback(()=>{e(E=>({...E,error:null}))},[]);return{...s,signUp:o,signIn:c,signOut:d,updateProfile:h,resetPassword:g,updatePassword:p,hasRecoverySession:m,clearRecoverySession:y,clearError:_}}function d1(){const e=gt.getInstance().getEventService(),t=C.useRef([]);C.useEffect(()=>()=>{t.current.forEach(c=>c()),t.current=[]},[]);const n=C.useCallback((c,d)=>{const h=e.subscribe(c,d);return t.current.push(h),h},[e]),a=C.useCallback(c=>{const d=e.subscribeToListEvents(c);return t.current.push(d),d},[e]),o=C.useCallback(c=>{e.publish(c)},[e]);return{subscribe:n,subscribeToListEvents:a,publish:o}}function j2(s){const{subscribeToListEvents:e}=d1();C.useEffect(()=>e(s),[s,e])}function N2(){const[s,e]=C.useState([]),[t,n]=C.useState(!0),[a,o]=C.useState(null),c=gt.getInstance(),d=c.getListController(),h=c.getLogService(),g=c.getEventService(),{subscribe:p}=d1(),m=C.useCallback(async()=>{try{n(!0),o(null),h.debugSync("useSortedLists: Loading all lists");const _=await d.getAllLists();e(_),h.debugSync(`useSortedLists: Loaded ${_.length} lists`)}catch(_){const E=_ instanceof Error?_.message:"Unknown error";h.errorSync("useSortedLists: Failed to load lists:",_),o(E)}finally{n(!1)}},[d,h]),y=C.useMemo(()=>[...s].sort((_,E)=>{const S=_.updatedAt?.getTime()||_.createdAt?.getTime()||0;return(E.updatedAt?.getTime()||E.createdAt?.getTime()||0)-S}),[s]);return C.useEffect(()=>{m()},[m]),C.useEffect(()=>{if(!g){h.warnSync("useSortedLists: EventService not ready, skipping subscription setup");return}const _=[],E=(A,Y)=>{try{return g.subscribe(A,Y)}catch(Z){return h.errorSync(`Failed to subscribe to ${A}:`,Z),()=>{}}},S=E(ye.LIST_CREATED,async A=>{try{const Y=A.payload;h.debugSync(`useSortedLists: Received list_created event for list ${Y.listId}`),await m()}catch(Y){h.errorSync("Error handling list_created event:",Y)}}),T=E(ye.LIST_DELETED,async A=>{try{const Y=A.payload;h.debugSync(`useSortedLists: Received list_deleted event for list ${Y.listId}`),e(Z=>Z.filter(J=>J.id!==Y.listId))}catch(Y){h.errorSync("Error handling list_deleted event:",Y)}}),O=E(ye.BOOTSTRAP_COMPLETED,async()=>{try{h.debugSync("useSortedLists: Received bootstrap completion, refreshing lists"),await m()}catch(A){h.errorSync("Error handling bootstrap_completed event:",A)}}),$=p(ye.LIST_CREATED,async A=>{try{const Y=A.payload;h.debugSync(`useSortedLists: Received event list_created event for list ${Y.listId}`),await m()}catch(Y){h.errorSync("Error handling remote list_created event:",Y)}}),L=p(ye.LIST_DELETED,async A=>{try{const Y=A.payload;h.debugSync(`useSortedLists: Received event list_deleted event for list ${Y.listId}`),e(Z=>Z.filter(J=>J.id!==Y.listId))}catch(Y){h.errorSync("Error handling remote list_deleted event:",Y)}}),U=E(ye.LIST_METADATA_CHANGED,async A=>{try{const Y=A.payload;h.debugSync(`useSortedLists: Received list_metadata_changed event for list ${Y.listId}`);const Z=await d.getList(Y.listId);Z&&e(J=>[...J.filter(ee=>ee.id!==Y.listId),Z])}catch(Y){h.errorSync("useSortedLists: Failed to reload updated list:",Y)}});return _.push(S,T,O,$,L,U),h.debugSync("useSortedLists: Successfully set up all event subscriptions"),()=>{h.debugSync("useSortedLists: Cleaning up event subscriptions"),_.forEach(A=>A())}},[g,h,p,d]),{lists:y,isLoading:t,error:a,refreshLists:m}}const ch=({isOpen:s,onClose:e,title:t,children:n})=>(C.useEffect(()=>{const a=o=>{o.key==="Escape"&&e()};return s&&(document.addEventListener("keydown",a),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",a),document.body.style.overflow="unset"}},[s,e]),s?w.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[w.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:e}),w.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[w.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[w.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:t}),w.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:""})]}),w.jsx("div",{className:"p-6",children:n})]})]}):null),Gl=({isOpen:s,onClose:e,onConfirm:t,title:n,message:a,confirmText:o="Delete",cancelText:c="Cancel",isDeleting:d=!1})=>w.jsx(ch,{isOpen:s,onClose:e,title:n,children:w.jsxs("div",{className:"space-y-4",children:[w.jsx("p",{className:"text-gray-700",children:a}),w.jsxs("div",{className:"flex gap-3 justify-end",children:[w.jsx("button",{onClick:e,disabled:d,className:"btn btn-secondary",children:c}),w.jsx("button",{onClick:t,disabled:d,className:"btn btn-danger",children:d?"Deleting...":o})]})]})}),gv=({completedItems:s,totalItems:e,showLabel:t=!0,showProgressBar:n=!0,className:a=""})=>{const o=e>0?s/e*100:0;return w.jsxs("div",{className:`${a}`,children:[t&&w.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-2",children:[w.jsx("span",{children:"Progress"}),w.jsxs("span",{className:"font-medium",children:[s," / ",e," completed"]})]}),n&&e>0&&w.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:w.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${o}%`}})})]})};function M2(s){const[e,t]=C.useState(null),[n,a]=C.useState(!0),[o,c]=C.useState(null),d=gt.getInstance(),h=d.getListController(),g=d.getLogService(),p=d.getEventService(),m=C.useCallback(async()=>{if(s)try{a(!0),c(null),g.debugSync(`useListSubscription: Loading list ${s}`);const y=await h.getList(s);t(y),y?g.debugSync(`useListSubscription: Loaded list ${s} with ${y.items.length} items`):g.debugSync(`useListSubscription: List ${s} not found`)}catch(y){const _=y instanceof Error?y.message:"Unknown error";g.errorSync(`useListSubscription: Failed to load list ${s}:`,y),c(_)}finally{a(!1)}},[s,h,g]);return C.useEffect(()=>{m()},[m]),C.useEffect(()=>{if(!s)return;const y=[],_=p.subscribe(ye.LIST_METADATA_CHANGED,async T=>{T.payload.listId===s&&(g.debugSync(`useListSubscription: Received metadata change for list ${s}, refreshing`),m())}),E=p.subscribe(ye.BOOTSTRAP_COMPLETED,async()=>{g.debugSync(`useListSubscription: Received bootstrap completion, refreshing list ${s}`),m()}),S=p.subscribe(ye.LIST_DELETED,async T=>{T.payload.listId===s&&(g.debugSync(`useListSubscription: List ${s} was deleted, clearing state`),t(null),a(!1))});return y.push(_,E,S),()=>{y.forEach(T=>T())}},[s,p,m,g]),{list:e,isLoading:n,error:o,refreshList:m}}const h1=C.memo(({listId:s,onDeleteClick:e,isOwner:t=!1})=>{const{list:n,isLoading:a,error:o}=M2(s),c=ni(),d=()=>{n&&c(`/list/${n.id}`)},h=g=>{g.stopPropagation(),n&&e({name:n.title,uuid:n.id})};return a?w.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 animate-pulse flex flex-col h-full",children:[w.jsxs("div",{className:"flex items-start justify-between mb-3 flex-1",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("div",{className:"h-5 bg-gray-200 rounded mb-2"}),w.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})]}),w.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded"})]}),w.jsx("div",{className:"h-2 bg-gray-200 rounded mt-auto"})]}):o?w.jsx("div",{className:"bg-red-50 rounded-lg border border-red-200 p-6 flex flex-col h-full",children:w.jsx("div",{className:"flex items-start justify-between mb-3 flex-1",children:w.jsxs("div",{className:"flex-1",children:[w.jsx("h3",{className:"text-lg font-medium text-red-900 mb-1",children:"Error loading list"}),w.jsx("p",{className:"text-sm text-red-600",children:o})]})})}):n?w.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer flex flex-col h-full",onClick:d,children:[w.jsxs("div",{className:"flex items-start justify-between mb-3 flex-1",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:n.title}),n.description&&w.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:n.description}),w.jsxs("p",{className:"text-sm text-gray-500",children:[n.createdAt&&`Created: ${n.createdAt.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}`,n.updatedAt&&n.updatedAt.getTime()!==n.createdAt?.getTime()&&w.jsxs("span",{className:"block",children:["Updated:"," ",n.updatedAt.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]})]})]}),t&&w.jsx("button",{onClick:h,className:"text-red-500 hover:text-red-700 p-1",title:"Delete list",children:""})]}),w.jsx(gv,{completedItems:n.statistics.completedItems,totalItems:n.statistics.totalItems,className:"mt-auto"})]}):null});h1.displayName="ListItem";function f1({isOpen:s,onClose:e,onSuccess:t}){const[n,a]=C.useState(""),[o,c]=C.useState(""),[d,h]=C.useState(!1),g=ni(),p=gt.getInstance(),m=p.getLogService(),y=p.getListController(),_=async()=>{if(n.trim())try{h(!0);const S=await y.createList(n.trim(),o.trim()||void 0);a(""),c(""),e(),t&&t(),m.infoSync("List created successfully from header"),g(`/list/${S}`)}catch(S){m.errorSync("Error creating list from header:",S)}finally{h(!1)}},E=()=>{a(""),c(""),e()};return w.jsx(ch,{isOpen:s,onClose:E,title:"Create New List",children:w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{htmlFor:"listName",className:"block text-sm font-medium text-gray-700 mb-2",children:"List Name"}),w.jsx("input",{id:"listName",type:"text",value:n,onChange:S=>a(S.target.value),onKeyDown:S=>S.key==="Enter"&&_(),placeholder:"Enter list name...",className:"input",autoFocus:!0})]}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"listDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),w.jsx("textarea",{id:"listDescription",value:o,onChange:S=>c(S.target.value),placeholder:"Enter list description...",className:"input min-h-[80px] resize-none",rows:3})]}),w.jsxs("div",{className:"flex gap-2 justify-end",children:[w.jsx("button",{onClick:E,className:"btn btn-secondary",children:"Cancel"}),w.jsx("button",{onClick:_,disabled:!n.trim()||d,className:"btn btn-primary",children:d?"Creating...":"Create List"})]})]})})}const U2=()=>{const[s,e]=C.useState(!1),[t,n]=C.useState(!1),[a,o]=C.useState(null),[c,d]=C.useState(!1),{user:h}=hi(),{lists:g,isLoading:p,error:m}=N2(),y=gt.getInstance(),_=y.getLogService(),E=y.getListController(),S=$=>{o($),n(!0)},T=async()=>{if(a)try{d(!0),await E.deleteList(a.uuid),n(!1),o(null)}catch($){_.errorSync("Error deleting list:",$)}finally{d(!1)}},O=()=>{n(!1),o(null)};return w.jsxs("div",{className:"max-w-4xl mx-auto",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[w.jsxs("div",{children:[w.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"My Lists"}),h&&w.jsxs("p",{className:"text-gray-600",children:["Welcome, ",h.displayName||h.email]})]}),w.jsx("div",{className:"flex items-center gap-4",children:w.jsx("button",{onClick:()=>e(!0),className:"btn btn-primary",children:"Create New List"})})]}),w.jsx(f1,{isOpen:s,onClose:()=>e(!1)}),w.jsx(Gl,{isOpen:t,onClose:O,onConfirm:T,title:"Delete List",message:`Are you sure you want to delete "${a?.name||"this list"}" and all its items? This action cannot be undone.`,isDeleting:c}),p?w.jsxs("div",{className:"text-center py-12",children:[w.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),w.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:"Loading lists..."}),w.jsx("p",{className:"text-gray-600",children:"Please wait while we load your lists"})]}):m?w.jsxs("div",{className:"text-center py-12",children:[w.jsx("div",{className:"text-red-400 text-6xl mb-4",children:""}),w.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:"Error loading lists"}),w.jsx("p",{className:"text-gray-600",children:m})]}):g.length===0?w.jsxs("div",{className:"text-center py-12",children:[w.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),w.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:"No lists yet"}),w.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first list to get started"}),w.jsx("button",{onClick:()=>e(!0),className:"btn btn-primary",children:"Create Your First List"})]}):w.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:g.map($=>w.jsx(h1,{listId:$.id,onDeleteClick:S,isOwner:h?.id===$.ownerId},$.id))})]})};function $2(s,e){let t;return(...n)=>{clearTimeout(t),t=setTimeout(()=>s(...n),e)}}function I2(s){const[e,t]=C.useState(null),[n,a]=C.useState(!0),[o,c]=C.useState(null),[d,h]=C.useState(!1),[g,p]=C.useState(!1),[m,y]=C.useState(!1),[_,E]=C.useState(!1),[S,T]=C.useState(!1),[O,$]=C.useState(!1),L=gt.getInstance(),U=L.getListController(),A=L.getLogService(),Y=L.getEventService(),Z=C.useCallback(async()=>{if(s)try{a(!0),c(null),A.infoSync(`useNewList: Loading list ${s}`);const V=await U.getList(s);t(V),V?A.infoSync(`useNewList: Loaded list ${s}: ${V.title}`):c("List not found")}catch(V){A.errorSync(`useNewList: Error loading list ${s}:`,V),c(V instanceof Error?V.message:"Failed to load list")}finally{a(!1)}},[s,U,A]),J=C.useMemo(()=>$2(Z,300),[Z]),fe=C.useCallback(async V=>{if(!s||!e)return;const D=VR(),z={id:D,content:V,isCompleted:!1,isOptimistic:!0,tempId:D},F=e;try{p(!0),c(null),t(P=>({...P,items:[...P.items,z]})),A.infoSync(`useNewList: Adding item to list ${s}: ${V}`),await U.addItem(s,V),A.infoSync(`useNewList: Added item to list ${s}`)}catch(P){throw A.errorSync(`useNewList: Error adding item to list ${s}:`,P),t(F),c(`Failed to add item: ${P instanceof Error?P.message:"Unknown error"}`),setTimeout(()=>c(null),3e3),P}finally{p(!1)}},[s,e,U,A]),ee=C.useCallback(async(V,D)=>{if(!s||!e)return;if(!e.items.find(P=>P.id===V))throw new Error(`Item with ID ${V} not found`);const F=e;try{y(!0),c(null),t(P=>({...P,items:P.items.map(W=>W.id===V?{...W,content:D.content}:W)})),A.infoSync(`useNewList: Updating item ${V} in list ${s}: ${D.content}`),await U.editItem(s,V,D.content),A.infoSync(`useNewList: Updated item ${V} in list ${s}`)}catch(P){throw A.errorSync(`useNewList: Error updating item ${V} in list ${s}:`,P),t(F),c(`Failed to update item: ${P instanceof Error?P.message:"Unknown error"}`),setTimeout(()=>c(null),3e3),P}finally{y(!1)}},[s,e,U,A]),ce=C.useCallback(async V=>{if(!s||!e)return;if(!e.items.find(F=>F.id===V))throw new Error(`Item with ID ${V} not found`);const z=e;try{E(!0),c(null),t(F=>({...F,items:F.items.filter(P=>P.id!==V)})),A.infoSync(`useNewList: Deleting item ${V} from list ${s}`),await U.deleteItem(s,V),A.infoSync(`useNewList: Deleted item ${V} from list ${s}`)}catch(F){throw A.errorSync(`useNewList: Error deleting item ${V} from list ${s}:`,F),t(z),c(`Failed to delete item: ${F instanceof Error?F.message:"Unknown error"}`),setTimeout(()=>c(null),3e3),F}finally{E(!1)}},[s,e,U,A]),de=C.useCallback(async V=>{if(!s||!e)return;if(!e.items.find(F=>F.id===V))throw new Error(`Item with ID ${V} not found`);const z=e;try{T(!0),c(null),t(F=>({...F,items:F.items.map(P=>P.id===V?{...P,isCompleted:!P.isCompleted}:P)})),A.infoSync(`useNewList: Toggling item ${V} in list ${s}`),await U.toggleItem(s,V),A.infoSync(`useNewList: Toggled item ${V} in list ${s}`)}catch(F){throw A.errorSync(`useNewList: Error toggling item ${V} in list ${s}:`,F),t(z),c(`Failed to toggle item: ${F instanceof Error?F.message:"Unknown error"}`),setTimeout(()=>c(null),3e3),F}finally{T(!1)}},[s,e,U,A]),Se=C.useCallback(async(V,D)=>{if(!s||!e)return;if(!e.items.find(P=>P.id===V))throw new Error(`Item with ID ${V} not found`);const F=e;try{$(!0),c(null),t(P=>{const W=[...P.items],ge=W.findIndex(ne=>ne.id===V);if(ge!==-1){const[ne]=W.splice(ge,1);W.splice(D,0,ne)}return{...P,items:W}}),A.infoSync(`useNewList: Moving item ${V} to position ${D} in list ${s}`),await U.moveItem(s,V,D),A.infoSync(`useNewList: Moved item ${V} to position ${D} in list ${s}`)}catch(P){throw A.errorSync(`useNewList: Error moving item ${V} in list ${s}:`,P),t(F),c(`Failed to move item: ${P instanceof Error?P.message:"Unknown error"}`),setTimeout(()=>c(null),3e3),P}finally{$(!1)}},[s,e,U,A]),Ue=C.useCallback(async V=>{if(!s||!e)return;const D=e;try{c(null),t(z=>({...z,...V})),A.infoSync(`useNewList: Editing metadata of list ${s}: ${JSON.stringify(V)}`),await U.editListMetadata(s,V),A.infoSync(`useNewList: Edited metadata of list ${s}: ${JSON.stringify(V)}`)}catch(z){throw A.errorSync(`useNewList: Error editing metadata of list ${s}:`,z),t(D),c(`Failed to edit metadata: ${z instanceof Error?z.message:"Unknown error"}`),setTimeout(()=>c(null),3e3),z}},[s,e,U,A]),xe=C.useCallback(async()=>{if(s)try{c(null),A.infoSync(`useNewList: Deleting list ${s}`),await U.deleteList(s),A.infoSync(`useNewList: Deleted list ${s}`)}catch(V){throw A.errorSync(`useNewList: Error deleting list ${s}:`,V),c(`Failed to delete list: ${V instanceof Error?V.message:"Unknown error"}`),setTimeout(()=>c(null),3e3),V}},[s,U,A]),H=C.useCallback(async()=>{if(!s||!e)return;const V=e;try{c(null),t(D=>({...D,items:D.items.filter(z=>!z.isCompleted)})),A.infoSync(`useNewList: Clearing completed items from list ${s}`),await U.clearCompletedItems(s),A.infoSync(`useNewList: Cleared completed items from list ${s}`)}catch(D){throw A.errorSync(`useNewList: Error clearing completed items from list ${s}:`,D),t(V),c(`Failed to clear completed items: ${D instanceof Error?D.message:"Unknown error"}`),setTimeout(()=>c(null),3e3),D}},[s,e,U,A]),K=C.useCallback(async()=>{if(s)try{c(null),A.infoSync(`useNewList: Leaving list ${s}`),await U.leaveList(s),A.infoSync(`useNewList: Left list ${s}`)}catch(V){throw A.errorSync(`useNewList: Error leaving list ${s}:`,V),c(`Failed to leave list: ${V instanceof Error?V.message:"Unknown error"}`),setTimeout(()=>c(null),3e3),V}},[s,U,A]);C.useEffect(()=>{Z()},[Z]);const re=C.useCallback(async V=>{try{switch(V.type){case ye.LIST_DELETED:A.infoSync(`useNewList: List ${s} was deleted remotely`),h(!0),t(null);break;case ye.LIST_LEFT:A.infoSync(`useNewList: List ${s} was left by user`),h(!0),t(null);break;case ye.ITEM_ADDED:{if(g){const D=V.payload;A.infoSync(`useNewList: Received ITEM_ADDED event for item ${D.itemId} while adding, replacing optimistic item`),t(z=>{if(!z)return z;const F=z.items.map(P=>P.isOptimistic&&P.content===D.content?{...P,id:D.itemId,isOptimistic:!1,tempId:void 0}:P);return{...z,items:F}})}else A.infoSync(`useNewList: List ${s} was changed (${V.type}), refreshing (debounced)`),J();break}case ye.ITEM_DELETED:case ye.ITEM_CONTENT_CHANGED:case ye.ITEM_COMPLETED:case ye.ITEM_UNCOMPLETED:case ye.ITEM_MOVED:{g||_||m||S||O?A.debugSync(`useNewList: Ignoring ${V.type} event as we're performing an optimistic operation`):(A.infoSync(`useNewList: List ${s} was changed (${V.type}), refreshing (debounced)`),J());break}case ye.LIST_METADATA_CHANGED:A.infoSync(`useNewList: List ${s} metadata changed (${V.type}), refreshing (debounced)`),J();break;default:break}}catch(D){A.errorSync(`useNewList: Error handling event ${V.type}:`,D)}},[s,A,g,_,m,S,O,J]);return j2(re),C.useEffect(()=>{const V=Y.subscribe(ye.BOOTSTRAP_COMPLETED,async()=>{try{A.infoSync(`useNewList: Received bootstrap_completed event for list ${s}, refreshing`),J()}catch(D){A.errorSync("useNewList: Error handling bootstrap_completed event:",D)}});return()=>{V()}},[Y,J,s,A]),C.useEffect(()=>{e&&h(!1)},[e]),{document:e,isLoading:n,error:o,wasDeletedRemotely:d,isAddingItem:g,isUpdatingItem:m,isDeletingItem:_,isTogglingItem:S,isMovingItem:O,addItem:fe,updateItem:ee,deleteItem:ce,toggleItem:de,moveItem:Se,editListMetadata:Ue,deleteList:xe,leaveList:K,clearCompletedItems:H,refreshList:Z}}function B2(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return C.useMemo(()=>n=>{e.forEach(a=>a(n))},e)}const uh=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Oo(s){const e=Object.prototype.toString.call(s);return e==="[object Window]"||e==="[object global]"}function cm(s){return"nodeType"in s}function En(s){var e,t;return s?Oo(s)?s:cm(s)&&(e=(t=s.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function um(s){const{Document:e}=En(s);return s instanceof e}function Lc(s){return Oo(s)?!1:s instanceof En(s).HTMLElement}function g1(s){return s instanceof En(s).SVGElement}function Lo(s){return s?Oo(s)?s.document:cm(s)?um(s)?s:Lc(s)||g1(s)?s.ownerDocument:document:document:document}const Ri=uh?C.useLayoutEffect:C.useEffect;function dm(s){const e=C.useRef(s);return Ri(()=>{e.current=s}),C.useCallback(function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e.current==null?void 0:e.current(...n)},[])}function z2(){const s=C.useRef(null),e=C.useCallback((n,a)=>{s.current=setInterval(n,a)},[]),t=C.useCallback(()=>{s.current!==null&&(clearInterval(s.current),s.current=null)},[]);return[e,t]}function _c(s,e){e===void 0&&(e=[s]);const t=C.useRef(s);return Ri(()=>{t.current!==s&&(t.current=s)},e),t}function jc(s,e){const t=C.useRef();return C.useMemo(()=>{const n=s(t.current);return t.current=n,n},[...e])}function Hd(s){const e=dm(s),t=C.useRef(null),n=C.useCallback(a=>{a!==t.current&&e?.(a,t.current),t.current=a},[]);return[t,n]}function pv(s){const e=C.useRef();return C.useEffect(()=>{e.current=s},[s]),e.current}let dp={};function Nc(s,e){return C.useMemo(()=>{if(e)return e;const t=dp[s]==null?0:dp[s]+1;return dp[s]=t,s+"-"+t},[s,e])}function p1(s){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return n.reduce((o,c)=>{const d=Object.entries(c);for(const[h,g]of d){const p=o[h];p!=null&&(o[h]=p+s*g)}return o},{...e})}}const uo=p1(1),bc=p1(-1);function P2(s){return"clientX"in s&&"clientY"in s}function hm(s){if(!s)return!1;const{KeyboardEvent:e}=En(s.target);return e&&s instanceof e}function q2(s){if(!s)return!1;const{TouchEvent:e}=En(s.target);return e&&s instanceof e}function vv(s){if(q2(s)){if(s.touches&&s.touches.length){const{clientX:e,clientY:t}=s.touches[0];return{x:e,y:t}}else if(s.changedTouches&&s.changedTouches.length){const{clientX:e,clientY:t}=s.changedTouches[0];return{x:e,y:t}}}return P2(s)?{x:s.clientX,y:s.clientY}:null}const wc=Object.freeze({Translate:{toString(s){if(!s)return;const{x:e,y:t}=s;return"translate3d("+(e?Math.round(e):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(s){if(!s)return;const{scaleX:e,scaleY:t}=s;return"scaleX("+e+") scaleY("+t+")"}},Transform:{toString(s){if(s)return[wc.Translate.toString(s),wc.Scale.toString(s)].join(" ")}},Transition:{toString(s){let{property:e,duration:t,easing:n}=s;return e+" "+t+"ms "+n}}}),vS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function H2(s){return s.matches(vS)?s:s.querySelector(vS)}const F2={display:"none"};function Y2(s){let{id:e,value:t}=s;return ft.createElement("div",{id:e,style:F2},t)}function V2(s){let{id:e,announcement:t,ariaLiveType:n="assertive"}=s;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ft.createElement("div",{id:e,style:a,role:"status","aria-live":n,"aria-atomic":!0},t)}function G2(){const[s,e]=C.useState("");return{announce:C.useCallback(n=>{n!=null&&e(n)},[]),announcement:s}}const v1=C.createContext(null);function Q2(s){const e=C.useContext(v1);C.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(s)},[s,e])}function X2(){const[s]=C.useState(()=>new Set),e=C.useCallback(n=>(s.add(n),()=>s.delete(n)),[s]);return[C.useCallback(n=>{let{type:a,event:o}=n;s.forEach(c=>{var d;return(d=c[a])==null?void 0:d.call(c,o)})},[s]),e]}const K2={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},J2={onDragStart(s){let{active:e}=s;return"Picked up draggable item "+e.id+"."},onDragOver(s){let{active:e,over:t}=s;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(s){let{active:e,over:t}=s;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(s){let{active:e}=s;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function Z2(s){let{announcements:e=J2,container:t,hiddenTextDescribedById:n,screenReaderInstructions:a=K2}=s;const{announce:o,announcement:c}=G2(),d=Nc("DndLiveRegion"),[h,g]=C.useState(!1);if(C.useEffect(()=>{g(!0)},[]),Q2(C.useMemo(()=>({onDragStart(m){let{active:y}=m;o(e.onDragStart({active:y}))},onDragMove(m){let{active:y,over:_}=m;e.onDragMove&&o(e.onDragMove({active:y,over:_}))},onDragOver(m){let{active:y,over:_}=m;o(e.onDragOver({active:y,over:_}))},onDragEnd(m){let{active:y,over:_}=m;o(e.onDragEnd({active:y,over:_}))},onDragCancel(m){let{active:y,over:_}=m;o(e.onDragCancel({active:y,over:_}))}}),[o,e])),!h)return null;const p=ft.createElement(ft.Fragment,null,ft.createElement(Y2,{id:n,value:a.draggable}),ft.createElement(V2,{id:d,announcement:c}));return t?Il.createPortal(p,t):p}var Ot;(function(s){s.DragStart="dragStart",s.DragMove="dragMove",s.DragEnd="dragEnd",s.DragCancel="dragCancel",s.DragOver="dragOver",s.RegisterDroppable="registerDroppable",s.SetDroppableDisabled="setDroppableDisabled",s.UnregisterDroppable="unregisterDroppable"})(Ot||(Ot={}));function Fd(){}function mS(s,e){return C.useMemo(()=>({sensor:s,options:e??{}}),[s,e])}function W2(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return C.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const di=Object.freeze({x:0,y:0});function m1(s,e){return Math.sqrt(Math.pow(s.x-e.x,2)+Math.pow(s.y-e.y,2))}function y1(s,e){let{data:{value:t}}=s,{data:{value:n}}=e;return t-n}function eM(s,e){let{data:{value:t}}=s,{data:{value:n}}=e;return n-t}function yS(s){let{left:e,top:t,height:n,width:a}=s;return[{x:e,y:t},{x:e+a,y:t},{x:e,y:t+n},{x:e+a,y:t+n}]}function _1(s,e){if(!s||s.length===0)return null;const[t]=s;return t[e]}function _S(s,e,t){return e===void 0&&(e=s.left),t===void 0&&(t=s.top),{x:e+s.width*.5,y:t+s.height*.5}}const tM=s=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=s;const a=_S(e,e.left,e.top),o=[];for(const c of n){const{id:d}=c,h=t.get(d);if(h){const g=m1(_S(h),a);o.push({id:d,data:{droppableContainer:c,value:g}})}}return o.sort(y1)},nM=s=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=s;const a=yS(e),o=[];for(const c of n){const{id:d}=c,h=t.get(d);if(h){const g=yS(h),p=a.reduce((y,_,E)=>y+m1(g[E],_),0),m=Number((p/4).toFixed(4));o.push({id:d,data:{droppableContainer:c,value:m}})}}return o.sort(y1)};function iM(s,e){const t=Math.max(e.top,s.top),n=Math.max(e.left,s.left),a=Math.min(e.left+e.width,s.left+s.width),o=Math.min(e.top+e.height,s.top+s.height),c=a-n,d=o-t;if(n<a&&t<o){const h=e.width*e.height,g=s.width*s.height,p=c*d,m=p/(h+g-p);return Number(m.toFixed(4))}return 0}const sM=s=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=s;const a=[];for(const o of n){const{id:c}=o,d=t.get(c);if(d){const h=iM(d,e);h>0&&a.push({id:c,data:{droppableContainer:o,value:h}})}}return a.sort(eM)};function rM(s,e,t){return{...s,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function b1(s,e){return s&&e?{x:s.left-e.left,y:s.top-e.top}:di}function aM(s){return function(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];return a.reduce((c,d)=>({...c,top:c.top+s*d.y,bottom:c.bottom+s*d.y,left:c.left+s*d.x,right:c.right+s*d.x}),{...t})}}const oM=aM(1);function lM(s){if(s.startsWith("matrix3d(")){const e=s.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(s.startsWith("matrix(")){const e=s.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function cM(s,e,t){const n=lM(e);if(!n)return s;const{scaleX:a,scaleY:o,x:c,y:d}=n,h=s.left-c-(1-a)*parseFloat(t),g=s.top-d-(1-o)*parseFloat(t.slice(t.indexOf(" ")+1)),p=a?s.width/a:s.width,m=o?s.height/o:s.height;return{width:p,height:m,top:g,right:h+p,bottom:g+m,left:h}}const uM={ignoreTransform:!1};function jo(s,e){e===void 0&&(e=uM);let t=s.getBoundingClientRect();if(e.ignoreTransform){const{transform:g,transformOrigin:p}=En(s).getComputedStyle(s);g&&(t=cM(t,g,p))}const{top:n,left:a,width:o,height:c,bottom:d,right:h}=t;return{top:n,left:a,width:o,height:c,bottom:d,right:h}}function bS(s){return jo(s,{ignoreTransform:!0})}function dM(s){const e=s.innerWidth,t=s.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function hM(s,e){return e===void 0&&(e=En(s).getComputedStyle(s)),e.position==="fixed"}function fM(s,e){e===void 0&&(e=En(s).getComputedStyle(s));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=e[a];return typeof o=="string"?t.test(o):!1})}function dh(s,e){const t=[];function n(a){if(e!=null&&t.length>=e||!a)return t;if(um(a)&&a.scrollingElement!=null&&!t.includes(a.scrollingElement))return t.push(a.scrollingElement),t;if(!Lc(a)||g1(a)||t.includes(a))return t;const o=En(s).getComputedStyle(a);return a!==s&&fM(a,o)&&t.push(a),hM(a,o)?t:n(a.parentNode)}return s?n(s):t}function w1(s){const[e]=dh(s,1);return e??null}function hp(s){return!uh||!s?null:Oo(s)?s:cm(s)?um(s)||s===Lo(s).scrollingElement?window:Lc(s)?s:null:null}function S1(s){return Oo(s)?s.scrollX:s.scrollLeft}function E1(s){return Oo(s)?s.scrollY:s.scrollTop}function mv(s){return{x:S1(s),y:E1(s)}}var Yt;(function(s){s[s.Forward=1]="Forward",s[s.Backward=-1]="Backward"})(Yt||(Yt={}));function x1(s){return!uh||!s?!1:s===document.scrollingElement}function C1(s){const e={x:0,y:0},t=x1(s)?{height:window.innerHeight,width:window.innerWidth}:{height:s.clientHeight,width:s.clientWidth},n={x:s.scrollWidth-t.width,y:s.scrollHeight-t.height},a=s.scrollTop<=e.y,o=s.scrollLeft<=e.x,c=s.scrollTop>=n.y,d=s.scrollLeft>=n.x;return{isTop:a,isLeft:o,isBottom:c,isRight:d,maxScroll:n,minScroll:e}}const gM={x:.2,y:.2};function pM(s,e,t,n,a){let{top:o,left:c,right:d,bottom:h}=t;n===void 0&&(n=10),a===void 0&&(a=gM);const{isTop:g,isBottom:p,isLeft:m,isRight:y}=C1(s),_={x:0,y:0},E={x:0,y:0},S={height:e.height*a.y,width:e.width*a.x};return!g&&o<=e.top+S.height?(_.y=Yt.Backward,E.y=n*Math.abs((e.top+S.height-o)/S.height)):!p&&h>=e.bottom-S.height&&(_.y=Yt.Forward,E.y=n*Math.abs((e.bottom-S.height-h)/S.height)),!y&&d>=e.right-S.width?(_.x=Yt.Forward,E.x=n*Math.abs((e.right-S.width-d)/S.width)):!m&&c<=e.left+S.width&&(_.x=Yt.Backward,E.x=n*Math.abs((e.left+S.width-c)/S.width)),{direction:_,speed:E}}function vM(s){if(s===document.scrollingElement){const{innerWidth:o,innerHeight:c}=window;return{top:0,left:0,right:o,bottom:c,width:o,height:c}}const{top:e,left:t,right:n,bottom:a}=s.getBoundingClientRect();return{top:e,left:t,right:n,bottom:a,width:s.clientWidth,height:s.clientHeight}}function T1(s){return s.reduce((e,t)=>uo(e,mv(t)),di)}function mM(s){return s.reduce((e,t)=>e+S1(t),0)}function yM(s){return s.reduce((e,t)=>e+E1(t),0)}function _M(s,e){if(e===void 0&&(e=jo),!s)return;const{top:t,left:n,bottom:a,right:o}=e(s);w1(s)&&(a<=0||o<=0||t>=window.innerHeight||n>=window.innerWidth)&&s.scrollIntoView({block:"center",inline:"center"})}const bM=[["x",["left","right"],mM],["y",["top","bottom"],yM]];class fm{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=dh(t),a=T1(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,c,d]of bM)for(const h of c)Object.defineProperty(this,h,{get:()=>{const g=d(n),p=a[o]-g;return this.rect[h]+p},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ec{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...t)})},this.target=e}add(e,t,n){var a;(a=this.target)==null||a.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function wM(s){const{EventTarget:e}=En(s);return s instanceof e?s:Lo(s)}function fp(s,e){const t=Math.abs(s.x),n=Math.abs(s.y);return typeof e=="number"?Math.sqrt(t**2+n**2)>e:"x"in e&&"y"in e?t>e.x&&n>e.y:"x"in e?t>e.x:"y"in e?n>e.y:!1}var Jn;(function(s){s.Click="click",s.DragStart="dragstart",s.Keydown="keydown",s.ContextMenu="contextmenu",s.Resize="resize",s.SelectionChange="selectionchange",s.VisibilityChange="visibilitychange"})(Jn||(Jn={}));function wS(s){s.preventDefault()}function SM(s){s.stopPropagation()}var je;(function(s){s.Space="Space",s.Down="ArrowDown",s.Right="ArrowRight",s.Left="ArrowLeft",s.Up="ArrowUp",s.Esc="Escape",s.Enter="Enter",s.Tab="Tab"})(je||(je={}));const D1={start:[je.Space,je.Enter],cancel:[je.Esc],end:[je.Space,je.Enter,je.Tab]},EM=(s,e)=>{let{currentCoordinates:t}=e;switch(s.code){case je.Right:return{...t,x:t.x+25};case je.Left:return{...t,x:t.x-25};case je.Down:return{...t,y:t.y+25};case je.Up:return{...t,y:t.y-25}}};class gm{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new ec(Lo(t)),this.windowListeners=new ec(En(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Jn.Resize,this.handleCancel),this.windowListeners.add(Jn.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Jn.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&_M(n),t(di)}handleKeyDown(e){if(hm(e)){const{active:t,context:n,options:a}=this.props,{keyboardCodes:o=D1,coordinateGetter:c=EM,scrollBehavior:d="smooth"}=a,{code:h}=e;if(o.end.includes(h)){this.handleEnd(e);return}if(o.cancel.includes(h)){this.handleCancel(e);return}const{collisionRect:g}=n.current,p=g?{x:g.left,y:g.top}:di;this.referenceCoordinates||(this.referenceCoordinates=p);const m=c(e,{active:t,context:n.current,currentCoordinates:p});if(m){const y=bc(m,p),_={x:0,y:0},{scrollableAncestors:E}=n.current;for(const S of E){const T=e.code,{isTop:O,isRight:$,isLeft:L,isBottom:U,maxScroll:A,minScroll:Y}=C1(S),Z=vM(S),J={x:Math.min(T===je.Right?Z.right-Z.width/2:Z.right,Math.max(T===je.Right?Z.left:Z.left+Z.width/2,m.x)),y:Math.min(T===je.Down?Z.bottom-Z.height/2:Z.bottom,Math.max(T===je.Down?Z.top:Z.top+Z.height/2,m.y))},fe=T===je.Right&&!$||T===je.Left&&!L,ee=T===je.Down&&!U||T===je.Up&&!O;if(fe&&J.x!==m.x){const ce=S.scrollLeft+y.x,de=T===je.Right&&ce<=A.x||T===je.Left&&ce>=Y.x;if(de&&!y.y){S.scrollTo({left:ce,behavior:d});return}de?_.x=S.scrollLeft-ce:_.x=T===je.Right?S.scrollLeft-A.x:S.scrollLeft-Y.x,_.x&&S.scrollBy({left:-_.x,behavior:d});break}else if(ee&&J.y!==m.y){const ce=S.scrollTop+y.y,de=T===je.Down&&ce<=A.y||T===je.Up&&ce>=Y.y;if(de&&!y.x){S.scrollTo({top:ce,behavior:d});return}de?_.y=S.scrollTop-ce:_.y=T===je.Down?S.scrollTop-A.y:S.scrollTop-Y.y,_.y&&S.scrollBy({top:-_.y,behavior:d});break}}this.handleMove(e,uo(bc(m,this.referenceCoordinates),_))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}gm.activators=[{eventName:"onKeyDown",handler:(s,e,t)=>{let{keyboardCodes:n=D1,onActivation:a}=e,{active:o}=t;const{code:c}=s.nativeEvent;if(n.start.includes(c)){const d=o.activatorNode.current;return d&&s.target!==d?!1:(s.preventDefault(),a?.({event:s.nativeEvent}),!0)}return!1}}];function SS(s){return!!(s&&"distance"in s)}function ES(s){return!!(s&&"delay"in s)}class pm{constructor(e,t,n){var a;n===void 0&&(n=wM(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:o}=e,{target:c}=o;this.props=e,this.events=t,this.document=Lo(c),this.documentListeners=new ec(this.document),this.listeners=new ec(n),this.windowListeners=new ec(En(c)),this.initialCoordinates=(a=vv(o))!=null?a:di,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Jn.Resize,this.handleCancel),this.windowListeners.add(Jn.DragStart,wS),this.windowListeners.add(Jn.VisibilityChange,this.handleCancel),this.windowListeners.add(Jn.ContextMenu,wS),this.documentListeners.add(Jn.Keydown,this.handleKeydown),t){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ES(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(SS(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:a}=this.props;a(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Jn.Click,SM,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Jn.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:a,props:o}=this,{onMove:c,options:{activationConstraint:d}}=o;if(!a)return;const h=(t=vv(e))!=null?t:di,g=bc(a,h);if(!n&&d){if(SS(d)){if(d.tolerance!=null&&fp(g,d.tolerance))return this.handleCancel();if(fp(g,d.distance))return this.handleStart()}if(ES(d)&&fp(g,d.tolerance))return this.handleCancel();this.handlePending(d,g);return}e.cancelable&&e.preventDefault(),c(h)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===je.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const xM={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class vm extends pm{constructor(e){const{event:t}=e,n=Lo(t.target);super(e,xM,n)}}vm.activators=[{eventName:"onPointerDown",handler:(s,e)=>{let{nativeEvent:t}=s,{onActivation:n}=e;return!t.isPrimary||t.button!==0?!1:(n?.({event:t}),!0)}}];const CM={move:{name:"mousemove"},end:{name:"mouseup"}};var yv;(function(s){s[s.RightClick=2]="RightClick"})(yv||(yv={}));class TM extends pm{constructor(e){super(e,CM,Lo(e.event.target))}}TM.activators=[{eventName:"onMouseDown",handler:(s,e)=>{let{nativeEvent:t}=s,{onActivation:n}=e;return t.button===yv.RightClick?!1:(n?.({event:t}),!0)}}];const gp={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class DM extends pm{constructor(e){super(e,gp)}static setup(){return window.addEventListener(gp.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(gp.move.name,e)};function e(){}}}DM.activators=[{eventName:"onTouchStart",handler:(s,e)=>{let{nativeEvent:t}=s,{onActivation:n}=e;const{touches:a}=t;return a.length>1?!1:(n?.({event:t}),!0)}}];var tc;(function(s){s[s.Pointer=0]="Pointer",s[s.DraggableRect=1]="DraggableRect"})(tc||(tc={}));var Yd;(function(s){s[s.TreeOrder=0]="TreeOrder",s[s.ReversedTreeOrder=1]="ReversedTreeOrder"})(Yd||(Yd={}));function kM(s){let{acceleration:e,activator:t=tc.Pointer,canScroll:n,draggingRect:a,enabled:o,interval:c=5,order:d=Yd.TreeOrder,pointerCoordinates:h,scrollableAncestors:g,scrollableAncestorRects:p,delta:m,threshold:y}=s;const _=RM({delta:m,disabled:!o}),[E,S]=z2(),T=C.useRef({x:0,y:0}),O=C.useRef({x:0,y:0}),$=C.useMemo(()=>{switch(t){case tc.Pointer:return h?{top:h.y,bottom:h.y,left:h.x,right:h.x}:null;case tc.DraggableRect:return a}},[t,a,h]),L=C.useRef(null),U=C.useCallback(()=>{const Y=L.current;if(!Y)return;const Z=T.current.x*O.current.x,J=T.current.y*O.current.y;Y.scrollBy(Z,J)},[]),A=C.useMemo(()=>d===Yd.TreeOrder?[...g].reverse():g,[d,g]);C.useEffect(()=>{if(!o||!g.length||!$){S();return}for(const Y of A){if(n?.(Y)===!1)continue;const Z=g.indexOf(Y),J=p[Z];if(!J)continue;const{direction:fe,speed:ee}=pM(Y,J,$,e,y);for(const ce of["x","y"])_[ce][fe[ce]]||(ee[ce]=0,fe[ce]=0);if(ee.x>0||ee.y>0){S(),L.current=Y,E(U,c),T.current=ee,O.current=fe;return}}T.current={x:0,y:0},O.current={x:0,y:0},S()},[e,U,n,S,o,c,JSON.stringify($),JSON.stringify(_),E,g,A,p,JSON.stringify(y)])}const AM={x:{[Yt.Backward]:!1,[Yt.Forward]:!1},y:{[Yt.Backward]:!1,[Yt.Forward]:!1}};function RM(s){let{delta:e,disabled:t}=s;const n=pv(e);return jc(a=>{if(t||!n||!a)return AM;const o={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[Yt.Backward]:a.x[Yt.Backward]||o.x===-1,[Yt.Forward]:a.x[Yt.Forward]||o.x===1},y:{[Yt.Backward]:a.y[Yt.Backward]||o.y===-1,[Yt.Forward]:a.y[Yt.Forward]||o.y===1}}},[t,e,n])}function OM(s,e){const t=e!=null?s.get(e):void 0,n=t?t.node.current:null;return jc(a=>{var o;return e==null?null:(o=n??a)!=null?o:null},[n,e])}function LM(s,e){return C.useMemo(()=>s.reduce((t,n)=>{const{sensor:a}=n,o=a.activators.map(c=>({eventName:c.eventName,handler:e(c.handler,n)}));return[...t,...o]},[]),[s,e])}var Sc;(function(s){s[s.Always=0]="Always",s[s.BeforeDragging=1]="BeforeDragging",s[s.WhileDragging=2]="WhileDragging"})(Sc||(Sc={}));var _v;(function(s){s.Optimized="optimized"})(_v||(_v={}));const xS=new Map;function jM(s,e){let{dragging:t,dependencies:n,config:a}=e;const[o,c]=C.useState(null),{frequency:d,measure:h,strategy:g}=a,p=C.useRef(s),m=T(),y=_c(m),_=C.useCallback(function(O){O===void 0&&(O=[]),!y.current&&c($=>$===null?O:$.concat(O.filter(L=>!$.includes(L))))},[y]),E=C.useRef(null),S=jc(O=>{if(m&&!t)return xS;if(!O||O===xS||p.current!==s||o!=null){const $=new Map;for(let L of s){if(!L)continue;if(o&&o.length>0&&!o.includes(L.id)&&L.rect.current){$.set(L.id,L.rect.current);continue}const U=L.node.current,A=U?new fm(h(U),U):null;L.rect.current=A,A&&$.set(L.id,A)}return $}return O},[s,o,t,m,h]);return C.useEffect(()=>{p.current=s},[s]),C.useEffect(()=>{m||_()},[t,m]),C.useEffect(()=>{o&&o.length>0&&c(null)},[JSON.stringify(o)]),C.useEffect(()=>{m||typeof d!="number"||E.current!==null||(E.current=setTimeout(()=>{_(),E.current=null},d))},[d,m,_,...n]),{droppableRects:S,measureDroppableContainers:_,measuringScheduled:o!=null};function T(){switch(g){case Sc.Always:return!1;case Sc.BeforeDragging:return t;default:return!t}}}function k1(s,e){return jc(t=>s?t||(typeof e=="function"?e(s):s):null,[e,s])}function NM(s,e){return k1(s,e)}function MM(s){let{callback:e,disabled:t}=s;const n=dm(e),a=C.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,t]);return C.useEffect(()=>()=>a?.disconnect(),[a]),a}function hh(s){let{callback:e,disabled:t}=s;const n=dm(e),a=C.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[t]);return C.useEffect(()=>()=>a?.disconnect(),[a]),a}function UM(s){return new fm(jo(s),s)}function CS(s,e,t){e===void 0&&(e=UM);const[n,a]=C.useState(null);function o(){a(h=>{if(!s)return null;if(s.isConnected===!1){var g;return(g=h??t)!=null?g:null}const p=e(s);return JSON.stringify(h)===JSON.stringify(p)?h:p})}const c=MM({callback(h){if(s)for(const g of h){const{type:p,target:m}=g;if(p==="childList"&&m instanceof HTMLElement&&m.contains(s)){o();break}}}}),d=hh({callback:o});return Ri(()=>{o(),s?(d?.observe(s),c?.observe(document.body,{childList:!0,subtree:!0})):(d?.disconnect(),c?.disconnect())},[s]),n}function $M(s){const e=k1(s);return b1(s,e)}const TS=[];function IM(s){const e=C.useRef(s),t=jc(n=>s?n&&n!==TS&&s&&e.current&&s.parentNode===e.current.parentNode?n:dh(s):TS,[s]);return C.useEffect(()=>{e.current=s},[s]),t}function BM(s){const[e,t]=C.useState(null),n=C.useRef(s),a=C.useCallback(o=>{const c=hp(o.target);c&&t(d=>d?(d.set(c,mv(c)),new Map(d)):null)},[]);return C.useEffect(()=>{const o=n.current;if(s!==o){c(o);const d=s.map(h=>{const g=hp(h);return g?(g.addEventListener("scroll",a,{passive:!0}),[g,mv(g)]):null}).filter(h=>h!=null);t(d.length?new Map(d):null),n.current=s}return()=>{c(s),c(o)};function c(d){d.forEach(h=>{const g=hp(h);g?.removeEventListener("scroll",a)})}},[a,s]),C.useMemo(()=>s.length?e?Array.from(e.values()).reduce((o,c)=>uo(o,c),di):T1(s):di,[s,e])}function DS(s,e){e===void 0&&(e=[]);const t=C.useRef(null);return C.useEffect(()=>{t.current=null},e),C.useEffect(()=>{const n=s!==di;n&&!t.current&&(t.current=s),!n&&t.current&&(t.current=null)},[s]),t.current?bc(s,t.current):di}function zM(s){C.useEffect(()=>{if(!uh)return;const e=s.map(t=>{let{sensor:n}=t;return n.setup==null?void 0:n.setup()});return()=>{for(const t of e)t?.()}},s.map(e=>{let{sensor:t}=e;return t}))}function PM(s,e){return C.useMemo(()=>s.reduce((t,n)=>{let{eventName:a,handler:o}=n;return t[a]=c=>{o(c,e)},t},{}),[s,e])}function A1(s){return C.useMemo(()=>s?dM(s):null,[s])}const kS=[];function qM(s,e){e===void 0&&(e=jo);const[t]=s,n=A1(t?En(t):null),[a,o]=C.useState(kS);function c(){o(()=>s.length?s.map(h=>x1(h)?n:new fm(e(h),h)):kS)}const d=hh({callback:c});return Ri(()=>{d?.disconnect(),c(),s.forEach(h=>d?.observe(h))},[s]),a}function HM(s){if(!s)return null;if(s.children.length>1)return s;const e=s.children[0];return Lc(e)?e:s}function FM(s){let{measure:e}=s;const[t,n]=C.useState(null),a=C.useCallback(g=>{for(const{target:p}of g)if(Lc(p)){n(m=>{const y=e(p);return m?{...m,width:y.width,height:y.height}:y});break}},[e]),o=hh({callback:a}),c=C.useCallback(g=>{const p=HM(g);o?.disconnect(),p&&o?.observe(p),n(p?e(p):null)},[e,o]),[d,h]=Hd(c);return C.useMemo(()=>({nodeRef:d,rect:t,setRef:h}),[t,d,h])}const YM=[{sensor:vm,options:{}},{sensor:gm,options:{}}],VM={current:{}},pd={draggable:{measure:bS},droppable:{measure:bS,strategy:Sc.WhileDragging,frequency:_v.Optimized},dragOverlay:{measure:jo}};class nc extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return(t=(n=this.get(e))==null?void 0:n.node.current)!=null?t:void 0}}const GM={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new nc,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Fd},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:pd,measureDroppableContainers:Fd,windowRect:null,measuringScheduled:!1},QM={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Fd,draggableNodes:new Map,over:null,measureDroppableContainers:Fd},fh=C.createContext(QM),R1=C.createContext(GM);function XM(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new nc}}}function KM(s,e){switch(e.type){case Ot.DragStart:return{...s,draggable:{...s.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Ot.DragMove:return s.draggable.active==null?s:{...s,draggable:{...s.draggable,translate:{x:e.coordinates.x-s.draggable.initialCoordinates.x,y:e.coordinates.y-s.draggable.initialCoordinates.y}}};case Ot.DragEnd:case Ot.DragCancel:return{...s,draggable:{...s.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ot.RegisterDroppable:{const{element:t}=e,{id:n}=t,a=new nc(s.droppable.containers);return a.set(n,t),{...s,droppable:{...s.droppable,containers:a}}}case Ot.SetDroppableDisabled:{const{id:t,key:n,disabled:a}=e,o=s.droppable.containers.get(t);if(!o||n!==o.key)return s;const c=new nc(s.droppable.containers);return c.set(t,{...o,disabled:a}),{...s,droppable:{...s.droppable,containers:c}}}case Ot.UnregisterDroppable:{const{id:t,key:n}=e,a=s.droppable.containers.get(t);if(!a||n!==a.key)return s;const o=new nc(s.droppable.containers);return o.delete(t),{...s,droppable:{...s.droppable,containers:o}}}default:return s}}function JM(s){let{disabled:e}=s;const{active:t,activatorEvent:n,draggableNodes:a}=C.useContext(fh),o=pv(n),c=pv(t?.id);return C.useEffect(()=>{if(!e&&!n&&o&&c!=null){if(!hm(o)||document.activeElement===o.target)return;const d=a.get(c);if(!d)return;const{activatorNode:h,node:g}=d;if(!h.current&&!g.current)return;requestAnimationFrame(()=>{for(const p of[h.current,g.current]){if(!p)continue;const m=H2(p);if(m){m.focus();break}}})}},[n,e,a,c,o]),null}function ZM(s,e){let{transform:t,...n}=e;return s!=null&&s.length?s.reduce((a,o)=>o({transform:a,...n}),t):t}function WM(s){return C.useMemo(()=>({draggable:{...pd.draggable,...s?.draggable},droppable:{...pd.droppable,...s?.droppable},dragOverlay:{...pd.dragOverlay,...s?.dragOverlay}}),[s?.draggable,s?.droppable,s?.dragOverlay])}function eU(s){let{activeNode:e,measure:t,initialRect:n,config:a=!0}=s;const o=C.useRef(!1),{x:c,y:d}=typeof a=="boolean"?{x:a,y:a}:a;Ri(()=>{if(!c&&!d||!e){o.current=!1;return}if(o.current||!n)return;const g=e?.node.current;if(!g||g.isConnected===!1)return;const p=t(g),m=b1(p,n);if(c||(m.x=0),d||(m.y=0),o.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const y=w1(g);y&&y.scrollBy({top:m.y,left:m.x})}},[e,c,d,n,t])}const O1=C.createContext({...di,scaleX:1,scaleY:1});var Hs;(function(s){s[s.Uninitialized=0]="Uninitialized",s[s.Initializing=1]="Initializing",s[s.Initialized=2]="Initialized"})(Hs||(Hs={}));const tU=C.memo(function(e){var t,n,a,o;let{id:c,accessibility:d,autoScroll:h=!0,children:g,sensors:p=YM,collisionDetection:m=sM,measuring:y,modifiers:_,...E}=e;const S=C.useReducer(KM,void 0,XM),[T,O]=S,[$,L]=X2(),[U,A]=C.useState(Hs.Uninitialized),Y=U===Hs.Initialized,{draggable:{active:Z,nodes:J,translate:fe},droppable:{containers:ee}}=T,ce=Z!=null?J.get(Z):null,de=C.useRef({initial:null,translated:null}),Se=C.useMemo(()=>{var st;return Z!=null?{id:Z,data:(st=ce?.data)!=null?st:VM,rect:de}:null},[Z,ce]),Ue=C.useRef(null),[xe,H]=C.useState(null),[K,re]=C.useState(null),V=_c(E,Object.values(E)),D=Nc("DndDescribedBy",c),z=C.useMemo(()=>ee.getEnabled(),[ee]),F=WM(y),{droppableRects:P,measureDroppableContainers:W,measuringScheduled:ge}=jM(z,{dragging:Y,dependencies:[fe.x,fe.y],config:F.droppable}),ne=OM(J,Z),lt=C.useMemo(()=>K?vv(K):null,[K]),Ce=ar(),ct=NM(ne,F.draggable.measure);eU({activeNode:Z!=null?J.get(Z):null,config:Ce.layoutShiftCompensation,initialRect:ct,measure:F.draggable.measure});const _e=CS(ne,F.draggable.measure,ct),fn=CS(ne?ne.parentElement:null),xt=C.useRef({activatorEvent:null,active:null,activeNode:ne,collisionRect:null,collisions:null,droppableRects:P,draggableNodes:J,draggingNode:null,draggingNodeRect:null,droppableContainers:ee,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),nn=ee.getNodeFor((t=xt.current.over)==null?void 0:t.id),Mt=FM({measure:F.dragOverlay.measure}),xn=(n=Mt.nodeRef.current)!=null?n:ne,Cn=Y?(a=Mt.rect)!=null?a:_e:null,Ct=!!(Mt.nodeRef.current&&Mt.rect),Qr=$M(Ct?null:_e),ds=A1(xn?En(xn):null),Tn=IM(Y?nn??ne:null),ii=qM(Tn),Oi=ZM(_,{transform:{x:fe.x-Qr.x,y:fe.y-Qr.y,scaleX:1,scaleY:1},activatorEvent:K,active:Se,activeNodeRect:_e,containerNodeRect:fn,draggingNodeRect:Cn,over:xt.current.over,overlayNodeRect:Mt.rect,scrollableAncestors:Tn,scrollableAncestorRects:ii,windowRect:ds}),hs=lt?uo(lt,fe):null,Xr=BM(Tn),No=DS(Xr),gn=DS(Xr,[_e]),Qe=uo(Oi,No),Tt=Cn?oM(Cn,Oi):null,ut=Se&&Tt?m({active:Se,collisionRect:Tt,droppableRects:P,droppableContainers:z,pointerCoordinates:hs}):null,Kr=_1(ut,"id"),[zn,Jr]=C.useState(null),fs=Ct?Oi:uo(Oi,gn),gs=rM(fs,(o=zn?.rect)!=null?o:null,_e),Dn=C.useRef(null),Li=C.useCallback((st,Qt)=>{let{sensor:Ut,options:kn}=Qt;if(Ue.current==null)return;const $t=J.get(Ue.current);if(!$t)return;const se=st.nativeEvent,_t=new Ut({active:Ue.current,activeNode:$t,event:se,options:kn,context:xt,onAbort(ze){if(!J.get(ze))return;const{onDragAbort:et}=V.current,sn={id:ze};et?.(sn),$({type:"onDragAbort",event:sn})},onPending(ze,Ie,et,sn){if(!J.get(ze))return;const{onDragPending:or}=V.current,fi={id:ze,constraint:Ie,initialCoordinates:et,offset:sn};or?.(fi),$({type:"onDragPending",event:fi})},onStart(ze){const Ie=Ue.current;if(Ie==null)return;const et=J.get(Ie);if(!et)return;const{onDragStart:sn}=V.current,Ni={activatorEvent:se,active:{id:Ie,data:et.data,rect:de}};Il.unstable_batchedUpdates(()=>{sn?.(Ni),A(Hs.Initializing),O({type:Ot.DragStart,initialCoordinates:ze,active:Ie}),$({type:"onDragStart",event:Ni}),H(Dn.current),re(se)})},onMove(ze){O({type:Ot.DragMove,coordinates:ze})},onEnd:It(Ot.DragEnd),onCancel:It(Ot.DragCancel)});Dn.current=_t;function It(ze){return async function(){const{active:et,collisions:sn,over:Ni,scrollAdjustedTranslate:or}=xt.current;let fi=null;if(et&&or){const{cancelDrop:ps}=V.current;fi={activatorEvent:se,active:et,collisions:sn,delta:or,over:Ni},ze===Ot.DragEnd&&typeof ps=="function"&&await Promise.resolve(ps(fi))&&(ze=Ot.DragCancel)}Ue.current=null,Il.unstable_batchedUpdates(()=>{O({type:ze}),A(Hs.Uninitialized),Jr(null),H(null),re(null),Dn.current=null;const ps=ze===Ot.DragEnd?"onDragEnd":"onDragCancel";if(fi){const Mi=V.current[ps];Mi?.(fi),$({type:ps,event:fi})}})}}},[J]),ji=C.useCallback((st,Qt)=>(Ut,kn)=>{const $t=Ut.nativeEvent,se=J.get(kn);if(Ue.current!==null||!se||$t.dndKit||$t.defaultPrevented)return;const _t={active:se};st(Ut,Qt.options,_t)===!0&&($t.dndKit={capturedBy:Qt.sensor},Ue.current=kn,Li(Ut,Qt))},[J,Li]),Zr=LM(p,ji);zM(p),Ri(()=>{_e&&U===Hs.Initializing&&A(Hs.Initialized)},[_e,U]),C.useEffect(()=>{const{onDragMove:st}=V.current,{active:Qt,activatorEvent:Ut,collisions:kn,over:$t}=xt.current;if(!Qt||!Ut)return;const se={active:Qt,activatorEvent:Ut,collisions:kn,delta:{x:Qe.x,y:Qe.y},over:$t};Il.unstable_batchedUpdates(()=>{st?.(se),$({type:"onDragMove",event:se})})},[Qe.x,Qe.y]),C.useEffect(()=>{const{active:st,activatorEvent:Qt,collisions:Ut,droppableContainers:kn,scrollAdjustedTranslate:$t}=xt.current;if(!st||Ue.current==null||!Qt||!$t)return;const{onDragOver:se}=V.current,_t=kn.get(Kr),It=_t&&_t.rect.current?{id:_t.id,rect:_t.rect.current,data:_t.data,disabled:_t.disabled}:null,ze={active:st,activatorEvent:Qt,collisions:Ut,delta:{x:$t.x,y:$t.y},over:It};Il.unstable_batchedUpdates(()=>{Jr(It),se?.(ze),$({type:"onDragOver",event:ze})})},[Kr]),Ri(()=>{xt.current={activatorEvent:K,active:Se,activeNode:ne,collisionRect:Tt,collisions:ut,droppableRects:P,draggableNodes:J,draggingNode:xn,draggingNodeRect:Cn,droppableContainers:ee,over:zn,scrollableAncestors:Tn,scrollAdjustedTranslate:Qe},de.current={initial:Cn,translated:Tt}},[Se,ne,ut,Tt,J,xn,Cn,P,ee,zn,Tn,Qe]),kM({...Ce,delta:fe,draggingRect:Tt,pointerCoordinates:hs,scrollableAncestors:Tn,scrollableAncestorRects:ii});const Wr=C.useMemo(()=>({active:Se,activeNode:ne,activeNodeRect:_e,activatorEvent:K,collisions:ut,containerNodeRect:fn,dragOverlay:Mt,draggableNodes:J,droppableContainers:ee,droppableRects:P,over:zn,measureDroppableContainers:W,scrollableAncestors:Tn,scrollableAncestorRects:ii,measuringConfiguration:F,measuringScheduled:ge,windowRect:ds}),[Se,ne,_e,K,ut,fn,Mt,J,ee,P,zn,W,Tn,ii,F,ge,ds]),ea=C.useMemo(()=>({activatorEvent:K,activators:Zr,active:Se,activeNodeRect:_e,ariaDescribedById:{draggable:D},dispatch:O,draggableNodes:J,over:zn,measureDroppableContainers:W}),[K,Zr,Se,_e,O,D,J,zn,W]);return ft.createElement(v1.Provider,{value:L},ft.createElement(fh.Provider,{value:ea},ft.createElement(R1.Provider,{value:Wr},ft.createElement(O1.Provider,{value:gs},g)),ft.createElement(JM,{disabled:d?.restoreFocus===!1})),ft.createElement(Z2,{...d,hiddenTextDescribedById:D}));function ar(){const st=xe?.autoScrollEnabled===!1,Qt=typeof h=="object"?h.enabled===!1:h===!1,Ut=Y&&!st&&!Qt;return typeof h=="object"?{...h,enabled:Ut}:{enabled:Ut}}}),nU=C.createContext(null),AS="button",iU="Draggable";function sU(s){let{id:e,data:t,disabled:n=!1,attributes:a}=s;const o=Nc(iU),{activators:c,activatorEvent:d,active:h,activeNodeRect:g,ariaDescribedById:p,draggableNodes:m,over:y}=C.useContext(fh),{role:_=AS,roleDescription:E="draggable",tabIndex:S=0}=a??{},T=h?.id===e,O=C.useContext(T?O1:nU),[$,L]=Hd(),[U,A]=Hd(),Y=PM(c,e),Z=_c(t);Ri(()=>(m.set(e,{id:e,key:o,node:$,activatorNode:U,data:Z}),()=>{const fe=m.get(e);fe&&fe.key===o&&m.delete(e)}),[m,e]);const J=C.useMemo(()=>({role:_,tabIndex:S,"aria-disabled":n,"aria-pressed":T&&_===AS?!0:void 0,"aria-roledescription":E,"aria-describedby":p.draggable}),[n,_,S,T,E,p.draggable]);return{active:h,activatorEvent:d,activeNodeRect:g,attributes:J,isDragging:T,listeners:n?void 0:Y,node:$,over:y,setNodeRef:L,setActivatorNodeRef:A,transform:O}}function rU(){return C.useContext(R1)}const aU="Droppable",oU={timeout:25};function lU(s){let{data:e,disabled:t=!1,id:n,resizeObserverConfig:a}=s;const o=Nc(aU),{active:c,dispatch:d,over:h,measureDroppableContainers:g}=C.useContext(fh),p=C.useRef({disabled:t}),m=C.useRef(!1),y=C.useRef(null),_=C.useRef(null),{disabled:E,updateMeasurementsFor:S,timeout:T}={...oU,...a},O=_c(S??n),$=C.useCallback(()=>{if(!m.current){m.current=!0;return}_.current!=null&&clearTimeout(_.current),_.current=setTimeout(()=>{g(Array.isArray(O.current)?O.current:[O.current]),_.current=null},T)},[T]),L=hh({callback:$,disabled:E||!c}),U=C.useCallback((J,fe)=>{L&&(fe&&(L.unobserve(fe),m.current=!1),J&&L.observe(J))},[L]),[A,Y]=Hd(U),Z=_c(e);return C.useEffect(()=>{!L||!A.current||(L.disconnect(),m.current=!1,L.observe(A.current))},[A,L]),C.useEffect(()=>(d({type:Ot.RegisterDroppable,element:{id:n,key:o,disabled:t,node:A,rect:y,data:Z}}),()=>d({type:Ot.UnregisterDroppable,key:o,id:n})),[n]),C.useEffect(()=>{t!==p.current.disabled&&(d({type:Ot.SetDroppableDisabled,id:n,key:o,disabled:t}),p.current.disabled=t)},[n,o,t,d]),{active:c,rect:y,isOver:h?.id===n,node:A,over:h,setNodeRef:Y}}function mm(s,e,t){const n=s.slice();return n.splice(t<0?n.length+t:t,0,n.splice(e,1)[0]),n}function cU(s,e){return s.reduce((t,n,a)=>{const o=e.get(n);return o&&(t[a]=o),t},Array(s.length))}function ad(s){return s!==null&&s>=0}function uU(s,e){if(s===e)return!0;if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==e[t])return!1;return!0}function dU(s){return typeof s=="boolean"?{draggable:s,droppable:s}:s}const L1=s=>{let{rects:e,activeIndex:t,overIndex:n,index:a}=s;const o=mm(e,n,t),c=e[a],d=o[a];return!d||!c?null:{x:d.left-c.left,y:d.top-c.top,scaleX:d.width/c.width,scaleY:d.height/c.height}},od={scaleX:1,scaleY:1},hU=s=>{var e;let{activeIndex:t,activeNodeRect:n,index:a,rects:o,overIndex:c}=s;const d=(e=o[t])!=null?e:n;if(!d)return null;if(a===t){const g=o[c];return g?{x:0,y:t<c?g.top+g.height-(d.top+d.height):g.top-d.top,...od}:null}const h=fU(o,a,t);return a>t&&a<=c?{x:0,y:-d.height-h,...od}:a<t&&a>=c?{x:0,y:d.height+h,...od}:{x:0,y:0,...od}};function fU(s,e,t){const n=s[e],a=s[e-1],o=s[e+1];return n?t<e?a?n.top-(a.top+a.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):a?n.top-(a.top+a.height):0:0}const j1="Sortable",N1=ft.createContext({activeIndex:-1,containerId:j1,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:L1,disabled:{draggable:!1,droppable:!1}});function gU(s){let{children:e,id:t,items:n,strategy:a=L1,disabled:o=!1}=s;const{active:c,dragOverlay:d,droppableRects:h,over:g,measureDroppableContainers:p}=rU(),m=Nc(j1,t),y=d.rect!==null,_=C.useMemo(()=>n.map(Y=>typeof Y=="object"&&"id"in Y?Y.id:Y),[n]),E=c!=null,S=c?_.indexOf(c.id):-1,T=g?_.indexOf(g.id):-1,O=C.useRef(_),$=!uU(_,O.current),L=T!==-1&&S===-1||$,U=dU(o);Ri(()=>{$&&E&&p(_)},[$,_,E,p]),C.useEffect(()=>{O.current=_},[_]);const A=C.useMemo(()=>({activeIndex:S,containerId:m,disabled:U,disableTransforms:L,items:_,overIndex:T,useDragOverlay:y,sortedRects:cU(_,h),strategy:a}),[S,m,U.draggable,U.droppable,L,_,T,h,y,a]);return ft.createElement(N1.Provider,{value:A},e)}const pU=s=>{let{id:e,items:t,activeIndex:n,overIndex:a}=s;return mm(t,n,a).indexOf(e)},vU=s=>{let{containerId:e,isSorting:t,wasDragging:n,index:a,items:o,newIndex:c,previousItems:d,previousContainerId:h,transition:g}=s;return!g||!n||d!==o&&a===c?!1:t?!0:c!==a&&e===h},mU={duration:200,easing:"ease"},M1="transform",yU=wc.Transition.toString({property:M1,duration:0,easing:"linear"}),_U={roleDescription:"sortable"};function bU(s){let{disabled:e,index:t,node:n,rect:a}=s;const[o,c]=C.useState(null),d=C.useRef(t);return Ri(()=>{if(!e&&t!==d.current&&n.current){const h=a.current;if(h){const g=jo(n.current,{ignoreTransform:!0}),p={x:h.left-g.left,y:h.top-g.top,scaleX:h.width/g.width,scaleY:h.height/g.height};(p.x||p.y)&&c(p)}}t!==d.current&&(d.current=t)},[e,t,n,a]),C.useEffect(()=>{o&&c(null)},[o]),o}function wU(s){let{animateLayoutChanges:e=vU,attributes:t,disabled:n,data:a,getNewIndex:o=pU,id:c,strategy:d,resizeObserverConfig:h,transition:g=mU}=s;const{items:p,containerId:m,activeIndex:y,disabled:_,disableTransforms:E,sortedRects:S,overIndex:T,useDragOverlay:O,strategy:$}=C.useContext(N1),L=SU(n,_),U=p.indexOf(c),A=C.useMemo(()=>({sortable:{containerId:m,index:U,items:p},...a}),[m,a,U,p]),Y=C.useMemo(()=>p.slice(p.indexOf(c)),[p,c]),{rect:Z,node:J,isOver:fe,setNodeRef:ee}=lU({id:c,data:A,disabled:L.droppable,resizeObserverConfig:{updateMeasurementsFor:Y,...h}}),{active:ce,activatorEvent:de,activeNodeRect:Se,attributes:Ue,setNodeRef:xe,listeners:H,isDragging:K,over:re,setActivatorNodeRef:V,transform:D}=sU({id:c,data:A,attributes:{..._U,...t},disabled:L.draggable}),z=B2(ee,xe),F=!!ce,P=F&&!E&&ad(y)&&ad(T),W=!O&&K,ge=W&&P?D:null,lt=P?ge??(d??$)({rects:S,activeNodeRect:Se,activeIndex:y,overIndex:T,index:U}):null,Ce=ad(y)&&ad(T)?o({id:c,items:p,activeIndex:y,overIndex:T}):U,ct=ce?.id,_e=C.useRef({activeId:ct,items:p,newIndex:Ce,containerId:m}),fn=p!==_e.current.items,xt=e({active:ce,containerId:m,isDragging:K,isSorting:F,id:c,index:U,items:p,newIndex:_e.current.newIndex,previousItems:_e.current.items,previousContainerId:_e.current.containerId,transition:g,wasDragging:_e.current.activeId!=null}),nn=bU({disabled:!xt,index:U,node:J,rect:Z});return C.useEffect(()=>{F&&_e.current.newIndex!==Ce&&(_e.current.newIndex=Ce),m!==_e.current.containerId&&(_e.current.containerId=m),p!==_e.current.items&&(_e.current.items=p)},[F,Ce,m,p]),C.useEffect(()=>{if(ct===_e.current.activeId)return;if(ct!=null&&_e.current.activeId==null){_e.current.activeId=ct;return}const xn=setTimeout(()=>{_e.current.activeId=ct},50);return()=>clearTimeout(xn)},[ct]),{active:ce,activeIndex:y,attributes:Ue,data:A,rect:Z,index:U,newIndex:Ce,items:p,isOver:fe,isSorting:F,isDragging:K,listeners:H,node:J,overIndex:T,over:re,setNodeRef:z,setActivatorNodeRef:V,setDroppableNodeRef:ee,setDraggableNodeRef:xe,transform:nn??lt,transition:Mt()};function Mt(){if(nn||fn&&_e.current.newIndex===U)return yU;if(!(W&&!hm(de)||!g)&&(F||xt))return wc.Transition.toString({...g,property:M1})}}function SU(s,e){var t,n;return typeof s=="boolean"?{draggable:s,droppable:!1}:{draggable:(t=s?.draggable)!=null?t:e.draggable,droppable:(n=s?.droppable)!=null?n:e.droppable}}function Vd(s){if(!s)return!1;const e=s.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const EU=[je.Down,je.Right,je.Up,je.Left],xU=(s,e)=>{let{context:{active:t,collisionRect:n,droppableRects:a,droppableContainers:o,over:c,scrollableAncestors:d}}=e;if(EU.includes(s.code)){if(s.preventDefault(),!t||!n)return;const h=[];o.getEnabled().forEach(m=>{if(!m||m!=null&&m.disabled)return;const y=a.get(m.id);if(y)switch(s.code){case je.Down:n.top<y.top&&h.push(m);break;case je.Up:n.top>y.top&&h.push(m);break;case je.Left:n.left>y.left&&h.push(m);break;case je.Right:n.left<y.left&&h.push(m);break}});const g=nM({collisionRect:n,droppableRects:a,droppableContainers:h});let p=_1(g,"id");if(p===c?.id&&g.length>1&&(p=g[1].id),p!=null){const m=o.get(t.id),y=o.get(p),_=y?a.get(y.id):null,E=y?.node.current;if(E&&_&&m&&y){const T=dh(E).some((Y,Z)=>d[Z]!==Y),O=U1(m,y),$=CU(m,y),L=T||!O?{x:0,y:0}:{x:$?n.width-_.width:0,y:$?n.height-_.height:0},U={x:_.left,y:_.top};return L.x&&L.y?U:bc(U,L)}}}};function U1(s,e){return!Vd(s)||!Vd(e)?!1:s.data.current.sortable.containerId===e.data.current.sortable.containerId}function CU(s,e){return!Vd(s)||!Vd(e)||!U1(s,e)?!1:s.data.current.sortable.index<e.data.current.sortable.index}function TU({item:s,index:e,renderItem:t,className:n=""}){const{attributes:a,listeners:o,setNodeRef:c,transform:d,transition:h,isDragging:g}=wU({id:e.toString()}),p={transform:wc.Transform.toString(d),transition:h};return w.jsx("div",{ref:c,style:p,className:`${n} ${g?"z-50 shadow-lg bg-white":""}`,children:t(s,e,g,{attributes:a,listeners:o})})}function DU({items:s,onReorder:e,renderItem:t,keyExtractor:n,className:a="",itemClassName:o=""}){const c=W2(mS(vm),mS(gm,{coordinateGetter:xU}));function d(h){const{active:g,over:p}=h;if(g.id!==p?.id&&p){const m=parseInt(g.id),y=parseInt(p.id),_=mm(s,m,y);e(_)}}return w.jsx(tU,{sensors:c,collisionDetection:tM,onDragEnd:d,children:w.jsx(gU,{items:s.map((h,g)=>g.toString()),strategy:hU,children:w.jsx("div",{className:a,children:s.map((h,g)=>w.jsx(TU,{item:h,index:g,renderItem:t,className:o},n(h)))})})})}const kU=({isOpen:s,onClose:e,onSave:t,currentTitle:n,currentDescription:a="",isSaving:o=!1})=>{const[c,d]=C.useState(n),[h,g]=C.useState(a);C.useEffect(()=>{s&&(d(n),g(a||""))},[s,n,a]);const p=async y=>{y.preventDefault(),c.trim()&&(await t(c.trim(),h.trim()),e())},m=()=>{d(n),g(a||""),e()};return w.jsx(ch,{isOpen:s,onClose:m,title:"Edit List",children:w.jsxs("form",{onSubmit:p,className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),w.jsx("input",{type:"text",id:"title",value:c,onChange:y=>d(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter list title",required:!0,disabled:o})]}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),w.jsx("textarea",{id:"description",value:h,onChange:y=>g(y.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter list description (optional)",disabled:o})]}),w.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[w.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",disabled:o,children:"Cancel"}),w.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",disabled:o||!c.trim(),children:o?"Saving...":"Save Changes"})]})]})})},AU=({isOpen:s,onClose:e,listId:t,listTitle:n})=>{const[a,o]=C.useState(""),[c,d]=C.useState(!1),[h,g]=C.useState([]),[p,m]=C.useState(!1),[y,_]=C.useState(null),[E,S]=C.useState(null),T=gt.getInstance(),O=T.getRemoteStorageService(),$=T.getLogService(),L=T.getAuthService();C.useEffect(()=>{s&&U()},[s,t]);const U=async()=>{try{m(!0),_(null);const ee=await L.getCurrentUser();if(!ee){_("You must be logged in to view invites");return}const ce=await O.getListInvites(t,ee.id);g(ce)}catch(ee){$.errorSync("Failed to load invites:",ee),_("Failed to load existing invites")}finally{m(!1)}},A=async()=>{try{d(!0),_(null),S(null);const ee=await L.getCurrentUser();if(!ee){_("You must be logged in to generate invites");return}const ce={listId:t,invitationFor:a.trim()},de=await O.createInvite(ce,ee.id);g(Se=>[de.invite,...Se]),S(`Invite for ${a.trim()} generated! Share this link: ${de.inviteUrl}`),o(""),$.infoSync("Invite generated successfully:",de)}catch(ee){$.errorSync("Failed to generate invite:",ee),_(ee instanceof Error?ee.message:"Failed to generate invite")}finally{d(!1)}},Y=async ee=>{try{const ce=await L.getCurrentUser();if(!ce){_("You must be logged in to revoke invites");return}await O.revokeInvite(ee,ce.id),g(de=>de.filter(Se=>Se.id!==ee)),S("Invite revoked successfully"),$.infoSync("Invite revoked successfully:",ee)}catch(ce){$.errorSync("Failed to revoke invite:",ce),_("Failed to revoke invite")}},Z=async ee=>{try{await navigator.clipboard.writeText(ee),S("Link copied to clipboard!"),setTimeout(()=>S(null),2e3)}catch(ce){$.errorSync("Failed to copy to clipboard:",ce),_("Failed to copy link")}},J=ee=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(ee),fe=ee=>{switch(ee){case"pending":return"text-yellow-600 bg-yellow-100";case"accepted":return"text-green-600 bg-green-100";case"expired":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}};return s?w.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:w.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[w.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:['Manage Invites for "',n,'"']}),w.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:w.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),w.jsxs("div",{className:"px-6 py-4 overflow-y-auto max-h-[calc(90vh-140px)]",children:[w.jsxs("div",{className:"mb-6",children:[w.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Generate New Invite"}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{type:"text",placeholder:"Who is this invite for? (e.g., John, Sarah, Team Lead)",value:a,onChange:ee=>o(ee.target.value),className:"flex-1 input",disabled:c}),w.jsx("button",{onClick:A,disabled:!a.trim()||c,className:"btn btn-primary",children:c?"Generating...":"Generate New Invite"})]})]}),y&&w.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-md",children:y}),E&&w.jsx("div",{className:"mb-4 p-3 bg-green-100 border border-green-300 text-green-700 rounded-md",children:E}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Invites by Person"}),p?w.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading invites..."}):h.length===0?w.jsx("div",{className:"text-center py-4 text-gray-500",children:"No invites yet. Generate your first invite above!"}):w.jsx("div",{className:"space-y-3",children:h.map(ee=>w.jsxs("div",{className:"p-3 border border-gray-200 rounded-lg bg-gray-50",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"font-medium text-gray-900",children:ee.invitationFor}),w.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${fe(ee.status)}`,children:ee.status})]}),w.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Created: ",J(ee.createdAt),ee.expiresAt&&w.jsxs("span",{className:"ml-4",children:["Expires: ",J(ee.expiresAt)]})]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("button",{onClick:()=>Z(`${window.location.origin}/manage/#/invite/${ee.token}`),className:"btn btn-secondary text-sm",children:"Copy Link"}),ee.status==="pending"&&w.jsx("button",{onClick:()=>Y(ee.id),className:"btn btn-danger text-sm",children:"Revoke"})]})]},ee.id))})]})]}),w.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:w.jsx("div",{className:"flex justify-end",children:w.jsx("button",{onClick:e,className:"btn btn-secondary",children:"Close"})})})]})}):null},$l=({onClick:s,icon:e,children:t,variant:n="default",disabled:a=!1})=>{const d=`w-full text-left px-4 py-2.5 text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${{default:"text-gray-700 hover:bg-gray-100",danger:"text-red-600 hover:bg-red-50"}[n]}`;return w.jsxs("button",{onClick:s,className:d,disabled:a,type:"button",children:[e&&w.jsx("span",{className:"mr-2 inline-block w-4",children:e}),t]})},RU=()=>{const{listId:s}=IS(),e=ni(),[t,n]=C.useState(""),[a,o]=C.useState(null),[c,d]=C.useState(""),[h,g]=C.useState(!1),[p,m]=C.useState(null),[y,_]=C.useState(!1),[E,S]=C.useState(!1),[T,O]=C.useState(!1),[$,L]=C.useState(!1),[U,A]=C.useState(!1),[Y,Z]=C.useState(!1),[J,fe]=C.useState(!1),[ee,ce]=C.useState(!1),[de,Se]=C.useState(!1),[Ue,xe]=C.useState(!1),K=gt.getInstance().getLogService(),re=C.useRef(null),V=C.useRef(null),D=C.useRef(new Map),{user:z}=hi();C.useEffect(()=>{const se=_t=>{re.current&&!re.current.contains(_t.target)&&_(!1)};return y&&document.addEventListener("mousedown",se),()=>{document.removeEventListener("mousedown",se)}},[y]);const[F,P]=C.useState(null),{document:W,isLoading:ge,error:ne,wasDeletedRemotely:lt,isAddingItem:Ce,isDeletingItem:ct,addItem:_e,updateItem:fn,deleteItem:xt,toggleItem:nn,moveItem:Mt,editListMetadata:xn,deleteList:Cn,leaveList:Ct,clearCompletedItems:Qr}=I2(s||""),ds=()=>{P("newItem")},Tn=se=>{P(se)},ii=se=>{o(se.id),d(se.content)},Oi=async()=>{if(a&&c.trim()!=="")try{await fn(a,{content:c.trim()}),o(null),d("")}catch(se){K.errorSync("Failed to update item:",se)}},hs=()=>{o(null),d("")},Xr=se=>{se.key==="Enter"?Oi():se.key==="Escape"&&hs()},No=se=>{m(se),g(!0)},gn=W?.title||"Untitled List",Qe=C.useMemo(()=>W?.items||[],[W?.items]);if(C.useEffect(()=>{if(F==="newItem"&&V.current&&document.activeElement!==V.current&&setTimeout(()=>{V.current?.focus()},0),F&&F!=="newItem"&&D.current.has(F)){const se=D.current.get(F);se&&document.activeElement!==se&&setTimeout(()=>{se.focus()},0)}},[Qe,F]),!s)return w.jsx("div",{children:"List ID is required"});if(ge)return w.jsx("div",{className:"flex items-center justify-center min-h-screen",children:w.jsx(gv,{completedItems:0,totalItems:0})});if(ne)return w.jsx("div",{className:"flex items-center justify-center min-h-screen",children:w.jsxs("div",{className:"text-center",children:[w.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Error Loading List"}),w.jsx("p",{className:"text-gray-600",children:ne})]})});if(lt)return w.jsx("div",{className:"flex items-center justify-center min-h-screen",children:w.jsxs("div",{className:"text-center",children:[w.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"List Deleted"}),w.jsx("p",{className:"text-gray-600 mb-4",children:"This list was deleted by another user."}),w.jsx("button",{onClick:()=>e("/lists"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Lists"})]})});const Tt=z?.id===W?.ownerId,ut=async()=>{if(t.trim())try{await _e(t.trim()),n("")}catch(se){K.errorSync("Failed to add item:",se)}},Kr=async()=>{if(p)try{await xt(p.id),g(!1),m(null)}catch(se){K.errorSync("Error deleting item:",se)}},zn=()=>{g(!1),m(null)},Jr=async se=>{const _t=W?.items||[];for(let It=0;It<se.length;It++)if(_t[It]?.id!==se[It].id){const ze=se[It];try{await Mt(ze.id,It)}catch(Ie){K.errorSync("Error moving item:",Ie)}break}},fs=()=>{e("/lists")},gs=()=>{S(!0),_(!1)},Dn=async(se,_t)=>{try{O(!0),await xn({title:se,description:_t}),K.infoSync("List updated successfully")}catch(It){K.errorSync("Failed to update list:",It)}finally{O(!1)}},Li=()=>{_(!y)},ji=()=>{L(!0),_(!1)},Zr=async()=>{try{A(!0),await Cn(),e("/lists")}catch(se){K.errorSync("Failed to delete list:",se)}finally{A(!1),L(!1)}},Wr=()=>{L(!1)},ea=()=>{Z(!0),_(!1)},ar=async()=>{try{fe(!0),await Qr(),K.infoSync("Completed items cleared successfully")}catch(se){K.errorSync("Failed to clear completed items:",se)}finally{fe(!1),Z(!1)}},st=()=>{Z(!1)},Qt=()=>{ce(!0),_(!1)},Ut=()=>{Se(!0),_(!1)},kn=async()=>{try{xe(!0),await Ct(),e("/lists")}catch(se){K.errorSync("Failed to leave list:",se)}finally{xe(!1),Se(!1)}},$t=()=>{Se(!1)};return w.jsxs("div",{className:"max-w-4xl mx-auto",children:[w.jsxs("div",{className:"mb-6",children:[w.jsxs("div",{className:"flex items-center mb-2",children:[w.jsx("button",{onClick:fs,className:"btn btn-secondary mr-4","aria-label":"Back to lists",children:""}),w.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:gn}),w.jsxs("div",{className:"relative ml-auto",ref:re,children:[w.jsx("button",{onClick:Li,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",title:"List options",children:w.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),y&&w.jsxs("div",{className:"absolute right-0 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-10",children:[w.jsx($l,{onClick:gs,icon:"",children:"Edit List"}),w.jsx($l,{onClick:ea,icon:"",children:"Clear Completed"}),Tt&&w.jsx($l,{onClick:Qt,icon:"",children:"Manage Invites"}),!Tt&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"border-t border-gray-200"}),w.jsx($l,{onClick:Ut,icon:"",variant:"danger",children:"Leave List"})]}),Tt&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"border-t border-gray-200"}),w.jsx($l,{onClick:ji,icon:"",variant:"danger",children:"Delete List"})]})]})]})]}),W?.description&&w.jsx("p",{className:"text-gray-600 ml-16",children:W.description})]}),Qe.length>0&&w.jsx("div",{className:"mt-4",children:w.jsx(gv,{completedItems:Qe.filter(se=>se.isCompleted).length,totalItems:Qe.length,showLabel:!0,showProgressBar:!0,className:"text-center"})}),w.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 my-6",children:w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{ref:V,type:"text",value:t,onChange:se=>n(se.target.value),onKeyDown:se=>se.key==="Enter"&&ut(),onFocus:ds,placeholder:"Add a new item...",className:"input flex-1"}),w.jsx("button",{onClick:ut,disabled:!t.trim()||Ce,className:"btn btn-primary",children:Ce?"Adding...":"Add"})]})}),w.jsx("div",{className:"bg-white rounded-lg border border-gray-200",children:Qe.length===0?w.jsx("div",{className:"p-8 text-center text-gray-500",children:"No items yet. Add your first item above!"}):w.jsx(DU,{items:Qe,onReorder:Jr,keyExtractor:se=>se.id,className:"divide-y divide-gray-200",itemClassName:"",renderItem:(se,_t,It,ze)=>w.jsxs("div",{className:"flex items-center gap-3 p-4",children:[w.jsx("div",{...ze.attributes,...ze.listeners,className:"cursor-grab active:cursor-grabbing text-gray-400 hover:text-gray-600 p-1",title:"Drag to reorder",children:""}),w.jsx("input",{type:"checkbox",checked:se.isCompleted,onChange:()=>nn(se.id),className:"w-4 h-4 text-primary-600 rounded border-gray-300 focus:ring-primary-500"}),w.jsx("div",{className:"flex-1",children:a===se.id?w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{ref:Ie=>{Ie?D.current.set(se.id,Ie):D.current.delete(se.id)},type:"text",value:c,onChange:Ie=>d(Ie.target.value),onKeyDown:Xr,onFocus:()=>Tn(se.id),className:"flex-1 bg-white border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0}),w.jsx("button",{onClick:Oi,className:"text-green-600 hover:text-green-800 px-2 py-1 text-sm",title:"Save",children:""}),w.jsx("button",{onClick:hs,className:"text-gray-600 hover:text-gray-800 px-2 py-1 text-sm",title:"Cancel",children:""})]}):w.jsx("div",{className:`cursor-pointer ${se.isCompleted?"line-through text-gray-500":"text-gray-900"}`,onClick:()=>ii(se),children:se.content})}),a!==se.id&&w.jsx("button",{onClick:()=>No(se),className:"text-red-500 hover:text-red-700 p-1",title:"Delete item",children:""})]})})}),!1,w.jsx(Gl,{isOpen:h,onClose:zn,onConfirm:Kr,title:"Delete Item",message:`Are you sure you want to delete "${p?.content}"? This action cannot be undone.`,isDeleting:ct}),w.jsx(Gl,{isOpen:$,onClose:Wr,onConfirm:Zr,title:"Delete List",message:`Are you sure you want to delete "${gn}"? This will permanently remove the list and all its items. This action cannot be undone.`,isDeleting:U}),w.jsx(Gl,{isOpen:Y,onClose:st,onConfirm:ar,title:"Clear Completed Items",message:`Are you sure you want to clear all completed items from "${gn}"? This action cannot be undone.`,isDeleting:J}),w.jsx(Gl,{isOpen:de,onClose:$t,onConfirm:kn,title:"Leave List",message:`Are you sure you want to leave "${gn}"? You will no longer have access to this list and all local data will be removed.`,isDeleting:Ue}),w.jsx(kU,{isOpen:E,onClose:()=>S(!1),onSave:Dn,currentTitle:gn,currentDescription:W?.description||"",isSaving:T}),w.jsx(AU,{isOpen:ee,onClose:()=>ce(!1),listId:s||"",listTitle:gn})]})};function OU({onSuccess:s}){const{signIn:e,loading:t,error:n,clearError:a}=hi(),o=ni(),[c,d]=C.useState({email:"",password:""}),h=async m=>{m.preventDefault(),a();try{const y={email:c.email,password:c.password};await e(y),s?.()}catch{}},g=()=>{o("/password-reset")},p=m=>{const{name:y,value:_}=m.target;d(E=>({...E,[y]:_}))};return w.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[w.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Sign In"}),n&&w.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:n}),w.jsxs("form",{onSubmit:h,className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),w.jsx("input",{type:"email",id:"email",name:"email",value:c.email,onChange:p,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your email",autoFocus:!0})]}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),w.jsx("input",{type:"password",id:"password",name:"password",value:c.password,onChange:p,required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your password"})]}),w.jsx("button",{type:"submit",disabled:t,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Loading...":"Sign In"}),w.jsx("div",{className:"text-center",children:w.jsx("button",{type:"button",onClick:g,className:"text-blue-600 hover:text-blue-500 font-medium",children:"Forgot your password?"})})]})]})}function LU(){const s=ni();C.useEffect(()=>{const n=setTimeout(async()=>{try{console.log("Attempting to clean up leftover databases on auth page load..."),await gt.getInstance().cleanupLeftoverDatabases()}catch(a){console.log("Error during database cleanup on auth page load:",a)}},500);return()=>clearTimeout(n)},[]);const e=()=>{s("/lists")};return w.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[w.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[w.jsx("h1",{className:"text-center text-3xl font-extrabold text-gray-900 mb-2",children:"Shared Lists App"}),w.jsx("p",{className:"text-center text-gray-600",children:"Collaborative lists for families and teams"})]}),w.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[w.jsx(OU,{onSuccess:e}),w.jsx("div",{className:"mt-6 text-center",children:w.jsxs("p",{className:"text-sm text-gray-600",children:["This is an invite-only system. Need access?"," ",w.jsx("a",{href:"mailto:sandymc@gmail.com",className:"font-medium text-blue-600 hover:text-blue-500",children:"Request an invite"})]})})]})]})}function jU({onSuccess:s,onCancel:e}){const{updatePassword:t,loading:n,error:a,clearError:o}=hi(),[c,d]=C.useState({newPassword:"",confirmPassword:""}),[h,g]=C.useState(null),p=async y=>{if(y.preventDefault(),o(),g(null),c.newPassword!==c.confirmPassword){g("Passwords do not match");return}if(c.newPassword.length<6){g("Password must be at least 6 characters long");return}try{await t(c.newPassword),s?.()}catch{}},m=y=>{const{name:_,value:E}=y.target;d(S=>({...S,[_]:E}))};return w.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[w.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Set New Password"}),w.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Please enter your new password below."}),(a||h)&&w.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:a||h}),w.jsxs("form",{onSubmit:p,className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),w.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:c.newPassword,onChange:m,required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your new password",autoFocus:!0})]}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),w.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:c.confirmPassword,onChange:m,required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirm your new password"})]}),w.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Updating...":"Update Password"}),e&&w.jsx("div",{className:"text-center",children:w.jsx("button",{type:"button",onClick:e,className:"text-blue-600 hover:text-blue-500 font-medium",children:"Cancel"})})]})]})}function RS(){const s=ni(),{resetPassword:e,clearRecoverySession:t,loading:n,error:a,clearError:o}=hi(),[c,d]=C.useState(!1),[h,g]=C.useState(!0),[p,m]=C.useState(!1),[y,_]=C.useState("");C.useEffect(()=>{const O=Jv();console.log("Full URL hash:",window.location.hash),console.log("Parsed hash params:",O),console.log("Has recovery params:",kd()),kd()?(console.log("Recovery parameters found:",O),d(!0)):(console.log("No valid recovery parameters found"),d(!1)),g(!1)},[]);const E=()=>{t(),s("/lists")},S=()=>{t(),s("/auth",{replace:!0})},T=async O=>{O.preventDefault(),o();try{await e(y),m(!0)}catch{}};return h?w.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),w.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):c?w.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[w.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[w.jsx("h1",{className:"text-center text-3xl font-extrabold text-gray-900 mb-2",children:"SharedListsApp"}),w.jsx("p",{className:"text-center text-gray-600",children:"Reset your password"})]}),w.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:w.jsx(jU,{onSuccess:E,onCancel:S})})]}):w.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:w.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[w.jsx("h1",{className:"text-2xl font-bold text-center mb-6",children:"Request Password Reset"}),a&&w.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:a}),p?w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:"Password reset email sent! Check your inbox and follow the instructions to reset your password."}),w.jsx("button",{onClick:()=>s("/auth"),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Go to Sign In"})]}):w.jsxs("form",{onSubmit:T,className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),w.jsx("input",{type:"email",id:"email",value:y,onChange:O=>_(O.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your email",autoFocus:!0})]}),w.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Sending...":"Send Reset Email"}),w.jsx("div",{className:"text-center",children:w.jsx("button",{type:"button",onClick:()=>s("/auth"),className:"text-blue-600 hover:text-blue-500 font-medium",children:"Back to Sign In"})})]})]})})}function NU(){const s=ni(),{user:e}=hi();return C.useEffect(()=>{kd()?s("/reset-password",{replace:!0}):e?s("/lists",{replace:!0}):s("/auth",{replace:!0})},[s,e]),w.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),w.jsx("p",{className:"mt-4 text-gray-600",children:"Redirecting..."})]})})}function MU(){const[s,e]=C.useState(!1),t=ni();return C.useEffect(()=>{const n=setTimeout(()=>{e(!0)},1e3);return()=>clearTimeout(n)},[]),w.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[w.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-green-500 text-6xl mb-4",children:""}),w.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 mb-2",children:"Signed Out Successfully"}),w.jsx("p",{className:"text-gray-600 mb-8",children:"You have been signed out of your account. All your data has been cleared from this device."})]})}),w.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:w.jsx("div",{className:"bg-white py-8 px-6 shadow rounded-lg",children:w.jsx("div",{className:"text-center space-y-4",children:s?w.jsxs(w.Fragment,{children:[w.jsx("p",{className:"text-sm text-gray-600",children:"Ready to get back to your lists?"}),w.jsx("button",{onClick:()=>{t("/auth")},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",children:"Sign In Again"})]}):w.jsx("div",{className:"text-sm text-gray-500",children:w.jsx("div",{className:"animate-pulse",children:"Clearing data..."})})})})})]})}const Gd=({message:s="Loading...",size:e="md"})=>{const t={sm:"h-8 w-8",md:"h-12 w-12",lg:"h-16 w-16"};return w.jsx("div",{className:"flex items-center justify-center min-h-screen",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:`animate-spin rounded-full border-b-2 border-blue-600 mx-auto ${t[e]}`}),w.jsx("p",{className:"mt-4 text-gray-600",children:s})]})})},UU=()=>{const{token:s}=IS(),e=ni(),{user:t,loading:n}=hi(),[a,o]=C.useState(null),[c,d]=C.useState(!0),[h,g]=C.useState(!1),[p,m]=C.useState(null),[y,_]=C.useState(null),E=gt.getInstance(),S=E.getLogService(),T=E.getRemoteStorageService(),O=E.getListController();C.useEffect(()=>{if(!s){m("Invalid invite link"),d(!1);return}$()},[s]);const $=async()=>{try{d(!0),m(null);const A=await T.getInviteByToken(s);o(A),d(!1)}catch(A){S.errorSync("Failed to load invite:",A),m(A instanceof Error?A.message:"Failed to load invite details"),d(!1)}},L=async()=>{if(!(!t||!a))try{g(!0),m(null),await T.acceptInvite(a.token),_("Invite accepted successfully! Setting up list...");try{_("Setting up list data..."),await O.bootstrapFromRemote(),_("List ready! Redirecting..."),setTimeout(()=>{e(`/list/${a.yjsDocumentId}`)},1500)}catch(A){S.errorSync("Failed to bootstrap list data:",A),_("Invite accepted! Redirecting..."),setTimeout(()=>{e(`/list/${a.yjsDocumentId}`)},1500)}}catch(A){S.errorSync("Failed to accept invite:",A),m(A instanceof Error?A.message:"Failed to accept invite"),g(!1)}},U=()=>{e("/auth")};return n||c?w.jsx("div",{className:"min-h-screen flex items-center justify-center",children:w.jsx(Gd,{message:"Loading invite..."})}):t?p?w.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:w.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center",children:[w.jsxs("div",{className:"mb-6",children:[w.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-2",children:"Invalid Invite"}),w.jsx("p",{className:"text-gray-600",children:p})]}),w.jsx("button",{onClick:()=>e("/lists"),className:"bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition-colors",children:"Go to Lists"})]})}):a?w.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:w.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8",children:[w.jsxs("div",{className:"mb-6 text-center",children:[w.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Accept Invite"}),w.jsx("p",{className:"text-gray-600",children:"You've been invited to join a list"})]}),w.jsx("div",{className:"mb-6 space-y-4",children:w.jsxs("div",{className:"bg-gray-50 p-4 rounded-md",children:[w.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Invite Details"}),w.jsxs("div",{className:"space-y-2 text-sm",children:[w.jsxs("div",{children:[w.jsx("span",{className:"font-medium text-gray-700",children:"For:"})," ",a.invitationFor]}),w.jsxs("div",{children:[w.jsx("span",{className:"font-medium text-gray-700",children:"Status:"}),w.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${a.status==="pending"?"bg-yellow-100 text-yellow-800":a.status==="accepted"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.status})]}),w.jsxs("div",{children:[w.jsx("span",{className:"font-medium text-gray-700",children:"Expires:"})," ",a.expiresAt.toLocaleDateString()]})]})]})}),y?w.jsx("div",{className:"mb-4 p-4 bg-green-100 text-green-800 rounded-md text-center",children:y}):w.jsxs("div",{className:"space-y-4",children:[w.jsx("button",{onClick:L,disabled:h||a.status!=="pending",className:`w-full py-2 px-4 rounded-md transition-colors ${a.status==="pending"&&!h?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:h?"Accepting...":"Accept Invite"}),a.status!=="pending"&&w.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["This invite has already been"," ",a.status==="accepted"?"accepted":"expired","."]})]}),w.jsx("div",{className:"mt-6 text-center",children:w.jsx("button",{onClick:()=>e("/lists"),className:"text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"})})]})}):w.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:w.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center",children:[w.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Loading Invite..."}),w.jsx(Gd,{message:"Please wait..."})]})}):w.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:w.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center",children:[w.jsxs("div",{className:"mb-6",children:[w.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Sign In Required"}),w.jsx("p",{className:"text-gray-600",children:"You need to sign in or create an account to accept this invite."})]}),w.jsxs("div",{className:"space-y-4",children:[w.jsx("button",{onClick:U,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Sign In / Sign Up"}),w.jsx("p",{className:"text-sm text-gray-500",children:"After signing in, you'll be able to accept the invite and join the list."})]})]})})};function OS({children:s,fallback:e}){const{user:t,loading:n}=hi();return n?w.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),w.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):t?w.jsx(w.Fragment,{children:s}):e?w.jsx(w.Fragment,{children:e}):w.jsx(KD,{to:"/auth",replace:!0})}function $U({isOpen:s,onClose:e,onSuccess:t}){const{user:n,updateProfile:a}=hi(),[o,c]=C.useState(n?.displayName||""),[d,h]=C.useState(!1),[g,p]=C.useState(null);C.useEffect(()=>{n&&c(n.displayName||"")},[n?.displayName]);const m=async()=>{if(n)try{h(!0),p(null),await a({displayName:o.trim()||void 0}),t&&t(o.trim()),e()}catch(_){p(_ instanceof Error?_.message:"Failed to update profile")}finally{h(!1)}},y=()=>{c(n?.displayName||""),p(null),e()};return w.jsx(ch,{isOpen:s,onClose:y,title:"Edit Profile",children:w.jsxs("div",{className:"space-y-4",children:[g&&w.jsx("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:g}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Name"}),w.jsx("input",{id:"displayName",type:"text",value:o,onChange:_=>c(_.target.value),placeholder:"Enter your display name",className:"input",autoFocus:!0}),w.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This name will be displayed in the header and shared lists"})]}),w.jsxs("div",{className:"flex gap-2 justify-end",children:[w.jsx("button",{onClick:y,className:"btn btn-secondary",children:"Cancel"}),w.jsx("button",{onClick:m,disabled:d,className:"btn btn-primary",children:d?"Updating...":"Update Profile"})]})]})})}const $1=C.forwardRef(({user:s,onClick:e},t)=>{const[n,a]=C.useState(s?.displayName||"");C.useImperativeHandle(t,()=>({setDisplayName:c=>{a(c)}}));const o=c=>c?c.split(" ").map(d=>d.charAt(0)).join("").toUpperCase().slice(0,2):"?";return s?w.jsx("button",{onClick:e,className:"w-8 h-8 bg-gray-600 hover:bg-gray-700 text-white rounded-full flex items-center justify-center text-sm font-medium transition-colors",children:o(n)}):null});$1.displayName="UserAvatar";function IU(){const{user:s,signOut:e}=hi(),[t,n]=C.useState(!1),[a,o]=C.useState(!1),[c,d]=C.useState(!1),[h,g]=C.useState(!0),[p,m]=C.useState(0),y=C.useRef(null);C.useEffect(()=>{const A=()=>{const Y=window.scrollY;Y<p?g(!0):Y>p&&Y>100&&g(!1),m(Y)};return window.addEventListener("scroll",A,{passive:!0}),()=>{window.removeEventListener("scroll",A)}},[p]);const _=()=>{n(!t)},E=()=>{n(!1)},S=()=>{o(!0)},T=()=>{o(!1)},O=()=>{d(!0),E()},$=()=>{d(!1)},L=A=>{y.current&&y.current.setDisplayName(A)},U=async()=>{try{await e(),E()}catch(A){console.error("Sign out failed:",A)}};return w.jsxs(w.Fragment,{children:[w.jsx("header",{className:`fixed top-0 left-0 right-0 bg-white border-b border-gray-200 shadow-sm z-50 transition-transform duration-300 ease-in-out ${h?"translate-y-0":"-translate-y-full"}`,children:w.jsx("div",{className:"container mx-auto px-4",children:w.jsxs("div",{className:"flex items-center justify-between h-16",children:[w.jsxs(mb,{to:"/",className:"flex items-center space-x-2 hover:opacity-80 transition-opacity",children:[w.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:w.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),w.jsx("span",{className:"text-xl font-semibold text-gray-900",children:"Shared Lists"})]}),w.jsxs("div",{className:"flex items-center space-x-3",children:[s&&w.jsx("button",{onClick:S,className:"w-8 h-8 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center justify-center transition-colors",title:"Create New List",children:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s?w.jsxs("div",{className:"relative",children:[w.jsx($1,{ref:y,user:s,onClick:_}),t&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"fixed inset-0 z-40",onClick:E}),w.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-50",children:w.jsxs("div",{className:"py-1",children:[w.jsx("button",{onClick:O,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:"Edit Profile"}),w.jsx("button",{onClick:U,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:"Sign Out"})]})})]})]}):w.jsx(mb,{to:"/auth",className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-md transition-colors",children:"Sign In"})]})]})})}),w.jsx(f1,{isOpen:a,onClose:T}),w.jsx($U,{isOpen:c,onClose:$,onSuccess:L})]})}function BU(){const[s,e]=C.useState("syncing"),[t,n]=C.useState("idle"),[a,o]=C.useState(!1),[c,d]=C.useState({browserOnline:navigator.onLine,realtimeConnected:!1,isOnline:!1}),{user:h,loading:g}=hi(),p=C.useMemo(()=>gt.getInstance(),[]),m=C.useMemo(()=>p.getLogService(),[p]);return C.useEffect(()=>{if(!h||g||a)return;(async()=>{e("syncing");try{const _=p.getListController();await _.getAllLists(),await p.getRemoteUpdateHandler().start();const S=p.getConnectionMonitor();S.start(),S.onConnectionChange(O=>{d($=>(O.isOnline!==$.isOnline&&m.infoSync("Connection state changed:",{isOnline:O.isOnline,browserOnline:O.browserOnline,realtimeConnected:O.realtimeConnected}),O))}),await new Promise(O=>setTimeout(O,1e3));try{n("loading"),await _.bootstrapFromRemote(),m.infoSync("Bootstrap completed successfully"),n("complete"),await new Promise(O=>setTimeout(O,500))}catch(O){m.warnSync("Failed to bootstrap from remote server:",O),n("error")}await p.getBackgroundSyncService().start(),e("synced"),o(!0)}catch(_){m.errorSync("Error initializing app:",_),e("offline"),o(!0)}})()},[h,g,p,m,a]),C.useEffect(()=>{h||(n("idle"),o(!1))},[h]),w.jsxs("div",{className:"min-h-screen bg-gray-50",children:[w.jsx(IU,{}),!1,w.jsx("div",{className:"container mx-auto px-4 py-8 pt-24",children:w.jsxs(ZD,{children:[w.jsx(Wi,{path:"/auth",element:w.jsx(LU,{})}),w.jsx(Wi,{path:"/reset-password",element:w.jsx(RS,{})}),w.jsx(Wi,{path:"/password-reset",element:w.jsx(RS,{})}),w.jsx(Wi,{path:"/signout",element:w.jsx(MU,{})}),w.jsx(Wi,{path:"/invite/:token",element:w.jsx(UU,{})}),w.jsx(Wi,{path:"/",element:w.jsx(NU,{})}),w.jsx(Wi,{path:"/lists",element:g?w.jsx(Gd,{message:"Loading..."}):w.jsx(OS,{children:w.jsx(U2,{})})}),w.jsx(Wi,{path:"/list/:listId",element:g?w.jsx(Gd,{message:"Loading..."}):w.jsx(OS,{children:w.jsx(RU,{})})})]})})]})}var I1=C.createContext({client:Nr});function B1(s,e,t){if(t===void 0&&(t=new WeakMap),s===e)return!0;if(typeof s!="object"||s===null||typeof e!="object"||e===null)return!1;if(t.has(s)&&t.get(s)===e)return!0;t.set(s,e);var n=Object.keys(s),a=Object.keys(e);if(n.length!==a.length)return!1;for(var o=0,c=n;o<c.length;o++){var d=c[o];if(!a.includes(d)||!B1(s[d],e[d],t))return!1}return!0}function zU(s){var e=s.children,t=s.client,n=s.apiKey,a=s.options,o=C.useRef(null),c=C.useMemo(function(){return t?(n&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),a&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),t):(n||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),Nr)},[t,n,JSON.stringify(a)]);return C.useEffect(function(){if(!t){var d=o.current;d?(n!==d.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),a&&!B1(a,d.options)&&Nr.set_config(a),o.current={apiKey:n,options:a??{}}):(Nr.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),Nr.init(n,a),o.current={apiKey:n,options:a??{}})}},[t,n,JSON.stringify(a)]),ft.createElement(I1.Provider,{value:{client:c}},e)}var bv=function(s,e){return bv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])},bv(s,e)};function PU(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");bv(s,e);function t(){this.constructor=s}s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var pp=function(s){return typeof s=="function"},qU={componentStack:null,exceptionEvent:null,error:null},HU={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};(function(s){PU(e,s);function e(t){var n=s.call(this,t)||this;return n.state=qU,n}return e.prototype.componentDidCatch=function(t,n){var a=this.props.additionalProperties,o;pp(a)?o=a(t):typeof a=="object"&&(o=a);var c=this.context.client,d=c.captureException(t,o),h=n.componentStack;this.setState({error:t,componentStack:h,exceptionEvent:d})},e.prototype.render=function(){var t=this.props,n=t.children,a=t.fallback,o=this.state;if(o.componentStack==null)return pp(n)?n():n;var c=pp(a)?ft.createElement(a,{error:o.error,componentStack:o.componentStack,exceptionEvent:o.exceptionEvent}):a;return ft.isValidElement(c)?c:(console.warn(HU.INVALID_FALLBACK),ft.createElement(ft.Fragment,null))},e.contextType=I1,e})(ft.Component);aD.createRoot(document.getElementById("root")).render(w.jsx(ft.StrictMode,{children:w.jsx(zU,{apiKey:"phc_FYn515r5YWyPaCiWwdwpDAOZmcIyhKBErrVG8OmPr9D",options:{api_host:"https://us.i.posthog.com",defaults:"2025-05-24",capture_exceptions:!0,debug:!1},children:w.jsx(rk,{children:w.jsx(BU,{})})})}));
